#include <stdio.h>
#ifdef _WIN32
  #include <WinSock2.h>
#else
  #include <unistd.h>
#endif
#define chararraysize 2048
int main(void) {
  int res __attribute__((unused)) = 0;
  char hostname[chararraysize] __attribute__((unused));
  FILE *outfp = NULL;
  #ifdef _WIN32
  LPHOSTENT lpHostEntry;
  WORD wVersionRequested;
  WSADATA wsaData;
  wVersionRequested = MAKEWORD(1, 1);
  WSAStartup(wVersionRequested, &wsaData);
  #endif

  outfp = fopen("${BRLCAD_BINARY_DIR}/include/conf/HOST.tmp", "w");

#if defined(_BSD_SOURCE) \
    || defined(_XOPEN_SOURCE) && _XOPEN_SOURCE  >= 500 \
    || defined(_POSIX_C_SOURCE) && _POSIX_C_SOURCE >= 200112
  res = gethostname(hostname, chararraysize - 1);
  if (!res && hostname[0] != ' ')
    fprintf(outfp, "\"%s\"", hostname);
  else
    fprintf(outfp, "\"%s\"", "unknown");
#else
  fprintf(outfp, "\"%s\"", "unknown");
#endif

  fclose(outfp);
  return 0;
}
