blob
data 1525
This software is copyrighted by Brian Paul (brian@mesa3d.org),
Benjamin Bederson (bederson@cs.umd.edu), and Greg Couch
(gregcouch@users.sourceforge.net).  The following terms apply to all
files associated with the software unless explicitly disclaimed in
individual files.

The authors hereby grant permission to use, copy, modify, distribute,
and license this software and its documentation for any purpose, provided
that existing copyright notices are retained in all copies and that this
notice is included verbatim in any distributions.  No written agreement,
license, or royalty fee is required for any of the authorized uses.
Modifications to this software may be copyrighted by their authors
and need not follow the licensing terms described here, provided that
the new terms are clearly indicated on the first page of each file where
they apply.

IN NO EVENT SHALL THE AUTHORS OR DISTRIBUTORS BE LIABLE TO ANY PARTY
FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OF THIS SOFTWARE, ITS DOCUMENTATION, OR ANY
DERIVATIVES THEREOF, EVEN IF THE AUTHORS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.

THE AUTHORS AND DISTRIBUTORS SPECIFICALLY DISCLAIM ANY WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.  THIS SOFTWARE
IS PROVIDED ON AN "AS IS" BASIS, AND THE AUTHORS AND DISTRIBUTORS HAVE
NO OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
MODIFICATIONS.

blob
data 20408
# Makefile.in --
#
#	This file is a Makefile for Sample TEA Extension.  If it has the name
#	"Makefile.in" then it is a template for a Makefile;  to generate the
#	actual Makefile, run "./configure", which is a configuration script
#	generated by the "autoconf" program (constructs like "@foo@" will get
#	replaced in the actual Makefile.
#
# Copyright (c) 1999 Scriptics Corporation.
# Copyright (c) 2002-2005 ActiveState Corporation.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# RCS: @(#) $Id$

#========================================================================
# Add additional lines to handle any additional AC_SUBST cases that
# have been added in a customized configure script.
#========================================================================

#SAMPLE_NEW_VAR	= @SAMPLE_NEW_VAR@
SHLIB_SUFFIX	= @SHLIB_SUFFIX@
MATH_LIBS	= @MATH_LIBS@
LIBGLU		= @LIBGLU@

EXAMPLE_SRCS	= double.c gears.c index.c overlay.c stereo.c texture.c
EXAMPLE_OBJS	= $(EXAMPLE_SRCS:.c=.$(OBJEXT))
EXAMPLE_SHLIBS	= $(EXAMPLE_SRCS:.c=$(SHLIB_SUFFIX))

#========================================================================
# Nothing of the variables below this line should need to be changed.
# Please check the TARGETS section below to make sure the make targets
# are correct.
#========================================================================

#========================================================================
# The names of the source files is defined in the configure script.
# The object files are used for linking into the final library.
# This will be used when a dist target is added to the Makefile.
# It is not important to specify the directory, as long as it is the
# $(srcdir) or in the generic, win or unix subdirectory.
#========================================================================

PKG_SOURCES	= @PKG_SOURCES@
PKG_OBJECTS	= @PKG_OBJECTS@

PKG_STUB_SOURCES = @PKG_STUB_SOURCES@
PKG_STUB_OBJECTS = @PKG_STUB_OBJECTS@

#========================================================================
# PKG_TCL_SOURCES identifies Tcl runtime files that are associated with
# this package that need to be installed, if any.
#========================================================================

PKG_TCL_SOURCES = @PKG_TCL_SOURCES@

#========================================================================
# This is a list of public header files to be installed, if any.
#========================================================================

PKG_HEADERS	= @PKG_HEADERS@

#========================================================================
# "PKG_LIB_FILE" refers to the library (dynamic or static as per
# configuration options) composed of the named objects.
#========================================================================

PKG_LIB_FILE	= @PKG_LIB_FILE@
PKG_STUB_LIB_FILE = @PKG_STUB_LIB_FILE@

pkglib_BINARIES	= $(PKG_LIB_FILE)
lib_BINARIES	= $(PKG_STUB_LIB_FILE)
BINARIES	= $(pkglib_BINARIES) $(lib_BINARIES)

SHELL		= @SHELL@

srcdir		= @srcdir@
prefix		= @prefix@
exec_prefix	= @exec_prefix@

bindir		= @bindir@
libdir		= @libdir@
includedir	= @includedir@
datarootdir	= @datarootdir@
datadir		= @datadir@
mandir		= @mandir@

DESTDIR		=

PKG_DIR		= $(PACKAGE_NAME)$(PACKAGE_VERSION)
pkgdatadir	= $(datadir)/$(PKG_DIR)
pkglibdir	= $(libdir)/$(PKG_DIR)
pkgincludedir	= $(includedir)/$(PKG_DIR)

top_builddir	= .

INSTALL		= @INSTALL@
INSTALL_PROGRAM	= @INSTALL_PROGRAM@
INSTALL_DATA	= @INSTALL_DATA@
INSTALL_SCRIPT	= @INSTALL_SCRIPT@

PACKAGE_NAME	= @PACKAGE_NAME@
PACKAGE_VERSION	= @PACKAGE_VERSION@
CC		= @CC@
CFLAGS_DEFAULT	= @CFLAGS_DEFAULT@
CFLAGS_WARNING	= @CFLAGS_WARNING@
EXEEXT		= @EXEEXT@
LDFLAGS_DEFAULT	= @LDFLAGS_DEFAULT@
MAKE_LIB	= @MAKE_LIB@
MAKE_SHARED_LIB	= @MAKE_SHARED_LIB@
MAKE_STATIC_LIB	= @MAKE_STATIC_LIB@
MAKE_STUB_LIB	= @MAKE_STUB_LIB@
OBJEXT		= @OBJEXT@
RANLIB		= @RANLIB@
RANLIB_STUB	= @RANLIB_STUB@
SHLIB_CFLAGS	= @SHLIB_CFLAGS@
SHLIB_LD	= @SHLIB_LD@
SHLIB_LD_LIBS	= @SHLIB_LD_LIBS@
STLIB_LD	= @STLIB_LD@
#TCL_DEFS	= @TCL_DEFS@
TCL_BIN_DIR	= @TCL_BIN_DIR@
TCL_SRC_DIR	= @TCL_SRC_DIR@
#TK_BIN_DIR	= @TK_BIN_DIR@
#TK_SRC_DIR	= @TK_SRC_DIR@

# Not used, but retained for reference of what libs Tcl required
#TCL_LIBS	= @TCL_LIBS@

#========================================================================
# TCLLIBPATH seeds the auto_path in Tcl's init.tcl so we can test our
# package without installing.  The other environment variables allow us
# to test against an uninstalled Tcl.  Add special env vars that you
# require for testing here (like TCLX_LIBRARY).
#========================================================================

#EXTRA_PATH	= $(top_builddir):$(TCL_BIN_DIR)
EXTRA_PATH	= $(top_builddir):$(TCL_BIN_DIR):$(TK_BIN_DIR)
TCLLIBPATH	= $(top_builddir)
TCLSH_ENV	= TCL_LIBRARY=`@CYGPATH@ $(TCL_SRC_DIR)/library` \
		  @LD_LIBRARY_PATH_VAR@="$(EXTRA_PATH):$(@LD_LIBRARY_PATH_VAR@)" \
		  PATH="$(EXTRA_PATH):$(PATH)" \
		  TCLLIBPATH="$(TCLLIBPATH)"
#		  TK_LIBRARY=`@CYGPATH@ $(TK_SRC_DIR)/library`

TCLSH_PROG	= @TCLSH_PROG@
TCLSH	= $(TCLSH_ENV) $(TCLSH_PROG)

WISH_PROG	= @WISH_PROG@
WISH	= $(TCLSH_ENV) $(WISH_PROG)


SHARED_BUILD	= @SHARED_BUILD@

#INCLUDES	= @PKG_INCLUDES@ @TCL_INCLUDES@
INCLUDES	= -I. @PKG_INCLUDES@ @TCL_INCLUDES@ @TK_INCLUDES@ @TK_XINCLUDES@

PKG_CFLAGS	= @PKG_CFLAGS@

# TCL_DEFS is not strictly need here, but if you remove it, then you
# must make sure that configure.in checks for the necessary components
# that your library may use.  TCL_DEFS can actually be a problem if
# you do not compile with a similar machine setup as the Tcl core was
# compiled with.
#DEFS		= $(TCL_DEFS) @DEFS@ $(PKG_CFLAGS)
DEFS		= @DEFS@ -DAUTOSTEREOD=\"@AUTOSTEREOD@\" $(PKG_CFLAGS)

CONFIG_CLEAN_FILES = Makefile pkgIndex.tcl togl_ws.h
CLEANFILES	= @CLEANFILES@ $(EXAMPLE_OBJS) $(EXAMPLE_SHLIBS)

CPPFLAGS	= @CPPFLAGS@
LIBS		= @PKG_LIBS@ @LIBS@
AR		= @AR@
CFLAGS		= @CFLAGS@
COMPILE		= $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)

#========================================================================
# Start of user-definable TARGETS section
#========================================================================

#========================================================================
# TEA TARGETS.  Please note that the "libraries:" target refers to platform
# independent files, and the "binaries:" target inclues executable programs and
# platform-dependent libraries.  Modify these targets so that they install
# the various pieces of your package.  The make and install rules
# for the BINARIES that you specified above have already been done.
#========================================================================

all: binaries libraries doc

#========================================================================
# The binaries target builds executable programs, Windows .dll's, unix
# shared/static libraries, and any other platform-dependent files.
# The list of targets to build for "binaries:" is specified at the top
# of the Makefile, in the "BINARIES" variable.
#========================================================================

binaries: $(BINARIES)

libraries:

#========================================================================
# Example section.  These are examples because we don't want to install them.
# And they're not tests because we currently have no automatic way to see
# if they work.
#========================================================================

examples: $(EXAMPLE_SHLIBS)

double$(SHLIB_SUFFIX): double.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="double.$(OBJEXT) $(PKG_STUB_LIB_FILE)" $@ ; \
	fi

gears$(SHLIB_SUFFIX): gears.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="gears.$(OBJEXT) $(PKG_STUB_LIB_FILE)" $@ ; \
	fi

index$(SHLIB_SUFFIX): index.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="index.$(OBJEXT) $(PKG_STUB_LIB_FILE)" $@ ; \
	fi

overlay$(SHLIB_SUFFIX): overlay.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="overlay.$(OBJEXT) $(PKG_STUB_LIB_FILE)" $@ ; \
	fi

stereo$(SHLIB_SUFFIX): stereo.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="stereo.$(OBJEXT) $(PKG_STUB_LIB_FILE)" $@ ; \
	fi

texture$(SHLIB_SUFFIX): texture.$(OBJEXT) image.$(OBJEXT) $(PKG_STUB_LIB_FILE)
	-match=`expr 'x$(PKG_OBJECTS)' : '.*togl.*'`; \
	if [ $$match -eq 0 ]; then \
		$(MAKE_SHARED_LIB) ; \
	else \
		$(MAKE) PKG_OBJECTS="texture.$(OBJEXT) image.$(OBJEXT) $(PKG_STUB_LIB_FILE) $(LIBGLU)" $@ ; \
	fi

#========================================================================
# Stub section.
#========================================================================

toglDecls.h toglStubInit.c: togl.decls
	$(TCLSH) `@CYGPATH@ $(TCL_SRC_DIR)/tools/genStubs.tcl` . $(srcdir)/togl.decls

#========================================================================
# Your doc target should differentiate from doc builds (by the developer)
# and doc installs (see install-doc), which just install the docs on the
# end user machine when building from source.
#========================================================================

doc:
#	@echo "If you have documentation to create, place the commands to"
#	@echo "build the docs in the 'doc:' target.  For example:"
#	@echo "        xml2nroff sample.xml > sample.n"
#	@echo "        xml2html sample.xml > sample.html"

install: all install-binaries install-libraries install-doc

install-binaries: binaries install-lib-binaries install-bin-binaries

#========================================================================
# This rule installs platform-independent files, such as header files.
# The list=...; for p in $$list handles the empty list case x-platform.
#========================================================================

install-libraries: libraries
	@mkdir -p $(DESTDIR)$(includedir)
	@echo "Installing header files in $(DESTDIR)$(includedir)"
	@list='$(PKG_HEADERS)'; for i in $$list; do \
	    echo "Installing $(srcdir)/$$i" ; \
	    $(INSTALL_DATA) $(srcdir)/$$i $(DESTDIR)$(includedir) ; \
	done
	@echo "Installing togl_ws.h"
	@$(INSTALL_DATA) ./togl_ws.h $(DESTDIR)$(includedir)


#========================================================================
# Install documentation.  Unix manpages should go in the $(mandir)
# directory.
#========================================================================

install-doc: doc
#	@mkdir -p $(DESTDIR)$(mandir)/mann
#	@echo "Installing documentation in $(DESTDIR)$(mandir)"
#	@list='$(srcdir)/doc/*.n'; for i in $$list; do \
#	    echo "Installing $$i"; \
#	    rm -f $(DESTDIR)$(mandir)/mann/`basename $$i`; \
#	    $(INSTALL_DATA) $$i $(DESTDIR)$(mandir)/mann ; \
#	done

test: binaries libraries
	$(TCLSH) `@CYGPATH@ $(srcdir)/tests/all.tcl` $(TESTFLAGS)

shell: binaries libraries
	@$(TCLSH) $(SCRIPT)

gdb:
	$(TCLSH_ENV) gdb $(TCLSH_PROG) $(SCRIPT)

depend:

#========================================================================
# $(PKG_LIB_FILE) should be listed as part of the BINARIES variable
# mentioned above.  That will ensure that this target is built when you
# run "make binaries".
#
# The $(PKG_OBJECTS) objects are created and linked into the final
# library.  In most cases these object files will correspond to the
# source files above.
#========================================================================

$(PKG_LIB_FILE): $(PKG_OBJECTS)
	-rm -f $(PKG_LIB_FILE)
	${MAKE_LIB}
	$(RANLIB) $(PKG_LIB_FILE)

$(PKG_STUB_LIB_FILE): $(PKG_STUB_OBJECTS)
	-rm -f $(PKG_STUB_LIB_FILE)
	${MAKE_STUB_LIB}
	$(RANLIB_STUB) $(PKG_STUB_LIB_FILE)

#========================================================================
# We need to enumerate the list of .c to .o lines here.
#
# In the following lines, $(srcdir) refers to the toplevel directory
# containing your extension.  If your sources are in a subdirectory,
# you will have to modify the paths to reflect this:
#
# sample.$(OBJEXT): $(srcdir)/generic/sample.c
# 	$(COMPILE) -c `@CYGPATH@ $(srcdir)/generic/sample.c` -o $@
#
# Setting the VPATH variable to a list of paths will cause the makefile
# to look into these paths when resolving .c to .obj dependencies.
# As necessary, add $(srcdir):$(srcdir)/compat:....
#========================================================================

VPATH = $(srcdir):$(srcdir)/generic:$(srcdir)/unix:$(srcdir)/win

.c.@OBJEXT@:
	$(COMPILE) -c `@CYGPATH@ $<` -o $@

#========================================================================
# Distribution creation
# You may need to tweak this target to make it work correctly.
#========================================================================

COMPRESS	= tar zcvf $(PKG_DIR)-src.tar.gz $(PKG_DIR)
DIST_ROOT	= /tmp/togl-dist
DIST_DIR	= $(DIST_ROOT)/$(PKG_DIR)
BINPKG_DIR	= $(PKG_DIR)-@TCL_VERSION@-$(subst Darwin,MacOSX,$(subst CYGWIN,Windows,$(shell uname -s | sed -e 's/[-_].*//')))
BINDIST_DIR	= $(DIST_ROOT)/$(BINPKG_DIR)

dist-clean:
	rm -rf $(DIST_DIR) $(DIST_ROOT)/$(PKG_DIR)*

dist: dist-clean
	mkdir -p $(DIST_DIR)
	cp -p $(srcdir)/README* $(srcdir)/LICENSE* $(srcdir)/togl.decls \
		$(srcdir)/*.py $(srcdir)/*.tcl \
		$(srcdir)/aclocal.m4 $(srcdir)/configure $(srcdir)/*.in \
		ben.rgb tree2.rgba \
		$(DIST_DIR)/
	chmod 664 $(DIST_DIR)/*
	chmod 775 $(DIST_DIR)/configure $(DIST_DIR)/configure.in

	for i in $(srcdir)/*.[ch]; do \
	    if [ -f $$i ]; then \
		cp -p $$i $(DIST_DIR)/ ; \
	    fi; \
	done
	cd $(DIST_DIR); rm -f $(CONFIG_CLEAN_FILES)

	mkdir $(DIST_DIR)/tclconfig
	cp $(srcdir)/tclconfig/install-sh $(srcdir)/tclconfig/tcl.m4 \
		$(DIST_DIR)/tclconfig/
	chmod 664 $(DIST_DIR)/tclconfig/tcl.m4
	chmod +x $(DIST_DIR)/tclconfig/install-sh

	list='examples doc generic library mac tests unix win StereoI'; \
	for p in $$list; do \
	    if test -d $(srcdir)/$$p ; then \
		mkdir $(DIST_DIR)/$$p; \
		cp -p $(srcdir)/$$p/*.* $(DIST_DIR)/$$p/; \
	    fi; \
	done

	(cd $(DIST_ROOT); $(COMPRESS);)

bindist-clean:
	rm -rf $(BINDIST_DIR) $(DIST_ROOT)/$(PKG_DIR)*

bindist: all bindist-clean
	mkdir -p $(BINDIST_DIR)
	$(MAKE) prefix=$(BINDIST_DIR) exec_prefix=$(BINDIST_DIR) install
	$(INSTALL_DATA) README.bin $(BINDIST_DIR)/README.txt
	mkdir -p $(BINDIST_DIR)/doc
	@list='doc/*.html doc/*.js'; for i in $$list; do \
	    echo "Installing $$i"; \
	    rm -f $(BINDIST_DIR)/doc/`basename $$i`; \
	    $(INSTALL_DATA) $$i $(BINDIST_DIR)/doc ; \
	done
	if [ @TOGL_WINDOWINGSYSTEM@ == TOGL_WGL ]; then \
		(cd $(DIST_ROOT); zip -rDX9 $(BINPKG_DIR).zip $(BINPKG_DIR)); \
	else \
		(cd $(DIST_ROOT); tar zcvf $(BINPKG_DIR).tar.gz $(BINPKG_DIR)); \
	fi

#========================================================================
# End of user-definable section
#========================================================================

#========================================================================
# Don't modify the file to clean here.  Instead, set the "CLEANFILES"
# variable in configure.in
#========================================================================

clean:  
	-test -z "$(BINARIES)" || rm -f $(BINARIES)
	-rm -f *.$(OBJEXT) core *.core
	-test -z "$(CLEANFILES)" || rm -f $(CLEANFILES)

distclean: clean
	-rm -f *.tab.c
	-rm -f $(CONFIG_CLEAN_FILES)
	-rm -f config.cache config.log config.status

#========================================================================
# Install binary object libraries.  On Windows this includes both .dll and
# .lib files.  Because the .lib files are not explicitly listed anywhere,
# we need to deduce their existence from the .dll file of the same name.
# Library files go into the lib directory.
# In addition, this will generate the pkgIndex.tcl
# file in the install location (assuming it can find a usable tclsh shell)
#
# You should not have to modify this target.
#========================================================================

install-lib-binaries: binaries
	@mkdir -p $(DESTDIR)$(libdir)
	@list='$(lib_BINARIES)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(libdir)/$$p"; \
	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(libdir)/$$p; \
	    stub=`echo $$p|sed -e "s/.*\(stub\).*/\1/"`; \
	    if test "x$$stub" = "xstub"; then \
		echo " $(RANLIB_STUB) $(DESTDIR)$(libdir)/$$p"; \
		$(RANLIB_STUB) $(DESTDIR)$(libdir)/$$p; \
	    else \
		echo " $(RANLIB) $(DESTDIR)$(libdir)/$$p"; \
		$(RANLIB) $(DESTDIR)$(libdir)/$$p; \
	    fi; \
	    ext=`echo $$p|sed -e "s/.*\.//"`; \
	    if test "x$$ext" = "xdll"; then \
		lib=`basename $$p|sed -e 's/.[^.]*$$//'`.lib; \
		if test -f $$lib; then \
		    echo " $(INSTALL_DATA) $$lib $(DESTDIR)$(libdir)/$$lib"; \
	            $(INSTALL_DATA) $$lib $(DESTDIR)$(libdir)/$$lib; \
		fi; \
	    fi; \
	  fi; \
	done
	@mkdir -p $(DESTDIR)$(pkglibdir)
	@list='$(pkglib_BINARIES)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p"; \
	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(pkglibdir)/$$p; \
	    stub=`echo $$p|sed -e "s/.*\(stub\).*/\1/"`; \
	    if test "x$$stub" = "xstub"; then \
		echo " $(RANLIB_STUB) $(DESTDIR)$(pkglibdir)/$$p"; \
		$(RANLIB_STUB) $(DESTDIR)$(pkglibdir)/$$p; \
	    else \
		echo " $(RANLIB) $(DESTDIR)$(pkglibdir)/$$p"; \
		$(RANLIB) $(DESTDIR)$(pkglibdir)/$$p; \
	    fi; \
	    ext=`echo $$p|sed -e "s/.*\.//"`; \
	    if test "x$$ext" = "xdll"; then \
		lib=`basename $$p|sed -e 's/.[^.]*$$//'`.lib; \
		if test -f $$lib; then \
		    echo " $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib"; \
	            $(INSTALL_DATA) $$lib $(DESTDIR)$(pkglibdir)/$$lib; \
		fi; \
	    fi; \
	  fi; \
	done
	@list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
	  if test -f $(srcdir)/$$p; then \
	    destp=`basename $$p`; \
	    echo " Install $$destp $(DESTDIR)$(pkglibdir)/$$destp"; \
	    $(INSTALL_DATA) $(srcdir)/$$p $(DESTDIR)$(pkglibdir)/$$destp; \
	  fi; \
	done
	@if test "x$(SHARED_BUILD)" = "x1"; then \
	    echo " Install pkgIndex.tcl $(DESTDIR)$(pkglibdir)"; \
	    $(INSTALL_DATA) pkgIndex.tcl $(DESTDIR)$(pkglibdir); \
	    echo " Install LICENSE $(DESTDIR)$(pkglibdir)"; \
	    $(INSTALL_DATA) LICENSE $(DESTDIR)$(pkglibdir); \
	else \
	    echo " Install LICENSE.togl $(DESTDIR)$(libdir)"; \
	    $(INSTALL_DATA) LICENSE $(DESTDIR)$(libdir)/LICENSE.togl; \
	fi

#========================================================================
# Install binary executables (e.g. .exe files and dependent .dll files)
# This is for files that must go in the bin directory (located next to
# wish and tclsh), like dependent .dll files on Windows.
#
# You should not have to modify this target, except to define bin_BINARIES
# above if necessary.
#========================================================================

install-bin-binaries: binaries
	@mkdir -p $(DESTDIR)$(bindir)
	@list='$(bin_BINARIES)'; for p in $$list; do \
	  if test -f $$p; then \
	    echo " $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/$$p"; \
	    $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/$$p; \
	  fi; \
	done

.SUFFIXES: .c .$(OBJEXT)

Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
	cd $(top_builddir) \
	  && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status

uninstall-binaries:
	list='$(pkglib_BINARIES)'; for p in $$list; do \
	  rm -f $(DESTDIR)$(pkglibdir)/$$p; \
	done
	list='$(lib_BINARIES)'; for p in $$list; do \
	  rm -f $(DESTDIR)$(libdir)/$$p; \
	done
	list='$(PKG_TCL_SOURCES)'; for p in $$list; do \
	  p=`basename $$p`; \
	  rm -f $(DESTDIR)$(pkglibdir)/$$p; \
	done
	list='$(bin_BINARIES)'; for p in $$list; do \
	  rm -f $(DESTDIR)$(bindir)/$$p; \
	done

.PHONY: all binaries clean depend distclean doc install libraries test

# Tell versions [3.59,3.63) of GNU make to not export all variables.
# Otherwise a system limit (for SysV at least) may be exceeded.
.NOEXPORT:

# Additional dependencies
togl.$(OBJEXT): toglFont.c

blob
data 2519
README.txt: Togl

    This is a Togl 2.X binary distribution for both users and developers.
    It is specific to a particular operating system (e.g., Windows, Mac
    OS X, Linux, etc.).  Since the C ABI should be same for all compilers
    on the same system, using Togl via the Tcl interface should work
    regardless of which compiler Tcl was compiled with.

    The files are named:

    	ToglTOGL_VERSION-TCL_VERSION-OS.SUFFIX

    For example, TOGL_VERSION=2.0, TCL_VERSION=8.4, OS=Linux,
    and SUFFIX=.tar.gz gives:

    	Togl2.0-8.4-Linux.tar.gz

    Togl is also available at:
        http://sourceforge.net/projects/togl/

    You can get any release of Togl from the file distributions
    link at the above URL.

    A copy of the online documentation is in the doc directory.

For users:

    Only the lib/Togl2.X directory (and its contents) need to be installed
    in your Tcl library.  Execute the following Tcl script to find the
    directories Tcl looks for packages in:

	puts $tcl_libPath

    and then copy the lib/Togl2.X directory into one of those directories.

For developers:

    The lib/Togl2.X directory (and its contents) is all that needs to be
    redistributed in your application distribution.

    If you wish to link with Togl, then you will need the include files
    and a link library for your compiler.  The compilers used are (OS-
    WINDOWING_SYSTEM):

    MacOSX: gcc 4.0.1, Mac OS X 10.4, ppc/i386
    Linux: gcc 3.3.6, Red Hat 7.1, i386
    Linux64: gcc 4.2.3 -Wl,--hash-style=both, Red Hat Server 5.1, x86_64
    Windows: Microsoft Visual Studio .NET 2003, Windows XP SP2, i386

File hierarchy:

	README.txt		this file
        bin/                    unused (empty)
        lib/
            Togl2.X/		Tcl package (place on Tcl's autopath)
		LICENSE		redistribution license
                pkgIndex.tcl	Tcl package index
                Togl2X.dll	Windows Tcl package binary
            Toglstub2X.a	Windows gcc/mingw link library
            Toglstub2X.lib	Windows Visual Studio link library
	    libToglstub2X.a	UNIX (Linux, IRIX, etc.) link library
	include/
	    togl.h		Main header file, includes others
	    toglDecls.h		API function declarations
	    togl_ws.h		Which windowing system togl was compiled with
	doc/			Documentation
	    *.html		Start with index.html

The contents of the include and lib directories can be placed verbatim
in the Tcl installataion hierachy.

Documentation is in the doc directory.  Start with doc/index.html in
your web browser.

blob
data 1220
This version of Togl is entirely free from
dependencies on Tcl/Tk's internal functions. It uses the public stubs
interface, witch means that the same binary works with any stubs-aware
wish (i.e. version >= 8.1)

It has been tested on Windows NT/2000 and Linux for several Tcl/Tk versions up
to 8.4a3. I haven't been able to test the Mac port, it propably needs mending 
but I can't see why it shouldn't work in principle.

Implementation wise, what differs from Togl 1.5 is that Togl_MakeWindowExist()
is replaced by Togl_CreateWindow(), a function that gets registered in Tk as a callback for window creation. In Tk/Tk 8.4a3, there is a new public API call 
Tk_SetClassProcs() to register this callback, but for earlier versions of Tk 
one needs to do this using some pointer magic.
There is a run-time check to determine which method to use, hence the 
same binary runs on all versions of Wish from 8.1 and up. For this to 
work you need to compile against the headers from Tcl/Tk 8.4a3 or later, or
the binary will only work for Tcl/Tk 8.1-8.4a2.
The tk8.4a3 public headers (tk8.4a3.h + tkDecls.h) are included for
conveniance, and they are used if the flag -DUSE_LOCAL_TK_H is specified.

Jonas Beskow, December 2001
blob
data 540
The StereoI files are from the NVidia SDK 9.5 and are needed to use the
NVidia Consumer 3D Stereo driver:

"c:/Program Files/NVIDIA Corporation/SDK 9.5/LIBS/lib/Release/StereoI.lib"
"c:/Program Files/NVIDIA Corporation/SDK 9.5/LIBS/inc/StereoI/StereoI.h"

Currently, the Microsoft compiler must be used because StereoI.h is
for C++ only, and StereoI.lib has references to msvcrt's operator new
and operator delete and mingw does not provide entry points for those
operators (??2@YAPAXI@Z and ??3@YAXPAX@Z) in its import library for
msvcrt.

blob
data 1955
/*----------------------------------------------------------------------------------------------------
Copyright NVIDIA Corporation 2005
TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, THIS SOFTWARE IS PROVIDED *AS IS* AND NVIDIA AND
AND ITS SUPPLIERS DISCLAIM ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO EVENT SHALL NVIDIA
OR ITS SUPPLIERS BE LIABLE FOR ANY SPECIAL, INCIDENTAL, INDIRECT, OR CONSEQUENTIAL DAMAGES WHATSOEVER
INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF BUSINESS PROFITS, BUSINESS INTERRUPTION, LOSS OF
BUSINESS INFORMATION, OR ANY OTHER PECUNIARY LOSS) ARISING OUT OF THE USE OF OR INABILITY TO USE THIS
SOFTWARE, EVEN IF NVIDIA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
----------------------------------------------------------------------------------------------------*/

#ifndef STEREO_I_H
#define STEREO_I_H

// Stereo states: bit 0 - on/off; bit 1 - enabled/disabled.
// Returned by GetStereoState.
#define STEREO_STATE_ENABLED         0x2
#define STEREO_STATE_DISABLED        0x0
#define STEREO_STATE_ON              0x1
#define STEREO_STATE_OFF             0x0

// CaptureImageFormats.
#define IMAGE_JPEG     0
#define IMAGE_PNG      1

// Image quality applies to JPEG only and varies from 0 to 100. 100 being the best.
// Default setting for CaptureStereoImage is JPEG and quality=75. 

interface StereoI
{
	virtual int			CheckAPIVersion(int);
    virtual int			GetStereoState(void);
	virtual int			SetStereoState(int);
	virtual float       GetSeparation(void);
    virtual float       SetSeparation(float);
    virtual float       GetConvergence(void);
    virtual float       SetConvergence(float);
	virtual void		CaptureStereoImage(int format, int quality);
	//Stereo images are dumped to [RootDir]\NVSTEREO.IMG
};

int CreateStereoI(StereoI **ppStereoI);
int isStereoEnabled(void);

#endif

blob
data 24348
!<arch>
/               1108613735              0       1009      `
     à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à  à??0StereoI@@QAE@XZ ??0nvStereoI@@QAE@XZ ??_7StereoI@@6B@ ??_7nvStereoI@@6B@ ??_C@_0BA@FGJIKEGP@CreateStereoAPI?$AA@ ??_C@_0M@OHDNJKND@StereoI?4dll?$AA@ ??_C@_13FPGAJAPJ@?$AA?2?$AA?$AA@ ??_C@_1BK@LBDEKHOH@?$AAn?$AAv?$AAs?$AAt?$AAe?$AAr?$AAc?$AAp?$AA?4?$AAd?$AAl?$AAl?$AA?$AA@ ?CaptureStereoImage@StereoI@@UAEXHH@Z ?CaptureStereoImage@nvStereoI@@UAEXHH@Z ?CheckAPIVersion@StereoI@@UAEHH@Z ?CheckAPIVersion@nvStereoI@@UAEHH@Z ?CheckDriver@@YA_NPBG@Z ?CreateStereoI@@YAHPAPAUStereoI@@@Z ?GetConvergence@StereoI@@UAEMXZ ?GetConvergence@nvStereoI@@UAEMXZ ?GetSeparation@StereoI@@UAEMXZ ?GetSeparation@nvStereoI@@UAEMXZ ?GetStereoState@StereoI@@UAEHXZ ?GetStereoState@nvStereoI@@UAEHXZ ?SetConvergence@StereoI@@UAEMM@Z ?SetConvergence@nvStereoI@@UAEMM@Z ?SetSeparation@StereoI@@UAEMM@Z ?SetSeparation@nvStereoI@@UAEMM@Z ?SetStereoState@StereoI@@UAEHH@Z ?SetStereoState@nvStereoI@@UAEHH@Z __real@00000000 
/               1108613735              0       963       `
   à                                ??0StereoI@@QAE@XZ ??0nvStereoI@@QAE@XZ ??_7StereoI@@6B@ ??_7nvStereoI@@6B@ ??_C@_0BA@FGJIKEGP@CreateStereoAPI?$AA@ ??_C@_0M@OHDNJKND@StereoI?4dll?$AA@ ??_C@_13FPGAJAPJ@?$AA?2?$AA?$AA@ ??_C@_1BK@LBDEKHOH@?$AAn?$AAv?$AAs?$AAt?$AAe?$AAr?$AAc?$AAp?$AA?4?$AAd?$AAl?$AAl?$AA?$AA@ ?CaptureStereoImage@StereoI@@UAEXHH@Z ?CaptureStereoImage@nvStereoI@@UAEXHH@Z ?CheckAPIVersion@StereoI@@UAEHH@Z ?CheckAPIVersion@nvStereoI@@UAEHH@Z ?CheckDriver@@YA_NPBG@Z ?CreateStereoI@@YAHPAPAUStereoI@@@Z ?GetConvergence@StereoI@@UAEMXZ ?GetConvergence@nvStereoI@@UAEMXZ ?GetSeparation@StereoI@@UAEMXZ ?GetSeparation@nvStereoI@@UAEMXZ ?GetStereoState@StereoI@@UAEHXZ ?GetStereoState@nvStereoI@@UAEHXZ ?SetConvergence@StereoI@@UAEMM@Z ?SetConvergence@nvStereoI@@UAEMM@Z ?SetSeparation@StereoI@@UAEMM@Z ?SetSeparation@nvStereoI@@UAEMM@Z ?SetStereoState@StereoI@@UAEHH@Z ?SetStereoState@nvStereoI@@UAEHH@Z __real@00000000 
//              1108613735              0       22        `
.\Release\StereoI.obj /0              1108613735              100666  22103     `
LF gBƒ=  #      .drectve        t                  
 .debug$S        F  x              @ B.text           ç   æ'  K(  ë(     P`.debug$S           ˝(  *         @B.rdata             ;*              @0@.debug$F           ?*  O*         @B.text           	   Y*  b*          P`.debug$S        É   l*  Ô*         @B.rdata              +  -+         @0@.debug$F           }+  ç+         @B.text           
   ó+      °+      P`.debug$S        ã   ß+  2,         @B.debug$F           P,  `,         @B.text              j,      {,      P`.debug$S        ö   Å,  -         @B.debug$F           9-  I-         @B.text           
   S-      ]-      P`.debug$S        å   c-  Ô-         @B.debug$F           .  .         @B.text              '.      8.      P`.debug$S        õ   >.  Ÿ.         @B.debug$F           ˜.  /         @B.text           #   /      4/      P`.debug$S        ◊   :/  0         @B.debug$F           /0  ?0         @B.text              I0      Z0      P`.debug$S        õ   `0  ˚0         @B.debug$F           1  )1         @B.text           
   31      =1      P`.debug$S        å   C1  œ1         @B.debug$F           Ì1  ˝1         @B.text              2      2      P`.debug$S        °   2  ø2         @B.debug$F           ›2  Ì2         @B.text              ˜2  ˛2  3     P`.debug$S        â   3  ó3         @B.rdata             µ3              @0@.debug$F           π3  …3         @B.text           	   ”3  ‹3  Ê3     P`.debug$S        ò   Ï3  Ñ4         @B.debug$F           ¢4  ≤4         @B.text              º4  √4  Õ4     P`.debug$S        ä   ”4  ]5         @B.debug$F           {5  ã5         @B.text           	   ï5  û5  ®5     P`.debug$S        ô   Æ5  G6         @B.debug$F           e6  u6         @B.text              6      Ç6      P`.debug$S        µ   à6  =7         @B.debug$F           [7  k7         @B.text              u7      z7      P`.debug$S        ô   Ä7  8         @B.debug$F           78  G8         @B.text              Q8      T8      P`.debug$S        ä   Z8  ‰8         @B.debug$F           9  9         @B.text              9      !9      P`.debug$S        ü   '9  ∆9         @B.debug$F           ‰9  Ù9         @B.text           	   ˛9  :          P`.debug$S        á   :  ò:         @B.rdata              ∂:  ÷:         @0@.debug$F           &;  6;         @B.text           u   @;  µ;  <     P`.debug$S        ß   _<  =         @B.rdata             $=              @0@.rdata             4=              @0@.rdata             @=              @0@.debug$F           Z=  j=         @B.debug$T        P   t=              @ B/DEFAULTLIB:"uuid.lib" /DEFAULTLIB:"uuid.lib" /DEFAULTLIB:"Version.lib" /DEFAULTLIB:"MSVCRT" /DEFAULTLIB:"OLDNAMES"    Ò   y   =     c:\sw\devrel\Sdk\Libs\src\StereoI\Release\StereoI.obj 8      
  
 Microsoft (R) Optimizing Compiler      Û   ¿   $T2 $esp .cbLocals + .cbSavedRegs + = $T0 .raSearchStart = $eip $T0 ^ = $esp $T0 4 + = $T2 $esp .cbLocals + .cbSavedRegs + = $T0 .raSearchStart = $eip $T0 ^ = $esp $T0 4 + = $ebx $T0 16 - ^ = Ò        ã   CC_CDECL  ã   CC_MSCPASCAL  ã   CC_PASCAL  ã   CC_MACPASCAL  ã   CC_STDCALL  ã   CC_FPFASTCALL  ã   CC_SYSCALL  ã   CC_MPWCDECL  ã   CC_MPWPASCAL  C   VAR_STATIC     URLZONE_INTRANET  ˇ    URLZONEREG_DEFAULT  ˇ   URLZONEREG_HKLM  @   BINDSTRING_POST_COOKIE ' @   BINDSTRING_FLAG_BIND_TO_OBJECT  ˘   SYS_WIN32  ˘   SYS_MAC  ß    NODE_INVALID  ß   NODE_ELEMENT  ß   NODE_ATTRIBUTE  ß   NODE_TEXT  ß   NODE_CDATA_SECTION  ß   NODE_ENTITY_REFERENCE  ß   NODE_ENTITY  ß   NODE_COMMENT  ß  	 NODE_DOCUMENT     COR_VERSION_MAJOR_V2  ß  
 NODE_DOCUMENT_TYPE  ß   NODE_DOCUMENT_FRAGMENT  ^   XMLELEMTYPE_DOCUMENT # ¬   BINDSTATUS_FINDINGRESOURCE  ¬   BINDSTATUS_CONNECTING  ¬   BINDSTATUS_REDIRECTING % ¬   BINDSTATUS_BEGINDOWNLOADDATA # ¬   BINDSTATUS_ENDDOWNLOADDATA + ¬   BINDSTATUS_BEGINDOWNLOADCOMPONENTS ( ¬   BINDSTATUS_INSTALLINGCOMPONENTS ) ¬  	 BINDSTATUS_ENDDOWNLOADCOMPONENTS # ¬  
 BINDSTATUS_USINGCACHEDCOPY " ¬   BINDSTATUS_SENDINGREQUEST % ¬   BINDSTATUS_MIMETYPEAVAILABLE * ¬   BINDSTATUS_CACHEFILENAMEAVAILABLE & ¬   BINDSTATUS_BEGINSYNCOPERATION $ ¬   BINDSTATUS_ENDSYNCOPERATION # ¬   BINDSTATUS_BEGINUPLOADDATA ! ¬   BINDSTATUS_ENDUPLOADDATA # ¬   BINDSTATUS_PROTOCOLCLASSID  ¬   BINDSTATUS_ENCODING - ¬   BINDSTATUS_VERIFIEDMIMETYPEAVAILABLE ( ¬   BINDSTATUS_CLASSINSTALLLOCATION  ¬   BINDSTATUS_DECODING & ¬   BINDSTATUS_LOADINGMIMEHANDLER , ¬   BINDSTATUS_CONTENTDISPOSITIONATTACH ' ¬   BINDSTATUS_CLSIDCANINSTANTIATE % ¬   BINDSTATUS_IUNKNOWNAVAILABLE     VT_I2  ¬   BINDSTATUS_DIRECTBIND  ¬   BINDSTATUS_RAWMIMETYPE " ¬    BINDSTATUS_PROXYDETECTING   ¬  ! BINDSTATUS_ACCEPTRANGES  ¬  " BINDSTATUS_COOKIE_SENT + ¬  # BINDSTATUS_COMPACT_POLICY_RECEIVED % ¬  $ BINDSTATUS_COOKIE_SUPPRESSED     VT_BSTR    	 VT_DISPATCH ' ¬  & BINDSTATUS_COOKIE_STATE_ACCEPT ' ¬  ' BINDSTATUS_COOKIE_STATE_REJECT ' ¬  ( BINDSTATUS_COOKIE_STATE_PROMPT . ¬  . BINDSTATUS_PERSISTENT_COOKIE_RECEIVED    $ VT_RECORD  •    IdleShutdown  á   PARSE_CANONICALIZE  á   PARSE_FRIENDLY  á   PARSE_SECURITY_URL  á   PARSE_ROOTDOCUMENT  á   PARSE_DOCUMENT  á   PARSE_ENCODE  á   PARSE_DECODE  á  	 PARSE_PATH_FROM_URL    Ä ÄVT_RESERVED  á  
 PARSE_URL_FROM_PATH  á   PARSE_MIME  á   PARSE_SERVER  á   PARSE_SCHEMA  á   PARSE_SITE  á   PARSE_DOMAIN  á   PARSE_LOCATION  á   PARSE_SECURITY_DOMAIN  á   PARSE_ESCAPE  ù    CHANGEKIND_ADDMEMBER   ù   CHANGEKIND_DELETEMEMBER  }   PSU_DEFAULT  ù   CHANGEKIND_SETNAMES $ ù   CHANGEKIND_SETDOCUMENTATION  ù   CHANGEKIND_GENERAL  ù   CHANGEKIND_INVALIDATE   ù   CHANGEKIND_CHANGEFAILED   >  
 QUERY_IS_INSTALLEDENTRY  &   TYSPEC_MIMETYPE  &   TYSPEC_FILENAME  &   TYSPEC_PROGID  &   TYSPEC_PACKAGENAME  ç    CIP_DISK_FULL  ç   CIP_ACCESS_DENIED ! ç   CIP_NEWER_VERSION_EXISTS ! ç   CIP_OLDER_VERSION_EXISTS  ç   CIP_NAME_CONFLICT 1 ç   CIP_TRUST_VERIFICATION_COMPONENT_MISSING + ç   CIP_EXE_SELF_REGISTERATION_TIMEOUT  ç   CIP_UNSAFE_TO_ABORT  ¥   TKIND_INTERFACE  ¥   TKIND_DISPATCH  ¥   TKIND_ALIAS   (   DESCKIND_IMPLICITAPPOBJ  n  tagPARAMDESC  r  tagPARAMDESCEX  p  tagBINDPTR  l  LPPARAMDESCEX  ã  CALLCONV  p  BINDPTR  ¥  TYPEKIND    FUNCKIND  n  PARAMDESC  b  HINSTANCE  ˚  tagTLIBATTR  h  ELEMDESC  G  VARIANTARG    SAFEARRAYBOUND  h  tagELEMDESC  (  DESCKIND  "  TYPEDESC  \  tagEXCEPINFO    tagSTATSTG  C  VARKIND  a  tagFUNCDESC  "   ULONG    tagIDLDESC 
   IID  i  CreateStereoAPIFunction     LONGLONG  e  tagApplicationType  Å  tagCABSTR  c  PIDMSI_STATUS_VALUE  !   PROPVAR_PAD3    LPVOID  a  FUNCDESC  î  tagCACLSID  ô  tagCADBL  "   SIZE_T  "   HREFTYPE    CAUB  ¥  tagTYPEKIND  (  tagDESCKIND  4  tagCACY  ˘  tagSYSKIND  ^  tagXMLEMEM_TYPE  !   OLECHAR  C  tagVARKIND  \  EXCEPINFO  ∆  _FILETIME  #   ULONGLONG  E  VARDESC  I  LPCOLESTR  p  LPSTR  W  IUnknown     MEMBERID  I  tagARRAYDESC  A   DOUBLE  E  tagVARDESC 	 :  CY  @  tagBINDSTRING  º  DECIMAL  I  LPCWSTR  ˘  SYSKIND  É  CAUL  ˝  BSTRBLOB  …  tagCAH  >  _tagQUERYOPTION  :  tagCY  8  ITypeComp  t   BOOL  w  tagCAUI  Ñ  tagCAFILETIME  Å  tagDISPPARAMS     VARIANT_BOOL  "   LCID  {  tagSAFEARRAY  A  PROPVARIANT  J  IStereoAPI  ¢  CAPROPVARIANT  &  tagTYSPEC  "  tagTYPEDESC  ∫  tagCLIPDATA  ´  CADATE  !   wchar_t  í  tagCAC    IDLDESC  ∏  tagTYPEATTR    tagSAFEARRAYBOUND  ê  tagBLOB    tagURLZONE  ˜  _LARGE_INTEGER #   ReplacesCorHdrNumericDefines  ™  _ULARGE_INTEGER    ISequentialStream    VARENUM  é  tagCAI    tagCAUB    tagFUNCKIND  "  LPSAFEARRAY  ˇ  _URLZONEREG  ˝  tagBSTRBLOB  ˚  TLIBATTR  ˜  LARGE_INTEGER  Û  IEnumSTATSTG  !   VARTYPE  ‰  ITypeLib  º  tagDEC  ∫  CLIPDATA  ∏  TYPEATTR  G  tagVARIANT     DISPID  !   USHORT    PVOID  ´  tagCADATE  b  HMODULE 
 £  CAL  ó  tagCAUH  ™  ULARGE_INTEGER  ¶  IRecordInfo  Ö  CASCODE      UCHAR  Ñ  CAFILETIME  Å  DISPPARAMS  C  LPVARIANT  y  nvStereoI  "   DWORD    INVOKEKIND    STATSTG  5  tagCALPWSTR  !   WORD      BYTE  ƒ  CAFLT  }  _tagPSUACTION  !   PROPVAR_PAD1  2  CALPSTR  q   WCHAR  {  SAFEARRAY  â  tagCABOOL  w  CAUI  u  IStorage     SHORT  f  PCSTEREOAPI     LONG  @   FLOAT  5  CALPWSTR  4  CACY  `  StereoI  2  tagCALPSTR  /  ITypeInfo  A   DATE  !  LPWSTR     LPVERSIONEDSTREAM  Ì  IStream  A  tagPROPVARIANT  †  CABSTRBLOB  À  tagVersionedStream 
 …  CAH    _GUID  ∆  FILETIME  ƒ  tagCAFLT  õ  tagCACLIPDATA  ¬  tagBINDSTATUS  G  VARIANT  ¿  IDispatch  ß  tagDOMNodeType  •  tagShutdownType     SCODE  £  tagCAL  ¢  tagCAPROPVARIANT  !  BSTR  †  tagCABSTRBLOB 
 t   INT  ù  tagCHANGEKIND  õ  CACLIPDATA  ô  CADBL  ó  CAUH    GUID  î  CACLSID  p   CHAR 
 í  CAC  ê  BLOB  d  HINSTANCE__ 
 é  CAI    CLSID  !   PROPVAR_PAD2  ç  __MIDL_ICodeInstall_0001  u   UINT  ã  tagCALLCONV  â  CABOOL  á  _tagPARSEACTION  Ö  tagCASCODE  É  tagCAUL  Å  CABSTR ÉÏSã\$VçD$PSË    ãÖˆw^2¿[Éƒ√WVË    Éƒã¯WVj SË    Ö¿uWË    Éƒ_^2¿[Éƒ√çL$QçT$Rh    WË    Ö¿Wt’ãD$ãpË    ÉƒÅÊˇˇ  _Å˛  ^ù¿[Éƒ√       %       4       >       Y       _       p                            #    .    <   	 G   
 J    N    e    f    h    o    w    ~    â       ı   Ñ           ç                 	         Ö             W         	   |             W          #   [             W          Ò       1             ç   	   â   }         CheckDriver     I  filename  ¸ˇˇˇu   iLen  ¯ˇˇˇ"   dwDummyHandle  Ùˇˇˇ  lpvi          ∏       º      
 \       ç       	         ã¡«     √   (       ı   $           	                         Ò       6             	         ]         StereoI::StereoI  P   this      %    X   %    \   %   
                                     ˆ       È       ‹       ò       ®       µ       ¬       œ        	              %    ãAãPˇQ√/        ı   $           
                          Ò       >             
       	   o         nvStereoI::GetSeparation  l   this      /    X   /    \   /   
     
               /    ãT$ãAãRPˇQ¬ =        ı   $                                    Ò       >                       p         nvStereoI::SetSeparation  l   this     @   in      =    X   =    \   =   
                   =    ãAãPˇQ(√J        ı   $           
                          Ò       ?             
       	   o         nvStereoI::GetConvergence  l   this      J    X   J    \   J   
     
               J    ãT$ãAãRPˇQ,¬ W        ı   $                                    Ò       ?                       p         nvStereoI::SetConvergence  l   this     @   in      W    X   W    \   W   
                   W    ãT$VRãT$ãÒãFãRPˇQXãvãVˇP\^¬ d        ı   D           #                                                   Ò       C             #          q         nvStereoI::CaptureStereoImage  l   this     t   format     t   quality      d    x   d    |   d   
     #             d    ãT$ãAãRPˇQd¬ q        ı   $                                    Ò       ?                       m         nvStereoI::SetStereoState  l   this     t   in      q    X   q    \   q   
                   q    ãAãPˇQh√~        ı   $           
                          Ò       ?             
       	   n         nvStereoI::GetStereoState  l   this      ~    X   ~    \   ~   
     
               ~    ãT$ãAãRPˇQl¬ ã        ı   $                                    Ò       @                       m         nvStereoI::CheckAPIVersion  l   this     t   version      ã    X   ã    \   ã   
                   ã    Ÿ    √   ú    ò        ı   $                                     Ò       <                       T         StereoI::GetSeparation  P   this      ò    X   ò    \   ò   
                        ò    Ÿ    ¬    ú    ®        ı   $           	                         Ò       <             	          V         StereoI::SetSeparation  P   this     @   in      ®    X   ®    \   ®   
     	              ®    Ÿ    √   ú    µ        ı   $                                     Ò       =                       T         StereoI::GetConvergence  P   this      µ    X   µ    \   µ   
                    µ    Ÿ    ¬    ú    ¬        ı   $           	                         Ò       =             	          V         StereoI::SetConvergence  P   this     @   in      ¬    X   ¬    \   ¬   
     	              ¬    ¬ œ        ı   $                                    Ò       A                        X         StereoI::CaptureStereoImage  P   this     t   format     t   quality      œ    X   œ    \   œ   
                   œ    3¿¬ ‹        ı   $                                    Ò       =                       Q         StereoI::SetStereoState  P   this     t   in      ‹    X   ‹    \   ‹   
                   ‹    3¿√È        ı   $                                     Ò       =                       S         StereoI::GetStereoState  P   this      È    X   È    \   È   
                    È    3¿¬ ˆ        ı   $                                    Ò       >                       Q         StereoI::CheckAPIVersion  P   this     t   version      ˆ    X   ˆ    \   ˆ   
                   ˆ    ã¡«     √         ı   $           	                         Ò       :             	         v         nvStereoI::nvStereoI  l   this         X      \     
                                     ã       ~       q       /       =       J       W       d        	                 Vãt$ÖˆthÉ> uch    Ë    ÉƒÑ¿tRjË    ÉƒÖ¿t«     Î3¿h    âˇ    Ö¿t)h    Pˇ    Ö¿tãÉ¡Qˇ–ÉƒÖ¿t
ããj ˇ^√3¿^√             "       /      8      @      I      P                  	               	     7    H    X    g    p    q    t       ı   D           u                           s                         Ò       3             u      t            CreateStereoI     L  ppStereoI         x      |     
 CreateStereoAPI StereoI.dll n v s t e r c p . d l l       u                   J Ò—‹%îˆHíﬂ˘p≈õ5   c:\sw\devrel\sdk\libs\src\stereoi\release\vc70.pdb Ò.file      ˛ˇ  g.\StereoI.cpp     @comp.id` ˇˇ   @feat.00   ˇˇ   .drectve       t                 .debug$S       F                .text          ç     û˝‹Q     .debug$S                     .file       ˛ˇ  gc:\sw\devrel\sdk\libs\src\stereoi\stereoi.cpp                          ç   ë(                        .rdata                ∞€Å         /               P                ]                u                Ç            .bf            e                 .lf           e .ef     ç      e    3             .debug$F                     .text          	      4Î€Y     .debug$S       É                  ù           .rdata      	                       ∞       	    .debug$F    
                 .text          
      œØí     .debug$S       ã                  ¡          2   
   °+            ‚            .bf            e    P             .lf           e .ef     
      e    P             .debug$F                     .text                QeqG     .debug$S       ö                  Ï          ?      {,        .bf            e    S             .lf           e .ef           e    S             .debug$F                     .text          
      0g\·     .debug$S       å                           L   
   ]-        .bf            e    V             .lf           e .ef     
      e    V             .debug$F                     .text                ß
88     .debug$S       õ                  0         Y      8.        .bf            e    Y             .lf           e .ef           e    Y             .debug$F                     .text          #      dˆº     .debug$S       ◊                  S         f   #   4/        .bf            e    \             .lf           e .ef     #      e    \             .debug$F                     .text                uzòf     .debug$S       õ                  {         s      Z0        .bf            e    _             .lf           e .ef           e    _             .debug$F                     .text          
      5(%     .debug$S       å                  û         Ä   
   =1        .bf            e    b             .lf           e .ef     
      e    b             .debug$F                     .text                 öR,£     .debug$S    !   °                   ¿          ç      2        .bf             e    e             .lf            e .ef            e    e             .debug$F    "                  .text       #        /D˚l     .debug$S    $   â          #        ‰      #   ù      3        .rdata      %                             %    .bf         #   e    j             .lf        #   e .ef        #   e    j             .debug$F    &             #    .text       '   	     ,~     .debug$S    (   ò          '              '   ™   	   Ê3        .bf         '   e    m             .lf        '   e .ef     	   '   e    m             .debug$F    )             '    .text       *        /D˚l     .debug$S    +   ä          *        3      *   ∑      Õ4        .bf         *   e    p             .lf        *   e .ef        *   e    p             .debug$F    ,             *    .text       -   	     ,~     .debug$S    .   ô          -        S      -   ƒ   	   ®5        .bf         -   e    s             .lf        -   e .ef     	   -   e    s             .debug$F    /             -    .text       0         &»ÚZ     .debug$S    1   µ          0        t      0   —      Ç6        .bf         0   e    v             .lf        0   e .ef        0   e    v             .debug$F    2             0    .text       3         z´ãf     .debug$S    4   ô          3        ö      3   ﬁ      z7        .bf         3   e    y             .lf        3   e .ef        3   e    y             .debug$F    5             3    .text       6         ç∫Ô     .debug$S    7   ä          6        ª      6   Î      T8        .bf         6   e    |             .lf        6   e .ef        6   e    |             .debug$F    8             6    .text       9         z´ãf     .debug$S    :   ü          9        €      9   ¯      !9        .bf         9   e                 .lf        9   e .ef        9   e                 .debug$F    ;             9    .text       <   	      4Î€Y     .debug$S    =   á          <        ˝      <    .rdata      >                             >    .debug$F    ?             <    .text       @   u     ˇWxZ     .debug$S    A   ß          @        %      @     u   <            I           .rdata      B          ≈‹E         a      B        â           .rdata      C          C£c         ü      C    .rdata      D          *Ê'·         √      D    .bf         @   e    7             .lf        @   e .ef     u   @   e    M             .debug$F    E             @    .debug$T    F   P                   ?CheckDriver@@YA_NPBG@Z _VerQueryValueW@16 ??_C@_13FPGAJAPJ@?$AA?2?$AA?$AA@ ??3@YAXPAX@Z _GetFileVersionInfoW@16 ??2@YAPAXI@Z _GetFileVersionInfoSizeW@8 ??0StereoI@@QAE@XZ ??_7StereoI@@6B@ ?GetSeparation@nvStereoI@@UAEMXZ __fltused ?SetSeparation@nvStereoI@@UAEMM@Z ?GetConvergence@nvStereoI@@UAEMXZ ?SetConvergence@nvStereoI@@UAEMM@Z ?CaptureStereoImage@nvStereoI@@UAEXHH@Z ?SetStereoState@nvStereoI@@UAEHH@Z ?GetStereoState@nvStereoI@@UAEHXZ ?CheckAPIVersion@nvStereoI@@UAEHH@Z ?GetSeparation@StereoI@@UAEMXZ __real@00000000 ?SetSeparation@StereoI@@UAEMM@Z ?GetConvergence@StereoI@@UAEMXZ ?SetConvergence@StereoI@@UAEMM@Z ?CaptureStereoImage@StereoI@@UAEXHH@Z ?SetStereoState@StereoI@@UAEHH@Z ?GetStereoState@StereoI@@UAEHXZ ?CheckAPIVersion@StereoI@@UAEHH@Z ??0nvStereoI@@QAE@XZ ??_7nvStereoI@@6B@ ?CreateStereoI@@YAHPAPAUStereoI@@@Z __imp__GetProcAddress@8 ??_C@_0BA@FGJIKEGP@CreateStereoAPI?$AA@ __imp__LoadLibraryA@4 ??_C@_0M@OHDNJKND@StereoI?4dll?$AA@ ??_C@_1BK@LBDEKHOH@?$AAn?$AAv?$AAs?$AAt?$AAe?$AAr?$AAc?$AAp?$AA?4?$AAd?$AAl?$AAl?$AA?$AA@ 

blob
data 3240

"""
Tkinter support for the Togl 2.X Tk OpenGL widget.

Copyright (C) 2006-2007  Greg Couch
See the LICENSE file for copyright details.
"""
__all__ = ['Togl', 'NORMAL', 'OVERLAY']

import Tkinter
import weakref, atexit

# Overlay constants
NORMAL = 1
OVERLAY = 2

class Togl(Tkinter.Widget):
	"""Tk OpenGL Widget"""
	_instances = weakref.WeakKeyDictionary()

	def __init__(self, master=None, cnf={}, **kw):
		"""Return new Togl widget"""
		if master is None:
			master = Tkinter._default_root
		master.tk.call('package', 'require', 'Togl', '2.0')
		Tkinter.Widget.__init__(self, master, "togl", cnf, kw)
		Togl._instances[self] = True

	def _cbsubst(self, *args):
		"""callback command argument substitution"""
		if len(args) != 1:
			return args
		return (self._nametowidget(args[0]),)

	def _options(self, cnf, kw = None):
		"""Internal function."""
		if kw:
			cnf = Tkinter._cnfmerge((cnf, kw))
		else:
			cnf = Tkinter._cnfmerge(cnf)
		res = ()
		for k, v in cnf.items():
			if v is not None:
				if k[-1] == '_': k = k[:-1]
				if callable(v):
					if k.endswith('command'):
						v = self._register(v, self._cbsubst)
					else:
						v = self._register(v)
				res = res + ('-'+k, v)
		return res

	# cget, configure are inherited

	def extensions(self):
		"""Return list of supported OpenGL extensions"""
		return self.tk.call(self._w, 'extensions')

	def postredisplay(self):
		"""Cause the displaycommand callback to be called
		the next time the event loop is idle."""
		self.tk.call(self._w, 'postredisplay')

	def render(self):
		"""Call the displaycommand callback immediately."""
		self.tk.call(self._w, 'render')

	def swapbuffers(self):
		"""If single-buffred, just flush OpenGL command buffer.  If
		double-buffered, swap front and back buffers.  (So this is
		appropriate to call after every frame is drawn.)"""
		self.tk.call(self._w, 'swapbuffers')

	def makecurrent(self):
		"""Make widget the current OpenGL context"""
		self.tk.call(self._w, 'makecurrent')

	def takephoto(self, imageName):
		"""Copy current contents of widget into the given photo image
		"""
		self.tk.call(self._w, 'takephoto', imageName)

	def loadbitmapfont(self, name):
		return self.tk.call(self._w, 'loadbitmapfont', name)

	def unloadbitmapfont(self, fontbase):
		self.tk.call(self._w, 'unloadbitmapfont', fontbase)

	def uselayer(self, layer):
		self.tk.call(self._w, 'uselayer', layer)

	def showoverlay(self):
		self.tk.call(self._w, 'showoverlay')

	def hideoverlay(self):
		self.tk.call(self._w, 'hideoverlay')

	def postredisplayoverlay(self):
		self.tk.call(self._w, 'postredisplayoverlay')

	def renderoverlay(self):
		self.tk.call(self._w, 'renderoverlay')

	def existsoverlay(self):
		return self.tk.call(self._w, 'existsoverlay')

	def ismappedoverlay(self):
		return self.tk.call(self._w, 'ismappedoverlay')

	def getoverlaytransparentvalue(self):
		return self.tk.call(self._w, 'getoverlaytransparentvalue')

	def destroy(self):
		del Togl._instances[self]
		Tkinter.Widget.destroy(self)

def _cleanup():
	# destroy OpenGL contexts early, so destroycommand's don't
	# try to make any OpenGL calls during exit.
	for t in Togl._instances.keys():
		try:
			t.destroy()
		except Tkinter.TclError:
			pass
atexit.register(_cleanup)

blob
data 946
#
# Include the TEA standard macro set
#

builtin(include,tclconfig/tcl.m4)

#
# Add here whatever m4 macros you want to define for your package
#

#------------------------------------------------------------------------
# TOGL_ENABLE_STUBS --
#
#	Specifiy if stubs should be used.
#
# Arguments:
#	none
#
# Results:
#
#	Adds the following arguments to configure:
#		--enable-stubs
#
#------------------------------------------------------------------------

AC_DEFUN(TOGL_ENABLE_STUBS, [
    AC_MSG_CHECKING([whether to link with stubs library])
    AC_ARG_ENABLE(stubs,
	[  --enable-stubs          build and link with stub libraries (--enable-stubs)],
	[tcl_ok=$enableval], [tcl_ok=yes])

    if test "${enable_stubs+set}" = set; then
	enableval="$enable_stubs"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" ; then
	AC_MSG_RESULT([stubs])
	USE_STUBS=1
    else
	AC_MSG_RESULT([no stubs])
	USE_STUBS=0
    fi
])

blob
data 49959
⁄  Ö û        ˇ    no name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   –  X  „  j  ˜  }    é    £   0  !≤  #;  $∫  &G  '   )T  *◊  ,U  -”  /]  0‡  2a  3·  5b  6ﬁ  8\  9‡  ;V  <‰  >f  ?Ô  Aw  C  Dê  F
  Gè  I  Jé  L  Mú  O  Pñ  R  Sü  U   Vò  X  Yç  [   \u  ]È  _Y  `Œ  b>  c¨  e"  fú  h  i{  jÏ  lP  mæ  o"  pê  qı  sL  t¨  v	  wX  x£  yÂ  {%  |^  }è  ~ø  Í  Å  Ç  É%  Ñ4  Ö7  Ü7  á*  à&  â2  ä  ã/  å.  ç  é&  è  è´  êo  ë  ëŸ  í}  ìT  îf  ï5  ïˇ  ó  ó÷  òä  ôO  ö  öÀ  õç  úb  ù#  ùÛ  û¡  üë  †Y  °7  ¢  ¢¯  £÷  §≠  •ä  ¶y  ßm  ®B  ©  ©‰  ™∑  ´Ö  ¨j  ≠B  Æ  Æı  Øÿ  ∞Æ  ±î  ≤Ä  ≥]  ¥>  µ'  ∂  ∂ÿ  ∑°  ∏r  πD  ∫  ∫ı  ªÀ  ºî  Ωl  æ3  æÊ  ø¶  ¿F  ¿–  ¡k  ¡Ê  ¬N  ¬ë  ¬‘  S  ›  g  Ú  {    é    õ  $   ≥  "6  #æ  %>  &   (K  )‘  +S  ,’  .U  /›  1]  2ﬁ  4]  5›  7^  8ÿ  :W  ;€  =c  >È  @l  A˝  Cä  E  Få  H  Ië  K  Lò  N  Oî  Q  Rù  T  Uú  W  Xé  Z  [x  \  ^b  _”  aE  bª  d&  eü  g  hÖ  iˆ  kb  l»  n1  oö  q  re  s¬  u  vv  wÀ  y  zQ  {è  |∆  }¯     ÄF  Åa  Çm  É  Ñà  Öã  ÜÜ  áz  àÑ  â|  ä{  ãá  åÅ  çz  ét  è>  èÛ  ê´  ë[  í  íº  ì≤  î¶  ïs  ñW  óL  ò  òÀ  ôå  öH  õ	  õÃ  úô  ù]  û+  û˛  üÃ  ††  °y  ¢\  £;  §  §ˆ  •”  ¶»  ß¨  ®{  ©J  ™   ™  ´»  ¨ß  ≠É  ÆX  Ø=  ∞  ∞Ú  ±ÿ  ≤»  ≥ü  ¥ã  µm  ∂G  ∑  ∑Í  ∏≥  πÖ  ∫X  ª:  º  º⁄  ΩØ  æl  ø%  ø÷  ¿r  ¡   ¡ì  ¬  ¬c  ¬®  ¬Ì  “  _  Ë  p  ˘  Ä  	  ì    ®  !1  "∏  $;  %¡  'H  (—  *U  +“  -U  .ÿ  0Z  1ﬁ  3]  4ﬂ  6]  7€  9[  :ÿ  <^  =Ê  ?k  @Û  BÇ  D  Eà  G  Hï  J  Kö  M  Nõ  P  Qö  S  T†  V  Wó  Y  ZÖ  [ı  ]m  ^ﬁ  `R  a¡  c0  d®  f  gè  h˚  jn  k÷  mB  n©  p  q|  r◊  t5  uî  vÊ  x6  yt  zπ  {ı  })  ~Z  É  Ä®  Å∫  Ç…  É◊  Ñ€  Ö‚  Ü’  á“  à‹  â“  ä’  ã€  åÕ  çŒ  éø  èq  ê/  ê‰  ëõ  íG  í˛  î  îÈ  ïÆ  ñ≠  óì  òM  ô  ô—  öâ  õJ  ú  ú›  ù¶  ûq  üH  †  †  °∆  ¢¨  £á  §f  •B  ¶  ß  ßˆ  ®≈  ©ï  ™m  ´6  ¨  ¨Û  ≠Ã  Æ£  Øâ  ∞e  ±B  ≤+  ≥  ≥  ¥Ÿ  µª  ∂ë  ∑a  ∏4  ∏˘  π…  ∫®  ªÉ  ºM  Ω!  ΩÙ  æ®  øh  ¿  ¿ü  ¡5  ¡ø  ¬(  ¬{  ¬¡  √   É   Ö   Ñ   à   Ñ   Ñ   à   Ñ   Å   Å   É   Ñ   É   Ñ   É   Å   Ä   |   Ä   Ç   Ä   }   }   |   {   Ä   |   w   Ö      É   }   Ü   É   ~   Ç   ~   {   Ö      {   y      Ç   |   |   }   x   y   x   {   y   z   w   }   z   }   {   z   {   v   x   s   x   w   p   v   r   m   s   l   l   j   h   i   a   \   Z   V   Z   T   T   O   P   ^   J   \   X   S   [   N   3   H   <   B   7   ?   ^   @   >   X   G   =   A   =   9   >   ?   7   :   8   =   ;   G   B   I   C   H   I   I   O   ?   9   C   <   9   C   =   A   B   H   @   D   D   H   B   M   F   @   D   I   A   A   K   E   @   F   C   9   ?   0   ,   0   (   !               Ç   Å   ~   ~      {   Å   Ä   Ñ   ~   Ç   }   É   ~   Ü   Å      Ä   É   }   Å      Ç   Ä   }   É   Å   É   É   Ç   á   Ö   Ö   z   É   à   Ä   á   Ç   Ñ   É   Ö      Ö      Ç   Ä      }   }   |      |   u   Ç   }   x   v   x   t   z   x   {   u   r   s   v   p   k   e   h   f   c   b   c   b   Y   \   X   S   W   O   X   X   V   Z   T   L   T   K   3   <   9   @   7   B   \   C   ;   V   G   :   C   E   A   A   F   D   I   F   J   E   P   M   P   L   H   L   K   O   J   J   K   M   F   H   L   I   K   L   M   P   S   M   Q   N   N   J   E   J   F   D   P   I   B   G   E   <   C   :   -   5   ,   !            Ü   Ñ   Ç   á   Ñ   Ü   Ö   á   à   à   Å   É      Ü   Ç   É   Ç   É   ~   Ö   Ü   É   Ñ   É   Å   Å   Ö   ~   Ü   Ä   Ñ   Ñ   Ö   Å   Ç   Ä   Å   }      Ç   Ä      Å   É   Ä   }         {   Ä   |   {   |   }   |   z   Ä   |   Ä   ~   z   |   y   {   y   u   w   u   r   m   q   l   i   f   e   g   _   ]   \   ]   \   U   U   T   V   M   Z   S   R   X   L   :   @   5   >   6   V   X   L   Q   X   C   =   A   >   B   C   P   F   M   P   I   H   G   M   L   O   G   H   [   V   L   B   O   J   O   Z   O   J   R   O   I   R   U   H   N   N   L   G   @   >   K   D   M   H   G   K   ?   >   >   6   1   6   '   &         §e2!C!v2eC!2e2òÀvCe!2eÀ˛Te!!e‹‹ò!eÇ‹ÀeåCe˛˛ee2ee˛˛òeö˛˛TòeeÀ˛˛òTòeT˛˛øòeeTò˛˛áeëÀÀ2e2eò 2!22CòeëÀ˛ÀCòeeò˛Àee˛òT!e2C §22! !v22C! 22eÀv 2!22ÀÀT2!!2‹‹e!2Ç‹ò2ÑC2˛˛2É˛Àe2Ñ˛ÀT2ãò˛ÀeT22TÀ˛ø2ÖTe˛˛á2ÇÀò2ãò!2!2 Ce2Ñò˛ÀC2âe˛À22À2T!2C §22! !v22C! 22òÀv 2!22À˛T2!!2‹‹2!2Ç‹À2ÖCe˛˛e2Ñe˛˛e2ö˛ÀT2e2ò˛˛eT22TÀ˛ø2eeTò˛˛á2ÇÀÀ2°ò  !22Cò2e22À˛ÀC2e2ò˛˛22˛eT!22 2C øe2!!2e!C©22!!22òøá2!e2eø‹ee!ee©˛áe2e2ø˛Ce2ee‹˛òCeeT˛˛ee!ò˛˛òeìò˛˛òòCòeÀ˛‹Tòeeò˛˛Àeëò‹e!ò2©e!!T2!vòeÉÀ˛ÀeÜÀ˛‹ee‹eÇòùÀò4 £e2!!22!C©2 !!22eøá2!2 2ø‹e1!2 ©Àá2ÉøÀC2ë‹˛eC22T˛˛22!2˛˛e2åe˛˛e2C22ò˛‹T2ÑeÀ˛ò2ëe‹2!22©e!!T2!ve2ÉÀ˛ò2Üò˛‹22‹2ÅòÀòe ñ22!!22!C©2 !! 2eøá2!2äø‹e !24©˛á2ÉøÀC2ë‹˛eC22T˛˛22!e˛˛e2åò˛˛eeCe2À˛‹T2Ñe˛˛À2ôò‹2!22©2!!T2!ve22e2À˛Àe2áÀÀ‹22‹e2Çee2  ÑTC!2!£2eá2!!2!2!eÀá22!eeò˛ò2e!e˛Àe2eeò˛òeÉÀ˛áeÉ˛˛ÀeÉ‹˛øeåò˛˛eCòeÀ˛˛òeüò‹˛Àòe2e‹òeòeTv2!!!eòeòCee˛˛òeéòÀ˛ÀeeÀòe2eòÀù˛© ÑT !2!ú 2á2!! ! !eòá22!22òÀe22!2˛ò2Ñ ò˛e2ÉÀ˛á2ÉÀ˛ò2É‹˛ø2ã˛˛2C22ò˛Àe2û‹˛À22 2‹e2e2Tv2!!!2ee2C22À˛e2áÀ˛ò22òe2ÉòÀÀ˛© ÑT ! !ú eá2!! ! !eÀá 2!22À˛e22!2˛ò2Ñ4ò˛e2ë˛˛á22e2˛˛ò2e22‹˛ø2ìe˛˛2C2eÀ˛˛ee2ee‹˛À2£‹e2ò2Tv !!!2òe2C22˛˛ò22eeÀ˛À22Àee2ò© ´e!eò!C!22T!!!!Cøøee2e!ò‹òee!ev˛‹ee2ee‹ÀCeäÀ˛©e2ee‹˛‹eÖCò˛˛Teì˛˛Àeòeeò˛˛òeòee©˛˛Teê©À!ò©ee!!!CveTeç˛˛òeeòe˛˛òe!ÀeÜ!eòeòòe2 £2!ee! !22T!!!!Cøø2 22!e‹ò22!2vÀ‹2É‹ÀC2Éò˛©2É‹˛‹2ÖCe˛ÀT2ÉÀ˛ò2Ñe˛˛e2ó©˛˛T22 ©ò!e© e! ! v2T2ÉÀ˛e2ãÀ˛ò2!ee22!eò2 £e!eò! ! 2T!!!!Cøø2422!ò‹À22!2v˛‹2É‹òC2äò˛©22e2‹˛‹2ÖCòÀ˛T2¶˛˛À2e22e˛˛ò2e2e©˛˛T224©À!e©4e! ! veT2óeÀ˛e2e2e˛˛ò2!òe22!2e2e2e  ±22òò2!!!e!!!!CCÀøe2!eeò˛©C22TeÀ˛Tee2eÀ‹òe2eò˛ÀeÑÀ˛‹òeÉ‹˛òeìø˛‹òCòeò˛˛ÀTeTòò˛˛òeéòÀeeÀee2e2C!TeÉ˛‹òeêò˛˛òeeòeòe2eòeÀ˛˛À §22eò2!!!2!!!! Còø22!22eÀ©C22 2À˛T2Çò‹2Ée˛À2Ñò˛‹e2É‹˛e2Öø˛‹2C2ã˛˛òT2T2e˛˛e2ÖeÀ22À2Ü22 !T2Ç˛‹2Ñe˛˛e2Åe2ÑeòòÀ˛ § 2òò !!!2!!!! CÀø22!22ò˛©C22 2˛˛T2ÇÀ‹2Éò˛À2åeò˛‹2e22e‹˛e2õø˛‹eCe2e˛˛òT2T2e˛˛ee22eÀ2eÀ2à22 !T2e2çe˛‹e22ee˛˛ò22e2Çò˛˛À §!!ee2!2!22!!2!CÀøT!e!!ò‹Àe2eCeÀ˛eâá˛eT2T˛˛eÖTò˛˛òeÉÀ˛ÀeÑò˛˛TeãÀ˛Àòeeòe˛˛©eïÀee‹ò2eCT2!e2!eòeeò˛ÀeàÀ˛˛TòeeòeÅòÀÅ‹˛À §!!2e2! !22!!2!CòøT!2!!e‹ò22 C2À˛2âá˛2 2T˛À2ÖTe˛˛e2ÉÀ˛ò2Ñò˛ÀT2Éò˛À2ÑeÀ˛©2éÀ22‹e22CT2!22!2Ç˛À2àe˛˛T2 ee2ÖòÀ˛˛‹˛ §!!ee2! !2 !!2!CÀøT!2!!e‹À224C2À˛2Æá˛2 2T˛Àe22Tò˛˛e2e22˛˛ò2e2ò˛ÀTe22eÀ˛Àe22ee˛˛©2¢eÀ22‹e22CT2!e2!2e22e˛˛2e22ò˛˛T242ò2ÅeòÅ‹À ú!2eC!!!! ee!eòÀTe22ee‹‹eí!eò˛Àe2e2T˛‹e2eeÀ˛eÜòT˛˛øòeÉò˛‹e≥‹˛òeòeeò˛˛veòeòø˛‹eòeeÀeeøòee!e2òe2eeCòee˛ÀeeòòÀ˛‹òeÖòee2òÀÅ˛˛‹ ï!22C!!! !e2!2òÀT2Ç‹‹2Ö!2e˛ò2Ñ TÀ‹2ÉÀ˛e2ÑTÀ˛ø2Ée˛‹2É‹˛e2Ñe˛˛v2Éø˛‹2ïò22øe22!22ee 22C22e˛ò2Éò˛‹2Åe2À˛‹ ï!2eC!!!  e2!2ÀÀT2Ée‹‹2Ö!2ò˛À2ÉT˛‹2äÀ˛e22eT˛˛ø2Ée˛‹2çe‹˛e2e22ò˛˛v2e®ø˛‹2e22òe2øò22!22òe 2eCe2e˛òe2eeò˛‹e22ee2ÅeòÅ˛À‹ â!!2!vò22ò!Cò!!©Àò2Ce2eÀÀCe!ee˛ÀeÉ‹˛òeãò˛ÀCeeòò˛˛TeÑT˛˛òeãÀ˛áòòCòò‹˛ÀeÑTÀ˛˛eéòTeòÀ2òCeev!e2eÉò˛©eÑTÀ˛ÀeÅòeÅ©ÀÅ˛‹˛ â!! !ve2 ã!Ce!!©Àe2 2äòÀC2!22ÀÀ2ä‹Àe2 2e˛òC2Ñò˛ÀT2ÑTÀ˛e2ãò˛á2eC2e‹˛e2ÖTe˛Àe2åeT2eò2eC2ev!2Ç˛©2ÑTò˛À2Åe2Ç©À˛‹˛ â!! !ve2 ã!Ce!!©Àe2 2äÀÀC2!22˛À2ä‹˛e242ò˛òC2Ñò˛˛T2ÑT˛˛e2ìÀ˛áeeCee‹Àòee2Tò˛˛e2èòT2òò2eC2ev!22e2ãe˛©2e2TÀ˛Àe2Öò2e2©òÅÀ‹À ≤C!!eeáe!2!!!!ee2òÀò2e!eeø‹Tee!ee˛˛Tee2eø˛òeC!e‹ÀeÖTò˛˛òeÉÀ˛Àeãò˛ÀòTòòT˛˛øeóòò˛˛òòeeTòeeÀeve2òe2!eòeÇ˛òeÖò˛˛øòeÅòeÀ˛ ≤ !!2eá2!2!  !e22eÀe22! 2ø‹T22!22˛ÀT22 2ø˛ò2C!2‹À2åT2˛˛e22 2À˛ò2ãe˛òeT22TÀ˛ø2Ñe˛˛e2çTe22ò2v22e22!2ÇÀe2ÉÀ˛ø2Åe2ÑÀÀ˛À˛ • !!2eáe! !  !e2 ò˛e22!42ø‹T22!2e˛ÀT2òø˛ò2C!2‹À22eTe˛˛e224eÀ˛ò2ãe˛À2TeeT˛˛ø2ùeò˛˛ò22eTe22À2v22ò22!2e2e2eÀò2âeÀ˛ø2e22ò2ÅeòÅÀÀ˛ Å!Ñ2áve!ú22v‹òe!2e!ÀÀòe!eeTÀ˛eeCeeò˛˛eÉò˛òeãò˛˛©eCeeÀ˛‹eí‹˛òòTòeÀ˛˛òòeeò˛˛Àeèòòe!TòeeCò2C2òòeÇÀÀeçò‹˛òCòeeÀeòCòÀÅ‹˛‹ Å!®2áv2!! !! !!2 v‹ò2!22!òÀe2!2 TÀÀe2C22e˛À2Ée˛e2ô˛˛©2C22ò˛‹2 22‹˛e2Te2ò˛˛e2ÑeÀ˛ò2ée2!Te22Ce2 2ee2ÇÀe2Ñ‹˛eC2Ñò22CÀÇ˛‹˛‹ Å!®2áv2!! !! !!22v‹ò2!22!ÀÀò2!24TÀ˛e2C22ò˛À2Éò˛e2Õe˛˛©2C22À˛‹242e‹˛eeT2eÀ˛˛e2ee2˛˛ò2e22ò2!Tee2Cò2 2òe22e2˛e22ee‹˛òCe22ò2eCeòòe‹À‹ ãe!C!CeáT!2!î22v‹ÀC2e2eò‹òe2e!eÀ˛eå2ev˛‹CeeCe˛ÀeÑò‹‹˛eÉò˛‹eÑÀ˛Àeòê©˛˛òCòeeÀ˛ÀTòee©eêáò2!òe!e˛áeeòeÀòeÑò˛˛òeÇòÀeÖ©ÀòÀÀ˛ ã2! ! eáT! !ç2 v‹òC2 22ò‹ò2ì!2ÀÀe22 2vÀ‹C2 C2ÀÀ2Ñe‹‹À2Ée˛‹2åò˛òe22e©˛˛eC2Ñò˛òT2é©22 áe2!e2!2Àá2ÇÀe2É˛˛e2Åò2É©˛À˛ ã2! ! òáT! !ç  v‹ÀC2422À‹ò2Ö!2˛˛e2ëv˛‹C24Ce˛À22ee‹‹À2Éò˛‹2ÑÀ˛ò2e£©˛˛òC22eÀ˛ÀT2e2©224áe2!ò2!2˛á2e22Àò2âò˛˛e2e2eÀ2Ñ©eòòÀ ¶2!2!!eò!!!C!C!!T˛øee2e!À‹À2ee2eÀ˛òCeÇ˛˛eÉÀ˛òeÑø˛øòeÑò‹˛òeò©˛‹òòeòò˛˛©òeTò©˛‹òeòeÀòeâò2eeÀCe‹òeÉT˛áeçò˛˛òeòeò˛CòeòÀ˛‹ ï2! !!2e!! C! !!TÀø2Ñ!e‹ò2Ñò˛eC2ÉÀ˛e2Éò˛e2Éø˛ø2Ñe‹˛e2í©˛‹22e2e˛˛©22T2©˛‹2Çòe2âe2 eò 2‹e2ÉTòá2Ñe˛Àe2ÜeÀC22òÀÅ˛˛‹ ï2! !!2ò!! C! !!T˛ø2Ñ!ò‹À2ÑÀ˛òC2Ñe˛˛e2æÀ˛e22eø˛ø22e2e‹˛e22e©˛‹ee2eò˛˛©2eTe©˛‹ee2eÀee22ò 4eò e‹ò22eTÀá2çe˛˛ee2ee˛Ce2eòÀ‹ Ç22!Öòe!eó2!!2CÀ‹e2e2e‹ÀCe2ee©˛©eå2e‹˛òeCee©˛©eãÀ˛ÀTòeeò‹˛ÀeÖò˛˛òCòê˛˛‹òTòeò˛˛òTòeòÀeâáe2ò˛T!ÀÀeÉòÀÀeÉò˛˛eÜò˛TeeòÀ˛ Ç22!Öò2!2á2!! CÀ‹2ã‹òC2 22©À©2ä‹˛e2C22©À©2Ñò˛ÀT2É‹˛e2òe˛˛eC22eÀ˛‹2T22e˛˛eT22eò2âá22eÀT!òò2Çòò2Ée˛À2àe˛T22ò˛À˛ Ç2 !Öò2!2á2!! C˛‹2Ñ‹ÀC2É©˛©2ò‹˛ò2C22©˛©2e2À˛ÀTe22e‹˛ò2òe˛˛eC2ee˛˛‹eT2ee˛˛eT22òò2èá22e˛T!Àò22e2ÀÀ2Ñò˛Àe2Üò˛T22eòÀ ≠e!C!C2e©e!v2!!e2!eø˛Tee2eT˛ÀeCe!eò˛ÀeC2eeÀ˛òeÉò˛‹eÑ©˛˛òeÑ‹˛øòeå˛˛Àeeòò‹˛˛òeòà˛˛ÀòTòT˛eâòòeò˛òTvÀeíø˛2e2À˛‹eòeeÀ˛òeòòÀ‹À ≠2! ! 22©e!v2 !22!2øÀT2 22TÀÀ2C2!2e˛ò2C 22ò˛e2Ée˛‹2Ñ©˛Àe2É‹˛ø2ãÀ˛ò2e2e‹˛Àe2âeÀ˛ò2T2TÀ2àe2e˛e vò2àøÀ22 ò˛‹2Çò˛2ÖòÀ˛À˛‹˛ ße! ! 2e©e!v2 !22!2ø˛T2422T˛À2C2!2ò˛À2C2ÉÀ˛ò2Ée˛‹2Ñ©˛˛e2´e‹˛ø22e2˛˛òe2e2‹˛˛e2e2e˛˛òeTeTÀe22eò2ò˛ò vÀ2ÉeøÀ2çò˛‹22e2À˛e2eeò‹À Ñv2!!2ûòá!eá!!2!2C2À˛e22e2e˛‹ee2e2ò˛‹eüò‹ÀeCeCT˛‹Teòò˛˛òTòee˛˛ÀòeeòÀ˛˛òÑCÀ˛˛òãTòÀ˛øòòeò‹òeà©!À˛á!eòeÉòÀ‹eçÀ˛øeòeòÀ˛TeeòÀ˛ ñv2!!2 2eá!eá!! !2 2ò˛e2Ç˛‹2ÉeÀ‹2íò‹ò2C CTÀ‹T22e˛˛eT2Ñò˛Àe2íò˛Àe22Ce˛˛ee2T2À˛ø2Ç‹e2à©!ò˛á! e2àÀ‹212ò˛ø2äÀ˛T22òÀÀ˛À˛ ñv2!!2 2òá!eá!! !2 2À˛e2Ée˛‹2ÉòÀ‹2ôÀ‹ò2C4CT˛‹T2eò˛˛eTe22À˛Àe2äò˛˛2eeCò˛˛eãTeÀ˛øe22e‹ò2à©!ò˛á!4ò2óe˛‹e 2À˛øee22˛˛T22eòòeòÀ éòò!!T22vò!2òe2ú!eò˛áee2ee‹˛ve2eeòÀÀCe2eeò˛Àe¨‹˛òeeò‹˛ÀTòòeÀ˛˛òTòeT˛˛áòCòò‹˛ÀòòeòÀ˛‹òTòe˛ÀeâòeøÀòe!eTeé˛‹òeeÀ˛ÀòeeT˛˛eÅTe éòe!! 22ve!2ee2ú!2òÀá22 22‹Àv2 22eÀÀC2 22e˛ò2Æ 2‹˛e22e‹˛òT22eò˛˛eT22TÀ˛áeCe2‹˛òe2eeò˛‹2T22Àò2îe2øÀ22!2T2 2À‹e 2ò˛ò2ÉTÀ˛2ÑTeòeò éòe!! 22vò!2òe Ö!2ò˛á2Öe2‹˛v2Ñe˛ÀC2Éò˛À2°42‹˛e22e‹˛òT2e2À˛˛eTe2T˛˛áeC2e‹˛òe´À˛‹eTe2ÀÀ2e2eeø˛e2!2T24eÀ‹e42À˛ò2e2T˛˛22eT2eò ≠À©e!!e2e2eò2!!2!!á˛©e2e2eÀ˛òe2e2T˛‹eeCeCò˛‹eòÀ˛òeòT˛˛‹òòCòò˛˛òòTòò‹˛ÀòÑTÀ˛ÀòÉ˛˛òeÉø‹òeÉÀÀTeíòe2ò‹˛ò!eÀ˛òCòeò˛‹eÅ!e ñÀ©2!!2 2 ee2!! !!á˛©2ÉÀ˛e2å TÀ‹22C2CeÀ‹2òò˛ò22TÀ˛‹22C2e˛˛e2T22‹˛ò2ÖTò˛Àe2Ñe˛˛e2Çø‹2áòòT22 e2â‹˛e!2ò˛eC2Ç˛‹2Å!2e ñÀ©2!!2 e eò2!! !!á˛©2É˛˛e2çT˛‹e2C2Cò˛‹2e2òÀ˛ò2eTÀ˛‹eeCeò˛˛ò2T2e‹˛òeÑTò˛Àeñ2ò˛˛ee2eø‹e22e2ÀÀT224ò2é‹˛e!2ò˛òCe2e˛‹2Å!2 ñÀ‹ò2e!e2e2!2eT!!22á˛øeäÀ‹ò2e2ee‹˛eÉò˛‹eòÀ˛ÀeTò©˛˛òòTò˛˛ÀTòTòÀ˛ÀòÇ˛‹òâ˛˛Àeeò©˛òeòeí©òeeÀ˛òeeÀ˛òòeeò˛ÀeÅ2Å!áÀ Üò‹e22!2å!2eT!! 2áÀø2Éò‹e2ä‹Àe2 22eÀ‹2òò˛ò2T2©˛˛eeT2˛˛òT2T2À˛òeÜ2eÀ‹e2eÉ˛˛ò2É©Àe2Éeeò2Å©2àÀ˛ò2 ò˛e2Ée˛ò2Å!áÀ ñÀ‹e22!22e !2òT!!22á˛ø2ÉÀ‹ò2®e‹˛e2422e˛‹e2e2eÀ˛À2Te©˛˛eeT2˛˛òTeTeÀ˛ÀeÇ˛‹eäò˛˛ò22e©˛e2ùeòò22e2©e22˛Àò24À˛ee2ee˛À22e Å!áÀ â˛øe2!C2e!Ñee!2ãò˛‹e2e2e©˛©eç2eÀ˛òCeCeT˛˛òeäò˛‹eeòò˛˛Àòä‹˛ÀòeòCÀ˛˛òÇø˛òé˛˛‹òeeò˛ÀòeeÀòeìÀÀeeÀ˛øeeÀ˛òTòeò˛©òeÅ!2À‹ âÀø22! 22!ä2e!2 22˛‹2É©˛©2ãÀÀeC2C TÀ˛e2Ée˛‹2Öe˛˛òe2É‹˛À2ãCò˛˛ee2eeø˛eÖ2eÀ˛‹2Ée˛À2Çòe2íòÀ2 ò˛ø22ò˛2T22e˛©2Å!2À‹ â˛ø22! 22!ä2e!  2e˛‹2É©˛©2ãÀ˛eC2C4T˛˛e2Ñò˛‹2eÉ˛˛òeä‹˛Àe2eCÀ˛˛eÇø˛e™˛˛‹e22e˛Àee2òee2e22ÀÀ24À˛ø22À˛eT22ò˛©2e22! ò‹ ¶e‹‹e2e!2!C!2!Te!eT˛˛Tee2eò˛øeC2eeÀ‹òeÉ‹˛òeòò˛‹eeòe˛˛ÀòòTòÀ˛‹òòCòÀ˛˛òÉÀ˛Àòé˛˛‹òòeò˛˛òòeòáeõò‹˛eeÀ˛Àeeò‹òeòeÀ˛òeeòeC2CeÀ˛ ¶2‹‹e2 !2! ! !T2!2T˛ÀT22 2eÀø2C 22ò‹ò2É‹˛e2òe˛‹e2e2À˛Àe2Teò˛‹e2Cee˛˛eÜ2eò˛ò2eÑÀ˛‹e2áÀ˛e22eá2å‹˛22ò˛ò22e‹e2Ée˛e2ÑCeCeÀ˛ ó2‹‹e24!2! ! !T2!2T˛˛T2Öò˛ø2C2ÉÀ‹ò2Öe‹˛ee2ôò˛‹e2ee˛˛ÀeeTeÀ˛‹eeCeò˛˛òeÉÀ˛òe≠À˛‹ee2e˛˛ee2òá2e2ee‹˛22ò˛À22ò‹e2eeò˛ò2e22C2C2À˛ â2ò˛À22!e2!ä2C!2!!e˛˛TeÑCò˛ÀeÖÀ˛ÀeCeÉ‹˛òeôò˛˛òeòòø˛‹òTeòÀ˛˛òòTòò˛˛ÀòÉÀÀ‹ò˛ãòTòò‹˛Àeeòòeâòò˛˛Teò˛‹eêÀeòòeÀ˛òeòTeeeò˛ â òÀò22!2 !ä C! !!2À˛T2ÑCe˛ò2Öò˛ò2C2É‹˛e2É˛Àe2ìø˛‹2T22ò˛Àe2T2e˛˛ò2eÇ˛‹eäÀ˛˛eT2e‹˛ò2Åe2áÀ˛T2e˛‹2Åò2ãò˛e22Teeòò˛ â2À˛ò2 !22!ä2C! !!e˛˛T2ÑCò˛À2©eÀ˛À2C22e‹˛ò22e2e˛˛e2eeø˛‹eT2eÀ˛˛eeT2ò˛˛òe¥ò˛‹eeòòÀ˛˛eTee‹˛ò22eò2e2ee˛˛T2ò˛‹22eÀe2e2ò˛ee2T22 2eÀ˛ ãee‹‹e!2Cee2ó!ee‹˛òCeeCò‹‹TeCeeò˛ÀeÉÀ˛øeâ˛˛òeeTÀ˛˛òÖÀ˛˛òTòä‹˛‹òÀòÀÀ˛˛òäÀ˛˛ÀeòTÀ˛‹eçòeCeeò˛˛òee˛˛eâÀeòTòÀ˛òeòÀ˛ ¶22‹‹2!2 e22 22!22‹˛eC22C2‹‹T2C22e˛À2Éò˛ø2ò˛˛e22Te˛˛ee2eò˛˛eT22e‹˛‹eê˛Àe2eeò˛˛e22Te˛‹2àe2C22e˛˛2Ç˛À2êò22Teò˛e2e2òÀÀ˛À˛ ¶22‹‹2!2 e2 2 2!22‹˛òCe2Cò‹‹T2C22ò˛À2Öe2À˛ø2äe˛˛òe2Tò˛˛eÖò˛˛eTeä‹˛‹eòòeò˛˛e¶À˛˛ò2eTò˛‹e22ò2C2ee˛˛e2e˛Àe22À2eTeÀ˛e2eòÀò ó!eò‹!T2òáe2!!CC!2eÀ˛òeÑv˛‹òeÑò˛‹òeÑ©˛ÀTeâ˛˛©eeòò˛˛òÑeò˛˛òÖeòÀ˛˛òä˛˛òeòòÀ˛˛Àòù˛˛òeeòòeeò©˛‹òee˛Àòòe©òeòòÀ˛TòÇÀòÀ ó!2ò‹! 2eá2 !! C!22ò˛ò2ÉvÀ‹2Ée˛‹2Ñ©˛òT2ÉÀ˛©2íe˛˛e2e2e˛˛ee22eò˛˛eó2eÀ˛e2e2ò˛˛òe22e˛˛e22ee2É©˛‹2áÀÀe22©e2áò˛T2e2òÀ˛ ó!2À‹! 2òá22!! C!22À˛ò2Ñv˛‹e2Ñò˛‹e2í©˛ÀT22e2˛˛©2e2ò˛˛òeãò˛˛òe2eeÀ˛˛eµòe˛˛e2eeÀ˛˛òe2ee˛˛ee2ee2e2©˛‹e22˛Àe22©e2eeÀ˛Tee2eeòeeÀ eî‹À!!2©ÀT2C2!2!C2e©˛ÀeÉò‹˛eÑò˛˛TeÉÀ˛‹eä‹˛ÀeeTò˛˛Àòã˛˛Àòeòò©˛˛ÀòïÀ˛ÀeòòÀ˛˛øòTòò˛˛ÀeeòòeïÀ˛ÀòeeÀ‹òòeòòeòT˛˛eòTòÅ©À ó2 e‹ò!!2©òT2 2!2! 22©˛ò2Ñe‹˛e2Ñe˛ÀT2Éò˛‹2ò‹˛ò22Te˛˛òee2eÀ˛ò2e2e©˛˛eÑò˛ò2eä˛˛ø2Te2˛˛ò2Åe2õò˛òe22ò‹e22ee22TÀ˛22T2eÀòÀ©À˛ ó24e‹ò!!2©ÀT2 2!2! 22©˛À2çe2‹˛e2e22e˛˛T2Üeò˛‹2e2ä‹˛òe2Te˛˛òeã˛˛òee2e©˛˛òeÉÀ˛òeßò˛˛øeTee˛˛ò22ee2eeÀ˛Àe22À‹ee2ee2eTÀ˛eeTeÅ©ò é2e2À©!eCe‹Àe!e!ÖeCò˛‹eÉ‹‹ÀeÑT‹˛òeÑò˛‹òeäÀ˛Àeeòe˛˛‹òÉ˛˛øòÑÀ˛˛øòÉÀ˛ÀòÉ˛˛‹ò¢À˛ÀòeeÀòee˛˛òòTòò‹òòeò©eòò˛˛eòòCòÀòÀ é22 ò©!2 e‹ò2! !Ö Ce˛‹2É‹‹e2ÑT‹˛e2Ée˛‹2Éò˛À2®eÀ˛‹2e2eÀ˛ø22e2e˛˛ø2e2ee˛À22ee˛˛‹e2e2ò˛À2ùò22eÀ˛ò2T2e‹2e22©22eÀ˛22eCòÀòÀ˛ 2ãÀ©!2 ò‹ò2!4!ñ4Cò˛‹2e2ee‹‹ò2e2eT‹˛ee2Ñò˛‹e2ãeÀ˛À22eeÀ˛‹eÉ˛˛øeÑò˛˛øeÑÀ˛À2eß˛˛‹e2eeÀ˛Àe22òe2eÀ˛òeT2ò‹ee2e©22e˛Àe2eCeòÀ òe!ev©2!eCÀÀT2!!C2CCeò˛‹TeÉÀ˛©eÑò‹˛òeÖò˛˛Tòeä©˛‹eeòòÀ˛˛òÑTÀ˛‹òÖeò˛˛ÀòáÀ˛‹òTòò˛òçCÀ˛ÀòòCÀòeò˛˛òÑeò˛TòàÀeòò˛˛òTòÇÀòÀ ò2!2v©2!2CòòT2!! 2 C2e˛‹T2ÉÀ˛©2É‹˛e2É˛ÀT2ô©À‹22e2À˛˛ee2TÀ˛‹ee2eeÀ˛Àe§˛‹2T2eÀ˛Àe22Cò˛òe2Còe2eÀ˛ee22eÀTe22À2á˛˛2T22òÀ˛ ò2!2v©2!2CÀÀT2!! 2 C2ò˛‹T2É˛˛©2õee‹˛ò22e2e˛˛T2e22©˛‹e2eeÀ˛˛eÑTÀ˛‹eÉ˛˛Àeáò˛‹2Tee˛eîCò˛òeeCÀe2e˛˛òe2ee˛TeàÀ2ee˛˛eTeÉòeeò ô2!eCò22C2À©22!!2!2ee˛‹òCeÉø˛ÀeÉ‹˛ÀeÉ˛˛òeäÀ˛‹òTòòÀ˛˛òÉÀ˛˛òÉø˛˛òâ˛˛Àeeòø˛˛òÇ˛ÀòáÀeò˛˛òTòî˛òòTòÀeeò˛˛eòòTÀòÀòÀÀ‹ ô2!2Ce22  À© 2!!2!22e˛‹2C2ÉøÀÀ2É‹˛ò2ÑeÀ˛e2äò˛‹2T22ò˛˛eå2ò˛˛e2e22ø˛ÀeÖ2e˛˛ò2Éø˛˛e¢2e˛ò2e2ee2e˛ÀeT22eÀe2Teò22e˛Àe22TòÀ˛‹ Ø2!2Cò22 2À©2 !!2!22e˛‹eC2e2ø˛À2e22e‹˛ò2e22e˛˛e2åeò˛‹eTeeò˛˛òeÉÀ˛˛eÖ2eø˛˛eê˛˛ò22eø˛˛òee2ò˛òeáò2ò˛˛eTeè˛eeTeÀ2eò˛˛e2eTeÅòò‹ è2e2ee2e!22ÀÀòe2!eÇ˛˛eåÀ˛‹TòeeòÀ˛Àòeöò‹˛©eòeeò˛˛eeTòò˛˛ÀòòTò˛˛ÀòÉÀ˛˛òäÀ˛‹òeeÀ˛˛ÀòÇÀ˛òâ˛‹Tòeòò˛ÀòàeÀ˛˛òeòeÀ‹ Å 2à!22òÀò2 !Ü 22À˛e2Ñò˛‹T2ÉÀ˛À2É‹˛©2°e˛˛e2TeeÀ˛òe2Te˛˛ò2e2eò˛˛ee2e2À˛‹2îe˛˛òe2e2ÀÀe2e2ò2e˛‹T2êe˛ò2e2ò22e˛˛22e2ÀÇ˛À˛‹ 2ãe 2!22À˛e22!é42e˛˛e22e2ÀÀ‹T2¢eÀ˛Àe22ee‹˛©e2e2ò˛˛e2Tee˛˛òeeTò˛˛òeÉÀ˛˛eêÀ˛‹e2eò˛˛òeòeeÀ˛eåòeò˛‹T2e2ò˛òeäò22ò˛˛e2e2ò‹ òCe2CC2e!CeeÀÀT!C2eCee‹˛òeÜòá‹˛òTeöÀ˛‹TòeòeÀ˛ÀTeeòò˛˛òeòòT˛˛Àòã˛˛ÀòòTòÀ˛˛ÀòäÀ˛˛òeòe‹˛ÀòÇÀ˛òèÀÀò˛‹òTòTÀ˛ÀeòòeÖÀ˛˛òTòÑÀòÀòÀ˛ òC 2 C22! 22ÀòT! 2 C22‹˛e2Öá‹˛2T2Ñò˛‹T2ÑÀ˛òT2ÑeÀ˛e2õT˛˛òe2e2˛˛òe2T2e˛˛ò2ee2ò˛˛e2â‹˛òee22ò˛eç2eòeÀ‹2T2Tò˛ò2ãe22e˛˛2T2eòÀ˛ æC42 C22! 2eÀ˛T!  4C2e‹˛ee22eá‹˛eT2e2ò˛‹T2e2eÀ˛òT22ee˛˛ee2eT˛˛Àeã˛˛òeeTeò˛˛òeäÀ˛˛e22e‹˛ÀeÉÀ˛òeçòòe˛‹eTeTÀ˛À2eá2eò˛ÀeTeÑòeeòòÀ Åe2îC2e!e!eò‹©e!22!eeø˛áeÖCò˛˛òeÑÀ˛‹òeíÀ˛øòeòCò˛˛òeeTò˛˛ÀòÉ‹˛ÀòÑÀ˛˛ÀòãÀ˛˛ÀòeòÀ˛‹ÀòÇ˛Àòåøòò©eòTòÀ˛‹eòÜeeÀ˛˛TòÇÀòÀ‹ Å12îC 2!2!2e‹©2!22!22øÀá2ÖCe˛˛e2Ñò˛‹e2Éò˛ø2ùCe˛˛e22TeÀ˛òee2e‹˛Àee2ee˛˛ò22eÉ˛˛e2Éò˛‹eî˛ò2ee2ø2ò©22T2ò˛‹22e2àò˛ÀT2e2òÀ˛‹ Å 2∫C22!2!2À‹©2!22!2eø˛á2e2Cò˛˛e2e2eò˛‹ee2e2À˛ø2eeCe˛˛ò2eTe˛˛ÀeÉ‹˛ÀeÑò˛˛Àeãò˛˛òe2eÀ˛‹òeÉò˛Àeéøeò©e2T2À˛‹2ee2ÖÀ˛˛T2eò‹ òe2e2ee2!!e2eÀøv22CeCeÀ˛©e¢ò˛˛òòeòeò˛˛òeòTò©˛‹òeeCò˛˛©eeòò‹˛˛òÉÀ˛˛òÇTò˛òëÀ˛˛ÀòeòÀ˛˛òÀòòÀ˛˛òåáe2eeòTÀ˛‹òeòçeÀ˛‹òTòTÀòÀòòÀ˛ É22 2É !!2åòøv 2 2C2ò˛©2Öe˛˛ee2ãe˛˛e22T2©˛‹2ÖC2À˛©2†‹˛Àee2eò˛Àe22TeÀ˛Àee2ee˛˛òe22ò˛˛eÜ2eÀ˛e2eÉá2 2ÑTò˛‹2äee2ò˛‹2T2TÀ˛ Ñ224 2Ç!!2éÀøv22 2C2À˛©22e®˛˛ò22e2ò˛˛e2eT2©˛‹e22C2˛˛©e2ee‹˛ÀeòeeÀ˛˛eÖTe˛˛Àeåò˛˛Àe2eò˛˛eòeÇ˛˛eÇòá2áeeTÀ˛‹2eâ2À˛‹2TeTòeòÀ íò!e!eCe!e2e2vÀ©e2!e©ò˛ÀTeTòò‹˛ÀòCòCò˛˛òòCòeÀ˛˛Tòeòòø˛ÀeeòòÀ˛˛òÉÀ˛˛òÉø˛‹ò˛òÉ˛˛ÀòÉ˛˛ÀòìÀe!òòeò©˛ÀòeòòÀeÀ˛˛òÑÀòevò˛ íe!2!eC2!2 22vò©22!2õò˛òT2T2e‹˛ò2C2Ce˛˛e2C22ò˛ÀT2äø˛ò22eeÀ˛˛eÑ2ò˛˛eî2eø˛‹e22eeÀ˛Àe22eÀ˛òeöÀ˛ò2e2eò2!2e22©Àò22eeò2ò˛À2ÜeòÀÀòvò˛ àe!2!eC2!2ÜvÀ©22!2úò˛ÀT2T2e‹˛òeC2Ce˛˛ò2C2eò˛˛T2eÑøÀÀ2eÑÀ˛˛òeÑò˛˛òeÉø˛‹eä˛˛Àee2e˛˛òeÑòÀ˛òeìò2!2e2e©˛òe2eòò2À˛ÀeÜ2eòeeve˛ ÉÀe2eã!e!e2eòÀe2eïò˛ÀòeòeT˛˛øCòCòò˛˛ÀeCòÉ˛˛òeçTÀ˛ÀTòeòÀ˛˛ÀÀòÉ˛˛ÀòÉÀ˛˛òìÀò˛˛‹òòTò‹˛ÀòÀÀòÀ˛‹òâÀÀáÀ˛òe˛˛òáCÀ‹eÀ˛øòÜTveC24ò˛ êò22 e22!2!2 2òÀ2Ée˛À2îTÀ˛øC2C2eÀ˛ò2Ce2e˛˛e2öTò˛òT22eò˛˛òee2e˛˛òe2eeò˛˛eå2eÀ˛‹e2T2‹˛òe£ò˛‹22eeòeáòÀe2ò˛ee2Ce‹2ò˛ø22eTveC2eò˛ äÀ224e22!2!2Éò˛2¨e2ò˛À2e22T˛˛øCeCee˛˛òeCeeò˛˛ee22TÀ˛ÀT2eeÀ˛˛ÀeÑò˛˛òeÉÀ˛˛eë˛˛‹eeTe‹˛ÀeeòeÀ˛‹eúÀòáÀ˛e2À˛òeeCò‹2À˛øe2eTv C  e˛ í˛Te!òv22!ee2!eÀøT2eßv˛˛TTeòòÀ˛‹òTòòT˛˛ÀTòòeò˛˛òTòeòò˛‹òTòòÀ˛òÉ˛˛ÀòÑÀ˛˛ÀòÑÀ˛˛ÀòÉÀ˛˛òÑÀ˛˛ÀòâÀ‹ò©òeT©˛òáÀ˛À˛ÀTòÖe22eeò˛ ëÀT2!ev 2!2 2!2òøT2ÖvÀ˛TT2åÀ˛‹2T22TÀ˛òT2Öe˛˛eT2 ò˛‹2T2eò˛˛Àee2eÀ˛òee22e˛˛òee2eò˛˛e22ee˛˛e2eeò˛˛e2e2e‹e©e2 ©˛ee22e˛ò˛òTe22eò˛ ë˛T2!ev22!242!eÀøT2™v˛˛TTee2À˛‹eT2eT˛˛òT2e2ò˛˛òT2eeò˛‹2Teeò˛˛ÀeÉ˛˛ÀeÑò˛˛ÀeÖòÀ˛˛òeÉò˛˛eÑÀ˛˛òeäò‹ò©òe ©˛òeáò˛À˛ÀTe2eÀ Ü˛òe2òeá22e2òÀòe™ò˛˛òeòeTÀ˛‹òTòTò‹˛øòòCòò‹˛ÀòeòeÀ˛˛eeòòÀ˛˛ÀòÉÀ˛˛òÅÀ˛òÑÀ˛˛Àòä˛˛ÀòòÀÀ˛˛ÀòÉÀ˛ÀeÇ˛©òÜÀ˛ÀÀ˛ÀòeÇ2e©˛ Ü˛ò22e2ÉeÀe2É˛˛e2õTò˛‹eT2T2‹˛ø22Cee‹˛ò22e2e˛˛2éeò˛˛À2e2eÀ˛Àe2eÉ˛˛òeäò˛˛òe2e2À˛eã2e˛˛òe2e2Àò2ç˛©22ee˛òò˛ò22e©˛ â˛ò22e22e2©òÀò2e2ee˛˛e22eTÀ˛‹eTeT2‹˛øeeCee‹˛ò2e22ò˛˛eÖÀ˛˛ÀòeÉ˛˛ÀeÑò˛˛ÀeÑò˛˛òeÉ˛˛òeÑò˛˛òeÑòÀòe2åe˛©2eeò˛òò˛òe2É 22©˛ ¿˛‹e!òÀCe©e2e2eCÀ©eCeòT˛˛òòTòTÀ˛˛òòTòT˛˛ÀòòTòò‹˛ÀTòeòò˛˛òeòòÀ‹˛ÀÀòÉÀ˛˛òå˛˛‹òÀòòÀ˛˛øÀòÉÀ˛ÀòÑÀ‹˛‹òëø‹eòeeòÀÀeTòÀ˛Àø˛òÅTeÀ˛ ±˛‹2!eòC2©22 2 Cò©2C22TÀ˛ò2T2Tò˛Àe2T2TÀ˛Àe2T2e‹˛òT2ãe˛˛e22ee‹˛Àe¢ò˛Àee2eeÀ˛‹ee2ee˛˛ø2e2eÀ˛òe2ee‹˛‹2eÇø‹2èòe2T2ò˛òø˛e2eeTeÀ˛ ±˛‹2!òÀCe©22424CÀ©2C22T˛˛òeT2Tò˛˛eeT2TÀ˛Àe2Tee‹˛ÀTeä˛˛e2eeò‹˛ÀeÉÀ˛˛eÑò˛˛‹eÑò˛˛øeÉÀ˛ÀeÑò‹˛‹eíòø‹2e2e2ÀòeTeò˛Àø˛eÅT2ò˛ öÀ˛ò2vÀòv˛òeCe2evÀeòeTò‹˛ÀTòå˛˛òTòTò©˛˛eTòè‹˛Àòeòeò˛˛òòCÀò˛òÑÀ˛˛©òåÀÀ˛˛òòÀòÀ˛˛ÀòÉÀ˛‹òÅÀ˛åÀòòÀÀ˛òòeò˛˛òÖÀ˛‹ø˛òeÀ˛ åÀÀe2vÀ2vÀe2C2Çvò2ÜT2‹˛òT2çe˛˛eT2T2©˛ÀeT2í‹˛òe2e2eÀ˛e2CeeÀ˛˛e©2e˛˛©2e2eÀ˛˛ee2eeÀ˛Àee2ee˛‹e2eeÀ˛˛ee2ee˛e2èÀÀee22ò˛‹øÀee22eÇòeÀ˛ å˛˛e2vÀ2v˛ò2C2≠vÀ2eeTe‹˛òTe2eò˛˛eTeTe©˛˛eTe2e‹˛Àee2ee˛˛eeCeò˛àeòeeò˛˛©eÖÀ˛˛eòeä˛˛Àeeòeò˛‹eÖòÀ˛˛òeÇò˛eÇÀ˛eÜÀ˛‹ø˛òe2À˛ ∞À˛À2vÀTe˛‹ee2e2e©eCòeTÀ˛‹òTòTò˛˛áòòeòÀ˛˛òòTòòÀ˛˛òÜeò‹˛òTò˛ÇòÀòÉ‹˛Àò˛ÅÀò˛áòÀòÀÀ˛˛òêÀ˛˛ÀòÀòÀ˛Àeòò˛‹ÀòÖÀ˛‹À˛òe˛ çò˛ò2vÀT2À‹22 2ë©2C22Tò˛‹2T2Te˛˛á2öò˛˛e2Te2À˛Àe22ee‹˛eT2eeÀ˛˛eä‹˛òe2e2À˛˛eÑ2À˛Àeä˛˛ee2eò˛˛òeá˛À2eeÀ‹eâ2ò˛‹ò˛ee2eÑòeeò˛ äÀ˛ò2v˛Te˛‹2†©eC2eTÀ˛‹eTeTe˛˛áe2e2ò˛˛eeTeeÀ˛ÀeÜ2e‹˛òTeãÀ˛˛òeòeò‹˛òeÑÀ˛˛òeÅò˛eÑò˛˛òeòÀ˛˛òeòeò˛À2ee˛‹eòeeò˛‹ÀÀe2À˛ íe‹‹ee˛òeÀ‹òeC2e2vòeéòÀ˛‹òòeòò˛˛ÀeCòõ˛˛òeòòTø˛‹òòeòò‹˛ÀòTòòÀ˛˛ÀÀòÉ˛˛ÀòÑÀ˛˛ÀòåÀ‹˛˛ÀòÀòÀ˛˛ÀòôÀ˛˛ÀòÀÀò˛˛Àòò˛‹òòÀòø˛‹˛˛TòeÅò‹˛ í2‹‹2e˛e2À‹ò2C 2 ve2¿ò˛‹e2e2eÀ˛ò2Ce2e˛˛e2e2Tø˛‹e2e2e‹˛ò2Teeò˛˛òee2eÀ˛Àee2ee˛˛òee2e‹˛˛eå2eÀ˛ò2e2ò˛˛òeÇÀ˛eÇÀ‹eä2ø˛‹ò˛T2e2eÉòeò‹˛ çe‹‹2e˛e2À‹ò2C2òve2e2eÀ˛‹ee2ee˛˛òeC2eò˛˛eÑTø˛‹eå‹˛ò2TeòÀ˛˛òòeÉ˛˛ÀeÑÀ˛˛òeã‹˛˛òeòeò˛˛òeôÀ˛˛Àòeòò˛Àòòe˛‹òeòeø˛‹À˛Te2‹˛ åCÀ˛TT˛À2ò˛‹Teä2òòeTòeò˛˛òÖTò‹˛ÀòåCò˛˛ÀòeòòÀ˛˛òÑÀ˛ÀTòÅÀ˛òà‹˛˛ÀòòÀò˛èòÀòòÀ˛˛ÀÀòòÀÀ˛˛òãÀ˛˛‹ÀÀòÀÀ˛‹˛âÀòòÀ‹˛‹À‹òeÇvò˛ åCòÀTTÀò2eÀ‹T2∑ee2T2ee˛˛ee2T2‹˛òe22Ce˛˛ee2e2ò˛˛ee2e2ò˛òT22ee˛˛Àee2e‹˛ÀeÉ˛˛òeÖ2ò˛˛òeäÀ˛Àe2ee˛˛‹eìò˛‹˛ò˛˛ò2ee‹˛‹ò‹2e2eÑòevò˛ åCò˛TT˛ò2ò˛‹T2âòeeTe2ò˛˛eùTe‹˛Àe2eCe˛˛ò22e2À˛˛ee2eeÀ˛ÀTeÑò˛˛ÀeÉ‹˛˛eîòe˛˛Àeòeeò˛˛ÀòeòòÀ˛ÀeÖò˛˛‹eòêÀ˛‹˛À˛˛òeeò‹˛‹À‹e2Çv2˛ ∞ee‹òT‹À2eÀ˛©eC2ee©eeòeò˛˛òòTòò‹˛ÀòòCòò˛˛øTòeòò˛˛òÑT˛˛ÀòÉ˛˛‹òÅC˛òç˛˛‹òòÀòÀ˛˛øÀòÀÇ˛‹òÖ˛˛‹ÀÀ˛Å‹òÖ˛˛À‹˛òÜeveòò˛ í2e‹eT‹ò22òÀ©2C 2e©2±e˛˛e2T2e‹˛Àe2Ce2˛˛øT22ee˛˛ee22Tò˛À2e2eeÀ˛‹ee2Cò˛˛eá2eÀ˛‹e2eÉ˛˛øeëò˛‹e2eeÀ˛‹eeeò˛À˛ë‹ee2eÀ˛À‹Àe22eevò˛ ±2ò‹eT‹À22À˛©2C22e©e2eeò˛˛eeTee‹˛ÀeeCee˛˛øTe2ee˛˛òeÑTÀ˛Àeçòe˛˛‹eòeCÀ˛˛òeí˛˛‹eeòeò˛˛øeeòeÀ˛‹eà˛˛‹òeòò˛Å‹eÖ˛˛À‹˛eÖ v22e˛ åeTÀáe‹˛2eòÀ‹eä2òÀòTòTò‹˛òÜT˛˛‹òTòÉ‹˛Àòè˛˛ÀòTòò©˛ÀòeòòÀ˛òàÀÀ˛ÀòòÀò˛èòÀòòÀ˛˛ÀÀòÀòÀ˛˛ò˛ÖÀÀòÀÀ˛ÅÀòÉÀ˛˛ÀòeÅÀ˛ å2Tòá2‹À22eÀ‹2©eò2T2Te‹Àòe2eTÀ˛‹2T22e‹˛òe2e2e˛˛ò2Te2©˛À2eíÀ˛Àee2ee˛˛òe2eeÀ˛˛eÖ2eÀ˛Àeäò˛˛ee2eÀ˛˛eáòÀ˛À˛˛ò2âe˛˛òòÀ2e2eÑòeeÀ˛ ç2TÀá2‹˛ 2ò˛‹e2ôeòeT2Te‹˛òee2TÀ˛‹eTe2e‹˛Àeãò˛˛òeTee©˛ÀeÖò˛˛Àòeõò˛˛òeeòeÀ˛˛eòeeò˛˛ÀeòeeÀ˛˛òeÉÀ˛˛òÇeò˛ÅÀeÜò˛˛òÀÀe2ÅÀ˛ ±eeò©e‹‹2eC©˛øe2eeÀTòTòò‹˛ÀòTòòÀ˛˛òòTòò‹˛‹òTòeò˛˛ÀòÇ˛˛òåÀ˛˛òÀòòÀ˛˛øÀòÑÀ˛˛ÀòåÀÀ˛˛ÀòòÀÀ˛˛ÀòÉÀ˛˛ÀÜ‹˛‹‹˛ÀòÖ˛˛òÀøòÜeeòÀ˛ ç22e©2‹‹2 C©Àø2ØòT2T2e‹˛ò2T22ò˛˛e2Te2‹˛‹2T2ee˛˛òee2ee˛Àe22eeÀ˛˛e£2e˛˛øee2eò˛˛ee2eeÀ˛˛ee2ee˛˛ò2e2ò˛˛òeô‹˛‹‹˛òe2ee˛˛eòøe2e2eòòÀ˛ ç22ò©2‹‹24C©˛ø2õeÀTeTee‹˛òeTeeò˛˛eeTee‹˛‹eTeÉ˛˛ÀeÉò˛˛eçòÀ˛˛òeòeò˛˛øòeàÀ˛˛òeeòe˛éòeeòò˛˛À2eeò˛˛òÜ‹˛‹‹˛òeÖ˛˛òÀøeÜ2 22ò˛ áCee©!À˛eâ˛‹òe2eÀòTòÉ‹˛øòÑTÀ˛˛òÖø˛˛òeòÉ‹˛Àòû˛˛òòTòÀÀ˛˛ÀÀòòÀ˛˛‹òÀòòÀ˛˛ÀòòÀò˛àÀòÀòÀ˛˛ÀòÉÀ˛˛ÀõáÀ˛˛‹À˛‹ÀòòÀ˛˛ÀÀøòTòTòeee‹˛ áC22©!ò˛2ÉÀ‹e2∞À2T2ee‹˛øe2eTò˛˛e2e22ø˛Àe2e22‹˛À22e2e˛˛eeTeeò˛˛òeÉÀ˛‹eÉ˛˛òeÉò˛˛eîÀ˛À2e2e˛˛òòeáeÀ˛‹ò˛‹eèÀ˛eeø2TeTeòeò‹˛ áC2e©!À˛2äe˛‹ò22eÀeTeÉ‹˛øeÑTò˛˛eãø˛˛e2e2e‹˛Àeìò˛˛òeTeeÀ˛˛òòeòe˛˛‹eÖòÀ˛˛ÀeãÀ˛˛òòeòe˛˛Àeõò˛˛ÀòòáòÀ˛‹À˛‹òeeò˛˛eòøeTeT2É2‹˛ eôò2©‹eCee©˛ÀeeT‹òTòTò‹˛˛òTòÇ˛˛òçTòÀ˛˛òòeòò˛˛‹òÉ˛˛ÀòÉÀ˛˛Àäòò˛˛‹ÀòòÀò˛åòÀòòÀ˛˛ÀÀòÀò˛ò˛ÀÉ˛˛À˛ëòÀ˛˛‹òòÀòeòòeeò˛ 2øò2©‹2C22©ÀÀ22T‹eT2T2‹˛òeT22e˛˛ee2Teò˛˛e2e2eÀ˛‹ee2eeÀ˛ò22eeò˛˛òòe°À˛‹ee2ee˛˛Àee2ee˛˛òee2eÀ˛˛e22eÀ˛Àeêòò˛˛eÀ˛òeeÀ˛‹eeò2Üeeòò˛ 2¶ò2©‹2C2e©˛Àe2T‹eTeTe‹˛ÀeTeeò˛˛ò2eT2À˛˛eÑ2˛˛‹eÉ˛˛òeõòÀ˛˛Àòòeò˛˛‹òeòeò˛˛Àeòeòò˛˛òÖeòÀ˛˛eì˛˛ÀòòeòÀ˛˛òÀ˛ÀeòÀ˛‹òeÜ22 2e˛ áee!òee˛eéø‹Àee‹òòCòòÀ˛ÀòÉ˛˛ÀòÉÀ˛˛òÖCòÀ˛˛òÉ˛˛ÀòîÀò˛˛‹ÀòÀ‹˛˛ÀòÀòò˛˛‹òÇÀò˛ÑòòÀò˛ÅÀòÖø˛‹ÀáÀã˛˛Àò‹‹ÀÀ˛˛ÀòÜTeevò˛ á22!e2eÀ2êø‹ò22‹e2C2eò˛Àe2eî˛˛òe2e2e˛˛e22Ceò˛˛e2eÑÀ˛À2eä˛˛‹eee‹˛˛eÑ2À˛‹eÉ˛˛Àe¶ò˛˛e2e2ø˛‹eáeeò˛˛òe‹‹òe˛˛Àe2e2e2Teòvò˛ á22!e2e˛2èeø‹À2e‹òeCeeÀ˛ÀeÉ˛˛òeÉò˛˛eÖCeÀ˛˛eÑòÀ˛Àeçòò˛˛‹òee‹˛˛òeÉ˛˛‹eåò˛˛ÀeeòeÀ˛˛òeìø˛‹òáòòÀ˛˛Àò‹‹òò˛˛Àeá2T22v e˛ âe2eTeC˛eCeéò˛‹òeÀòòeòòÀ˛‹òÉ˛˛øòÖá˛˛ÀeòÉÀ˛˛òÉ˛˛‹òÅÀ˛åÀòÀòÀ˛˛ÀòòÀò˛êÀòÀòÀ˛˛‹òÀòòÀ˛˛ÀòÉÀ˛˛À˛ÑòÀ˛‹˛àÀòeeòòeòeÇòÀ˛ 2ÜT2CÀ2C2ùe˛‹e2Àee2e2ò˛‹ee22eÀ˛øe2e2á˛˛eè2eò˛˛ee2eeÀ˛‹e2eÉ˛˛ÀeÉò˛˛e™À˛˛ee2eeÀ˛‹ee2eò˛˛òe2eò˛˛eòeeò˛˛Àeò˛‹À˛˛ee2àe2eeòeòÀ˛ 2ÜT2C˛2C2àò˛‹e2˛ò2eãò˛‹ee2ee˛˛øeÑá˛˛òeÑò˛˛òeÉ˛˛‹eÇòe˛òúeÀ˛˛òeòeeÀ˛˛òeeòò˛˛‹eòeeÀ˛˛òeèÀ˛˛òòeòò˛˛ÀeÀ˛‹˛Üòee2ee2Çeò˛ àee!e2eÀ©eïø˛Àe‹ÀòeòeÀ˛˛òòTòò‹˛Àòã˛˛ÀòòeòÀ˛˛ÀòàÀ˛˛òòTÀÀ˛ÀÜòÀ˛˛øÀòàÀ˛˛ÀòÀòÀ˛ÅÀòÅÀ˛òÉÀ‹˛À˛Çòò˛ÅÀòáeeòee‹˛ É22!2Çò©2ïø˛ò2‹ò2e2eò˛˛e2Tee‹˛òeå2e˛˛òe2e2e˛˛eé2eÀ˛Àe2TeeÀ˛˛òeä˛˛øee2eò˛˛eíÀ˛˛ee2ee˛˛òee2e‹˛òeáòÀ˛˛eeÀ˛ÑÀ22e2Üeòeò‹˛ É22!2úÀ©22e2eø˛À2‹òee2eò˛˛eeTee‹˛ÀeÑò˛˛òeêò˛˛òeeòeÀ˛˛eeTòò˛àòòeeò˛˛øeÑòÀ˛˛òÜeeÀ˛˛òeÑò˛˛ÀeÉò‹˛ò˛Çòò˛âÀe2e2e2e2Å‹˛ àee!e!eò‹eÖ˛‹T‹ÀòÇ˛˛òÉ˛˛‹òÉ˛˛ÀòÉ˛˛ÀòÑÀ˛˛ÀòõÀÀ˛˛ÀÀòòÀ‹˛‹òÀòÀÀ˛˛øÀòÀòÀ˛˛ÀãòÀ˛˛‹ÀÀòò˛˛ÀÖÀ‹˛˛À˛ÅÀòÖeòòeòeÇò‹˛ à22!2!2e‹2ûÀ‹T‹òe22ee˛˛ee2e2À˛‹ee2eeÀ˛òe2eî˛˛òe2eeò˛˛ee2eeÀ˛˛òòeÉ‹˛‹eÉ˛˛øeúò˛˛òee2e˛˛‹e2e2À˛òeee‹˛˛òeò˛Çee2àe2eòòeò‹˛ â22!2!2ò‹e2Üe˛‹T‹ÀeÑ2ò˛˛eÉÀ˛‹eÉ˛˛ÀeÑò˛˛Àe§À˛˛òe2òòÀ˛˛Àòòeò‹˛‹eòòeò˛˛øeeòeÀ˛˛òòeÉ˛˛‹eç˛˛Àòòò‹˛˛òeÀ˛ÅòeÉ2ee2Å‹˛ âTe!e2ev˛Àeá©˛eÀ˛òCòÇ˛˛òÑø˛‹ÀòÉ‹˛Àòã˛˛øÀòòÀÀ˛˛ÀòÇÀÀ˛åÀÀòò˛˛‹ÀòÀòÀ˛åòòÀòÀ˛˛øÀòÀò˛òÇ˛˛À˛ÜÀòò˛˛‹òâeòCòeveò˛ âT2!22 vÀò2å©À2ÀÀeCe2e˛˛e•2eø˛‹ee2ee‹˛Àe2e2e˛˛øe2eeò˛˛òe2eeò˛˛ÀeÉÀ˛‹eÉ˛˛ÀeÉ˛˛øeäÀ˛Àee2eÀ˛Àeóòò˛˛òeeÀ˛‹e22e22C2òveò˛ õT2!224v˛ò2e2ee©˛eÀ˛eCeeò˛˛òeÉø˛‹eÉ‹˛Àeúò˛˛øeeòeÀ˛˛òòeòòÀ˛˛Àòòeò˛˛‹òeÅò˛åeòeòò˛˛øòeeò˛áeòeeÀ˛ÀòâÀ˛˛Àee˛˛‹eä2eC22v eeÀ˛ âòe!eTeeÀ˛eÖvvCÀ‹òä˛˛ÀòòTòÀ˛˛òÉ‹˛˛òÉ˛˛ÀòÑÀ˛˛ÀòâÀ©˛˛‹ÀáÀò˛çòòÀòò˛˛‹ÀÀòÀÀ˛ìòÀòÀÀ˛˛ÀòÀòÀ˛‹ÀÀòÀÀ˛ÜÀòÀ˛˛ÀòàeòevveÀ˛ âe2!2T22ÀÀ2îvvCÀ‹e2e2e˛˛òe2Teò˛˛eá2e‹˛Àe2eÉÀ˛ÀeÉ˛˛òeã©À˛‹eáeeò˛˛eÑ2À˛‹eä˛˛Àee2eÀ˛˛eå2ò˛‹eòeeò˛˛Àeè˛˛e2e2e22evvòÀ˛ ìe2!2T22˛Àe2e22vvCÀ‹eã˛˛òeeTeÀ˛˛òeÉ‹˛˛eã˛˛Àeeòeò˛˛Àeùò©˛˛‹òáeeÀ˛˛òeòeò˛˛‹òeòeò˛˛Àòe˛ÅòeÉÀ˛‹òâÀ˛˛ÀòeÀ˛˛eà2eev v2e˛ åÀeeCTeeò˛òeCeÇÀ˛òÉ˛˛ÀòÑÀ˛˛ÀòÉÀ˛˛òà˛˛‹ÀòÀòÀ˛òÖÀÀ‹˛˛ÀëòÀ˛˛ÀÀòòÀ‹˛˛ÀòòÀò˛ÅÀò˛áÀÀòòÀ˛˛Àï˛˛‹Àòò‹˛‹òòÀ˛òeòeeòeÀ˛ åÀ22 T22e˛ò2C2°À˛ee2ee˛˛òe2e2ò˛˛ee2eeò˛˛ee2eeÀÀ‹eã˛˛Àee2ee‹˛˛eÑò˛˛òeÉ‹˛˛eëÀ˛˛ee2eò˛˛òe2ee˛˛eñò˛˛‹ee2‹˛‹2eeÀ22eòeòeÀ˛ îÀ22 T2eò˛ò2C22e22À˛òeÉ˛˛ÀeÑò˛˛òeÉÀ˛˛eàÀ˛‹òeeòò˛eÑò‹˛˛òëeÀ˛˛òòeòe‹˛˛òòeòò˛ÅòeùÀ˛˛òeòeò˛˛òòeòò˛˛‹òee‹˛‹eeòÀe2ÅÀ˛ ã˛T22Teeò˛˛òeçòeeÀ˛ÀòTòò˛˛ÀòÉ˛˛ÀòÉÀ˛˛òÉÀ˛˛òÉ˛˛‹òñÀÀ˛˛ÀÀáòÀ˛˛ÀòòÀòÀ˛˛ÀÀòÀê˛˛ÀòòÀÀ˛˛ÀÀòÀÀ˛˛À˛íÀÀòÀ˛˛Àò˛˛Còòeòeò‹˛ ä˛T22T22e˛À2çe22À˛eeTe2˛˛Àeä˛˛òee2eò˛˛eù2eÀ˛˛e2e2eÀ˛‹ee2eeò˛˛òeáee˛˛òeìò˛˛òee2eÀ˛˛òe2eò˛˛òeäÀ˛òeeòeÀ˛˛eé˛˛ò2À˛C2òeòeò‹˛ õ˛T22T22ò˛Àe22ee22˛˛òeT2ò˛˛ÀeÉ˛˛òeÑò˛˛òeÑòÀ˛˛e£˛˛‹òeeòòÀ˛˛Àòáeò˛˛ÀeòeeÀ˛˛ÀeòeòÀ˛˛òeäÀ˛˛Àeòeò˛˛ò˛çòeeò˛˛òeÀ˛C2e2Å‹˛ É˛ò2eçT˛˛Còø˛Àò‹˛ÀòÉ˛˛ÀòÉ˛˛ÀòÑÀ˛˛ÀòÉÀ˛˛ò˛òÉÀ˛˛ÀÇòÀ˛¢ÀÀòÀÀ˛˛øÀòÀòÀ˛˛ÀÀòòÀ˛˛øÀòÀò˛˛ÀÀòÀÀ˛ÀÅò˛ÜÀ˛˛òeòeÅò˛ Ç˛e2óe2TÀ˛C2ø˛ee‹˛ò2e2eÀ˛Àe2ìe˛˛òe2e2ò˛˛òe2eeò˛˛eåÀ˛˛ee2eeò˛˛ÀeÉ˛˛ÀeÉ˛˛øeãò˛˛òe2ee˛˛øeÉÀ˛òeÑÀ˛˛òeçÀ˛Àò˛˛2eeòeòò˛ Ç˛e2èe2T˛˛Ceø˛òe‹˛òeÉÀ˛ÀeÑò˛˛ÀeÑÀ˛˛òeÑÀ˛˛òe£À˛˛eòeeòÀ˛˛Àòòee˛˛Àòeòeò˛˛øeeòeÀ˛˛Àeåò˛˛øeeòeÀ˛ÀeòáÀ˛˛òòee˛Ñò˛˛e2Åe˛ î˛©e!eTeòò˛ÀòòÀ˛˛À˛˛ÀòÉÀ˛˛òÉ˛˛øòåÀ˛˛ÀòÀòòÀ˛˛ÀòÑÀ˛˛ÀòÇÀÀ˛áÀÀòòÀ˛˛òåÀ˛˛‹ÀòÀòÀ˛˛ÀòàÀ˛˛ÀÀòÀÀ˛ÅòÀÉø˛˛ÀÇòÀ˛à‹eòveòvò˛ õ˛©1!2T22ò˛òe2ò˛˛ÀÀ˛Àe2eeÀ˛ÀeÑÀ˛ø2eÉ˛˛òeå2ò˛˛òe2eeò˛˛eÅò˛eÑ2ò˛˛eÉÀ˛‹eä˛˛Àe2ee˛˛ÀeÉÀ˛ÀeÑø˛˛òe˛à‹2evòevÀ˛ é˛© !2T2eÀ˛Àe2À˛ÅÀeÉÀ˛˛eÉ˛˛øeåò˛˛òeòeeò˛˛òeÖòÀ˛˛òeÇòò˛òÆeÀ˛˛òeeòò˛˛‹òeeòò˛˛Àòeeò˛˛ÀòòeòÀ˛˛eeòòø˛˛Àòòeò˛à‹e2v22ve˛ î˛ø2e!Teeò˛˛CòÀ˛˛‹˛˛òÉÀ˛˛òÉ‹˛ÀòÉ˛˛ÀòÖÀÀ˛˛ÀòÑÀ˛˛ÀòÇÀò˛òåÀ˛˛ÀòÀòÀ‹˛˛ÀòÅÀ˛ÑÀòòÀ˛åÀÀòÀÀ˛˛òÀòÀÀ˛ÑÀòÀò˛òÅeÅÀ˛ ≠˛ø22!T22eÀ˛Ceò˛À‹˛Àee2eò˛˛ee2e2‹˛Àee22e˛˛òe2eç˛˛òee22ò˛˛òe2eíÀ˛˛Àee2ò˛˛òe2ee‹˛˛eå2eÀ˛Àee2eÀ˛ÀeÑò˛˛2eÑ˛˛ÀòeÅÀ˛àe2òeòòÀ˛ î˛ø22!T22e˛˛CeÀ˛˛‹˛ÀeÉÀ˛˛eÉ‹˛ÀeÑò˛˛ÀeÜòò˛˛ÀòeâÀ˛˛òòeeòò˛àÀòeeÀ˛˛òeà‹˛˛òeòeò˛e˛àòeòòÀ˛˛eòá˛˛Àòeòe˛Ñe2e 2Åò˛ ÜòÀe!2Teã‹˛áòeT˛˛‹˛‹òÉÀ˛˛òÉÀ˛˛òÑÀ˛˛‹òçÀò˛˛øÀÀòòÀ˛˛ÀòåÀ‹˛˛‹ÀÀòò˛˛ÀòÜÀÀ˛˛ÀòÀÉ‹˛˛òí‹˛˛áÀòÀÀ˛˛ÀòÀòÀ˛˛‹ÀÅá˛àÀòCòeeò˛ ÜòÀ2!2T2í‹˛á22TÀ˛‹˛‹ee2eò˛˛eç2eÀ˛Àee2eeÀ˛‹eÉ˛˛øeå˛˛òee2ee‹˛˛‹eã˛˛òee2eò˛˛òeã‹˛˛e22e‹˛ÀáeÑò˛˛òeÑò˛˛‹eåáò˛˛ò2Còòeò˛ îÀÀ2!2T2e2‹˛á22T˛À‹˛‹eÉò˛˛eÉÀ˛˛eïòe˛˛‹eeòeò˛˛øeeòeò˛˛Àe¡òò‹˛˛‹òeeò˛˛ÀeòeòÀ˛˛òeeòò‹˛˛òe2ò‹˛˛áeeòÀÀ˛òòeòò˛˛‹òòeáÀ˛˛òeCe22e˛ ÜòÀe2eCeãò˛òTeò‹À©˛˛òÉÀ˛˛òÉÀ˛˛òì˛˛‹òòÀòò˛˛‹òòÀòÀ˛˛øòÇÀÀ˛ÑòÀòò˛êòòÀòÀ˛˛ÀÀòòÀÀ˛˛Àò˛ÉÀÀòÀÇ˛øÀí‹˛˛ÀÀòÀÀ˛˛ÀTòveòò˛ Ü2À22 C2ãò˛2T22‹ò©˛˛eå2e˛˛e2e2eò˛˛eÉÀ˛‹eÉ˛˛‹eì˛˛øee2eeò˛˛Àee2eÀ˛ÀeÑò˛˛òeäò˛˛òe22À˛˛eÉ˛˛øeí‹˛˛eòeeò˛˛òTeveòò˛ îeÀ2 4C22eò˛eTee‹À©˛˛eÑò˛˛òeÉÀ˛˛eÑ˛˛‹òeÖò˛˛‹òeÑò˛˛øeÇòò˛èòòee˛˛ÀeeòeÀ˛˛ÀòÖeÀ˛˛òeíÀ˛˛òòeòò˛˛øeeòò‹˛˛òä˛˛òT2v 22e˛ Öeøò!!eãòÀeòeò˛ÀÀ˛˛òÉ˛˛ÀòàÀ˛˛òòÀòò˛òÖÀ˛˛‹ÀòÑÀ˛˛ÀòÇÀÀ˛ëÀÀòòÀ˛˛òÀòÀÀ˛˛‹ÀòÀâ˛˛øÀòòÀ˛˛ÀÇòÀ˛ÇòòÀÇ˛˛Àä‹˛Àòeòe‹˛ Ö2øe!!2eä22e˛òò˛˛e2eä˛˛òee2eò˛˛eÉÀ˛˛eçÀ˛‹ee2eeÀ˛òe2e˛áòee2À˛ÀeÉ˛˛‹eë˛˛ø22eò˛˛òe2eeÀ˛ÀeÑò˛˛òeãò‹˛ò2eeò‹˛ Öeøe!!2åeeòee2ò˛Àò˛˛eÑò˛˛òeÑÀ˛˛òeîòÀ˛˛eòeòe˛˛‹òeòeò˛˛ÀeÇòò˛èòòeeÀ˛˛eòeòò˛˛‹eÖòò˛˛øe°ò˛˛òòeeò˛˛ÀeeòòÀ˛˛òòeòò‹˛À2e22 ‹˛ îeòÀ22e!eeòøòòeÀ˛òá‹˛òÉ˛˛ÀòÑÀ˛˛ÀòåÀ˛˛ÀòÀòÀ‹˛˛ÀòÉ˛˛ÀòêÀÀ˛˛ÀòÀòÀ˛˛ÀòòÀÀ˛ÖòÀòòÀ˛òíÀ˛˛øÀòÀÀ˛˛‹ÀòòÀÀ˛˛ÀááÀ‹˛ÀÀveÇ‹˛ É2eò2é!22eøe22ò˛eá‹˛eå2e˛˛òe2eeò˛˛eÉò˛˛eÉ‹˛˛eî2˛˛òe2e2eeò˛˛òee2ò˛˛eÉÀ˛Àeä˛˛Àe22e˛˛øeÉ˛˛‹eíò˛˛òeòáe‹˛Àòveeò‹˛ ï2òò2 2!22eøe2eò˛eá‹˛òeÉ˛˛òeïò˛˛òeòeeÀ˛˛òeeòe‹˛˛eòeÉ˛˛òeëòòÀ˛˛òòeeÀ˛˛òeòeò˛Åeò˛üee2À˛˛øòeòe˛˛‹òeeòò˛˛Àeòáò‹˛Àev2Ç‹˛ ïev˛ee2!eeÀ˛˛òòÀ˛eò˛˛ÀòÉ˛˛ÀòÑÀ˛˛ÀòåÀÀ˛˛ÀÀòòÀÀ˛˛òÉ˛˛ÀòÇÀÀ˛êÀòòÀ˛˛ÀòÀòÀÀ˛˛ÀòÀà˛˛ÀòòÀ˛˛ÀÇòÀ˛ÀÉ˛˛‹Àà˛‹òeòeÀ˛ î2vÀe 2!22ò˛ÀeeÀÀee˛˛eãÀ˛Àe2e2e˛˛òeÑò˛˛òeÉÀ˛˛eÜ˛˛òe22eÑò˛˛ÀeÉ˛˛òeÉò˛˛eäÀ˛˛e2ee˛˛ÀeÉÀ˛˛eÉ˛˛‹eâò˛‹eòòeÀ˛ î2v˛242!22À˛˛eeÀÀeò˛˛eÉ˛˛ÀeÑò˛˛òeåÀ˛˛òeòeòÀ˛˛òeÑò˛˛ÀeôòeÀ˛˛Àòòeò˛˛ÀeeòòÀ˛˛òeòeò˛ãòeeò˛˛Àòeòò˛àòòeòò˛˛‹òÉ˛‹2Åò˛ äTT˛ò2e2eòò˛á˛øòò˛˛òÉÀ˛˛òÉ˛˛ÀòàÀ˛˛ÀòÀòò˛ÅÀòä˛˛ÀòeòeòÀò˛ÀÑò˛˛‹òÜÀÀ˛˛ÀÀò˛ÅÀò˛åÀòòÀÀ˛˛ÀÀòÀò˛àòÀáÀÀ˛‹òeÅÀ˛ ÑTT˛e2ìò˛˛ÀÀø2e˛˛ee22eÀ˛Àeí˛˛òee2eò˛˛òee2eò˛˛eâ2e˛˛òe2e2eÉÀ˛˛eÑò˛‹2eÑò˛˛òeäò˛˛ò22eÀ˛ÀeÑò˛˛òeêòÀ˛˛eeáeò˛‹eeòeÀ˛ ÑTT˛e2Çeò˛à˛øee˛˛òeÉÀ˛˛eåò˛˛Àeòeeò˛˛ÀeÖòÀ˛˛òeä˛˛Àee2eeòò˛òóeÀ˛‹òeeòÀ˛˛ÀòeòeÀ˛˛òe2e˛åòeòeÀ˛˛òeòeò˛àeòáeò˛‹e2Åe˛ ãÀe‹áe2eeTòø˛ÜÀTÀ˛˛ÀòÉÀ˛‹òÅÀ˛âÀòòÀÀ˛˛øÀòÑÀ˛˛ÀòÉ˛˛ÀòÀî‹˛˛ÀÀòòÀ˛˛ÀòòÀÀ˛˛‹ÀòÀÉ˛˛øò˛À˛À˛åÀáÀòÀ˛‹òevò‹˛ Ñò2‹á2ÉT2ø˛ïòTeÀ˛ò2ee2ò˛‹ee2ee˛˛ÀeÉ˛˛øeÉò˛˛eÖ2e˛˛ò2àeòee‹˛˛òeãò˛Àee2ee˛˛‹eâ˛˛ø22eÀ˛˛eÑò˛˛òeèÀ˛˛eáeeò˛‹eòvò‹˛ ãe2‹á2 22Teø˛ÜòTe˛˛òeÉÀ˛‹eÉ˛˛ÀeÖò˛˛øòeÑÀ˛˛òeÑò˛˛òeòÑ‹˛˛ÀòìÀ˛Àeeòeò˛˛‹eòòeÀ˛˛øe˛õòòeòò˛˛ÀòòeòÀ˛˛òáeòò˛‹22v2‹˛ å‹eòÀ2eeTòòeÀ˛ÜòTò˛˛ÀòÉÀ˛˛òà˛˛‹áÀòÀò˛òÖÀÀ˛˛©òÇ˛˛ò˛ëòòÀ˛˛‹ÀÀòò˛‹òòÀòò˛ñòòÀòÀ˛˛‹ÀòòÀ˛˛ÀÀòÀÀ˛˛‹Àç˛˛ÀÀòÀÀ˛øòeò‹	˛ Ñ‹eeò2ÅT2Åe˛ñeTeÀ˛òee2eò˛˛ee2eeÀ˛‹áeó˛˛Àee2eò˛˛©ee2eÀ˛e2eÀ˛ÀeÉ˛˛‹eäÀ‹ee2eeÀ˛Àeä˛˛‹e22ò˛˛òeÉ˛˛‹eÖòò˛˛òeáò˛øòeò‹	˛ Ñ‹2òò2ÖT2e2À˛ÜòTe˛˛òeÉÀ˛˛eÖ˛˛‹áeòã˛˛Àeòeeò˛˛©eÇ˛˛eîÀ˛˛eeò˛˛‹òòee˛‹òòeeò˛ñeòeeò˛˛‹òe2ò˛˛òòeòò˛˛‹òéÀÀ˛òòeeÀ˛øe2e‹	˛ ï˛òeáee2eeTòeò˛˛òeò‹˛ÀòÉÀ˛˛ò˛ÅÀòÑÀ˛˛ÀòãÀ˛˛ÀòòeòÀÀò˛ÇøÀòâ˛˛ÀòÀòòÀÀòâÀÀ˛˛ÀòÀòÀ˛òçÀ˛˛ÀÀòÀÀ‹˛˛ÀòÀã˛˛ÀòÀòÀ˛òe©˛ Ñ˛òeá2ìT2ee˛˛e2e‹˛òe2e2ò˛˛eÉÀ˛Àeä˛˛À2ee2ò˛˛eÜ22òeeò˛áøò22ò˛ÀeÖ2eòe2eÉò˛˛eäÀ˛˛ee2e˛˛òeÑ‹˛ÀòeÑò˛˛òeÖò˛òò©˛ ÑÀe2á2çeTe2ò˛˛e2e‹˛òeÑò˛˛òeÑ˛˛ÀòeÉ˛˛ÀeÑÀ˛˛òeÑÀòeÀ˛ÅøeÉò˛˛òÉeòÀeäòòÀ˛˛òeòòe˛üòeeò˛˛Àòeeò‹˛˛òeòeÀ˛˛òeòeòÀe2©À
˛ á˛‹eò2eòãeeò‹‹òeò˛˛ÀòÑÀ˛˛ÀòîÀÀ˛˛ÀòÀÀ‹˛‹òÀòÀÀ˛˛Àò˛åø˛˛ÀÀòòÀÀòòeòàÀ˛˛ÀòÀÀò˛ÅÀòá˛˛ÀÀòÀò˛Àä˛˛øÀòÀòòÀ˛ à˛‹2e22ò2à‹‹22eÀ˛òeÉò˛˛eÑÀ˛˛eÉ‹˛‹eÜò˛˛ò22eÅÀ˛ñøò»òe2eÀòe22ee2ee2eò˛˛eäÀ˛˛ee2eÀ˛ÀeéÀ˛˛eòeeò˛˛øeeòÅÀ˛ è˛‹2e22ee22ee‹‹eÉÀ˛ÀeÑò˛˛òeìÀ˛˛eeòò‹˛‹òeeòò˛˛òeÅò˛ÅøòÖ2eòÀÀeÅòeÖÀ˛˛òeòÑÀ˛˛òeá˛˛Àeòeò˛Çòeòä˛˛øeòeò2ò˛ è˛˛òeøeC˛vTòeò˛ÀòÉø˛˛òàÀ˛˛ÀòòÀò˛êÀòÀòò˛˛‹ÀòÀòò˛˛áòÜeò˛‹ÀÀ˛ãÀòòÀ‹òeò©òeòÜÀ˛˛ÀÀòÀ˛òè˛˛‹ÀÀòÀÀ˛˛ÀÀÀÀ˛ÜòòÀò‹˛ ù˛˛òeø2CÀvT2e2˛À2eeø˛Àee2ee˛˛òeÉÀ˛˛eÉÀ˛‹eã˛˛áe2ee2e˛‹òç»ÀÀ»òe2ò‹e22©2Öee˛˛Àeâ˛˛òe22À˛‹eãò˛˛òeeòÀ˛ÀeÉò‹˛ ï˛˛eeø2C˛vTe2e˛Àe2eø˛Àeö˛˛òeeòeÀ˛˛òeòee˛˛‹eeòeò˛˛áeî2ò˛‹ÀeòòÀÀòò2eÀ‹e2e©eÜò˛˛ÀòeòÉ˛˛ÀeíÀ˛‹òòeeÀ˛˛òòòò˛˛ÀeÉe‹˛ ï˛˛ÀT˛Te˛Àòeòò˛ÀTòòÀ˛˛òã˛˛øÀòÀòÀ˛˛ÀòÑ˛˛‹ÀòäÀ˛˛ÀòeòòCeò˛é‹‹˛˛ÀCÀ˛ÀeeòòeòÉÀ˛˛òäÀ˛˛‹ÀòòÀ˛˛ÀÅò˛àÀÀòÀÀ˛˛Àò˛ â˛˛ÀTÀT2˛ò2ëe˛òT2eò˛˛e2e2e˛˛øeÑò˛˛òeÑ2˛˛‹eõ˛˛ee2e2C2e2eòÀÀ‹‹À»eCe˛ò22e2àee2À˛Àe2eâ˛˛‹ee2ò˛Àeèò˛˛òeeòe˛˛Àeeòò˛ ïÀ˛òTÀT2˛òe2eò˛òTeeÀ˛˛eÑò˛˛øeçòÀ˛˛òeòee˛˛‹òeÑò˛˛òeÅCeëòÀÀ‹‹ÀòeCò˛òe2òe2eåòÀ˛˛eeòeò˛˛‹eäÀ˛˛òòeòÀ˛˛òÉ˛˛ÀeÅÀ˛ ˛íò©ÀC‹˛ÀTò©˛ÀeòòÀ˛˛òëÀò˛˛‹òÀòòÀ˛˛ÀòÀòò˛òÑÀ˛˛ÀòÇeÀ˛ÇÀÀòàCÀòeòeòò˛éÀòòÀÀ˛˛‹ÀòòÀ˛˛ÀèòÀ˛˛øÀÀòò˛˛øòòÀ˛ ˛íe©òC‹ÀòT2©˛ò22eò˛ÀeÉ˛˛‹eãò˛˛òe2eeÀ˛Àeà2e˛˛ò2e2eì2eòÀ˛ÀÀ»»òòe2ee2Cee2åeò˛˛ee2eeÀ˛‹eÇ˛˛eÉ˛˛øeÜÀ˛øeòÀ˛ ï˛˛Àe©eC‹˛òT2©˛ò2eeÀ˛˛eåò˛˛‹eeòeÀ˛˛Àe˛àeòeeò˛˛òeÖòee2eÀòëe2òeeCòe2e2eeÀ˛˛òeäò˛˛‹òeeò˛˛òèeò˛˛øòeeòÀ˛øe2ò˛ ˛íÀeøeò˛˛Àòø˛ÀTòòÀ˛˛òåÀ‹˛‹ÀòòÀÀ˛˛ÀòìÀ‹˛˛òÀòÀò‹˛ÀòòÀòÀòe˛èÀ˛À˛˛ÀÀòeòeÀTòeòÉ‹˛˛òÑÀÀ˛˛Àîò˛˛ÀòòÀÀ˛˛ÀòòÀÀ‹‹òò‹˛ ˛íÀeø2ò˛˛ò2ø˛eTeeò˛˛eÉ‹˛‹eÑò˛˛òeÉ‹À˛eè‹˛òe2eòò22ò˛À»»òÉ»òe2ÇòT2ãe‹˛Àe2eeò˛˛eÉò˛òeÉÀ˛ÀeÜò‹‹òò‹˛ ˛íòeø2ò˛˛òeø˛òT2eò˛˛eå‹˛‹eòeeò˛˛òòeÉ‹˛˛eãò‹˛òeeòòÀe2À	òàe22eeÀT2e¢ò‹˛ÀeeòòÀ˛˛òòee˛˛òòeòe˛˛Àeeòò‹‹ee‹˛ ˛ãe©òCÀ˛˛À‹˛áòÉÀ˛˛òÖÀ‹˛‹ÀòÑÀ˛˛Àò˛òä˛˛øòòvÀÀeò˛ÜÀ˛À˛ÀÀ˛ÇÀÀòâÀòeeòò‹˛˛òãÀÀ˛˛ÀòÀòÀ˛˛ÀÅò˛ÀÑ˛©òò˛ ˛ëe©eCÀ˛˛ò‹˛á2e2ò˛˛eÉ‹˛‹eä˛˛òee2eÀ˛˛eç˛˛øe2vòò2eÀÀ»òà»»òe2eeò2ã‹˛Àe2eeò˛˛òeÇ˛òeäÀ˛˛eeòÀ©eò˛ ˛åÀ2©2CÀ˛˛ò‹˛áeÑò˛˛òeåò‹˛‹eeòeò˛˛òeÑÀ˛˛òeëò˛˛øeevÀÀ22ÀÀòòeòeòçe2eòòe22ee‹˛˛eÉÀ˛˛òàeò˛Àeeòe˛àeòòÀ©2eÀ˛ ˛ÖÀváeò˛ÅÀò¢À˛˛ÀòòÀòÀ˛‹ÀòÀòÀ˛˛ÀòòÀòÀ˛˛òÀòòÀ‹˛ÀòÑ‹©eò˛ÖÀ˛À˛À˛ÀÑ˛øòÀòÉ˛˛ÀòäÀ˛˛ÀÀòÀÀ˛‹òäÀÀ˛˛À‹˛©òÀ˛ ˛Üòvá2eÀ˛èò2eeò˛˛òee2eÀ˛‹eÉ˛˛òeÉÀ˛˛eç‹˛òe22‹©2eòÀ»òô»ò»»òòeòÀøee22e˛Àee22e˛˛òeè˛‹ee2eò˛˛ò‹˛©òÀ˛ ˛Öòvá2e˛àò2eeò˛˛òeÑÀ˛‹òeúò˛˛òòeòeÀ˛˛eòeòe‹˛Àee2‹©2eòÀòÉeòeòÖeeò˛øeÖ2ò˛˛òeóò˛˛Àòeòò˛‹òeòeÀ˛˛ò‹˛©2e˛ ˛Üe©eeò‹˛àÀTòÀÀ˛˛Àò˛åÀÀòòÀ˛˛ÀòÀòò˛êÀòòÀò˛˛øòTCÀòòÀÀ˛ÑÀ˛˛À˛åÀø˛˛ÀÀ‹Àeø˛ÀòÅÀ˛ãÀòÀò˛˛ÀÀòòÀ˛Ñ‹ÀòÀ˛ ˛Üe©22e‹˛ÇòTeÉ˛˛òeãò˛˛òee2e˛˛òeÉò˛˛eèÀ˛ø2TCòe2òò»»ò»òò»ò»ò»òøÀ˛òò‹e2ø˛À22eeÀ˛ÀeÇÀÀe˛Ñ‹òòÀ˛ ˛áÀ2©22e‹˛àòTeeò˛˛òeãÀ˛˛òeòeò˛˛òeÖÀ˛˛eòeá˛˛øeTCÀeòÑeòòeòÉeø˛ÀÜ‹ò2ø˛ÀeãòÀ˛ÀòeeòÀ˛òeÅò˛Ñ‹e2À˛ ˛äÀòeeò‹˛˛ÀòÑÀ˛˛ÀòÑÀ˛˛Àòô˛˛øÀòÀòø‹˛òÀòòÀ˛˛Àòeòòeòò˛ÑÀÀ˛À˛çÀ˛ø˛‹ÀÀ˛Àò˛˛ÀòîÀ˛˛áÀòò˛˛ÀòÀòÀ˛˛‹òò‹˛ ˛ãÀò22e‹˛˛ò2eÉ˛˛òeÉò˛˛eÉÀ˛øeÉø‹˛eÉÀ˛ò2Öe2eeò»òÉ»ò»òíø˛‹eÀ˛eeÀ˛ee2eò˛ÀáeÉÀ˛òeÜ˛˛‹òò‹˛ ˛äòe2ee‹˛˛òeÑò˛˛ÀeÑÀ˛˛òeãò˛˛øòeòeø‹˛eÑò˛˛òeòáeòeeòòeòçeòø˛‹òÀ˛òò˛˛òeäÀ˛˛áòee˛˛Àeáò˛˛‹ee‹˛ ˛âò©eeòò˛˛áòÑ˛˛øÀòÑÀ˛˛ÀòåÀ˛˛øÀòòÀø˛˛ÀòÉÀ‹˛òÖTÀÀáÀ˛áÀ˛˛ÀÀ˛À˛ÇÀÀ˛àòò˛Àò˛ÀòÀÇ˛˛ÀÅò˛âÀòÀ˛˛ÀòÀ‹˛ ˛âe©e22e˛˛áeÉ˛˛øeãò˛˛òe2ee˛˛øeÉø˛˛eè‹Àe22Tòòáeò»»ò»òÉ»ò»òè˛Àee˛òe˛ee2ee˛˛eÉò˛˛eÜÀ˛ÀòÀ‹˛ ˛â2©22eò˛˛áeÉ˛˛øeÑò˛˛òeÉ˛˛øeÖòø˛˛òeåò‹˛ee2TòòáeeòeÇòeòeãÀ˛Àeò˛òò˛òeòÇ˛˛òçeÀ˛˛òeò˛˛Àee‹˛ ˛â‹òòeeò˛˛ÀòåÀ˛˛ÀòÀòòÀ˛˛Àò˛îáòòÀÀ˛˛ÀòÀòÀ˛øòòeò˛˛À˛À˛ÅÀ˛ÀÑ˛ÀòòÀÜòòÀÀ˛˛ÀãòÀ˛˛Àò˛˛ÀòÀ˛ ˛â‹ee22e˛˛òeÉ˛˛ÀeÖò˛˛ò2eÑ˛˛Àáeîò˛˛òe2eeÀøe22eÀ˛òeò»òáÀòò»»ò»òÖ˛ò22ÀòÅ2eÇÀ˛eäò˛˛òeÀ˛ÀòÀ˛ ˛â‹ee22e˛˛òeÉ˛˛ÀeÖòò˛˛òeÖò˛˛ÀáeíÀ˛˛òeeòe˛øee2eÀ˛òeòeÜòeòeòeòüeeò˛òeeÀòòÀeeòò˛˛òeòeÀ˛˛òe˛˛òeò˛ ˛àÀeòòv˛˛Àòö˛˛‹ÀòòÀò˛˛ÀòòÀò˛˛‹òÀòòÀ˛˛Àòä˛ÀTòeò˛˛ÀÀ˛ÅÀ	˛ÅÀ˛ÀÖøÀeòÀòÖÀ˛˛ÀòÀá˛˛ò˛˛òò˛ ˛àÀee2v˛˛òeÉÀ˛‹eÉ˛˛òeÉÀ˛‹eÇ˛˛eÖ2eÀòT2ÇÀ˛òÅ»òãÀòÀò»ò»òò»»òáeòøe22òeÜ2eeÀ˛òeàÀÀeÀ˛òÀÀ˛ ˛àòe22v˛˛òeÉÀ˛‹eÑò˛˛òeÉ˛˛‹eÖòò˛˛òeì˛ÀT22e˛˛òeeòòeeòeòeòeõòøe2eÀòòeeòòÀ˛Àòeòò˛ÀeÀ˛eeÀ˛ ˛áòÀòò˛˛ÀòÉ‹˛˛òàÀ˛˛ÀòòÀò˛òóÀÀ˛˛ÀòÀòò˛Àòòeò˛˛òÀÀ˛˛À˛ÅÀ	˛ÑÀ˛ÀÀòÉevÀòÖÀÀ˛˛ÀòÑ˛‹©À˛ ˛òÑe˛˛òeÉ‹˛˛eÉ˛˛òeÉÀ˛ÀeÑò˛˛òeä˛òe22eÀ˛òeòÖ»»ò»ò»Ñòò»»òeå22vòe22eeò˛ÀeÑò‹©À˛ ˛áeòee˛˛òeÉ‹˛˛eåò˛˛òeeòeÀ˛Àòeïò˛˛òeòee˛Àe2ee˛˛eeòee	òÇeeòÇeòeÖ2e2vòeáòÀÀ˛eeòeÑò‹©ò˛ 	˛Ü‹À˛˛Àò˛åÀòòÀò˛˛ÀÀòÀò˛ñòÀòÀÀ˛˛ÀòÀòÀ˛ÀòòCÀ˛‹ÀÀ˛ÅÀ˛ÉÀ˛À˛ÀòÅeòÖÀ˛ÀòòÀÉ‹ÀÀ˛ 	˛Ü‹òÀ˛òeÉò˛˛eÉÀ˛òeÉÀ˛˛eÉ˛˛òeå˛òeeCe˛‹eòò»òê»»ò»ò»»ò»ò»ò»òÀòeç22ee2e2ee˛Àe2eÉ‹Àò˛ ˛áÀ‹e˛˛òeÉÀ˛˛eä˛˛òòeeòÀ˛˛eÖòò˛˛Àeâò˛ÀeeCe˛‹eÑòeòe	òÖeòeòòeÜ2e2e2òeÑòÀ˛ÀeÜòò‹òeÀ˛ 	˛ÜÀòT˛˛ÀòÉø˛˛ò®˛˛øÀÀÀ‹˛˛ÀòòÀò‹˛øÀòòÀ˛øÀòòÀ˛øÀ˛À˛À˛À˛˛À˛ÅÀ˛ÇÀÀòÑeòeòÇÀ‹òÖÀ‹˛ÀÀ˛ 	˛ÜÀeTÀ˛òeÉø˛˛eä˛˛øeeò‹˛˛eÉ‹˛øeäò˛øee2e˛øeòÅ»òÅ»òÑ»»ò»òÜe2e222ãee‹e22ò‹˛ÀÀ˛ 	˛ÜÀeT˛˛òeÉø˛˛eÆ˛˛øeòe‹˛˛eeòeò‹˛øeòeò˛øòe2ò˛øeeòeòeeòeòeòòeòeòÇeòe2Ée2eäò‹òeeò‹˛òò˛ 
˛ÖÀe‹˛øòÑ©˛˛Àòí˛˛ÀòÀòòÀ˛˛ÀòÀòÀ˛˛ÀòàÀ˛øÀeòá˛À˛ÇÀ˛À˛ÅÀ	˛ÜÀÀòeòeòÀáòeÀÀ˛‹À!˛ 
˛Öòe‹˛øeÑ©˛˛òeÉÀ˛ÀeÉò˛˛eé˛˛òee2ò˛øe22á˛òÅ»òÇ»»òà»»òòÀòee2Ñe22òeÜ2eò˛‹À!˛ 
˛çò2‹˛øe2ee©˛˛òeã˛˛Àeòeòò˛˛òeÑò˛˛Àeâò˛øò2eá˛òeÖòeeòòeòÑeeòeòeá22e2ò2eòàe2eò˛‹òÀ ˛ ˛Ñòò˛‹òÑÀ˛˛ÀòÅÀ˛âÀòòÀÀ˛˛ÀÀò˛òéÀ˛ÀÀeòÀ˛òÀ˛À˛˛ÀÜ˛˛À˛À˛À˛àÀòeeòòTÀòÖÀ˛˛À‹"˛ ˛ìòò˛‹ee2ee˛˛òe2ee˛˛Àeóò˛˛òee2eÀ˛òe22ò˛òò22e˛eòÅ»òÇeÀòÅÀò»òáee22e2TeÜ2e˛˛À‹"˛ ˛Ñee˛‹eÑò˛˛òeÉ˛˛Àeãò˛˛ÀeòeòÀ˛Àeàò˛Àò2eòÀeÇòòeá2eeòòeòeòÇee2åeeTòòe2ò˛˛ò‹"˛ ˛ãÀ‹˛òòeòò˛˛Àòõ˛˛‹áÀòòÀ˛˛ÀòÀòÀ‹˛øÀòòÀ˛À©eeÀ˛ÀÇòÀ˛À˛ÇÀÀòÑeÀeeòÑ˛‹À‹#˛ ˛Éò‹˛eÉ˛˛òeãÀ˛‹áe2ee˛˛òeè‹˛øee2e˛ò©22òòeòÅÀòÑ»»À»ò»òéee22ò22e2e˛‹À‹#˛ ˛ÜÀò‹Àe2eÑ˛˛À2eÑÀ˛‹áeÑò˛˛ÀeÉ‹˛øeåò˛ò©22òò2eeòeòÉeòòeÅ2òe2Öeeò22eÑ˛‹ò‹#˛ ˛Å‹˛Ü‹˛˛‹ÀÀòÉ˛˛øò˛àÀòòÀò‹˛˛òÉ˛˛ÀòÀÜeòÀòÀÀ˛ÖÀÀòÀÀ˛À˛çÀÀòòeÀòeòÀøÀò%˛ ˛Å‹˛é‹˛˛‹Àòee2ee˛˛øeÉò˛˛eè2e‹˛Àee2eÀ˛òe2eòÖe22òeòeÅò»òÑeeòò»Çòòeâ2òe22òøÀò%˛ ó˛À˛ÀÀ‹ÀÀ˛‹ÀÀ‹òòe2e2e˛˛øeÉÀ˛˛eÉ‹˛ÀeÉ˛˛ÀeÀÑe2eòeÉòe2eòeòèee2e22Àe2eeøòeÀ$˛ ëÀòÀò©À©òÀòÀ©òÀòòÀòãÀ‹‹ÀÀòá‹˛ÀòÉ˛˛‹òãø˛ÀÀòò©À‹òeòÖÀÀ˛˛ÀòÇÀÀòàeòeeòòÀÀ˛àÀòòeÀÀeTòÅÀ%˛ Àã©À©ÀòÀÀ©ÀòÀòeä‹‹eeeá‹˛òeìò˛‹e2e2ø˛òee2©e‹e22eòeÇòòeÅ2eò»éòòee22òò2TeòòÀ%˛ áòeòe©e©eÇò©eå2ò‹‹eeeá‹˛òeÉÀ˛‹eÉø˛Àeà©e‹ò22e2eÜòe22e2e2eòéeò22e2ÀòeTee2ò%˛ ÖÀ©ÀòÀòÉÀø˛ÇøÀòäÀ˛˛òòÀòÀ˛‹òÑT˛òeòÖÀ˛À˛ÀòÀÅòeÉòÀÀ˛ÜÀòeCÀ©òÇeò&˛ ãÀ©ÀòòÀòòÀòÀòãÀòÀòÀòòeòøÀÉ˛˛øeÉò˛˛eã˛‹e2e2T˛e22eòeÇòòeë21eeòò»ò»Àò22Cò©eò&˛ Çe©eÑ2eøÀÉ˛˛øeäò˛˛eeòeò˛‹eáT˛e2e22e2Ñe2e2e2Ç 2eäòeòee22Cò©eÉ2eÀ%˛ Ñ©À©ÀòÖeT2TeáveeTeòÇÀ‹˛õ‹˛ÀòÀ˛‹ÀòÀòÀ‹˛Àòòeò˛òeTòòÀ˛ÀÑòòeòÀáòòeeòÀÀ˛áÀÀeeÀÀòÅÀ&˛ å©À©ÀÀòòeTeTeçveeTeòeeòÀ‹˛Ç‹ÀeÇÀ‹eã‹Àee2e2Àe2TeòÖee2eeòeè2eeòò»Àòòe22òòòÅÀ&˛ Ñ©ò©òeè2T2T2eev22T2eÉòò‹˛á‹ÀòeòÀ‹eÉò‹Àeà2e˛e2T22e2eÖòeòee2eÅòeÜ22eòò2Åò&˛ àòÀ©ò©©ò2eÅCeÖvòòòáÀÀ©Àø˛‹˛Ç‹ÀòÇÀÀòÖ˛TeòòÀáòòeòÀ˛À˛ãÀ˛ÀÀòòe2eÀÀ˛âÀeò©áòòeò'˛ åÀÀ©À©©òee2eCeÖveeòáÀò©ÀøÀ‹˛Ç‹òeâòòee22e˛T2ÅeòeÜò»ò»ò»òÜee22eeòÑ22©áò'˛ Üeò©e©©2îC 22v22eeòeòe©òøÀ‹˛Ç‹òeÇòÀeÇ˛T2eÑ22eeòÇeòeÉ2 2eÉòee2Ç©á2Åe'˛ ìÀ©À©À©òvÀÀ˛À˛‹˛‹À˛À˛Ñ‹˛ÀÀ˛ÀòÅTòÜ˛òeòeòÀêòTòÀÀ˛˛À˛À˛À˛ÀÀòeéòÀ˛˛ÀÀòe©òòeòÀ'˛ êÀ©À©À©òvÀ˛À˛˛‹˛‹˛Ñ‹»ÀÀ˛ÇòòeÇ2TeÇ2˛2eáòòeeTee	òàeòee212eòÑee2©òÅÀ'˛ êò©e©e©evòòÀòÀ‹À‹	Àä˛À˛ÀÀ‹òòÀÀ˛òÑ2eeTeÇ˛e2eÖ22T2eòÉeòòe2É 22eà22©e22eò'˛ å©ÀòÀ©Àòò‹‹À‹Àé©À©À©©òÀ©À©‹À‹ÀÇ˛‹˛ÉÀÀeòáeò‹òeeòÀÑòeòòÀÜ˛˛À˛À˛ÀÇòòeçòÀ˛˛ÀòTÀòeòòÀ'˛ Å©Àà©Àòò‹‹À‹Àî©À©À©©ÀÀ©À©‹À‹ÀòòÀÀ‹˛ëÀòe22e22e‹e22eeòòeòÅeòeä221eeòÀò2TòÅÀ'˛ ç©eòò©eeò‹‹À‹Àòî©ò©ò©©òò©ò©‹ò‹òeòòÀ‹˛ãÀòe22ee2e‹e2Çee2áeeòòeeòe2Ç 2eâ22Tòe2e2ò'˛ àÀ©À©Àò©òÀ‹Ñ˛‹˛‹˛ÅÀ˛åÀòòeeò˛òeeòòÀäòeòòÀÀ˛ÀÀ˛Àé˛˛ÀÀòòCòeeòÀ˛ÀòÖeòeòÀ'˛ àÀ©À©ÀÀ©òÀ‹Ñ˛‹˛‹˛ÑÀ˛ÀÀ˛Çòe2ÇÀe2âeòeòe2eòeòÉeòeòåeeCe22eeòòeeòÅÀ'˛ àò©e©òò©eò‹ÑÀ‹À‹ÀÇ˛À˛ÑÀÀ˛À˛À˛àòee22eÀe2Çee2Çe2eÇ2C2eÉ22e2Çeò'˛ ÅòÀ&˛àòeeÀáeeòÀÑòeòòÀÅ˛À˛àÀòòeòeeòÀÑeòòeò'˛ À!˛ÅÀ˛àÀe22òá22eÅòeòÅeòÅ»òeà2e2eeòeeòÅÀ'˛ òÀÅ˛ÀÅ˛ÀÉ˛À˛Àâ˛˛ÀÀ22eòá2Åe2	eÉòeòe2äee22e2e22e'˛ ÑÀ©À©ÀÇ‹‹Àà‹À˛‹˛‹˛‹˛ãÀòòøÀCeòòÀÀeáòÀÀ˛˛À˛À˛ÀëòòeòòeòÀòòeòòeòòÀ&˛ ÑÀ©À©Àç‹‹À˛À‹˛À‹˛‹˛‹˛èÀe2øòC22eòee2eeòeòÅ»òeÅ2eò'˛ Öò©ò©eòç‹‹òÀò‹òÀ‹ò‹ò‹À˛Üòe2øòC2Åe2ÑeeòòeÇòòe
2Åe2Ée2À&˛ äòÀòÀÀ©ÀòÀòÀÑ‹À˛‹ ˛ÇÀ˛eÉÀÀòeÇòÀ˛À˛ÇÀÀòãeòÀòeòeòeòÀ&˛ ÀÅ©ÀâòÀòÀÀ‹˛˛‹˛ÖÀÀ»22eÑ22eeòÑeeòeòÅ»òeÅ2eòÅÀ&˛ òÅ©òÇeeòÜ‹ÀÀ‹˛À˛ÉÀòò2Åe2Çe2eÅ2eÑòeòe2Éeeò&˛ Àã©À©ÀÀ‹˛À˛˛‹	˛Å‹˛Å‹˛é‹˛eeòÀòòeeòÀÀ˛ÀÉ˛˛À˛ÇÀÀòäeòòeòòeòò&˛ ÀÜ©À©ÀÀ‹˛Å‹	˛Å‹˛Å‹˛Ç‹˛2eÑ12eeòeÇòeòÉÀòòeÜ2eeòòòÅÀ&˛ òÜ©ò©òò‹ÀÉ‹À˛ÀÅ‹ÀÅ‹ÀÅ˛ÀÉ˛‹˛2É 22eÉ2e2e2Åe2Å2Åe&˛ ÖÀòÀÀ©ÀÅø
ÀÜ˛˛‹˛˛‹˛ÖÀeeòòeÉòÀ˛À˛À˛ÅÀòeÇòeò&˛ ÀÅ©ÀÅø	Àá˛À˛‹˛˛‹˛Çò2eÑ22eeòeÅòeÉòò»òeÉ2eeò&˛ òÇe©òÅøòçÀòÀò‹ÀÀ‹ÀÀ˛˛À˛Åe2eÇòòeÇòòe
2Öe2eeÀ%˛ ÉÀÀøÀÉ©Àò2ÅòÀÇ˛À˛Ö‹òeòòeÉòÀ˛ÀÅ˛ÀÉòÀÀ˛ÇÀÀòeávòòeòòÀ%˛ ÉÀÀøÀÉ©Àò2àòÀòÀÀ»˛»˛â‹e2ee2e2eòÉee2eë22ee»»Àòòeòee21evòÅÀ%˛ êòòøòòe©òò  2 2eeòÜÀòÀÀ˛À˛ÅÀ˛ÅÀ˛çÀ˛À˛˛ÀÀ˛ÀÀ˛À‹2Ç 2e2e2ÉeòòeÇ2e2É  v2Çeò%˛ ÀÖøÀ©ÀòÀ•‹˛‹À˛‹‹˛‹À˛‹À˛‹˛À˛‹˛À˛À˛˛‹˛˛‹‹˛‹‹˛‹˛‹˛Ç‹ÀeáòÀÀ˛ÀÀòÀ˛ÀÇòò˛êÀ˛òòÀòeeCeòeòòò%˛ ÀÉøÀ©À¨˛‹»‹˛˛‹‹˛‹˛˛‹˛˛‹»˛˛‹»˛»˛À˛‹»˛‹‹»‹‹À‹˛‹˛À˛‹òe2äeeòòee22eeòeÇ2eòáeeòee2CòÉòÀ%˛ òÑøe©eò•‹ò‹òÀ‹‹À‹ÀÀ‹òÀ‹òÀÀ‹òÀòòÀò‹òÀ‹‹ò‹‹À‹À‹ÀÇ‹e2e2Éeòòe2àeeòee22e2ÅC2É2e%˛ ÀÉ©©ÀòÉ©À©Àá˛À˛‹˛˛‹˛ÅòeàòÀ˛˛ÀòòÀ˛àÀeòÀ˛˛ÀÀòäe2eeòeòeòÀ$˛ ÀÖ©©ÀòÀòÑÀ©À©Àá»À˛‹˛˛‹˛Éee2eáòòe22e»˛Ö»ò22eòàeeòee22eòÅÀ$˛ ÇòÀòÜ©©òeeòeÜ©e©eòeòàÀÀ‹ÀÀ‹ÀÀ˛Ö2 2 2e2Çeò˛ÉÀòe2ÅòeÇ2e2É 2e2Çeò$˛ ÀÅ©ÀàòC! !òòÀÅ‹#˛ÖeòeeòÀÇòò	˛âÀÀòòÀ˛À˛Àòàe22òòeòÅÀ"˛ ÀÅ©ÀÜòC ! òÉÀÀ‹"˛àÀe2e2eòòeÅò˛ÀeòeÜ22eòòÇÀÀ"˛ òï©òeòeC   eòeòò‹ÀÀ˛˛À˛ÇÀ˛Àâ˛À˛ÀÀ˛À˛À2eÉ22e˛ÀÑee22eë22e22 2 222eeòòÀ!˛ Àâ©ò©òeòvò©
Àû‹ÀÀ‹À˛À˛À˛˛‹˛À˛˛‹˛‹˛‹˛˛‹˛‹˛‹˛‹eÅòÀÖòÀ‹˛˛Àô˛ÀÀ˛˛À˛òÀòòe2!eeòeòeòeòeò ˛ è˛ÀÀ˛ÀÀ©À©òeòvò©	Àé˛‹ÀÀ‹À˛À»˛À˛‹»˛ú‹˛‹˛‹˛˛‹˛‹˛‹˛‹ee2eeòee2e‹˛òòeòäeòeeòe22!e	òÅÀ ˛ òä©ò©22ev2©e	òç‹òò‹òÀÀòòÀò‹òÀé‹À‹À‹ÀÀ‹À‹À‹À‹2âee22e‹ÀòòeÅ2eÇ2òeÉ22e2Ñ!22e2Çee ˛ É˛‹‹ÀÑòòeveÖòò©À©ÀÜ˛À‹˛˛‹˛ÑeòeeÀÉòeòÀ˛ÀÉ˛˛ÀòåeeCeòeòeòò˛ É»‹‹Àòâveòeòò©À©ÀÜ»À‹À˛‹˛âe2e2eòee2eÉòòeòÇeeòeÉ1CòÅòÅò˛ Éò‹‹òóeev2e2ee©e©eòÀòÀ‹ÀÀ‹À˛À˛ÅÀ2Çee2Çe2e2É C2â2e222eÀ˛ ÀÅ‹ÀÉòC ÅÀÇ˛‹"˛Ü‹eòeeòÀ	˛ÑÀ˛ÀÀ˛ÇÀÀòÇ2eòàeòeòeòeÀ˛ ÀÅ‹ÀÉòC!ÜòÀÀ»‹"˛à‹ee2eeòòeòÉeòeòÑ»»òòeÉ21eòÅÀ˛ òÅ‹òÉeC ÇeòÉ‹òÀ ˛Å‹2Öee2e2eòÇeòeÑòòee2É 2e	2Çeò˛ ÉÀ‹‹Ààò2!  vòÀÑ˛‹˛‹˛ÅøeÀÅ˛ÀÑ˛ÀÀ˛À˛ÜÀòòeeÀ˛âòòeòeòeòò˛ Ñ˛‹‹˛Àèòe !!vòòÀÀ˛‹˛‹˛Ñøee1eáòeòeòòeòÇeòeò»äòòee22ò»À»	ò˛ Éò‹‹òëe2   veeòòÀ‹À‹ÀÀ˛Ñø22 2Éee2eÅò	eòe2àeòÀòe22e2Åe˛ Å‹Àã‹ÀÀ©òveCeeòÀ"˛ÅÀeÅòÀÉòÀòÀÇ˛À˛ÜÀÀòeeò˛âÀòeòòeòø˛ Å‹Àã‹ÀÀ©òveCeeòÀ!˛áÀe2e2eòeÅòeÖòòeòeòÇ»À»Üòòee1e˛Å»òÅòÅø˛ Å‹òã‹òò©2v2C22eòÀÇ˛À˛Åò2Çe2eÇòÀòãee22 eòÀÀòe2Å2Åø˛ Ñ˛À˛‹Àâ2 !!vòÀ%˛ÅÀeÅòÀòÀ˛Å‹˛ÖÀÀòeò˛àòòeòeveÀ˛ Ñ˛À˛‹Àäe!!!vòÀ»$˛âÀe2eeòòeò	eÖòeeòeòè»‹˛À»Àòòe2eò˛˛»òÉvòÀ˛ ÑÀòÀ‹òä2 !!veòòÀ ˛ÅÀ2àe2ee2e2e2eâ2eeòò‹ÀÀòe2òÅe2Év2e˛ ÇÀ˛ÀÖ‹ÀòòCÇ vÀ$˛ÅÀeÉòÀ˛ÀÉòòÀ˛ÅÀ
˛ÑÀÀeeÀã˛˛ÀòeòeòòÀ˛ ÇÀ˛ÀÖ‹ÀÀòCÉ!vòÀ#˛ÖÀ2e2eòÇeòe»òáeòò»˛»˛»áòòee2òeòÅò˛ ÇòÀòÖ‹eòeCÖ veòòÀ ˛Åò2eÖ2e22eòeÖòòÀòÀòÇee2eÉ222ÉeÀÀ˛ Å˛ÀÜ‹ÀÀ©òe!É2vòÀÅ‹!˛Ü‹eeòòÀ˛ÖÀ˛ÀòÀ˛ÇÀÀ˛ÑÀòeÀ˛òÖeòvòÀ˛ ä˛ÀÀ˛‹ÀÀ©òe!É2vòÀÇ‹» ˛Å‹eòeêòÀ˛˛»»òòeò»˛À»À˛»ÑÀòe2òÇ»»òÉvòÀ˛ äòÀòò‹òò©e2!É veòÜ‹òÀÀ˛À˛Å‹2äeòee2ee2eeÀÇòòeÜòÀÀòÀÀòÑee22eÑòòee2Év2À˛ ÑÀ˛À‹Àáee!!eÀ%˛ÖeeòòÀ˛À˛ÇÀÀ˛Éòeò˛âÀeveeòeòÀ˛ ÑÀ˛À‹Àåòe!!eòÀÀ˛À#˛âe2eeòò»òòeåòÀ˛˛»ÀÀòòeòÀ	»Åòe»Ö˛»òòvòÅÀ˛ ÖòÀÀ‹eòäe2!!eeòòÀ!˛ÅÀ2eÅòeÑ22eeòeÑ22eÀ	òÑe2 2òÖÀòe2v2Çeò˛ Ö‹À˛À‹Àâve! !eÀÀ%˛Ü‹eòòÀÀ˛À˛ÅÀ˛ÑÀÀeò˛äÀòeòvòeòò‹˛ Ö‹À˛À‹Àãve!! eÀò»À#˛Ç‹2eÉò»»òÅeò»ÖÀ»òeò»Åò»òá22»À˛À»òÅvòÇÀ‹˛ Å‹òÅ‹òáv2!  2òÑÀòÀÀ ˛Å‹2ÅeòÉee2eòÇeòeòÅeòÇee2ÜòÀ˛Àòe2áv22ee‹À˛ ê‹‹À‹À‹Àòòe!! !vòÀÇ˛À!˛ÖÀeòòÀ˛À˛ÑÀòeò˛âeeòeeòeòò˛ ä‹‹À‹À‹Àòòe!ÇvòÀÇ˛À!˛ÅòeÇòò»òàeòòÀ»˛»ÀòÉ»»À»Üòò2ee»˛ÇòeòÅÀ˛ ê‹‹ò‹ò‹òee2!! !veòÇÀòÀ˛ÇÀe2ÇeeòÜee22eeòÉee2eÉòòeòäe22 eò˛ÀÀe2Åe2Çee˛ ÑÀ˛À‹Àáòv!2!2eÀ$˛ÖÀeòòÀ˛ÇÀÀ˛ÇÀÀ˛êÀÀòe!eÀ˛˛Àe2eeòvòÅÀ˛ ÖÀ˛À‹˛Àáòv!2!2eÀÇ˛» ˛É»»òeÑòò»À»òâeò»˛»»òeeò»òée2!2ò˛˛òe2eòòvò˛ òÅ‹òáev! !22òÉÀòÀ˛Éòòe2ÑeeòeòÖee2eeòÉee2eòeà22!2eÀÀe2Öv22eò˛ Ö˛‹‹À˛Àâee!!eÀÀ%˛ÑÀeòÀ	˛À˛ÇÀÀ˛ÜÀòe !e˛äò!eeòeeòò‹˛ É˛‹‹Àåòe! eòÀ»˛À ˛ç»»ò2eòòÀòÀ»ò»ò»ÇÀe
òêÀòÀee1!!e»»òe!eeòÇÀ‹˛ ÖÀ‹‹òÀòäe2! eeòòÀ˛éÀòòe22eòeòeòeòeÅ2òÉe22eÜ22  !2òÉ2! 2eÅ‹˛ ÀÉòòT É!eòÀÉ‹˛‹˛ÖòeòÀÀ˛ÅÀ˛ÇÀÀ˛Àá˛À˛À˛ÀÀ˛éòòC!Cò˛˛À !eeòÅÀ˛ ÇÀ˛ÀÑòòT2!ÇeòÀÖ˛À‹˛‹˛É»˛»eòÑÀòò»òÉeeò»ÅòeÇòeòÅeòçeeC  eòÀe!!eòÅÀ˛ òÜÀòòeeT É!2eòÜ‹À‹À˛À˛ò2eÉòeòe2ÅeòÅe2eå22C  2eÀ2 !2Çeò˛ è˛‹ÀÀ˛ÀÀ©òT2!22eÀ#˛ÅÀòÅÀ˛À˛ÜÀòÀ˛ÀÀòÀìòòe! eò˛À2Ceeòò‹˛ î»‹À˛À˛À©òT2!22eÀòÀ»À˛ÇòÀeÉòò»òeÖò»»ÀòeÖòeòe2eïòeec2!!2eòò2CòòòÀ‹˛ åò‹òòÀòò©eT2!2òÀ˛ÉÀee2Ñeeòòeâ2e22òòÀe2eè22e22e2e2 2! 2eâ2C222e‹˛ ÑÀÀ˛‹ÀÇòeÜ TÀÀ˛À"˛ÖÀÀeòÀ˛ÇÀ˛À˛ÅòÀá˛ò!!TòòÀìeòe !2!òòe 2òeòeòÀ˛ ÑÀ˛»‹ÀÇòeÜ!TòÀ»À˛ÇÀ»òÜeeòò»ÀòÇeòe†ò»˛òeeòeòe!!Te2eòee22! 2!2e2!eeòÅÀ˛ ÑÀÀò‹òÇe2Ç TòÀ˛ÇÀòeá22eeòeòe2ëeòòe22e2òe!!Te22e2Ö   !2Å 2Çeò˛ ë˛À˛À‹ÀÀ©e!!eÀÀ%˛ÑÀòÀÀ˛ÀÇòò˛ÀÜ˛e2!!eòÉee!Ç2C2eÖòòÀ˛ ì˛À»˛‹ÀÀ©e!!eÀÀ»À ˛âò»òòeeòòÀòeÑò»»òeáòÀe2!!2eÑ2e2!Ç2 2áòòòòÀ˛ ÅÀòã‹òò©2!!2òÀ˛ÖÀeòee2eÖ2ee2e2Ñeòòe2ÜòÀ22!!2É 2! Ç2 2Ü eeòÀ˛ ÑÀ‹À‹ÀÉòòe2ÅeÀÑ˛‹˛‹˛ÑòeòÀ˛ÀÉòÀÀ˛ÇÀòÀÑe22òÑeeòeä2eeòeeòòÀ˛ ÑÀ‹À‹ÀÇòe2ÇeòÀÉ‹˛‹˛»ÑÀò2eòeÅòe»ÅòeÜòe222eÑ2e21Ü2eòeòò˛ Ñò‹ò‹òâee2 2 2eeòÜÀ‹À‹ÀÀ˛òÇÀe2	e2òâ22eeÀe  2Å Å 2Ü22eÀÀ˛ ëÀ˛À˛À‹ÀÀòv !eÀÀ%˛Éò2òÀòàeeÀ˛ÀÀòÀ˛ÅÀòeÇòòeÜòeòe2 Ç!2eÖòeòòÀ˛ è˛˛À˛À‹ÀÀòv!!eÀÇ˛À˛»ÑÀe2eòeç22òÀòeeòò˛»òòe2äee21221e22É!eeòÅÀ˛ ìòÀòÀò‹òòev !2òòÀòÀ˛òÑÀe 2e2ÜòÀò22eòÅe
2à 22 22  Å!2Öe22eò˛ ÑÀ‹À˛Àâòv! TÀÀ%˛ÉC2eÀãòeòC!eøÀòÀ˛âÀÀòee2e2eòeÑ! Ç22eÑòeòÀ˛ ÑÀ‹À»Àäòv !TòÀ» ˛»èÀC22òòee2eC!eøeÅò»Öee2212Å.eÑ121!Å2eòÇÀÀ˛ Çò‹òàev  TeòÀ˛ÅÀ˛ÜÀ˛À˛˛À˛òÜeC 22e2äeC!eøe22eòÅe2Å 2Å 2á 2 ! Å 2Ñe2eò˛ Ñ˛ÀÀ‹Ààòòve2TeeòÉ©ò©ÀÅ‹˛ÜÀ˛˛e eòÜeT2!22òÅÀ˛ÉÀÀe2ÑeòÀÀòÅe
à2eeòeeò‹˛ Ñ˛À˛‹ÀàòòveeTeeòÖ©ò©ÀòÀÇ‹À˛Éò»ò2eÜ1T2!22eà»»À»»òee2eÉ2c2
à2eeòeòò‹˛ ÑòÀò‹òàeev22T22eÑ©e©eòÅ‹
ÀÉ˛ÀÀ	˛ÜÀeòe2 2á T2!22e2ÜòòÀòòe2Ö  22e2Ç 2
Å 2Çe‹˛ ä‹À‹ÀÀ‹ÀÀòe!ÅeÀ"˛ÜÀò2!!eòeÅ2eÉòòÀ˛	Àá˛Àòòee!	Ç!CeÇòò˛ ä‹À‹ÀÀ‹ÀÀòò!ÅeÀÅ»˛Ü»eò2 !eë212122122eeò»À»»òeÖòeòeòeÉ21!	Ñ!Ceeò˛ ä‹ò‹òò‹òòe2!Å2òÇÀòÀ˛Üòe22 !2Ü 2  2 2àeeòÀòòee2Öe2e2e2Ç !	Ç!C2Åe˛ Ñ˛À˛‹ÀÇòvÅTÀ"˛Öòe! !eòÑe2eò˛ÀÜòò2! á!4eeòÀ˛ Ñ˛À»‹ÀÇòvÖTòÀÀ» ˛ã»e2 !!122e2e2àeòò»ÀÀ˛À»Çò»òàee2c2 !á!eeòòÀ˛ òÅ‹òÇevÇTeòÀ˛áòe2  ! 2Åe2òÀòÇeòe2Ö 2  á! 222ò˛ ê‹‹ÀÀ˛ÀÀ©òv2!22eò	ÀÇ‹À˛ÉÀe!É!ee2!Çeò
˛Å‹˛ÅÀòÇ22	á eeveò‹˛ ì‹‹ÀÀ»ÀÀ©òv2!22eòòÀòÀÉ‹ÀÀ˛Éò1!Ç!12!Ö1eòòÀ˛Å‹»Ñò»òòe2	á!2evòò‹˛ Ç‹‹òà©ev ! 22eòÑ‹òÀÀ˛Éò !á! 22 22!Ü 2eòÀÀ˛ÇÀ‹òÖeòe2e2Ç  	á 22v2e‹˛ ÑÀ˛À‹ÀÉeC2ÇeòÀÉ˛˛‹˛Éò22Ç22eÇòÀ˛áÀòòC!! Ü2eeòò˛ ÑÀ˛À‹ÀâòC2e2eòòÀÇ»‹˛Éò22ç221221212eòòÀ˛ÑÀ˛À˛»ÅÀòáee2 ! !Ü2eòòò˛ ÑòòÀ‹òÉ2C2ÇeeòÖÀò‹ÀÀ˛Ée2 é 2 22 2 22eòÀÀ˛Àòe2Ñ !  Ü 22 2e˛ É˛À˛Àááe 2!eÀ!˛Ç2!É2eeòÇÀÀ˛Å‹˛ÜÀÀòeC2	Ü2eeeò˛ ÑÀ˛»˛Àãáe!2 eòÀÀ» ˛Çe!2ÅceòÖ»À˛˛‹˛èÀ˛»»À»òÀòòee1C2	Ü2eeòò˛ ÅÀòÅÀòàá2   2eòÀ˛ÅÀ˛Ç2!Ñ 22 2ÑeeòòÀÖ‹˛ÀÀ˛ÀÑòòeòeÖ22 C 	Ü 222e˛ êÀ‹‹À˛ÀÀòòe!! !TòÀÑ˛‹À‹˛Ñ‹òe2Ü! 2eeòÀ˛ÜÀÀòòC2Å Ü2eòeòò˛ ÖÀ‹‹À»ÀÇòe!ÑTòÀòÀÉ‹˛‹˛Ñ‹ò22Ñ!!22eòÑÀ»»À
˛»Çò»òÖee2 2	Çeeò˛ Éò‹‹òåee2!! !TeeòeòÖÀ‹ò‹À˛ÜÀ˛À˛˛À
˛Ñ‹e2 É!  2eÇòòÀÉ˛À˛ÀòÑeòee2Ç  Å 2Çee˛ É˛À˛Àç©òveTeevòÀòÀ©ÀÇ˛À˛ÜòT! !Åeò˛ÖÀòe2!á!eeeeò˛ É˛À˛Àà©òveTeevòÉÀ©òÀ˛çòT!!  !1e2eò»Ç˛À˛ÇÀ˛»ÇòÀòÑe22!á eòeòò˛ ÅÀòà©ev2T22veÉò©eòÀÇ˛À˛ÖeT! Ç! 2eòäÀÀ˛À˛À˛˛ÀÀòe2Ç !à 2222òÀ˛ Ñ˛‹À‹Àáòe!! CÀ˛Ñ‹T2!Ñ!eeòÀ˛Å‹˛áÀÀòe!! Å Å2eÑòeò‹˛ Ö˛‹À‹˛Àåòe!!!CòÀÀ»»˛Ñ‹T2!Ö!12ceòÖÀ»À˛‹˛ÅÀ»òÜee1! !Ñ2eòeòÅ‹˛ Ñò‹ò‹òàe2!! CeòÀ˛Ñ‹T !Ö! 2 2eÖòÀÀ‹À˛ÀòeÜ22 !  Å Å 2Çe‹˛ Ñ‹À˛˛ÀÉòe ÉCÀ©ÀÑ˛‹˛‹˛ÖÀe2! â !2eòòÀ˛À˛ÀÉòe!	à!eevòÀ˛ Ñ‹À˛»ÀÉòe!ÉCò©ÀÑ»‹˛‹˛ÖÀe2 !Ç!!2ÇeeòÉ»ÀÀ	˛ÜÀ»»ÀòòeÇ2 	á!eòvò˛ Å‹òÅÀòÉee ÉCe©òÉ‹ò‹À˛Öò22  É ! 2eÇòòÀã˛À˛˛À˛À˛Àòòe2Å 	â!2 2v2ÀÀ˛ ÑÀ‹À‹ÀÖ©òee2eÜòòÀòÀ©ÀÇ˛‹˛Ç‹vÇ !áeòòÀÀ˛À˛àÀÀòòe! Å2eÑòòÀ˛ ÑÀ‹À‹ÀÇ©òeòÑÀ©ÀòÀÅ‹˛Ç‹vÇ! Ü2ceeòeòÑ»»˛À	˛Ñ»»òòeÉ21!	à2eòeòòÀ˛ Ñò‹ò‹òÇ©e2eÇ©eòÉÀ‹À˛Ç‹vÇ  ã2 2e2e2eeòòÀ˛ÜÀÀòòee2Ñ ! Å 2Ñ2eÀ˛ Ö˛À˛À˛Àáòe!!!CÀÑ˛‹˛À˛åÀ2  2eeòÀ˛áÀòee! 2à!eeeòÀ˛ ÖÀ˛»À»Àèòe!!!CòÀÀ»‹»˛À˛àÀ2!!2ÇeeòÖ»»À˛À˛Ç»»òáee21!!2à!eòòòÀ˛ ÅÀòàee!!!CeòÜ‹òÀÀ˛À˛âÀ    2eÇòòÀ˛ÜÀÀòòee2Ñ !  à!22 2eò˛ Ö˛‹‹À‹Àáòe!!2À ˛ÇÀ2Ö !eeòÀ˛Å‹
˛ãÀÀee22! 2Ñ ! eÑeò‹˛ Ö»‹‹À‹Àéòe  2ÀòÀÀ»˛»˛ÇÀ2à!!12eeòeòÖ»»˛˛‹˛»Éòòe2Ö !2ã! !eòeòò‹˛ Öò‹‹e‹òâe2  2òeòÑÀòÀÀ˛ÇÀ É ! 2eÖòòÀÀ‹˛ÇÀÀòåe2e22      Å2Ñ2e‹˛ ÑÀÀ˛‹ÀãáeC2C2eòòÀ©ÀÉ˛˛‹˛ÇÀCÉ!2eÀ˛ÜÀòe2!!è !!22eeòò˛ ÑÀ˛»‹ÀàòáòC2CeeòÇ©òÀÉ»À‹˛ÇÀCâ!22_eeòeò»ÅÀ˛ÅÀ»óòòee1 !! !!!!22eò˛ ÑÀòò‹òàeá2C C22eÇ©eòÉÀ‹À˛ÇÀCâ! 2 22e2eòáÀÀ˛À˛ÀÀòeó2  !! ! !! 2222e˛ É˛˛‹ÀÇòe2çeòÀòÀÀ˛À˛˛‹˛‹˛É‹!!â!!2eòÀòÀÀ˛äÀÀe2!2! Ö!!4eÇòÀ˛ É˛»‹Àáòe2e22eòàÀ»ÀÀ˛‹˛‹˛É‹! Ñ !22eò»˛Ç»Àòâe22!2 !Ñ !eÉòòÀ˛ ÉÀò‹òÅe2eòÖÀò‹˛‹˛É‹! É ! 2ÇeeòÀÑòeòe2á !   Ö ! 2ÇeÀ˛ Ñ˛ÀÀ‹ÀÉ©òvÇCòÀ!˛ÇT Ü eòòÀ˛öÀÀòeC!2!!2 2Tvòò˛ Ñ˛À˛‹ÀÉ©òvÇCòÀÉ»˛À˛ÇT2Ñ!2eÜòòeòòÀ»Å˛»úòòee2 !2! 2!2TvòÀÀ˛ ÑÀòò‹òÉ©evÇCeòÀÇ˛À˛ÇT É 2Çe2eòÅÀòÇee2ñ ! !    T v2e˛ ÑÀ˛À˛Àçe22!2TòÀòÀÀ©ÀÉ˛À‹˛Åòä 22òÀòÀÀ˛À˛õÀÀee!2!! 2 ! ! !!2eveòÀ˛ ÀÅ»Àáe22!2TòÇÀ©ÀÇ˛‹˛ÅeÉ!22eò§»»À»˛»˛Àòòe21!2! !2 !!! !2evòòÀ˛ ÇòÀòàe2  ! TeÇò©òáÀò‹À˛˛À˛Åe 2eÉòòeòeÜ22 ! ! ê  !  ! 2v2eò˛ É˛À‹Àä©òeC2eTeòòÀÑ˛‹˛‹˛éC!! !eòòÀòÀÀ˛àÀÀ222!!Å !à !Ceeò©˛ É˛À‹Àà©òòCeeTeòÇÀòÀÑ»‹»‹˛âC !!!12eòÀÇ»À»âòòe22 ! å! ! !!Ceòò©˛ ÉÀò‹òà©eeC22T2eÇòeòÑ‹ò‹À˛àC ! ! 2eÇòeòâee22  ! à  !  !C2Ç©À˛ ÉÀÀ˛ÀÉòe!ÅCÀ#˛Ñò!Ö2òòÀòÀ	˛äÀÀò2! ! å!! !!2eeòÀÀ˛ ÉÀ˛»ÀÑòòe!âCòÀòÀ»À˛»˛Ñò Å2eòåÀ»À»»Àòòe22!Ç!Å !à 2eòòÀÀ˛ ÇÀÀòÑee2!ãCeòeòòÀÀòÀÀ˛Ñò 2eÑòeòòeà2 ! ! å ! !  22eòÀ˛ ÖÀ˛ÀÀ‹ÀÉòe!Ç2òÀÇ˛À˛èø2 !2!eòÀÀòÀÀ˛Àáe2!!!	ä ! 2CeòòÀ˛ ÖÀ»˛À‹ÀÉòe É2òòÀ˛âø2!!2!2eÇòòÀÇ»Àòàee2!  	ä! !2CeòòÀ˛ òÅ‹òÉe2 É2eeòÀ˛àø  ! !2eÅòeà22 !  	 à2C22òòÀ˛ ÑÀ‹À˛ÀÑòòv2eòÉÀÀ©À˛àò! !!2òÀ˛ãÀÀòee2!! 2 Ü ! 2!á 2evòÀÀ˛ Ñ˛‹À»ÀÉòòveòàÀ©òÀòÀÀ»˛àe!!! 2eòÇÀÀòÅe2Ñ! !2Ü! !2!Ü!2evòÀ˛ ÇÀ‹òÉeev2eÇ©eòÅÀ˛àe! !  2e2Ç !  Ç!á  2v2òÀ˛ Ñ˛ÀÀ‹Àááe!!!CÀÇ˛‹"˛Ñ‹22!ÇeeòÀÖòòee2!ä!! !!2eÇòÀ˛ ÀÅ‹Àéáe!!!CòòÀÀ»‹»!˛â‹22! !!1eÉceeòáee22!! è !! !22eòòÀ˛ ÑÀòò‹òâá2!!!CeeòÇ‹òÀ˛â‹2 ! !! 2Å 2Ée2e2Ñ !! ä !  ! 2ÉeòÀ˛ ÇÀ˛Ààòe! 2òÀÇ˛À"˛Öe  !!eòeÜ!2!  !Ç! å!22C4eòòÀÀ˛ ÉÀ»˛Àèòòe !2òòÀòÀ»À"˛Åe!Ñ !!2eÖ21!2 !Ç !å 22CeeòòÀÀ˛ ëòòÀòÀòòee2  2eeòÀÇ˛À˛à2  ! !!
2Ç ! Å!Ç  å  2C 2eeòÀ˛ Ñ‹ÀÀ˛Ààòòe2CeCeòÑÀ©À©À˛äÀ2!!2!22eÇ22!Ö!! í  !! 22eevòÀø‹˛ Ñ‹ÀÀ»ÀàòòeeCeCeòâÀ©ò©ÀÀòÀÀ˛çò2 !2!2212e2!á ! !!í!! !!22eevòÀø‹˛ Å‹òáee2C C2eÑ©e©eòÅÀ˛àò2 ! ! Ü2 22  !á ! ! í   !  2 2veòø‹˛ ÉÀ˛‹ÀÇòe!É2CòÀÇ˛À#˛ä‹C ! 2!!2!ã! ! ! !!â!! !! 2eÇÀ‹˛ ÉÀ»‹ÀÇòe!ã2CòòÀòò»À˛»!˛É‹C!Ñ2!!2é! ! ! !!! !é !!! !22eeÀ‹˛ Éòò‹òÉee2!Ç2CeòÑÀòÀÀ˛ë‹C !  !! 2 ! ! Ü!  !Ü ! ! 2Çò‹˛ Å˛Àâ©òe!! 2òÀ%˛ÇÀe!ã !!! 2 ó !!! ! !!!! ! !2eeòÀ ˛ Àà©òe !!2òÀÇ»À#˛ÖÀ2 ! !â !!2!Ñ!  !è !  ! !!2eeòÀ ˛ ÅÀòä©ee ! 2eeòÀÇ˛À˛ëÀ2 ! ! ! !   ç   ! !  !  Å!2ÉeòÀ˛ ÉÀÀ‹ÀÉòòe2ÖeòòÀòÀÅ‹ ˛äÀ22!! !!!Ç !â ! !!!!å 2!!22evÀ‹ ˛ ÉÀÀ‹ÀÑòÀòe2òÇÀòÀÇ‹»˛ÉÀ22!Ñ ! Ç! â! !!  !å!2 !22evÀ‹ ˛ Éòò‹òeÜ22  22eÇòeòÑ‹ò˛À˛äò2 !!  ! Ç  â   !  !å   ! 22vò‹ ˛ É‹À˛Àä©òeC2C2eòòÀÇ˛À$˛Ée!Å ù! !!!! 2! 2 ! 2!Ceeòò‹!˛ É‹À»Àà©òeCeCeeòÑÀòÀ»À"˛Ée Å!ù ! !! !2 !2! !2!Ceeòò‹!˛ Å‹òå©e2C2C22eeòeòÀ!˛Ée Å é   !!    â !C22ee‹!˛ ÀÇòeÉ!2òÀÇ˛À'˛ç©e2!! !!!â 2 ! !á22eòò©‹#˛ ÀÉòòeÑ 2òòÀÇ»À'˛§©22  ! ! ! !2!!!! !!22eeò©‹#˛ ÉÀòÀòÇe2Ñ 2eeòÀ#˛û©2     ! !    ! ! !! 2Ée©‹#˛ ÀÅ˛Àäòáv  2òòÀÉ˛˛‹$˛¢‹áCe 2!!2 ! ! 2!!2CevòÀ‹$˛ îÀ˛À»ÀÀòÀáv!!2eòòÀòÀÉ»˛‹$˛¢‹áC2!2 !2!!! !2 !2CevòÀ‹$˛ òàeáv  2eÇòeòÉÀ‹À#˛¢‹áC2   !  !     !2C veÀ‹$˛ ÉÀ˛‹ÀÇòòeÇTeòÀ(˛àÀ22  !ã2!22eeÀÀ‹&˛ ÉÀ»‹ÀÇòòeÇTeòáÀòÀòÀÀ»'˛àò22!!ë ! ! !2!22eeòÀ‹&˛ Éòò‹òÇee2ÇT2eòÅÀ&˛àÀ2   ë ! ! ! !  22òÀ‹&˛ Àâòe ! 2òòÀ.˛Ü‹ò!!!è2 ! ! !C2eeòòÀ)˛ ÀâòÀòe! !2òÀÅ»,˛ã‹ò! ! !2!ÇC2eÇòÀ)˛ òeÖ    eòÇÀòÀ)˛ò‹ò! ! !  ! ! !C 22eeÀ)˛ Ñ‹ÀÀøÀÉ©òeÇ!òÀÉ˛˛‹,˛ä‹òòe22!!Ç2eòÇø‹*˛ Ñ‹À˛øÀÉ©òeÅ!òàÀÀòÀÀ˛˛‹,˛É‹òe2è! ! !2eeòòø‹*˛ Ñ‹òòøòÉ©e2Å!eÇòeòÑÀÀ‹À+˛ê‹ee2  ! ! ! 2eÇø‹*˛ É‹À˛ÀÖòòe2TeòÇÀòÀ/˛çòòee!222òòÀ‹-˛ É‹À»ÀÖòòeeTeòáÀòÀòÀÀò.˛éÀòòe1!222eòÀ‹-˛ Å‹òàee22T 22	eòÇÀÀ-˛çee2 !  22òÀ‹-˛ Å˛ÀÉòe2!Ñ2òÀòÀÇ˛À4˛É‹‹ÀòÅÀ1˛ Å»ÀÑòòe2!Å2òÇÀòÀ4˛á‹‹ÀòeòÀ1˛ ÉòòÀòeÅ !Ö22eòeòÇÀòÀ1˛á‹‹òòeòÀ1˛ ÇÀ˛ÀÖ©òe!ÇòòÀn˛ ÇÀ˛ÀÖ©òe!òÀÉ»˛Àk˛ ÇòÀòÖ©e2!eòÀj˛ ÀÅ˛ÀÇòe2ÜevòòÀòÀj˛ ÀÅ»Àò2ÇevòÇÀòÀÅ»i˛ òÑee22 Çv2eòi˛ É‹À‹ÀÉ©òe2ÑCòÀ©ÀÇ˛Àl˛ É‹À‹ÀÉ©òe2èeCòò©òòÀòÀ»À»˛Ài˛ É‹ò‹òÑ©e2 2ÖCee©eòÇÀÀi˛ 
blob
data 362084
#! /bin/sh
# Guess values for system-dependent variables and create Makefiles.
# Generated by GNU Autoconf 2.61 for Togl 2.0.
#
# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
# 2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
# This configure script is free software; the Free Software Foundation
# gives unlimited permission to copy, distribute and modify it.
## --------------------- ##
## M4sh Initialization.  ##
## --------------------- ##

# Be more Bourne compatible
DUALCASE=1; export DUALCASE # for MKS sh
if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
  emulate sh
  NULLCMD=:
  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
  # is contrary to our usage.  Disable this feature.
  alias -g '${1+"$@"}'='"$@"'
  setopt NO_GLOB_SUBST
else
  case `(set -o) 2>/dev/null` in
  *posix*) set -o posix ;;
esac

fi




# PATH needs CR
# Avoid depending upon Character Ranges.
as_cr_letters='abcdefghijklmnopqrstuvwxyz'
as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
as_cr_Letters=$as_cr_letters$as_cr_LETTERS
as_cr_digits='0123456789'
as_cr_alnum=$as_cr_Letters$as_cr_digits

# The user is always right.
if test "${PATH_SEPARATOR+set}" != set; then
  echo "#! /bin/sh" >conf$$.sh
  echo  "exit 0"   >>conf$$.sh
  chmod +x conf$$.sh
  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
    PATH_SEPARATOR=';'
  else
    PATH_SEPARATOR=:
  fi
  rm -f conf$$.sh
fi

# Support unset when possible.
if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
  as_unset=unset
else
  as_unset=false
fi


# IFS
# We need space, tab and new line, in precisely that order.  Quoting is
# there to prevent editors from complaining about space-tab.
# (If _AS_PATH_WALK were called with IFS unset, it would disable word
# splitting by setting IFS to empty value.)
as_nl='
'
IFS=" ""	$as_nl"

# Find who we are.  Look in the path if we contain no directory separator.
case $0 in
  *[\\/]* ) as_myself=$0 ;;
  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
done
IFS=$as_save_IFS

     ;;
esac
# We did not find ourselves, most probably we were run as `sh COMMAND'
# in which case we are not to be found in the path.
if test "x$as_myself" = x; then
  as_myself=$0
fi
if test ! -f "$as_myself"; then
  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
  { (exit 1); exit 1; }
fi

# Work around bugs in pre-3.0 UWIN ksh.
for as_var in ENV MAIL MAILPATH
do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
done
PS1='$ '
PS2='> '
PS4='+ '

# NLS nuisances.
for as_var in \
  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
  LC_TELEPHONE LC_TIME
do
  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
    eval $as_var=C; export $as_var
  else
    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
  fi
done

# Required to use basename.
if expr a : '\(a\)' >/dev/null 2>&1 &&
   test "X`expr 00001 : '.*\(...\)'`" = X001; then
  as_expr=expr
else
  as_expr=false
fi

if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
  as_basename=basename
else
  as_basename=false
fi


# Name of the executable.
as_me=`$as_basename -- "$0" ||
$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
	 X"$0" : 'X\(//\)$' \| \
	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
echo X/"$0" |
    sed '/^.*\/\([^/][^/]*\)\/*$/{
	    s//\1/
	    q
	  }
	  /^X\/\(\/\/\)$/{
	    s//\1/
	    q
	  }
	  /^X\/\(\/\).*/{
	    s//\1/
	    q
	  }
	  s/.*/./; q'`

# CDPATH.
$as_unset CDPATH


if test "x$CONFIG_SHELL" = x; then
  if (eval ":") 2>/dev/null; then
  as_have_required=yes
else
  as_have_required=no
fi

  if test $as_have_required = yes && 	 (eval ":
(as_func_return () {
  (exit \$1)
}
as_func_success () {
  as_func_return 0
}
as_func_failure () {
  as_func_return 1
}
as_func_ret_success () {
  return 0
}
as_func_ret_failure () {
  return 1
}

exitcode=0
if as_func_success; then
  :
else
  exitcode=1
  echo as_func_success failed.
fi

if as_func_failure; then
  exitcode=1
  echo as_func_failure succeeded.
fi

if as_func_ret_success; then
  :
else
  exitcode=1
  echo as_func_ret_success failed.
fi

if as_func_ret_failure; then
  exitcode=1
  echo as_func_ret_failure succeeded.
fi

if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
  :
else
  exitcode=1
  echo positional parameters were not saved.
fi

test \$exitcode = 0) || { (exit 1); exit 1; }

(
  as_lineno_1=\$LINENO
  as_lineno_2=\$LINENO
  test \"x\$as_lineno_1\" != \"x\$as_lineno_2\" &&
  test \"x\`expr \$as_lineno_1 + 1\`\" = \"x\$as_lineno_2\") || { (exit 1); exit 1; }
") 2> /dev/null; then
  :
else
  as_candidate_shells=
    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  case $as_dir in
	 /*)
	   for as_base in sh bash ksh sh5; do
	     as_candidate_shells="$as_candidate_shells $as_dir/$as_base"
	   done;;
       esac
done
IFS=$as_save_IFS


      for as_shell in $as_candidate_shells $SHELL; do
	 # Try only shells that exist, to save several forks.
	 if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
		{ ("$as_shell") 2> /dev/null <<\_ASEOF
if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
  emulate sh
  NULLCMD=:
  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
  # is contrary to our usage.  Disable this feature.
  alias -g '${1+"$@"}'='"$@"'
  setopt NO_GLOB_SUBST
else
  case `(set -o) 2>/dev/null` in
  *posix*) set -o posix ;;
esac

fi


:
_ASEOF
}; then
  CONFIG_SHELL=$as_shell
	       as_have_required=yes
	       if { "$as_shell" 2> /dev/null <<\_ASEOF
if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
  emulate sh
  NULLCMD=:
  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
  # is contrary to our usage.  Disable this feature.
  alias -g '${1+"$@"}'='"$@"'
  setopt NO_GLOB_SUBST
else
  case `(set -o) 2>/dev/null` in
  *posix*) set -o posix ;;
esac

fi


:
(as_func_return () {
  (exit $1)
}
as_func_success () {
  as_func_return 0
}
as_func_failure () {
  as_func_return 1
}
as_func_ret_success () {
  return 0
}
as_func_ret_failure () {
  return 1
}

exitcode=0
if as_func_success; then
  :
else
  exitcode=1
  echo as_func_success failed.
fi

if as_func_failure; then
  exitcode=1
  echo as_func_failure succeeded.
fi

if as_func_ret_success; then
  :
else
  exitcode=1
  echo as_func_ret_success failed.
fi

if as_func_ret_failure; then
  exitcode=1
  echo as_func_ret_failure succeeded.
fi

if ( set x; as_func_ret_success y && test x = "$1" ); then
  :
else
  exitcode=1
  echo positional parameters were not saved.
fi

test $exitcode = 0) || { (exit 1); exit 1; }

(
  as_lineno_1=$LINENO
  as_lineno_2=$LINENO
  test "x$as_lineno_1" != "x$as_lineno_2" &&
  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2") || { (exit 1); exit 1; }

_ASEOF
}; then
  break
fi

fi

      done

      if test "x$CONFIG_SHELL" != x; then
  for as_var in BASH_ENV ENV
        do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
        done
        export CONFIG_SHELL
        exec "$CONFIG_SHELL" "$as_myself" ${1+"$@"}
fi


    if test $as_have_required = no; then
  echo This script requires a shell more modern than all the
      echo shells that I found on your system.  Please install a
      echo modern shell, or manually run the script under such a
      echo shell if you do have one.
      { (exit 1); exit 1; }
fi


fi

fi



(eval "as_func_return () {
  (exit \$1)
}
as_func_success () {
  as_func_return 0
}
as_func_failure () {
  as_func_return 1
}
as_func_ret_success () {
  return 0
}
as_func_ret_failure () {
  return 1
}

exitcode=0
if as_func_success; then
  :
else
  exitcode=1
  echo as_func_success failed.
fi

if as_func_failure; then
  exitcode=1
  echo as_func_failure succeeded.
fi

if as_func_ret_success; then
  :
else
  exitcode=1
  echo as_func_ret_success failed.
fi

if as_func_ret_failure; then
  exitcode=1
  echo as_func_ret_failure succeeded.
fi

if ( set x; as_func_ret_success y && test x = \"\$1\" ); then
  :
else
  exitcode=1
  echo positional parameters were not saved.
fi

test \$exitcode = 0") || {
  echo No shell found that supports shell functions.
  echo Please tell autoconf@gnu.org about your system,
  echo including any error possibly output before this
  echo message
}



  as_lineno_1=$LINENO
  as_lineno_2=$LINENO
  test "x$as_lineno_1" != "x$as_lineno_2" &&
  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {

  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
  # uniformly replaced by the line number.  The first 'sed' inserts a
  # line-number line after each line using $LINENO; the second 'sed'
  # does the real work.  The second script uses 'N' to pair each
  # line-number line with the line containing $LINENO, and appends
  # trailing '-' during substitution so that $LINENO is not a special
  # case at line end.
  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
  # scripts with optimization help from Paolo Bonzini.  Blame Lee
  # E. McMahon (1931-1989) for sed's syntax.  :-)
  sed -n '
    p
    /[$]LINENO/=
  ' <$as_myself |
    sed '
      s/[$]LINENO.*/&-/
      t lineno
      b
      :lineno
      N
      :loop
      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
      t loop
      s/-\n.*//
    ' >$as_me.lineno &&
  chmod +x "$as_me.lineno" ||
    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
   { (exit 1); exit 1; }; }

  # Don't try to exec as it changes $[0], causing all sort of problems
  # (the dirname of $[0] is not the place where we might find the
  # original and so on.  Autoconf is especially sensitive to this).
  . "./$as_me.lineno"
  # Exit status is that of the last command.
  exit
}


if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
  as_dirname=dirname
else
  as_dirname=false
fi

ECHO_C= ECHO_N= ECHO_T=
case `echo -n x` in
-n*)
  case `echo 'x\c'` in
  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
  *)   ECHO_C='\c';;
  esac;;
*)
  ECHO_N='-n';;
esac

if expr a : '\(a\)' >/dev/null 2>&1 &&
   test "X`expr 00001 : '.*\(...\)'`" = X001; then
  as_expr=expr
else
  as_expr=false
fi

rm -f conf$$ conf$$.exe conf$$.file
if test -d conf$$.dir; then
  rm -f conf$$.dir/conf$$.file
else
  rm -f conf$$.dir
  mkdir conf$$.dir
fi
echo >conf$$.file
if ln -s conf$$.file conf$$ 2>/dev/null; then
  as_ln_s='ln -s'
  # ... but there are two gotchas:
  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
  # In both cases, we have to default to `cp -p'.
  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
    as_ln_s='cp -p'
elif ln conf$$.file conf$$ 2>/dev/null; then
  as_ln_s=ln
else
  as_ln_s='cp -p'
fi
rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
rmdir conf$$.dir 2>/dev/null

if mkdir -p . 2>/dev/null; then
  as_mkdir_p=:
else
  test -d ./-p && rmdir ./-p
  as_mkdir_p=false
fi

if test -x / >/dev/null 2>&1; then
  as_test_x='test -x'
else
  if ls -dL / >/dev/null 2>&1; then
    as_ls_L_option=L
  else
    as_ls_L_option=
  fi
  as_test_x='
    eval sh -c '\''
      if test -d "$1"; then
        test -d "$1/.";
      else
	case $1 in
        -*)set "./$1";;
	esac;
	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
	???[sx]*):;;*)false;;esac;fi
    '\'' sh
  '
fi
as_executable_p=$as_test_x

# Sed expression to map a string onto a valid CPP name.
as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"

# Sed expression to map a string onto a valid variable name.
as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"



exec 7<&0 </dev/null 6>&1

# Name of the host.
# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
# so uname gets run too.
ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`

#
# Initializations.
#
ac_default_prefix=/usr/local
ac_clean_files=
ac_config_libobj_dir=.
LIBOBJS=
cross_compiling=no
subdirs=
MFLAGS=
MAKEFLAGS=
SHELL=${CONFIG_SHELL-/bin/sh}

# Identity of this package.
PACKAGE_NAME='Togl'
PACKAGE_TARNAME='togl'
PACKAGE_VERSION='2.0'
PACKAGE_STRING='Togl 2.0'
PACKAGE_BUGREPORT=''

# Factoring default headers for most tests.
ac_includes_default="\
#include <stdio.h>
#ifdef HAVE_SYS_TYPES_H
# include <sys/types.h>
#endif
#ifdef HAVE_SYS_STAT_H
# include <sys/stat.h>
#endif
#ifdef STDC_HEADERS
# include <stdlib.h>
# include <stddef.h>
#else
# ifdef HAVE_STDLIB_H
#  include <stdlib.h>
# endif
#endif
#ifdef HAVE_STRING_H
# if !defined STDC_HEADERS && defined HAVE_MEMORY_H
#  include <memory.h>
# endif
# include <string.h>
#endif
#ifdef HAVE_STRINGS_H
# include <strings.h>
#endif
#ifdef HAVE_INTTYPES_H
# include <inttypes.h>
#endif
#ifdef HAVE_STDINT_H
# include <stdint.h>
#endif
#ifdef HAVE_UNISTD_H
# include <unistd.h>
#endif"

ac_subst_vars='SHELL
PATH_SEPARATOR
PACKAGE_NAME
PACKAGE_TARNAME
PACKAGE_VERSION
PACKAGE_STRING
PACKAGE_BUGREPORT
exec_prefix
prefix
program_transform_name
bindir
sbindir
libexecdir
datarootdir
datadir
sysconfdir
sharedstatedir
localstatedir
includedir
oldincludedir
docdir
infodir
htmldir
dvidir
pdfdir
psdir
libdir
localedir
mandir
DEFS
ECHO_C
ECHO_N
ECHO_T
LIBS
build_alias
host_alias
target_alias
CYGPATH
EXEEXT
PKG_LIB_FILE
PKG_STUB_LIB_FILE
PKG_STUB_SOURCES
PKG_STUB_OBJECTS
PKG_TCL_SOURCES
PKG_HEADERS
PKG_INCLUDES
PKG_LIBS
PKG_CFLAGS
TCL_VERSION
TCL_BIN_DIR
TCL_SRC_DIR
TCL_LIB_FILE
TCL_LIB_FLAG
TCL_LIB_SPEC
TCL_STUB_LIB_FILE
TCL_STUB_LIB_FLAG
TCL_STUB_LIB_SPEC
TCL_LIBS
TCL_DEFS
TCL_EXTRA_CFLAGS
TCL_LD_FLAGS
TCL_SHLIB_LD_LIBS
TK_VERSION
TK_BIN_DIR
TK_SRC_DIR
TK_LIB_FILE
TK_LIB_FLAG
TK_LIB_SPEC
TK_STUB_LIB_FILE
TK_STUB_LIB_FLAG
TK_STUB_LIB_SPEC
TK_LIBS
TK_XINCLUDES
CC
CFLAGS
LDFLAGS
CPPFLAGS
ac_ct_CC
OBJEXT
CPP
INSTALL_PROGRAM
INSTALL_SCRIPT
INSTALL_DATA
SET_MAKE
RANLIB
GREP
EGREP
MATH_LIBS
PKG_SOURCES
PKG_OBJECTS
CLEANFILES
AUTOSTEREOD
TOGL_WINDOWINGSYSTEM
LIBGLU
TEA_WINDOWINGSYSTEM
TCL_TOP_DIR_NATIVE
TCL_GENERIC_DIR_NATIVE
TCL_UNIX_DIR_NATIVE
TCL_WIN_DIR_NATIVE
TCL_BMAP_DIR_NATIVE
TCL_TOOL_DIR_NATIVE
TCL_PLATFORM_DIR_NATIVE
TCL_INCLUDES
TK_TOP_DIR_NATIVE
TK_UNIX_DIR_NATIVE
TK_WIN_DIR_NATIVE
TK_GENERIC_DIR_NATIVE
TK_XLIB_DIR_NATIVE
TK_PLATFORM_DIR_NATIVE
TK_INCLUDES
XMKMF
TCL_THREADS
SHARED_BUILD
AR
CELIB_DIR
LIBOBJS
DL_LIBS
CFLAGS_DEBUG
CFLAGS_OPTIMIZE
CFLAGS_WARNING
STLIB_LD
SHLIB_LD
SHLIB_LD_LIBS
SHLIB_CFLAGS
LD_LIBRARY_PATH_VAR
SHLIB_SUFFIX
CFLAGS_DEFAULT
LDFLAGS_DEFAULT
TCL_DBGX
MAKE_LIB
MAKE_SHARED_LIB
MAKE_STATIC_LIB
MAKE_STUB_LIB
RANLIB_STUB
TCLSH_PROG
WISH_PROG
LTLIBOBJS'
ac_subst_files=''
      ac_precious_vars='build_alias
host_alias
target_alias
CC
CFLAGS
LDFLAGS
LIBS
CPPFLAGS
CPP
AUTOSTEREOD
XMKMF'


# Initialize some variables set by options.
ac_init_help=
ac_init_version=false
# The variables have the same names as the options, with
# dashes changed to underlines.
cache_file=/dev/null
exec_prefix=NONE
no_create=
no_recursion=
prefix=NONE
program_prefix=NONE
program_suffix=NONE
program_transform_name=s,x,x,
silent=
site=
srcdir=
verbose=
x_includes=NONE
x_libraries=NONE

# Installation directory options.
# These are left unexpanded so users can "make install exec_prefix=/foo"
# and all the variables that are supposed to be based on exec_prefix
# by default will actually change.
# Use braces instead of parens because sh, perl, etc. also accept them.
# (The list follows the same order as the GNU Coding Standards.)
bindir='${exec_prefix}/bin'
sbindir='${exec_prefix}/sbin'
libexecdir='${exec_prefix}/libexec'
datarootdir='${prefix}/share'
datadir='${datarootdir}'
sysconfdir='${prefix}/etc'
sharedstatedir='${prefix}/com'
localstatedir='${prefix}/var'
includedir='${prefix}/include'
oldincludedir='/usr/include'
docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
infodir='${datarootdir}/info'
htmldir='${docdir}'
dvidir='${docdir}'
pdfdir='${docdir}'
psdir='${docdir}'
libdir='${exec_prefix}/lib'
localedir='${datarootdir}/locale'
mandir='${datarootdir}/man'

ac_prev=
ac_dashdash=
for ac_option
do
  # If the previous option needs an argument, assign it.
  if test -n "$ac_prev"; then
    eval $ac_prev=\$ac_option
    ac_prev=
    continue
  fi

  case $ac_option in
  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
  *)	ac_optarg=yes ;;
  esac

  # Accept the important Cygnus configure options, so we can diagnose typos.

  case $ac_dashdash$ac_option in
  --)
    ac_dashdash=yes ;;

  -bindir | --bindir | --bindi | --bind | --bin | --bi)
    ac_prev=bindir ;;
  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
    bindir=$ac_optarg ;;

  -build | --build | --buil | --bui | --bu)
    ac_prev=build_alias ;;
  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
    build_alias=$ac_optarg ;;

  -cache-file | --cache-file | --cache-fil | --cache-fi \
  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
    ac_prev=cache_file ;;
  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
    cache_file=$ac_optarg ;;

  --config-cache | -C)
    cache_file=config.cache ;;

  -datadir | --datadir | --datadi | --datad)
    ac_prev=datadir ;;
  -datadir=* | --datadir=* | --datadi=* | --datad=*)
    datadir=$ac_optarg ;;

  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
  | --dataroo | --dataro | --datar)
    ac_prev=datarootdir ;;
  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
    datarootdir=$ac_optarg ;;

  -disable-* | --disable-*)
    ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
    # Reject names that are not valid shell variable names.
    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
   { (exit 1); exit 1; }; }
    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
    eval enable_$ac_feature=no ;;

  -docdir | --docdir | --docdi | --doc | --do)
    ac_prev=docdir ;;
  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
    docdir=$ac_optarg ;;

  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
    ac_prev=dvidir ;;
  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
    dvidir=$ac_optarg ;;

  -enable-* | --enable-*)
    ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
    # Reject names that are not valid shell variable names.
    expr "x$ac_feature" : ".*[^-._$as_cr_alnum]" >/dev/null &&
      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
   { (exit 1); exit 1; }; }
    ac_feature=`echo $ac_feature | sed 's/[-.]/_/g'`
    eval enable_$ac_feature=\$ac_optarg ;;

  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
  | --exec | --exe | --ex)
    ac_prev=exec_prefix ;;
  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
  | --exec=* | --exe=* | --ex=*)
    exec_prefix=$ac_optarg ;;

  -gas | --gas | --ga | --g)
    # Obsolete; use --with-gas.
    with_gas=yes ;;

  -help | --help | --hel | --he | -h)
    ac_init_help=long ;;
  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
    ac_init_help=recursive ;;
  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
    ac_init_help=short ;;

  -host | --host | --hos | --ho)
    ac_prev=host_alias ;;
  -host=* | --host=* | --hos=* | --ho=*)
    host_alias=$ac_optarg ;;

  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
    ac_prev=htmldir ;;
  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
  | --ht=*)
    htmldir=$ac_optarg ;;

  -includedir | --includedir | --includedi | --included | --include \
  | --includ | --inclu | --incl | --inc)
    ac_prev=includedir ;;
  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
  | --includ=* | --inclu=* | --incl=* | --inc=*)
    includedir=$ac_optarg ;;

  -infodir | --infodir | --infodi | --infod | --info | --inf)
    ac_prev=infodir ;;
  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
    infodir=$ac_optarg ;;

  -libdir | --libdir | --libdi | --libd)
    ac_prev=libdir ;;
  -libdir=* | --libdir=* | --libdi=* | --libd=*)
    libdir=$ac_optarg ;;

  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
  | --libexe | --libex | --libe)
    ac_prev=libexecdir ;;
  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
  | --libexe=* | --libex=* | --libe=*)
    libexecdir=$ac_optarg ;;

  -localedir | --localedir | --localedi | --localed | --locale)
    ac_prev=localedir ;;
  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
    localedir=$ac_optarg ;;

  -localstatedir | --localstatedir | --localstatedi | --localstated \
  | --localstate | --localstat | --localsta | --localst | --locals)
    ac_prev=localstatedir ;;
  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
    localstatedir=$ac_optarg ;;

  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
    ac_prev=mandir ;;
  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
    mandir=$ac_optarg ;;

  -nfp | --nfp | --nf)
    # Obsolete; use --without-fp.
    with_fp=no ;;

  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
  | --no-cr | --no-c | -n)
    no_create=yes ;;

  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
    no_recursion=yes ;;

  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
  | --oldin | --oldi | --old | --ol | --o)
    ac_prev=oldincludedir ;;
  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
    oldincludedir=$ac_optarg ;;

  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
    ac_prev=prefix ;;
  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
    prefix=$ac_optarg ;;

  -program-prefix | --program-prefix | --program-prefi | --program-pref \
  | --program-pre | --program-pr | --program-p)
    ac_prev=program_prefix ;;
  -program-prefix=* | --program-prefix=* | --program-prefi=* \
  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
    program_prefix=$ac_optarg ;;

  -program-suffix | --program-suffix | --program-suffi | --program-suff \
  | --program-suf | --program-su | --program-s)
    ac_prev=program_suffix ;;
  -program-suffix=* | --program-suffix=* | --program-suffi=* \
  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
    program_suffix=$ac_optarg ;;

  -program-transform-name | --program-transform-name \
  | --program-transform-nam | --program-transform-na \
  | --program-transform-n | --program-transform- \
  | --program-transform | --program-transfor \
  | --program-transfo | --program-transf \
  | --program-trans | --program-tran \
  | --progr-tra | --program-tr | --program-t)
    ac_prev=program_transform_name ;;
  -program-transform-name=* | --program-transform-name=* \
  | --program-transform-nam=* | --program-transform-na=* \
  | --program-transform-n=* | --program-transform-=* \
  | --program-transform=* | --program-transfor=* \
  | --program-transfo=* | --program-transf=* \
  | --program-trans=* | --program-tran=* \
  | --progr-tra=* | --program-tr=* | --program-t=*)
    program_transform_name=$ac_optarg ;;

  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
    ac_prev=pdfdir ;;
  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
    pdfdir=$ac_optarg ;;

  -psdir | --psdir | --psdi | --psd | --ps)
    ac_prev=psdir ;;
  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
    psdir=$ac_optarg ;;

  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
  | -silent | --silent | --silen | --sile | --sil)
    silent=yes ;;

  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
    ac_prev=sbindir ;;
  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
  | --sbi=* | --sb=*)
    sbindir=$ac_optarg ;;

  -sharedstatedir | --sharedstatedir | --sharedstatedi \
  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
  | --sharedst | --shareds | --shared | --share | --shar \
  | --sha | --sh)
    ac_prev=sharedstatedir ;;
  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
  | --sha=* | --sh=*)
    sharedstatedir=$ac_optarg ;;

  -site | --site | --sit)
    ac_prev=site ;;
  -site=* | --site=* | --sit=*)
    site=$ac_optarg ;;

  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
    ac_prev=srcdir ;;
  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
    srcdir=$ac_optarg ;;

  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
  | --syscon | --sysco | --sysc | --sys | --sy)
    ac_prev=sysconfdir ;;
  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
    sysconfdir=$ac_optarg ;;

  -target | --target | --targe | --targ | --tar | --ta | --t)
    ac_prev=target_alias ;;
  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
    target_alias=$ac_optarg ;;

  -v | -verbose | --verbose | --verbos | --verbo | --verb)
    verbose=yes ;;

  -version | --version | --versio | --versi | --vers | -V)
    ac_init_version=: ;;

  -with-* | --with-*)
    ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
    # Reject names that are not valid shell variable names.
    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
      { echo "$as_me: error: invalid package name: $ac_package" >&2
   { (exit 1); exit 1; }; }
    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
    eval with_$ac_package=\$ac_optarg ;;

  -without-* | --without-*)
    ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
    # Reject names that are not valid shell variable names.
    expr "x$ac_package" : ".*[^-._$as_cr_alnum]" >/dev/null &&
      { echo "$as_me: error: invalid package name: $ac_package" >&2
   { (exit 1); exit 1; }; }
    ac_package=`echo $ac_package | sed 's/[-.]/_/g'`
    eval with_$ac_package=no ;;

  --x)
    # Obsolete; use --with-x.
    with_x=yes ;;

  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
  | --x-incl | --x-inc | --x-in | --x-i)
    ac_prev=x_includes ;;
  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
    x_includes=$ac_optarg ;;

  -x-libraries | --x-libraries | --x-librarie | --x-librari \
  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
    ac_prev=x_libraries ;;
  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
    x_libraries=$ac_optarg ;;

  -*) { echo "$as_me: error: unrecognized option: $ac_option
Try \`$0 --help' for more information." >&2
   { (exit 1); exit 1; }; }
    ;;

  *=*)
    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
    # Reject names that are not valid shell variable names.
    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
      { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
   { (exit 1); exit 1; }; }
    eval $ac_envvar=\$ac_optarg
    export $ac_envvar ;;

  *)
    # FIXME: should be removed in autoconf 3.0.
    echo "$as_me: WARNING: you should use --build, --host, --target" >&2
    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
      echo "$as_me: WARNING: invalid host type: $ac_option" >&2
    : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
    ;;

  esac
done

if test -n "$ac_prev"; then
  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
  { echo "$as_me: error: missing argument to $ac_option" >&2
   { (exit 1); exit 1; }; }
fi

# Be sure to have absolute directory names.
for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
		datadir sysconfdir sharedstatedir localstatedir includedir \
		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
		libdir localedir mandir
do
  eval ac_val=\$$ac_var
  case $ac_val in
    [\\/$]* | ?:[\\/]* )  continue;;
    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
  esac
  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
   { (exit 1); exit 1; }; }
done

# There might be people who depend on the old broken behavior: `$host'
# used to hold the argument of --host etc.
# FIXME: To remove some day.
build=$build_alias
host=$host_alias
target=$target_alias

# FIXME: To remove some day.
if test "x$host_alias" != x; then
  if test "x$build_alias" = x; then
    cross_compiling=maybe
    echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
    If a cross compiler is detected then cross compile mode will be used." >&2
  elif test "x$build_alias" != "x$host_alias"; then
    cross_compiling=yes
  fi
fi

ac_tool_prefix=
test -n "$host_alias" && ac_tool_prefix=$host_alias-

test "$silent" = yes && exec 6>/dev/null


ac_pwd=`pwd` && test -n "$ac_pwd" &&
ac_ls_di=`ls -di .` &&
ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
  { echo "$as_me: error: Working directory cannot be determined" >&2
   { (exit 1); exit 1; }; }
test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
  { echo "$as_me: error: pwd does not report name of working directory" >&2
   { (exit 1); exit 1; }; }


# Find the source files, if location was not specified.
if test -z "$srcdir"; then
  ac_srcdir_defaulted=yes
  # Try the directory containing this script, then the parent directory.
  ac_confdir=`$as_dirname -- "$0" ||
$as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
	 X"$0" : 'X\(//\)[^/]' \| \
	 X"$0" : 'X\(//\)$' \| \
	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
echo X"$0" |
    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)[^/].*/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\).*/{
	    s//\1/
	    q
	  }
	  s/.*/./; q'`
  srcdir=$ac_confdir
  if test ! -r "$srcdir/$ac_unique_file"; then
    srcdir=..
  fi
else
  ac_srcdir_defaulted=no
fi
if test ! -r "$srcdir/$ac_unique_file"; then
  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
  { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
   { (exit 1); exit 1; }; }
fi
ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
ac_abs_confdir=`(
	cd "$srcdir" && test -r "./$ac_unique_file" || { echo "$as_me: error: $ac_msg" >&2
   { (exit 1); exit 1; }; }
	pwd)`
# When building in place, set srcdir=.
if test "$ac_abs_confdir" = "$ac_pwd"; then
  srcdir=.
fi
# Remove unnecessary trailing slashes from srcdir.
# Double slashes in file names in object file debugging info
# mess up M-x gdb in Emacs.
case $srcdir in
*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
esac
for ac_var in $ac_precious_vars; do
  eval ac_env_${ac_var}_set=\${${ac_var}+set}
  eval ac_env_${ac_var}_value=\$${ac_var}
  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
  eval ac_cv_env_${ac_var}_value=\$${ac_var}
done

#
# Report the --help message.
#
if test "$ac_init_help" = "long"; then
  # Omit some internal or obsolete options to make the list less imposing.
  # This message is too long to be a string in the A/UX 3.1 sh.
  cat <<_ACEOF
\`configure' configures Togl 2.0 to adapt to many kinds of systems.

Usage: $0 [OPTION]... [VAR=VALUE]...

To assign environment variables (e.g., CC, CFLAGS...), specify them as
VAR=VALUE.  See below for descriptions of some of the useful variables.

Defaults for the options are specified in brackets.

Configuration:
  -h, --help              display this help and exit
      --help=short        display options specific to this package
      --help=recursive    display the short help of all the included packages
  -V, --version           display version information and exit
  -q, --quiet, --silent   do not print \`checking...' messages
      --cache-file=FILE   cache test results in FILE [disabled]
  -C, --config-cache      alias for \`--cache-file=config.cache'
  -n, --no-create         do not create output files
      --srcdir=DIR        find the sources in DIR [configure dir or \`..']

Installation directories:
  --prefix=PREFIX         install architecture-independent files in PREFIX
			  [$ac_default_prefix]
  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
			  [PREFIX]

By default, \`make install' will install all the files in
\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
an installation prefix other than \`$ac_default_prefix' using \`--prefix',
for instance \`--prefix=\$HOME'.

For better control, use the options below.

Fine tuning of the installation directories:
  --bindir=DIR           user executables [EPREFIX/bin]
  --sbindir=DIR          system admin executables [EPREFIX/sbin]
  --libexecdir=DIR       program executables [EPREFIX/libexec]
  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
  --libdir=DIR           object code libraries [EPREFIX/lib]
  --includedir=DIR       C header files [PREFIX/include]
  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
  --datarootdir=DIR      read-only arch.-independent data root [PREFIX/share]
  --datadir=DIR          read-only architecture-independent data [DATAROOTDIR]
  --infodir=DIR          info documentation [DATAROOTDIR/info]
  --localedir=DIR        locale-dependent data [DATAROOTDIR/locale]
  --mandir=DIR           man documentation [DATAROOTDIR/man]
  --docdir=DIR           documentation root [DATAROOTDIR/doc/togl]
  --htmldir=DIR          html documentation [DOCDIR]
  --dvidir=DIR           dvi documentation [DOCDIR]
  --pdfdir=DIR           pdf documentation [DOCDIR]
  --psdir=DIR            ps documentation [DOCDIR]
_ACEOF

  cat <<\_ACEOF

X features:
  --x-includes=DIR    X include files are in DIR
  --x-libraries=DIR   X library files are in DIR
_ACEOF
fi

if test -n "$ac_init_help"; then
  case $ac_init_help in
     short | recursive ) echo "Configuration of Togl 2.0:";;
   esac
  cat <<\_ACEOF

Optional Features:
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
  --enable-stubs          build and link with stub libraries (--enable-stubs)
  --enable-threads        build with threads
  --enable-shared         build and link with shared libraries (default: on)
  --enable-64bit          enable 64bit support (default: off)
  --enable-64bit-vis      enable 64bit Sparc VIS support (default: off)
  --disable-rpath         disable rpath support (default: on)
  --enable-wince          enable Win/CE support (where applicable)
  --enable-load           allow dynamic loading and "load" command (default:
                          on)
  --enable-symbols        build with debugging symbols (default: off)

Optional Packages:
  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
  --with-tcl              directory containing tcl configuration
                          (tclConfig.sh)
  --with-tk               directory containing tk configuration (tkConfig.sh)
  --with-autostereo       directory with autostereo source (for SGI)
  --with-autostereod      path to autostereod daemon (for SGI)
  --with-x                use the X Window System
  --with-celib=DIR        use Windows/CE support library from DIR

Some influential environment variables:
  CC          C compiler command
  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
              nonstandard directory <lib dir>
  LIBS        libraries to pass to the linker, e.g. -l<library>
  CPPFLAGS    C/C++/Objective C preprocessor flags, e.g. -I<include dir> if
              you have headers in a nonstandard directory <include dir>
  CPP         C preprocessor
  AUTOSTEREOD Path to autostereod for SGI IRIX computers
  XMKMF       Path to xmkmf, Makefile generator for X Window System

Use these variables to override the choices made by `configure' or to help
it to find libraries and programs with nonstandard names/locations.

_ACEOF
ac_status=$?
fi

if test "$ac_init_help" = "recursive"; then
  # If there are subdirs, report their specific --help.
  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
    test -d "$ac_dir" || continue
    ac_builddir=.

case "$ac_dir" in
.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
*)
  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
  # A ".." for each directory in $ac_dir_suffix.
  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
  case $ac_top_builddir_sub in
  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
  esac ;;
esac
ac_abs_top_builddir=$ac_pwd
ac_abs_builddir=$ac_pwd$ac_dir_suffix
# for backward compatibility:
ac_top_builddir=$ac_top_build_prefix

case $srcdir in
  .)  # We are building in place.
    ac_srcdir=.
    ac_top_srcdir=$ac_top_builddir_sub
    ac_abs_top_srcdir=$ac_pwd ;;
  [\\/]* | ?:[\\/]* )  # Absolute name.
    ac_srcdir=$srcdir$ac_dir_suffix;
    ac_top_srcdir=$srcdir
    ac_abs_top_srcdir=$srcdir ;;
  *) # Relative name.
    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
    ac_top_srcdir=$ac_top_build_prefix$srcdir
    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
esac
ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix

    cd "$ac_dir" || { ac_status=$?; continue; }
    # Check for guested configure.
    if test -f "$ac_srcdir/configure.gnu"; then
      echo &&
      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
    elif test -f "$ac_srcdir/configure"; then
      echo &&
      $SHELL "$ac_srcdir/configure" --help=recursive
    else
      echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
    fi || ac_status=$?
    cd "$ac_pwd" || { ac_status=$?; break; }
  done
fi

test -n "$ac_init_help" && exit $ac_status
if $ac_init_version; then
  cat <<\_ACEOF
Togl configure 2.0
generated by GNU Autoconf 2.61

Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
2002, 2003, 2004, 2005, 2006 Free Software Foundation, Inc.
This configure script is free software; the Free Software Foundation
gives unlimited permission to copy, distribute and modify it.
_ACEOF
  exit
fi
cat >config.log <<_ACEOF
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by Togl $as_me 2.0, which was
generated by GNU Autoconf 2.61.  Invocation command line was

  $ $0 $@

_ACEOF
exec 5>>config.log
{
cat <<_ASUNAME
## --------- ##
## Platform. ##
## --------- ##

hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
uname -m = `(uname -m) 2>/dev/null || echo unknown`
uname -r = `(uname -r) 2>/dev/null || echo unknown`
uname -s = `(uname -s) 2>/dev/null || echo unknown`
uname -v = `(uname -v) 2>/dev/null || echo unknown`

/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`

/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`

_ASUNAME

as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  echo "PATH: $as_dir"
done
IFS=$as_save_IFS

} >&5

cat >&5 <<_ACEOF


## ----------- ##
## Core tests. ##
## ----------- ##

_ACEOF


# Keep a trace of the command line.
# Strip out --no-create and --no-recursion so they do not pile up.
# Strip out --silent because we don't want to record it for future runs.
# Also quote any args containing shell meta-characters.
# Make two passes to allow for proper duplicate-argument suppression.
ac_configure_args=
ac_configure_args0=
ac_configure_args1=
ac_must_keep_next=false
for ac_pass in 1 2
do
  for ac_arg
  do
    case $ac_arg in
    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
    | -silent | --silent | --silen | --sile | --sil)
      continue ;;
    *\'*)
      ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
    esac
    case $ac_pass in
    1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
    2)
      ac_configure_args1="$ac_configure_args1 '$ac_arg'"
      if test $ac_must_keep_next = true; then
	ac_must_keep_next=false # Got value, back to normal.
      else
	case $ac_arg in
	  *=* | --config-cache | -C | -disable-* | --disable-* \
	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
	  | -with-* | --with-* | -without-* | --without-* | --x)
	    case "$ac_configure_args0 " in
	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
	    esac
	    ;;
	  -* ) ac_must_keep_next=true ;;
	esac
      fi
      ac_configure_args="$ac_configure_args '$ac_arg'"
      ;;
    esac
  done
done
$as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
$as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }

# When interrupted or exit'd, cleanup temporary files, and complete
# config.log.  We remove comments because anyway the quotes in there
# would cause problems or look ugly.
# WARNING: Use '\'' to represent an apostrophe within the trap.
# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
trap 'exit_status=$?
  # Save into config.log some information that might help in debugging.
  {
    echo

    cat <<\_ASBOX
## ---------------- ##
## Cache variables. ##
## ---------------- ##
_ASBOX
    echo
    # The following way of writing the cache mishandles newlines in values,
(
  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
    eval ac_val=\$$ac_var
    case $ac_val in #(
    *${as_nl}*)
      case $ac_var in #(
      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
      esac
      case $ac_var in #(
      _ | IFS | as_nl) ;; #(
      *) $as_unset $ac_var ;;
      esac ;;
    esac
  done
  (set) 2>&1 |
    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
    *${as_nl}ac_space=\ *)
      sed -n \
	"s/'\''/'\''\\\\'\'''\''/g;
	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
      ;; #(
    *)
      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
      ;;
    esac |
    sort
)
    echo

    cat <<\_ASBOX
## ----------------- ##
## Output variables. ##
## ----------------- ##
_ASBOX
    echo
    for ac_var in $ac_subst_vars
    do
      eval ac_val=\$$ac_var
      case $ac_val in
      *\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
      esac
      echo "$ac_var='\''$ac_val'\''"
    done | sort
    echo

    if test -n "$ac_subst_files"; then
      cat <<\_ASBOX
## ------------------- ##
## File substitutions. ##
## ------------------- ##
_ASBOX
      echo
      for ac_var in $ac_subst_files
      do
	eval ac_val=\$$ac_var
	case $ac_val in
	*\'\''*) ac_val=`echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
	esac
	echo "$ac_var='\''$ac_val'\''"
      done | sort
      echo
    fi

    if test -s confdefs.h; then
      cat <<\_ASBOX
## ----------- ##
## confdefs.h. ##
## ----------- ##
_ASBOX
      echo
      cat confdefs.h
      echo
    fi
    test "$ac_signal" != 0 &&
      echo "$as_me: caught signal $ac_signal"
    echo "$as_me: exit $exit_status"
  } >&5
  rm -f core *.core core.conftest.* &&
    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
    exit $exit_status
' 0
for ac_signal in 1 2 13 15; do
  trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
done
ac_signal=0

# confdefs.h avoids OS command line length limits that DEFS can exceed.
rm -f -r conftest* confdefs.h

# Predefined preprocessor variables.

cat >>confdefs.h <<_ACEOF
#define PACKAGE_NAME "$PACKAGE_NAME"
_ACEOF


cat >>confdefs.h <<_ACEOF
#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
_ACEOF


cat >>confdefs.h <<_ACEOF
#define PACKAGE_VERSION "$PACKAGE_VERSION"
_ACEOF


cat >>confdefs.h <<_ACEOF
#define PACKAGE_STRING "$PACKAGE_STRING"
_ACEOF


cat >>confdefs.h <<_ACEOF
#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
_ACEOF


# Let the site file select an alternate cache file if it wants to.
# Prefer explicitly selected file to automatically selected ones.
if test -n "$CONFIG_SITE"; then
  set x "$CONFIG_SITE"
elif test "x$prefix" != xNONE; then
  set x "$prefix/share/config.site" "$prefix/etc/config.site"
else
  set x "$ac_default_prefix/share/config.site" \
	"$ac_default_prefix/etc/config.site"
fi
shift
for ac_site_file
do
  if test -r "$ac_site_file"; then
    { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
echo "$as_me: loading site script $ac_site_file" >&6;}
    sed 's/^/| /' "$ac_site_file" >&5
    . "$ac_site_file"
  fi
done

if test -r "$cache_file"; then
  # Some versions of bash will fail to source /dev/null (special
  # files actually), so we avoid doing that.
  if test -f "$cache_file"; then
    { echo "$as_me:$LINENO: loading cache $cache_file" >&5
echo "$as_me: loading cache $cache_file" >&6;}
    case $cache_file in
      [\\/]* | ?:[\\/]* ) . "$cache_file";;
      *)                      . "./$cache_file";;
    esac
  fi
else
  { echo "$as_me:$LINENO: creating cache $cache_file" >&5
echo "$as_me: creating cache $cache_file" >&6;}
  >$cache_file
fi

# Check that the precious variables saved in the cache have kept the same
# value.
ac_cache_corrupted=false
for ac_var in $ac_precious_vars; do
  eval ac_old_set=\$ac_cv_env_${ac_var}_set
  eval ac_new_set=\$ac_env_${ac_var}_set
  eval ac_old_val=\$ac_cv_env_${ac_var}_value
  eval ac_new_val=\$ac_env_${ac_var}_value
  case $ac_old_set,$ac_new_set in
    set,)
      { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
      ac_cache_corrupted=: ;;
    ,set)
      { echo "$as_me:$LINENO: error: \`$ac_var' was not set in the previous run" >&5
echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
      ac_cache_corrupted=: ;;
    ,);;
    *)
      if test "x$ac_old_val" != "x$ac_new_val"; then
	{ echo "$as_me:$LINENO: error: \`$ac_var' has changed since the previous run:" >&5
echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
	{ echo "$as_me:$LINENO:   former value:  $ac_old_val" >&5
echo "$as_me:   former value:  $ac_old_val" >&2;}
	{ echo "$as_me:$LINENO:   current value: $ac_new_val" >&5
echo "$as_me:   current value: $ac_new_val" >&2;}
	ac_cache_corrupted=:
      fi;;
  esac
  # Pass precious variables to config.status.
  if test "$ac_new_set" = set; then
    case $ac_new_val in
    *\'*) ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
    *) ac_arg=$ac_var=$ac_new_val ;;
    esac
    case " $ac_configure_args " in
      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
      *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
    esac
  fi
done
if $ac_cache_corrupted; then
  { echo "$as_me:$LINENO: error: changes in the environment can compromise the build" >&5
echo "$as_me: error: changes in the environment can compromise the build" >&2;}
  { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
   { (exit 1); exit 1; }; }
fi

























ac_ext=c
ac_cpp='$CPP $CPPFLAGS'
ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_c_compiler_gnu



#--------------------------------------------------------------------
# Call TEA_INIT as the first TEA_ macro to set up initial vars.
# This will define a ${TEA_PLATFORM} variable == "unix" or "windows"
# as well as PKG_LIB_FILE and PKG_STUB_LIB_FILE.
#--------------------------------------------------------------------


    # TEA extensions pass this us the version of TEA they think they
    # are compatible with.
    TEA_VERSION="3.6"

    { echo "$as_me:$LINENO: checking for correct TEA configuration" >&5
echo $ECHO_N "checking for correct TEA configuration... $ECHO_C" >&6; }
    if test x"${PACKAGE_NAME}" = x ; then
	{ { echo "$as_me:$LINENO: error:
The PACKAGE_NAME variable must be defined by your TEA configure.in" >&5
echo "$as_me: error:
The PACKAGE_NAME variable must be defined by your TEA configure.in" >&2;}
   { (exit 1); exit 1; }; }
    fi
    if test x"3.6" = x ; then
	{ { echo "$as_me:$LINENO: error:
TEA version not specified." >&5
echo "$as_me: error:
TEA version not specified." >&2;}
   { (exit 1); exit 1; }; }
    elif test "3.6" != "${TEA_VERSION}" ; then
	{ echo "$as_me:$LINENO: result: warning: requested TEA version \"3.6\", have \"${TEA_VERSION}\"" >&5
echo "${ECHO_T}warning: requested TEA version \"3.6\", have \"${TEA_VERSION}\"" >&6; }
    else
	{ echo "$as_me:$LINENO: result: ok (TEA ${TEA_VERSION})" >&5
echo "${ECHO_T}ok (TEA ${TEA_VERSION})" >&6; }
    fi
    case "`uname -s`" in
	*win32*|*WIN32*|*CYGWIN_NT*|*CYGWIN_9*|*CYGWIN_ME*|*MINGW32_*)
	    # Extract the first word of "cygpath", so it can be a program name with args.
set dummy cygpath; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_CYGPATH+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$CYGPATH"; then
  ac_cv_prog_CYGPATH="$CYGPATH" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_CYGPATH="cygpath -w"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

  test -z "$ac_cv_prog_CYGPATH" && ac_cv_prog_CYGPATH="echo"
fi
fi
CYGPATH=$ac_cv_prog_CYGPATH
if test -n "$CYGPATH"; then
  { echo "$as_me:$LINENO: result: $CYGPATH" >&5
echo "${ECHO_T}$CYGPATH" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


	    EXEEXT=".exe"
	    TEA_PLATFORM="windows"
	    ;;
	*)
	    CYGPATH=echo
	    EXEEXT=""
	    TEA_PLATFORM="unix"
	    ;;
    esac

    # Check if exec_prefix is set. If not use fall back to prefix.
    # Note when adjusted, so that TEA_PREFIX can correct for this.
    # This is needed for recursive configures, since autoconf propagates
    # $prefix, but not $exec_prefix (doh!).
    if test x$exec_prefix = xNONE ; then
	exec_prefix_default=yes
	exec_prefix=$prefix
    fi




    # This package name must be replaced statically for AC_SUBST to work

    # Substitute STUB_LIB_FILE in case package creates a stub library too.


    # We AC_SUBST these here to ensure they are subst'ed,
    # in case the user doesn't call TEA_ADD_...









ac_aux_dir=
for ac_dir in tclconfig "$srcdir"/tclconfig; do
  if test -f "$ac_dir/install-sh"; then
    ac_aux_dir=$ac_dir
    ac_install_sh="$ac_aux_dir/install-sh -c"
    break
  elif test -f "$ac_dir/install.sh"; then
    ac_aux_dir=$ac_dir
    ac_install_sh="$ac_aux_dir/install.sh -c"
    break
  elif test -f "$ac_dir/shtool"; then
    ac_aux_dir=$ac_dir
    ac_install_sh="$ac_aux_dir/shtool install -c"
    break
  fi
done
if test -z "$ac_aux_dir"; then
  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in tclconfig \"$srcdir\"/tclconfig" >&5
echo "$as_me: error: cannot find install-sh or install.sh in tclconfig \"$srcdir\"/tclconfig" >&2;}
   { (exit 1); exit 1; }; }
fi

# These three variables are undocumented and unsupported,
# and are intended to be withdrawn in a future Autoconf release.
# They can cause serious problems if a builder's source tree is in a directory
# whose full name contains unusual characters.
ac_config_guess="$SHELL $ac_aux_dir/config.guess"  # Please don't use this var.
ac_config_sub="$SHELL $ac_aux_dir/config.sub"  # Please don't use this var.
ac_configure="$SHELL $ac_aux_dir/configure"  # Please don't use this var.



#--------------------------------------------------------------------
# Load the tclConfig.sh file
#--------------------------------------------------------------------



    #
    # Ok, lets find the tcl configuration
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-tcl
    #

    if test x"${no_tcl}" = x ; then
	# we reset no_tcl in case something fails here
	no_tcl=true

# Check whether --with-tcl was given.
if test "${with_tcl+set}" = set; then
  withval=$with_tcl; with_tclconfig=${withval}
fi

	{ echo "$as_me:$LINENO: checking for Tcl configuration" >&5
echo $ECHO_N "checking for Tcl configuration... $ECHO_C" >&6; }
	if test "${ac_cv_c_tclconfig+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else


	    # First check to see if --with-tcl was specified.
	    if test x"${with_tclconfig}" != x ; then
		case ${with_tclconfig} in
		    */tclConfig.sh )
			if test -f ${with_tclconfig}; then
			    { echo "$as_me:$LINENO: WARNING: --with-tcl argument should refer to directory containing tclConfig.sh, not to tclConfig.sh itself" >&5
echo "$as_me: WARNING: --with-tcl argument should refer to directory containing tclConfig.sh, not to tclConfig.sh itself" >&2;}
			    with_tclconfig=`echo ${with_tclconfig} | sed 's!/tclConfig\.sh$!!'`
			fi ;;
		esac
		if test -f "${with_tclconfig}/tclConfig.sh" ; then
		    ac_cv_c_tclconfig=`(cd ${with_tclconfig}; pwd)`
		else
		    { { echo "$as_me:$LINENO: error: ${with_tclconfig} directory doesn't contain tclConfig.sh" >&5
echo "$as_me: error: ${with_tclconfig} directory doesn't contain tclConfig.sh" >&2;}
   { (exit 1); exit 1; }; }
		fi
	    fi

	    # then check for a private Tcl installation
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in \
			../tcl \
			`ls -dr ../tcl[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../tcl[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../tcl[8-9].[0-9]* 2>/dev/null` \
			../../tcl \
			`ls -dr ../../tcl[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../../tcl[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../../tcl[8-9].[0-9]* 2>/dev/null` \
			../../../tcl \
			`ls -dr ../../../tcl[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../../../tcl[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../../../tcl[8-9].[0-9]* 2>/dev/null` ; do
		    if test -f "$i/unix/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

	    # on Darwin, check in Framework installation locations
	    if test "`uname -s`" = "Darwin" -a x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d ~/Library/Frameworks 2>/dev/null` \
			`ls -d /Library/Frameworks 2>/dev/null` \
			`ls -d /Network/Library/Frameworks 2>/dev/null` \
			`ls -d /System/Library/Frameworks 2>/dev/null` \
			; do
		    if test -f "$i/Tcl.framework/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i/Tcl.framework; pwd)`
			break
		    fi
		done
	    fi

	    # TEA specific: on Windows, check in common installation locations
	    if test "${TEA_PLATFORM}" = "windows" \
		-a x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d C:/Tcl/lib 2>/dev/null` \
			`ls -d C:/Progra~1/Tcl/lib 2>/dev/null` \
			; do
		    if test -f "$i/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few common install locations
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d ${libdir} 2>/dev/null` \
			`ls -d ${exec_prefix}/lib 2>/dev/null` \
			`ls -d ${prefix}/lib 2>/dev/null` \
			`ls -d /usr/local/lib 2>/dev/null` \
			`ls -d /usr/contrib/lib 2>/dev/null` \
			`ls -d /usr/lib 2>/dev/null` \
			; do
		    if test -f "$i/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few other private locations
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in \
			${srcdir}/../tcl \
			`ls -dr ${srcdir}/../tcl[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ${srcdir}/../tcl[8-9].[0-9] 2>/dev/null` \
			`ls -dr ${srcdir}/../tcl[8-9].[0-9]* 2>/dev/null` ; do
		    if test -f "$i/unix/tclConfig.sh" ; then
		    ac_cv_c_tclconfig=`(cd $i/unix; pwd)`
		    break
		fi
		done
	    fi

fi


	if test x"${ac_cv_c_tclconfig}" = x ; then
	    TCL_BIN_DIR="# no Tcl configs found"
	    { echo "$as_me:$LINENO: WARNING: Can't find Tcl configuration definitions" >&5
echo "$as_me: WARNING: Can't find Tcl configuration definitions" >&2;}
	    exit 0
	else
	    no_tcl=
	    TCL_BIN_DIR=${ac_cv_c_tclconfig}
	    { echo "$as_me:$LINENO: result: found ${TCL_BIN_DIR}/tclConfig.sh" >&5
echo "${ECHO_T}found ${TCL_BIN_DIR}/tclConfig.sh" >&6; }
	fi
    fi


    { echo "$as_me:$LINENO: checking for existence of ${TCL_BIN_DIR}/tclConfig.sh" >&5
echo $ECHO_N "checking for existence of ${TCL_BIN_DIR}/tclConfig.sh... $ECHO_C" >&6; }

    if test -f "${TCL_BIN_DIR}/tclConfig.sh" ; then
        { echo "$as_me:$LINENO: result: loading" >&5
echo "${ECHO_T}loading" >&6; }
	. "${TCL_BIN_DIR}/tclConfig.sh"
    else
        { echo "$as_me:$LINENO: result: could not find ${TCL_BIN_DIR}/tclConfig.sh" >&5
echo "${ECHO_T}could not find ${TCL_BIN_DIR}/tclConfig.sh" >&6; }
    fi

    # eval is required to do the TCL_DBGX substitution
    eval "TCL_LIB_FILE=\"${TCL_LIB_FILE}\""
    eval "TCL_STUB_LIB_FILE=\"${TCL_STUB_LIB_FILE}\""

    # If the TCL_BIN_DIR is the build directory (not the install directory),
    # then set the common variable name to the value of the build variables.
    # For example, the variable TCL_LIB_SPEC will be set to the value
    # of TCL_BUILD_LIB_SPEC. An extension should make use of TCL_LIB_SPEC
    # instead of TCL_BUILD_LIB_SPEC since it will work with both an
    # installed and uninstalled version of Tcl.
    if test -f "${TCL_BIN_DIR}/Makefile" ; then
        TCL_LIB_SPEC=${TCL_BUILD_LIB_SPEC}
        TCL_STUB_LIB_SPEC=${TCL_BUILD_STUB_LIB_SPEC}
        TCL_STUB_LIB_PATH=${TCL_BUILD_STUB_LIB_PATH}
    elif test "`uname -s`" = "Darwin"; then
	# If Tcl was built as a framework, attempt to use the libraries
	# from the framework at the given location so that linking works
	# against Tcl.framework installed in an arbitary location.
	case ${TCL_DEFS} in
	    *TCL_FRAMEWORK*)
		if test -f "${TCL_BIN_DIR}/${TCL_LIB_FILE}"; then
		    for i in "`cd ${TCL_BIN_DIR}; pwd`" \
			     "`cd ${TCL_BIN_DIR}/../..; pwd`"; do
			if test "`basename "$i"`" = "${TCL_LIB_FILE}.framework"; then
			    TCL_LIB_SPEC="-F`dirname "$i"` -framework ${TCL_LIB_FILE}"
			    break
			fi
		    done
		fi
		if test -f "${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}"; then
		    TCL_STUB_LIB_SPEC="-L${TCL_BIN_DIR} ${TCL_STUB_LIB_FLAG}"
		    TCL_STUB_LIB_PATH="${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}"
		fi
		;;
	esac
    fi

    # eval is required to do the TCL_DBGX substitution
    eval "TCL_LIB_FLAG=\"${TCL_LIB_FLAG}\""
    eval "TCL_LIB_SPEC=\"${TCL_LIB_SPEC}\""
    eval "TCL_STUB_LIB_FLAG=\"${TCL_STUB_LIB_FLAG}\""
    eval "TCL_STUB_LIB_SPEC=\"${TCL_STUB_LIB_SPEC}\""













    # TEA specific:







#--------------------------------------------------------------------
# Load the tkConfig.sh file if necessary (Tk extension)
#--------------------------------------------------------------------


    #
    # Ok, lets find the tk configuration
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-tk
    #

    if test x"${no_tk}" = x ; then
	# we reset no_tk in case something fails here
	no_tk=true

# Check whether --with-tk was given.
if test "${with_tk+set}" = set; then
  withval=$with_tk; with_tkconfig=${withval}
fi

	{ echo "$as_me:$LINENO: checking for Tk configuration" >&5
echo $ECHO_N "checking for Tk configuration... $ECHO_C" >&6; }
	if test "${ac_cv_c_tkconfig+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else


	    # First check to see if --with-tkconfig was specified.
	    if test x"${with_tkconfig}" != x ; then
		case ${with_tkconfig} in
		    */tkConfig.sh )
			if test -f ${with_tkconfig}; then
			    { echo "$as_me:$LINENO: WARNING: --with-tk argument should refer to directory containing tkConfig.sh, not to tkConfig.sh itself" >&5
echo "$as_me: WARNING: --with-tk argument should refer to directory containing tkConfig.sh, not to tkConfig.sh itself" >&2;}
			    with_tkconfig=`echo ${with_tkconfig} | sed 's!/tkConfig\.sh$!!'`
			fi ;;
		esac
		if test -f "${with_tkconfig}/tkConfig.sh" ; then
		    ac_cv_c_tkconfig=`(cd ${with_tkconfig}; pwd)`
		else
		    { { echo "$as_me:$LINENO: error: ${with_tkconfig} directory doesn't contain tkConfig.sh" >&5
echo "$as_me: error: ${with_tkconfig} directory doesn't contain tkConfig.sh" >&2;}
   { (exit 1); exit 1; }; }
		fi
	    fi

	    # then check for a private Tk library
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in \
			../tk \
			`ls -dr ../tk[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../tk[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../tk[8-9].[0-9]* 2>/dev/null` \
			../../tk \
			`ls -dr ../../tk[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../../tk[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../../tk[8-9].[0-9]* 2>/dev/null` \
			../../../tk \
			`ls -dr ../../../tk[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ../../../tk[8-9].[0-9] 2>/dev/null` \
			`ls -dr ../../../tk[8-9].[0-9]* 2>/dev/null` ; do
		    if test -f "$i/unix/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

	    # on Darwin, check in Framework installation locations
	    if test "`uname -s`" = "Darwin" -a x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d ~/Library/Frameworks 2>/dev/null` \
			`ls -d /Library/Frameworks 2>/dev/null` \
			`ls -d /Network/Library/Frameworks 2>/dev/null` \
			`ls -d /System/Library/Frameworks 2>/dev/null` \
			; do
		    if test -f "$i/Tk.framework/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/Tk.framework; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few common install locations
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d ${libdir} 2>/dev/null` \
			`ls -d ${exec_prefix}/lib 2>/dev/null` \
			`ls -d ${prefix}/lib 2>/dev/null` \
			`ls -d /usr/local/lib 2>/dev/null` \
			`ls -d /usr/contrib/lib 2>/dev/null` \
			`ls -d /usr/lib 2>/dev/null` \
			; do
		    if test -f "$i/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # TEA specific: on Windows, check in common installation locations
	    if test "${TEA_PLATFORM}" = "windows" \
		-a x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d C:/Tcl/lib 2>/dev/null` \
			`ls -d C:/Progra~1/Tcl/lib 2>/dev/null` \
			; do
		    if test -f "$i/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few other private locations
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in \
			${srcdir}/../tk \
			`ls -dr ${srcdir}/../tk[8-9].[0-9].[0-9]* 2>/dev/null` \
			`ls -dr ${srcdir}/../tk[8-9].[0-9] 2>/dev/null` \
			`ls -dr ${srcdir}/../tk[8-9].[0-9]* 2>/dev/null` ; do
		    if test -f "$i/unix/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

fi


	if test x"${ac_cv_c_tkconfig}" = x ; then
	    TK_BIN_DIR="# no Tk configs found"
	    { echo "$as_me:$LINENO: WARNING: Can't find Tk configuration definitions" >&5
echo "$as_me: WARNING: Can't find Tk configuration definitions" >&2;}
	    exit 0
	else
	    no_tk=
	    TK_BIN_DIR=${ac_cv_c_tkconfig}
	    { echo "$as_me:$LINENO: result: found ${TK_BIN_DIR}/tkConfig.sh" >&5
echo "${ECHO_T}found ${TK_BIN_DIR}/tkConfig.sh" >&6; }
	fi
    fi


    { echo "$as_me:$LINENO: checking for existence of ${TK_BIN_DIR}/tkConfig.sh" >&5
echo $ECHO_N "checking for existence of ${TK_BIN_DIR}/tkConfig.sh... $ECHO_C" >&6; }

    if test -f "${TK_BIN_DIR}/tkConfig.sh" ; then
        { echo "$as_me:$LINENO: result: loading" >&5
echo "${ECHO_T}loading" >&6; }
	. "${TK_BIN_DIR}/tkConfig.sh"
    else
        { echo "$as_me:$LINENO: result: could not find ${TK_BIN_DIR}/tkConfig.sh" >&5
echo "${ECHO_T}could not find ${TK_BIN_DIR}/tkConfig.sh" >&6; }
    fi

    # eval is required to do the TK_DBGX substitution
    eval "TK_LIB_FILE=\"${TK_LIB_FILE}\""
    eval "TK_STUB_LIB_FILE=\"${TK_STUB_LIB_FILE}\""

    # If the TK_BIN_DIR is the build directory (not the install directory),
    # then set the common variable name to the value of the build variables.
    # For example, the variable TK_LIB_SPEC will be set to the value
    # of TK_BUILD_LIB_SPEC. An extension should make use of TK_LIB_SPEC
    # instead of TK_BUILD_LIB_SPEC since it will work with both an
    # installed and uninstalled version of Tcl.
    if test -f "${TK_BIN_DIR}/Makefile" ; then
        TK_LIB_SPEC=${TK_BUILD_LIB_SPEC}
        TK_STUB_LIB_SPEC=${TK_BUILD_STUB_LIB_SPEC}
        TK_STUB_LIB_PATH=${TK_BUILD_STUB_LIB_PATH}
    elif test "`uname -s`" = "Darwin"; then
	# If Tk was built as a framework, attempt to use the libraries
	# from the framework at the given location so that linking works
	# against Tk.framework installed in an arbitary location.
	case ${TK_DEFS} in
	    *TK_FRAMEWORK*)
		if test -f "${TK_BIN_DIR}/${TK_LIB_FILE}"; then
		    for i in "`cd ${TK_BIN_DIR}; pwd`" \
			     "`cd ${TK_BIN_DIR}/../..; pwd`"; do
			if test "`basename "$i"`" = "${TK_LIB_FILE}.framework"; then
			    TK_LIB_SPEC="-F`dirname "$i"` -framework ${TK_LIB_FILE}"
			    break
			fi
		    done
		fi
		if test -f "${TK_BIN_DIR}/${TK_STUB_LIB_FILE}"; then
		    TK_STUB_LIB_SPEC="-L${TK_BIN_DIR} ${TK_STUB_LIB_FLAG}"
		    TK_STUB_LIB_PATH="${TK_BIN_DIR}/${TK_STUB_LIB_FILE}"
		fi
		;;
	esac
    fi

    # eval is required to do the TK_DBGX substitution
    eval "TK_LIB_FLAG=\"${TK_LIB_FLAG}\""
    eval "TK_LIB_SPEC=\"${TK_LIB_SPEC}\""
    eval "TK_STUB_LIB_FLAG=\"${TK_STUB_LIB_FLAG}\""
    eval "TK_STUB_LIB_SPEC=\"${TK_STUB_LIB_SPEC}\""

    # TEA specific: Ensure windowingsystem is defined
    if test "${TEA_PLATFORM}" = "unix" ; then
	case ${TK_DEFS} in
	    *MAC_OSX_TK*)

cat >>confdefs.h <<\_ACEOF
#define MAC_OSX_TK 1
_ACEOF

		TEA_WINDOWINGSYSTEM="aqua"
		;;
	    *)
		TEA_WINDOWINGSYSTEM="x11"
		;;
	esac
    elif test "${TEA_PLATFORM}" = "windows" ; then
	TEA_WINDOWINGSYSTEM="win32"
    fi













    # TEA specific:




#-----------------------------------------------------------------------
# Handle the --prefix=... option by defaulting to what Tcl gave.
# Must be called after TEA_LOAD_TCLCONFIG and before TEA_SETUP_COMPILER.
#-----------------------------------------------------------------------


    if test "${prefix}" = "NONE"; then
	prefix_default=yes
	if test x"${TCL_PREFIX}" != x; then
	    { echo "$as_me:$LINENO: --prefix defaulting to TCL_PREFIX ${TCL_PREFIX}" >&5
echo "$as_me: --prefix defaulting to TCL_PREFIX ${TCL_PREFIX}" >&6;}
	    prefix=${TCL_PREFIX}
	else
	    { echo "$as_me:$LINENO: --prefix defaulting to /usr/local" >&5
echo "$as_me: --prefix defaulting to /usr/local" >&6;}
	    prefix=/usr/local
	fi
    fi
    if test "${exec_prefix}" = "NONE" -a x"${prefix_default}" = x"yes" \
	-o x"${exec_prefix_default}" = x"yes" ; then
	if test x"${TCL_EXEC_PREFIX}" != x; then
	    { echo "$as_me:$LINENO: --exec-prefix defaulting to TCL_EXEC_PREFIX ${TCL_EXEC_PREFIX}" >&5
echo "$as_me: --exec-prefix defaulting to TCL_EXEC_PREFIX ${TCL_EXEC_PREFIX}" >&6;}
	    exec_prefix=${TCL_EXEC_PREFIX}
	else
	    { echo "$as_me:$LINENO: --exec-prefix defaulting to ${prefix}" >&5
echo "$as_me: --exec-prefix defaulting to ${prefix}" >&6;}
	    exec_prefix=$prefix
	fi
    fi


#-----------------------------------------------------------------------
# Standard compiler checks.
# This sets up CC by using the CC env var, or looks for gcc otherwise.
# This also calls AC_PROG_CC, AC_PROG_INSTALL and a few others to create
# the basic setup necessary to compile executables.
#-----------------------------------------------------------------------


    # Don't put any macros that use the compiler (e.g. AC_TRY_COMPILE)
    # in this macro, they need to go into TEA_SETUP_COMPILER instead.

    # If the user did not set CFLAGS, set it now to keep
    # the AC_PROG_CC macro from adding "-g -O2".
    if test "${CFLAGS+set}" != "set" ; then
	CFLAGS=""
    fi

    ac_ext=c
ac_cpp='$CPP $CPPFLAGS'
ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_c_compiler_gnu
if test -n "$ac_tool_prefix"; then
  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
set dummy ${ac_tool_prefix}gcc; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$CC"; then
  ac_cv_prog_CC="$CC" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_CC="${ac_tool_prefix}gcc"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
CC=$ac_cv_prog_CC
if test -n "$CC"; then
  { echo "$as_me:$LINENO: result: $CC" >&5
echo "${ECHO_T}$CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


fi
if test -z "$ac_cv_prog_CC"; then
  ac_ct_CC=$CC
  # Extract the first word of "gcc", so it can be a program name with args.
set dummy gcc; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$ac_ct_CC"; then
  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_ac_ct_CC="gcc"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
ac_ct_CC=$ac_cv_prog_ac_ct_CC
if test -n "$ac_ct_CC"; then
  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
echo "${ECHO_T}$ac_ct_CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi

  if test "x$ac_ct_CC" = x; then
    CC=""
  else
    case $cross_compiling:$ac_tool_warned in
yes:)
{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&5
echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&2;}
ac_tool_warned=yes ;;
esac
    CC=$ac_ct_CC
  fi
else
  CC="$ac_cv_prog_CC"
fi

if test -z "$CC"; then
          if test -n "$ac_tool_prefix"; then
    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
set dummy ${ac_tool_prefix}cc; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$CC"; then
  ac_cv_prog_CC="$CC" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_CC="${ac_tool_prefix}cc"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
CC=$ac_cv_prog_CC
if test -n "$CC"; then
  { echo "$as_me:$LINENO: result: $CC" >&5
echo "${ECHO_T}$CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


  fi
fi
if test -z "$CC"; then
  # Extract the first word of "cc", so it can be a program name with args.
set dummy cc; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$CC"; then
  ac_cv_prog_CC="$CC" # Let the user override the test.
else
  ac_prog_rejected=no
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
       ac_prog_rejected=yes
       continue
     fi
    ac_cv_prog_CC="cc"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

if test $ac_prog_rejected = yes; then
  # We found a bogon in the path, so make sure we never use it.
  set dummy $ac_cv_prog_CC
  shift
  if test $# != 0; then
    # We chose a different compiler from the bogus one.
    # However, it has the same basename, so the bogon will be chosen
    # first if we set CC to just the basename; use the full file name.
    shift
    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
  fi
fi
fi
fi
CC=$ac_cv_prog_CC
if test -n "$CC"; then
  { echo "$as_me:$LINENO: result: $CC" >&5
echo "${ECHO_T}$CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


fi
if test -z "$CC"; then
  if test -n "$ac_tool_prefix"; then
  for ac_prog in cl.exe
  do
    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
set dummy $ac_tool_prefix$ac_prog; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$CC"; then
  ac_cv_prog_CC="$CC" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
CC=$ac_cv_prog_CC
if test -n "$CC"; then
  { echo "$as_me:$LINENO: result: $CC" >&5
echo "${ECHO_T}$CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


    test -n "$CC" && break
  done
fi
if test -z "$CC"; then
  ac_ct_CC=$CC
  for ac_prog in cl.exe
do
  # Extract the first word of "$ac_prog", so it can be a program name with args.
set dummy $ac_prog; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$ac_ct_CC"; then
  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_ac_ct_CC="$ac_prog"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
ac_ct_CC=$ac_cv_prog_ac_ct_CC
if test -n "$ac_ct_CC"; then
  { echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
echo "${ECHO_T}$ac_ct_CC" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


  test -n "$ac_ct_CC" && break
done

  if test "x$ac_ct_CC" = x; then
    CC=""
  else
    case $cross_compiling:$ac_tool_warned in
yes:)
{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&5
echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&2;}
ac_tool_warned=yes ;;
esac
    CC=$ac_ct_CC
  fi
fi

fi


test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
See \`config.log' for more details." >&5
echo "$as_me: error: no acceptable C compiler found in \$PATH
See \`config.log' for more details." >&2;}
   { (exit 1); exit 1; }; }

# Provide some information about the compiler.
echo "$as_me:$LINENO: checking for C compiler version" >&5
ac_compiler=`set X $ac_compile; echo $2`
{ (ac_try="$ac_compiler --version >&5"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compiler --version >&5") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }
{ (ac_try="$ac_compiler -v >&5"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compiler -v >&5") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }
{ (ac_try="$ac_compiler -V >&5"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compiler -V >&5") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }

cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
ac_clean_files_save=$ac_clean_files
ac_clean_files="$ac_clean_files a.out a.exe b.out"
# Try to create an executable without -o first, disregard a.out.
# It will help us diagnose broken compilers, and finding out an intuition
# of exeext.
{ echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6; }
ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
#
# List of possible output files, starting from the most likely.
# The algorithm is not robust to junk in `.', hence go to wildcards (a.*)
# only as a last resort.  b.out is created by i960 compilers.
ac_files='a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out'
#
# The IRIX 6 linker writes into existing files which may not be
# executable, retaining their permissions.  Remove them first so a
# subsequent execution test works.
ac_rmfiles=
for ac_file in $ac_files
do
  case $ac_file in
    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
  esac
done
rm -f $ac_rmfiles

if { (ac_try="$ac_link_default"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link_default") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; then
  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
# in a Makefile.  We should not override ac_cv_exeext if it was cached,
# so that the user can short-circuit this test for compilers unknown to
# Autoconf.
for ac_file in $ac_files ''
do
  test -f "$ac_file" || continue
  case $ac_file in
    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj )
	;;
    [ab].out )
	# We found the default executable, but exeext='' is most
	# certainly right.
	break;;
    *.* )
        if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
	then :; else
	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
	fi
	# We set ac_cv_exeext here because the later test for it is not
	# safe: cross compilers may not add the suffix if given an `-o'
	# argument, so we may need to know it at that point already.
	# Even if this section looks crufty: it has the advantage of
	# actually working.
	break;;
    * )
	break;;
  esac
done
test "$ac_cv_exeext" = no && ac_cv_exeext=

else
  ac_file=''
fi

{ echo "$as_me:$LINENO: result: $ac_file" >&5
echo "${ECHO_T}$ac_file" >&6; }
if test -z "$ac_file"; then
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

{ { echo "$as_me:$LINENO: error: C compiler cannot create executables
See \`config.log' for more details." >&5
echo "$as_me: error: C compiler cannot create executables
See \`config.log' for more details." >&2;}
   { (exit 77); exit 77; }; }
fi

ac_exeext=$ac_cv_exeext

# Check that the compiler produces executables we can run.  If not, either
# the compiler is broken, or we cross compile.
{ echo "$as_me:$LINENO: checking whether the C compiler works" >&5
echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6; }
# FIXME: These cross compiler hacks should be removed for Autoconf 3.0
# If not cross compiling, check that we can run a simple program.
if test "$cross_compiling" != yes; then
  if { ac_try='./$ac_file'
  { (case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_try") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; }; then
    cross_compiling=no
  else
    if test "$cross_compiling" = maybe; then
	cross_compiling=yes
    else
	{ { echo "$as_me:$LINENO: error: cannot run C compiled programs.
If you meant to cross compile, use \`--host'.
See \`config.log' for more details." >&5
echo "$as_me: error: cannot run C compiled programs.
If you meant to cross compile, use \`--host'.
See \`config.log' for more details." >&2;}
   { (exit 1); exit 1; }; }
    fi
  fi
fi
{ echo "$as_me:$LINENO: result: yes" >&5
echo "${ECHO_T}yes" >&6; }

rm -f a.out a.exe conftest$ac_cv_exeext b.out
ac_clean_files=$ac_clean_files_save
# Check that the compiler produces executables we can run.  If not, either
# the compiler is broken, or we cross compile.
{ echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6; }
{ echo "$as_me:$LINENO: result: $cross_compiling" >&5
echo "${ECHO_T}$cross_compiling" >&6; }

{ echo "$as_me:$LINENO: checking for suffix of executables" >&5
echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6; }
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; then
  # If both `conftest.exe' and `conftest' are `present' (well, observable)
# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
# work properly (i.e., refer to `conftest.exe'), while it won't with
# `rm'.
for ac_file in conftest.exe conftest conftest.*; do
  test -f "$ac_file" || continue
  case $ac_file in
    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.o | *.obj ) ;;
    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
	  break;;
    * ) break;;
  esac
done
else
  { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
See \`config.log' for more details." >&5
echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
See \`config.log' for more details." >&2;}
   { (exit 1); exit 1; }; }
fi

rm -f conftest$ac_cv_exeext
{ echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
echo "${ECHO_T}$ac_cv_exeext" >&6; }

rm -f conftest.$ac_ext
EXEEXT=$ac_cv_exeext
ac_exeext=$EXEEXT
{ echo "$as_me:$LINENO: checking for suffix of object files" >&5
echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6; }
if test "${ac_cv_objext+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.o conftest.obj
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; then
  for ac_file in conftest.o conftest.obj conftest.*; do
  test -f "$ac_file" || continue;
  case $ac_file in
    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf ) ;;
    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
       break;;
  esac
done
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

{ { echo "$as_me:$LINENO: error: cannot compute suffix of object files: cannot compile
See \`config.log' for more details." >&5
echo "$as_me: error: cannot compute suffix of object files: cannot compile
See \`config.log' for more details." >&2;}
   { (exit 1); exit 1; }; }
fi

rm -f conftest.$ac_cv_objext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
echo "${ECHO_T}$ac_cv_objext" >&6; }
OBJEXT=$ac_cv_objext
ac_objext=$OBJEXT
{ echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6; }
if test "${ac_cv_c_compiler_gnu+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
#ifndef __GNUC__
       choke me
#endif

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_compiler_gnu=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_compiler_gnu=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
ac_cv_c_compiler_gnu=$ac_compiler_gnu

fi
{ echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6; }
GCC=`test $ac_compiler_gnu = yes && echo yes`
ac_test_CFLAGS=${CFLAGS+set}
ac_save_CFLAGS=$CFLAGS
{ echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6; }
if test "${ac_cv_prog_cc_g+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_save_c_werror_flag=$ac_c_werror_flag
   ac_c_werror_flag=yes
   ac_cv_prog_cc_g=no
   CFLAGS="-g"
   cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_cv_prog_cc_g=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	CFLAGS=""
      cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  :
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_c_werror_flag=$ac_save_c_werror_flag
	 CFLAGS="-g"
	 cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_cv_prog_cc_g=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5


fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
   ac_c_werror_flag=$ac_save_c_werror_flag
fi
{ echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
echo "${ECHO_T}$ac_cv_prog_cc_g" >&6; }
if test "$ac_test_CFLAGS" = set; then
  CFLAGS=$ac_save_CFLAGS
elif test $ac_cv_prog_cc_g = yes; then
  if test "$GCC" = yes; then
    CFLAGS="-g -O2"
  else
    CFLAGS="-g"
  fi
else
  if test "$GCC" = yes; then
    CFLAGS="-O2"
  else
    CFLAGS=
  fi
fi
{ echo "$as_me:$LINENO: checking for $CC option to accept ISO C89" >&5
echo $ECHO_N "checking for $CC option to accept ISO C89... $ECHO_C" >&6; }
if test "${ac_cv_prog_cc_c89+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_prog_cc_c89=no
ac_save_CC=$CC
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdarg.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
struct buf { int x; };
FILE * (*rcsopen) (struct buf *, struct stat *, int);
static char *e (p, i)
     char **p;
     int i;
{
  return p[i];
}
static char *f (char * (*g) (char **, int), char **p, ...)
{
  char *s;
  va_list v;
  va_start (v,p);
  s = g (p, va_arg (v,int));
  va_end (v);
  return s;
}

/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
   function prototypes and stuff, but not '\xHH' hex character constants.
   These don't provoke an error unfortunately, instead are silently treated
   as 'x'.  The following induces an error, until -std is added to get
   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
   array size at least.  It's necessary to write '\x00'==0 to get something
   that's true only with -std.  */
int osf4_cc_array ['\x00' == 0 ? 1 : -1];

/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
   inside strings and character constants.  */
#define FOO(x) 'x'
int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];

int test (int i, double x);
struct s1 {int (*f) (int a);};
struct s2 {int (*f) (double a);};
int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
int argc;
char **argv;
int
main ()
{
return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
  ;
  return 0;
}
_ACEOF
for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
do
  CC="$ac_save_CC $ac_arg"
  rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_cv_prog_cc_c89=$ac_arg
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5


fi

rm -f core conftest.err conftest.$ac_objext
  test "x$ac_cv_prog_cc_c89" != "xno" && break
done
rm -f conftest.$ac_ext
CC=$ac_save_CC

fi
# AC_CACHE_VAL
case "x$ac_cv_prog_cc_c89" in
  x)
    { echo "$as_me:$LINENO: result: none needed" >&5
echo "${ECHO_T}none needed" >&6; } ;;
  xno)
    { echo "$as_me:$LINENO: result: unsupported" >&5
echo "${ECHO_T}unsupported" >&6; } ;;
  *)
    CC="$CC $ac_cv_prog_cc_c89"
    { echo "$as_me:$LINENO: result: $ac_cv_prog_cc_c89" >&5
echo "${ECHO_T}$ac_cv_prog_cc_c89" >&6; } ;;
esac


ac_ext=c
ac_cpp='$CPP $CPPFLAGS'
ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_c_compiler_gnu

    ac_ext=c
ac_cpp='$CPP $CPPFLAGS'
ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_c_compiler_gnu
{ echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6; }
# On Suns, sometimes $CPP names a directory.
if test -n "$CPP" && test -d "$CPP"; then
  CPP=
fi
if test -z "$CPP"; then
  if test "${ac_cv_prog_CPP+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
      # Double quotes because CPP needs to be expanded
    for CPP in "$CC -E" "$CC -E -traditional-cpp" "/lib/cpp"
    do
      ac_preproc_ok=false
for ac_c_preproc_warn_flag in '' yes
do
  # Use a header file that comes with gcc, so configuring glibc
  # with a fresh cross-compiler works.
  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
  # <limits.h> exists even on freestanding compilers.
  # On the NeXT, cc -E runs the code through the compiler's parser,
  # not just through cpp. "Syntax error" is here to catch this case.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif
		     Syntax error
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  :
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  # Broken: fails on valid input.
continue
fi

rm -f conftest.err conftest.$ac_ext

  # OK, works on sane cases.  Now check whether nonexistent headers
  # can be detected and how.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <ac_nonexistent.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  # Broken: success on invalid input.
continue
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  # Passes both tests.
ac_preproc_ok=:
break
fi

rm -f conftest.err conftest.$ac_ext

done
# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
rm -f conftest.err conftest.$ac_ext
if $ac_preproc_ok; then
  break
fi

    done
    ac_cv_prog_CPP=$CPP

fi
  CPP=$ac_cv_prog_CPP
else
  ac_cv_prog_CPP=$CPP
fi
{ echo "$as_me:$LINENO: result: $CPP" >&5
echo "${ECHO_T}$CPP" >&6; }
ac_preproc_ok=false
for ac_c_preproc_warn_flag in '' yes
do
  # Use a header file that comes with gcc, so configuring glibc
  # with a fresh cross-compiler works.
  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
  # <limits.h> exists even on freestanding compilers.
  # On the NeXT, cc -E runs the code through the compiler's parser,
  # not just through cpp. "Syntax error" is here to catch this case.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif
		     Syntax error
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  :
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  # Broken: fails on valid input.
continue
fi

rm -f conftest.err conftest.$ac_ext

  # OK, works on sane cases.  Now check whether nonexistent headers
  # can be detected and how.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <ac_nonexistent.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  # Broken: success on invalid input.
continue
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  # Passes both tests.
ac_preproc_ok=:
break
fi

rm -f conftest.err conftest.$ac_ext

done
# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
rm -f conftest.err conftest.$ac_ext
if $ac_preproc_ok; then
  :
else
  { { echo "$as_me:$LINENO: error: C preprocessor \"$CPP\" fails sanity check
See \`config.log' for more details." >&5
echo "$as_me: error: C preprocessor \"$CPP\" fails sanity check
See \`config.log' for more details." >&2;}
   { (exit 1); exit 1; }; }
fi

ac_ext=c
ac_cpp='$CPP $CPPFLAGS'
ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
ac_compiler_gnu=$ac_cv_c_compiler_gnu


    # Find a good install program.  We prefer a C program (faster),
# so one script is as good as another.  But avoid the broken or
# incompatible versions:
# SysV /etc/install, /usr/sbin/install
# SunOS /usr/etc/install
# IRIX /sbin/install
# AIX /bin/install
# AmigaOS /C/install, which installs bootblocks on floppy discs
# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
# AFS /usr/afsws/bin/install, which mishandles nonexistent args
# SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
# OS/2's system install, which has a completely different semantic
# ./install, which can be erroneously created by make from ./install.sh.
{ echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6; }
if test -z "$INSTALL"; then
if test "${ac_cv_path_install+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  # Account for people who put trailing slashes in PATH elements.
case $as_dir/ in
  ./ | .// | /cC/* | \
  /etc/* | /usr/sbin/* | /usr/etc/* | /sbin/* | /usr/afsws/bin/* | \
  ?:\\/os2\\/install\\/* | ?:\\/OS2\\/INSTALL\\/* | \
  /usr/ucb/* ) ;;
  *)
    # OSF1 and SCO ODT 3.0 have their own names for install.
    # Don't use installbsd from OSF since it installs stuff as root
    # by default.
    for ac_prog in ginstall scoinst install; do
      for ac_exec_ext in '' $ac_executable_extensions; do
	if { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; }; then
	  if test $ac_prog = install &&
	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
	    # AIX install.  It has an incompatible calling convention.
	    :
	  elif test $ac_prog = install &&
	    grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
	    # program-specific install script used by HP pwplus--don't use.
	    :
	  else
	    ac_cv_path_install="$as_dir/$ac_prog$ac_exec_ext -c"
	    break 3
	  fi
	fi
      done
    done
    ;;
esac
done
IFS=$as_save_IFS


fi
  if test "${ac_cv_path_install+set}" = set; then
    INSTALL=$ac_cv_path_install
  else
    # As a last resort, use the slow shell script.  Don't cache a
    # value for INSTALL within a source directory, because that will
    # break other packages using the cache if that directory is
    # removed, or if the value is a relative name.
    INSTALL=$ac_install_sh
  fi
fi
{ echo "$as_me:$LINENO: result: $INSTALL" >&5
echo "${ECHO_T}$INSTALL" >&6; }

# Use test -z because SunOS4 sh mishandles braces in ${var-val}.
# It thinks the first close brace ends the variable substitution.
test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'

test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'

test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'


    #--------------------------------------------------------------------
    # Checks to see if the make program sets the $MAKE variable.
    #--------------------------------------------------------------------

    { echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6; }
set x ${MAKE-make}; ac_make=`echo "$2" | sed 's/+/p/g; s/[^a-zA-Z0-9_]/_/g'`
if { as_var=ac_cv_prog_make_${ac_make}_set; eval "test \"\${$as_var+set}\" = set"; }; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.make <<\_ACEOF
SHELL = /bin/sh
all:
	@echo '@@@%%%=$(MAKE)=@@@%%%'
_ACEOF
# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
case `${MAKE-make} -f conftest.make 2>/dev/null` in
  *@@@%%%=?*=@@@%%%*)
    eval ac_cv_prog_make_${ac_make}_set=yes;;
  *)
    eval ac_cv_prog_make_${ac_make}_set=no;;
esac
rm -f conftest.make
fi
if eval test \$ac_cv_prog_make_${ac_make}_set = yes; then
  { echo "$as_me:$LINENO: result: yes" >&5
echo "${ECHO_T}yes" >&6; }
  SET_MAKE=
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
  SET_MAKE="MAKE=${MAKE-make}"
fi


    #--------------------------------------------------------------------
    # Find ranlib
    #--------------------------------------------------------------------

    if test -n "$ac_tool_prefix"; then
  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
set dummy ${ac_tool_prefix}ranlib; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_RANLIB+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$RANLIB"; then
  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
RANLIB=$ac_cv_prog_RANLIB
if test -n "$RANLIB"; then
  { echo "$as_me:$LINENO: result: $RANLIB" >&5
echo "${ECHO_T}$RANLIB" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


fi
if test -z "$ac_cv_prog_RANLIB"; then
  ac_ct_RANLIB=$RANLIB
  # Extract the first word of "ranlib", so it can be a program name with args.
set dummy ranlib; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_ac_ct_RANLIB+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$ac_ct_RANLIB"; then
  ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_ac_ct_RANLIB="ranlib"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
if test -n "$ac_ct_RANLIB"; then
  { echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
echo "${ECHO_T}$ac_ct_RANLIB" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi

  if test "x$ac_ct_RANLIB" = x; then
    RANLIB=":"
  else
    case $cross_compiling:$ac_tool_warned in
yes:)
{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&5
echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
whose name does not start with the host triplet.  If you think this
configuration is useful to you, please write to autoconf@gnu.org." >&2;}
ac_tool_warned=yes ;;
esac
    RANLIB=$ac_ct_RANLIB
  fi
else
  RANLIB="$ac_cv_prog_RANLIB"
fi


    #--------------------------------------------------------------------
    # Determines the correct binary file extension (.o, .obj, .exe etc.)
    #--------------------------------------------------------------------






{ echo "$as_me:$LINENO: checking for grep that handles long lines and -e" >&5
echo $ECHO_N "checking for grep that handles long lines and -e... $ECHO_C" >&6; }
if test "${ac_cv_path_GREP+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  # Extract the first word of "grep ggrep" to use in msg output
if test -z "$GREP"; then
set dummy grep ggrep; ac_prog_name=$2
if test "${ac_cv_path_GREP+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_path_GREP_found=false
# Loop through the user's path and test for each of PROGNAME-LIST
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_prog in grep ggrep; do
  for ac_exec_ext in '' $ac_executable_extensions; do
    ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
    { test -f "$ac_path_GREP" && $as_test_x "$ac_path_GREP"; } || continue
    # Check for GNU ac_path_GREP and select it if it is found.
  # Check for GNU $ac_path_GREP
case `"$ac_path_GREP" --version 2>&1` in
*GNU*)
  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
*)
  ac_count=0
  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
  while :
  do
    cat "conftest.in" "conftest.in" >"conftest.tmp"
    mv "conftest.tmp" "conftest.in"
    cp "conftest.in" "conftest.nl"
    echo 'GREP' >> "conftest.nl"
    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
    ac_count=`expr $ac_count + 1`
    if test $ac_count -gt ${ac_path_GREP_max-0}; then
      # Best one so far, save it but keep looking for a better one
      ac_cv_path_GREP="$ac_path_GREP"
      ac_path_GREP_max=$ac_count
    fi
    # 10*(2^10) chars as input seems more than enough
    test $ac_count -gt 10 && break
  done
  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
esac


    $ac_path_GREP_found && break 3
  done
done

done
IFS=$as_save_IFS


fi

GREP="$ac_cv_path_GREP"
if test -z "$GREP"; then
  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
   { (exit 1); exit 1; }; }
fi

else
  ac_cv_path_GREP=$GREP
fi


fi
{ echo "$as_me:$LINENO: result: $ac_cv_path_GREP" >&5
echo "${ECHO_T}$ac_cv_path_GREP" >&6; }
 GREP="$ac_cv_path_GREP"


{ echo "$as_me:$LINENO: checking for egrep" >&5
echo $ECHO_N "checking for egrep... $ECHO_C" >&6; }
if test "${ac_cv_path_EGREP+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
   then ac_cv_path_EGREP="$GREP -E"
   else
     # Extract the first word of "egrep" to use in msg output
if test -z "$EGREP"; then
set dummy egrep; ac_prog_name=$2
if test "${ac_cv_path_EGREP+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_path_EGREP_found=false
# Loop through the user's path and test for each of PROGNAME-LIST
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_prog in egrep; do
  for ac_exec_ext in '' $ac_executable_extensions; do
    ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
    { test -f "$ac_path_EGREP" && $as_test_x "$ac_path_EGREP"; } || continue
    # Check for GNU ac_path_EGREP and select it if it is found.
  # Check for GNU $ac_path_EGREP
case `"$ac_path_EGREP" --version 2>&1` in
*GNU*)
  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
*)
  ac_count=0
  echo $ECHO_N "0123456789$ECHO_C" >"conftest.in"
  while :
  do
    cat "conftest.in" "conftest.in" >"conftest.tmp"
    mv "conftest.tmp" "conftest.in"
    cp "conftest.in" "conftest.nl"
    echo 'EGREP' >> "conftest.nl"
    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
    ac_count=`expr $ac_count + 1`
    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
      # Best one so far, save it but keep looking for a better one
      ac_cv_path_EGREP="$ac_path_EGREP"
      ac_path_EGREP_max=$ac_count
    fi
    # 10*(2^10) chars as input seems more than enough
    test $ac_count -gt 10 && break
  done
  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
esac


    $ac_path_EGREP_found && break 3
  done
done

done
IFS=$as_save_IFS


fi

EGREP="$ac_cv_path_EGREP"
if test -z "$EGREP"; then
  { { echo "$as_me:$LINENO: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&5
echo "$as_me: error: no acceptable $ac_prog_name could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" >&2;}
   { (exit 1); exit 1; }; }
fi

else
  ac_cv_path_EGREP=$EGREP
fi


   fi
fi
{ echo "$as_me:$LINENO: result: $ac_cv_path_EGREP" >&5
echo "${ECHO_T}$ac_cv_path_EGREP" >&6; }
 EGREP="$ac_cv_path_EGREP"


{ echo "$as_me:$LINENO: checking for ANSI C header files" >&5
echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6; }
if test "${ac_cv_header_stdc+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>
#include <stdarg.h>
#include <string.h>
#include <float.h>

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_cv_header_stdc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_header_stdc=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext

if test $ac_cv_header_stdc = yes; then
  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <string.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "memchr" >/dev/null 2>&1; then
  :
else
  ac_cv_header_stdc=no
fi
rm -f conftest*

fi

if test $ac_cv_header_stdc = yes; then
  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "free" >/dev/null 2>&1; then
  :
else
  ac_cv_header_stdc=no
fi
rm -f conftest*

fi

if test $ac_cv_header_stdc = yes; then
  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
  if test "$cross_compiling" = yes; then
  :
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <ctype.h>
#include <stdlib.h>
#if ((' ' & 0x0FF) == 0x020)
# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
#else
# define ISLOWER(c) \
		   (('a' <= (c) && (c) <= 'i') \
		     || ('j' <= (c) && (c) <= 'r') \
		     || ('s' <= (c) && (c) <= 'z'))
# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
#endif

#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
int
main ()
{
  int i;
  for (i = 0; i < 256; i++)
    if (XOR (islower (i), ISLOWER (i))
	|| toupper (i) != TOUPPER (i))
      return 2;
  return 0;
}
_ACEOF
rm -f conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
  { (case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_try") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; }; then
  :
else
  echo "$as_me: program exited with status $ac_status" >&5
echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

( exit $ac_status )
ac_cv_header_stdc=no
fi
rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
fi


fi
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
echo "${ECHO_T}$ac_cv_header_stdc" >&6; }
if test $ac_cv_header_stdc = yes; then

cat >>confdefs.h <<\_ACEOF
#define STDC_HEADERS 1
_ACEOF

fi

# On IRIX 5.3, sys/types and inttypes.h are conflicting.









for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
		  inttypes.h stdint.h unistd.h
do
as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
{ echo "$as_me:$LINENO: checking for $ac_header" >&5
echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default

#include <$ac_header>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  eval "$as_ac_Header=yes"
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	eval "$as_ac_Header=no"
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi
ac_res=`eval echo '${'$as_ac_Header'}'`
	       { echo "$as_me:$LINENO: result: $ac_res" >&5
echo "${ECHO_T}$ac_res" >&6; }
if test `eval echo '${'$as_ac_Header'}'` = yes; then
  cat >>confdefs.h <<_ACEOF
#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
_ACEOF

fi

done



    # Any macros that use the compiler (e.g. AC_TRY_COMPILE) have to go here.


    #------------------------------------------------------------------------
    # If we're using GCC, see if the compiler understands -pipe. If so, use it.
    # It makes compiling go faster.  (This is only a performance feature.)
    #------------------------------------------------------------------------

    if test -z "$no_pipe" -a -n "$GCC"; then
	{ echo "$as_me:$LINENO: checking if the compiler understands -pipe" >&5
echo $ECHO_N "checking if the compiler understands -pipe... $ECHO_C" >&6; }
if test "${tcl_cv_cc_pipe+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	    hold_cflags=$CFLAGS; CFLAGS="$CFLAGS -pipe"
	    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_cc_pipe=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_cc_pipe=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
	    CFLAGS=$hold_cflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_cc_pipe" >&5
echo "${ECHO_T}$tcl_cv_cc_pipe" >&6; }
	if test $tcl_cv_cc_pipe = yes; then
	    CFLAGS="$CFLAGS -pipe"
	fi
    fi

    #--------------------------------------------------------------------
    # Common compiler flag setup
    #--------------------------------------------------------------------

    { echo "$as_me:$LINENO: checking whether byte ordering is bigendian" >&5
echo $ECHO_N "checking whether byte ordering is bigendian... $ECHO_C" >&6; }
if test "${ac_cv_c_bigendian+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  # See if sys/param.h defines the BYTE_ORDER macro.
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/types.h>
#include <sys/param.h>

int
main ()
{
#if  ! (defined BYTE_ORDER && defined BIG_ENDIAN && defined LITTLE_ENDIAN \
	&& BYTE_ORDER && BIG_ENDIAN && LITTLE_ENDIAN)
 bogus endian macros
#endif

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  # It does; now see whether it defined to BIG_ENDIAN or not.
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/types.h>
#include <sys/param.h>

int
main ()
{
#if BYTE_ORDER != BIG_ENDIAN
 not big endian
#endif

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_cv_c_bigendian=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_c_bigendian=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	# It does not; compile a test program.
if test "$cross_compiling" = yes; then
  # try to guess the endianness by grepping values into an object file
  ac_cv_c_bigendian=unknown
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
short int ascii_mm[] = { 0x4249, 0x4765, 0x6E44, 0x6961, 0x6E53, 0x7953, 0 };
short int ascii_ii[] = { 0x694C, 0x5454, 0x656C, 0x6E45, 0x6944, 0x6E61, 0 };
void _ascii () { char *s = (char *) ascii_mm; s = (char *) ascii_ii; }
short int ebcdic_ii[] = { 0x89D3, 0xE3E3, 0x8593, 0x95C5, 0x89C4, 0x9581, 0 };
short int ebcdic_mm[] = { 0xC2C9, 0xC785, 0x95C4, 0x8981, 0x95E2, 0xA8E2, 0 };
void _ebcdic () { char *s = (char *) ebcdic_mm; s = (char *) ebcdic_ii; }
int
main ()
{
 _ascii (); _ebcdic ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  if grep BIGenDianSyS conftest.$ac_objext >/dev/null ; then
  ac_cv_c_bigendian=yes
fi
if grep LiTTleEnDian conftest.$ac_objext >/dev/null ; then
  if test "$ac_cv_c_bigendian" = unknown; then
    ac_cv_c_bigendian=no
  else
    # finding both strings is unlikely to happen, but who knows?
    ac_cv_c_bigendian=unknown
  fi
fi
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5


fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
int
main ()
{

  /* Are we little or big endian?  From Harbison&Steele.  */
  union
  {
    long int l;
    char c[sizeof (long int)];
  } u;
  u.l = 1;
  return u.c[sizeof (long int) - 1] == 1;

  ;
  return 0;
}
_ACEOF
rm -f conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
  { (case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_try") 2>&5
  ac_status=$?
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); }; }; then
  ac_cv_c_bigendian=no
else
  echo "$as_me: program exited with status $ac_status" >&5
echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

( exit $ac_status )
ac_cv_c_bigendian=yes
fi
rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
fi


fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_c_bigendian" >&5
echo "${ECHO_T}$ac_cv_c_bigendian" >&6; }
case $ac_cv_c_bigendian in
  yes)

cat >>confdefs.h <<\_ACEOF
#define WORDS_BIGENDIAN 1
_ACEOF
 ;;
  no)
     ;;
  *)
    { { echo "$as_me:$LINENO: error: unknown endianness
presetting ac_cv_c_bigendian=no (or yes) will help" >&5
echo "$as_me: error: unknown endianness
presetting ac_cv_c_bigendian=no (or yes) will help" >&2;}
   { (exit 1); exit 1; }; } ;;
esac

    if test "${TEA_PLATFORM}" = "unix" ; then

    #--------------------------------------------------------------------
    # On a few very rare systems, all of the libm.a stuff is
    # already in libc.a.  Set compiler flags accordingly.
    # Also, Linux requires the "ieee" library for math to work
    # right (and it must appear before "-lm").
    #--------------------------------------------------------------------

    { echo "$as_me:$LINENO: checking for sin" >&5
echo $ECHO_N "checking for sin... $ECHO_C" >&6; }
if test "${ac_cv_func_sin+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define sin to an innocuous variant, in case <limits.h> declares sin.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define sin innocuous_sin

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char sin (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef sin

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char sin ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_sin || defined __stub___sin
choke me
#endif

int
main ()
{
return sin ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_func_sin=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_func_sin=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_func_sin" >&5
echo "${ECHO_T}$ac_cv_func_sin" >&6; }
if test $ac_cv_func_sin = yes; then
  MATH_LIBS=""
else
  MATH_LIBS="-lm"
fi

    { echo "$as_me:$LINENO: checking for main in -lieee" >&5
echo $ECHO_N "checking for main in -lieee... $ECHO_C" >&6; }
if test "${ac_cv_lib_ieee_main+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lieee  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */


int
main ()
{
return main ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_ieee_main=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_ieee_main=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_ieee_main" >&5
echo "${ECHO_T}$ac_cv_lib_ieee_main" >&6; }
if test $ac_cv_lib_ieee_main = yes; then
  MATH_LIBS="-lieee $MATH_LIBS"
fi


    #--------------------------------------------------------------------
    # Interactive UNIX requires -linet instead of -lsocket, plus it
    # needs net/errno.h to define the socket-related error codes.
    #--------------------------------------------------------------------

    { echo "$as_me:$LINENO: checking for main in -linet" >&5
echo $ECHO_N "checking for main in -linet... $ECHO_C" >&6; }
if test "${ac_cv_lib_inet_main+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-linet  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */


int
main ()
{
return main ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_inet_main=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_inet_main=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_inet_main" >&5
echo "${ECHO_T}$ac_cv_lib_inet_main" >&6; }
if test $ac_cv_lib_inet_main = yes; then
  LIBS="$LIBS -linet"
fi

    if test "${ac_cv_header_net_errno_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for net/errno.h" >&5
echo $ECHO_N "checking for net/errno.h... $ECHO_C" >&6; }
if test "${ac_cv_header_net_errno_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_net_errno_h" >&5
echo "${ECHO_T}$ac_cv_header_net_errno_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking net/errno.h usability" >&5
echo $ECHO_N "checking net/errno.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <net/errno.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking net/errno.h presence" >&5
echo $ECHO_N "checking net/errno.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <net/errno.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: net/errno.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: net/errno.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: net/errno.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: net/errno.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: net/errno.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: net/errno.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: net/errno.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: net/errno.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: net/errno.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: net/errno.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: net/errno.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for net/errno.h" >&5
echo $ECHO_N "checking for net/errno.h... $ECHO_C" >&6; }
if test "${ac_cv_header_net_errno_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_net_errno_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_net_errno_h" >&5
echo "${ECHO_T}$ac_cv_header_net_errno_h" >&6; }

fi
if test $ac_cv_header_net_errno_h = yes; then


cat >>confdefs.h <<\_ACEOF
#define HAVE_NET_ERRNO_H 1
_ACEOF

fi



    #--------------------------------------------------------------------
    #	Check for the existence of the -lsocket and -lnsl libraries.
    #	The order here is important, so that they end up in the right
    #	order in the command line generated by make.  Here are some
    #	special considerations:
    #	1. Use "connect" and "accept" to check for -lsocket, and
    #	   "gethostbyname" to check for -lnsl.
    #	2. Use each function name only once:  can't redo a check because
    #	   autoconf caches the results of the last check and won't redo it.
    #	3. Use -lnsl and -lsocket only if they supply procedures that
    #	   aren't already present in the normal libraries.  This is because
    #	   IRIX 5.2 has libraries, but they aren't needed and they're
    #	   bogus:  they goof up name resolution if used.
    #	4. On some SVR4 systems, can't use -lsocket without -lnsl too.
    #	   To get around this problem, check for both libraries together
    #	   if -lsocket doesn't work by itself.
    #--------------------------------------------------------------------

    tcl_checkBoth=0
    { echo "$as_me:$LINENO: checking for connect" >&5
echo $ECHO_N "checking for connect... $ECHO_C" >&6; }
if test "${ac_cv_func_connect+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define connect to an innocuous variant, in case <limits.h> declares connect.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define connect innocuous_connect

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char connect (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef connect

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char connect ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_connect || defined __stub___connect
choke me
#endif

int
main ()
{
return connect ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_func_connect=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_func_connect=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_func_connect" >&5
echo "${ECHO_T}$ac_cv_func_connect" >&6; }
if test $ac_cv_func_connect = yes; then
  tcl_checkSocket=0
else
  tcl_checkSocket=1
fi

    if test "$tcl_checkSocket" = 1; then
	{ echo "$as_me:$LINENO: checking for setsockopt" >&5
echo $ECHO_N "checking for setsockopt... $ECHO_C" >&6; }
if test "${ac_cv_func_setsockopt+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define setsockopt to an innocuous variant, in case <limits.h> declares setsockopt.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define setsockopt innocuous_setsockopt

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char setsockopt (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef setsockopt

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char setsockopt ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_setsockopt || defined __stub___setsockopt
choke me
#endif

int
main ()
{
return setsockopt ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_func_setsockopt=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_func_setsockopt=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_func_setsockopt" >&5
echo "${ECHO_T}$ac_cv_func_setsockopt" >&6; }
if test $ac_cv_func_setsockopt = yes; then
  :
else
  { echo "$as_me:$LINENO: checking for setsockopt in -lsocket" >&5
echo $ECHO_N "checking for setsockopt in -lsocket... $ECHO_C" >&6; }
if test "${ac_cv_lib_socket_setsockopt+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lsocket  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char setsockopt ();
int
main ()
{
return setsockopt ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_socket_setsockopt=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_socket_setsockopt=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_socket_setsockopt" >&5
echo "${ECHO_T}$ac_cv_lib_socket_setsockopt" >&6; }
if test $ac_cv_lib_socket_setsockopt = yes; then
  LIBS="$LIBS -lsocket"
else
  tcl_checkBoth=1
fi

fi

    fi
    if test "$tcl_checkBoth" = 1; then
	tk_oldLibs=$LIBS
	LIBS="$LIBS -lsocket -lnsl"
	{ echo "$as_me:$LINENO: checking for accept" >&5
echo $ECHO_N "checking for accept... $ECHO_C" >&6; }
if test "${ac_cv_func_accept+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define accept to an innocuous variant, in case <limits.h> declares accept.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define accept innocuous_accept

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char accept (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef accept

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char accept ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_accept || defined __stub___accept
choke me
#endif

int
main ()
{
return accept ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_func_accept=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_func_accept=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_func_accept" >&5
echo "${ECHO_T}$ac_cv_func_accept" >&6; }
if test $ac_cv_func_accept = yes; then
  tcl_checkNsl=0
else
  LIBS=$tk_oldLibs
fi

    fi
    { echo "$as_me:$LINENO: checking for gethostbyname" >&5
echo $ECHO_N "checking for gethostbyname... $ECHO_C" >&6; }
if test "${ac_cv_func_gethostbyname+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define gethostbyname to an innocuous variant, in case <limits.h> declares gethostbyname.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define gethostbyname innocuous_gethostbyname

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char gethostbyname (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef gethostbyname

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char gethostbyname ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_gethostbyname || defined __stub___gethostbyname
choke me
#endif

int
main ()
{
return gethostbyname ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_func_gethostbyname=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_func_gethostbyname=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $ac_cv_func_gethostbyname" >&5
echo "${ECHO_T}$ac_cv_func_gethostbyname" >&6; }
if test $ac_cv_func_gethostbyname = yes; then
  :
else
  { echo "$as_me:$LINENO: checking for gethostbyname in -lnsl" >&5
echo $ECHO_N "checking for gethostbyname in -lnsl... $ECHO_C" >&6; }
if test "${ac_cv_lib_nsl_gethostbyname+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lnsl  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char gethostbyname ();
int
main ()
{
return gethostbyname ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_nsl_gethostbyname=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_nsl_gethostbyname=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_nsl_gethostbyname" >&5
echo "${ECHO_T}$ac_cv_lib_nsl_gethostbyname" >&6; }
if test $ac_cv_lib_nsl_gethostbyname = yes; then
  LIBS="$LIBS -lnsl"
fi

fi


    # TEA specific: Don't perform the eval of the libraries here because
    # DL_LIBS won't be set until we call TEA_CONFIG_CFLAGS

    TCL_LIBS='${DL_LIBS} ${LIBS} ${MATH_LIBS}'




    { echo "$as_me:$LINENO: checking dirent.h" >&5
echo $ECHO_N "checking dirent.h... $ECHO_C" >&6; }
if test "${tcl_cv_dirent_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/types.h>
#include <dirent.h>
int
main ()
{

#ifndef _POSIX_SOURCE
#   ifdef __Lynx__
	/*
	 * Generate compilation error to make the test fail:  Lynx headers
	 * are only valid if really in the POSIX environment.
	 */

	missing_procedure();
#   endif
#endif
DIR *d;
struct dirent *entryPtr;
char *p;
d = opendir("foobar");
entryPtr = readdir(d);
p = entryPtr->d_name;
closedir(d);

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_dirent_h=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_dirent_h=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_dirent_h" >&5
echo "${ECHO_T}$tcl_cv_dirent_h" >&6; }

    if test $tcl_cv_dirent_h = no; then

cat >>confdefs.h <<\_ACEOF
#define NO_DIRENT_H 1
_ACEOF

    fi

    # TEA specific:
    if test "${ac_cv_header_errno_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for errno.h" >&5
echo $ECHO_N "checking for errno.h... $ECHO_C" >&6; }
if test "${ac_cv_header_errno_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_errno_h" >&5
echo "${ECHO_T}$ac_cv_header_errno_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking errno.h usability" >&5
echo $ECHO_N "checking errno.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <errno.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking errno.h presence" >&5
echo $ECHO_N "checking errno.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <errno.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: errno.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: errno.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: errno.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: errno.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: errno.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: errno.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: errno.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: errno.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: errno.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: errno.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: errno.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for errno.h" >&5
echo $ECHO_N "checking for errno.h... $ECHO_C" >&6; }
if test "${ac_cv_header_errno_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_errno_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_errno_h" >&5
echo "${ECHO_T}$ac_cv_header_errno_h" >&6; }

fi
if test $ac_cv_header_errno_h = yes; then
  :
else

cat >>confdefs.h <<\_ACEOF
#define NO_ERRNO_H 1
_ACEOF

fi


    if test "${ac_cv_header_float_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for float.h" >&5
echo $ECHO_N "checking for float.h... $ECHO_C" >&6; }
if test "${ac_cv_header_float_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_float_h" >&5
echo "${ECHO_T}$ac_cv_header_float_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking float.h usability" >&5
echo $ECHO_N "checking float.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <float.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking float.h presence" >&5
echo $ECHO_N "checking float.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <float.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: float.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: float.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: float.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: float.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: float.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: float.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: float.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: float.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: float.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: float.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: float.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for float.h" >&5
echo $ECHO_N "checking for float.h... $ECHO_C" >&6; }
if test "${ac_cv_header_float_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_float_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_float_h" >&5
echo "${ECHO_T}$ac_cv_header_float_h" >&6; }

fi
if test $ac_cv_header_float_h = yes; then
  :
else

cat >>confdefs.h <<\_ACEOF
#define NO_FLOAT_H 1
_ACEOF

fi


    if test "${ac_cv_header_values_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for values.h" >&5
echo $ECHO_N "checking for values.h... $ECHO_C" >&6; }
if test "${ac_cv_header_values_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_values_h" >&5
echo "${ECHO_T}$ac_cv_header_values_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking values.h usability" >&5
echo $ECHO_N "checking values.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <values.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking values.h presence" >&5
echo $ECHO_N "checking values.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <values.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: values.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: values.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: values.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: values.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: values.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: values.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: values.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: values.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: values.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: values.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: values.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for values.h" >&5
echo $ECHO_N "checking for values.h... $ECHO_C" >&6; }
if test "${ac_cv_header_values_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_values_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_values_h" >&5
echo "${ECHO_T}$ac_cv_header_values_h" >&6; }

fi
if test $ac_cv_header_values_h = yes; then
  :
else

cat >>confdefs.h <<\_ACEOF
#define NO_VALUES_H 1
_ACEOF

fi


    if test "${ac_cv_header_limits_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for limits.h" >&5
echo $ECHO_N "checking for limits.h... $ECHO_C" >&6; }
if test "${ac_cv_header_limits_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_limits_h" >&5
echo "${ECHO_T}$ac_cv_header_limits_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking limits.h usability" >&5
echo $ECHO_N "checking limits.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <limits.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking limits.h presence" >&5
echo $ECHO_N "checking limits.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <limits.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: limits.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: limits.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: limits.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: limits.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: limits.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: limits.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: limits.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: limits.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: limits.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: limits.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: limits.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for limits.h" >&5
echo $ECHO_N "checking for limits.h... $ECHO_C" >&6; }
if test "${ac_cv_header_limits_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_limits_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_limits_h" >&5
echo "${ECHO_T}$ac_cv_header_limits_h" >&6; }

fi
if test $ac_cv_header_limits_h = yes; then

cat >>confdefs.h <<\_ACEOF
#define HAVE_LIMITS_H 1
_ACEOF

else

cat >>confdefs.h <<\_ACEOF
#define NO_LIMITS_H 1
_ACEOF

fi


    if test "${ac_cv_header_stdlib_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for stdlib.h" >&5
echo $ECHO_N "checking for stdlib.h... $ECHO_C" >&6; }
if test "${ac_cv_header_stdlib_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_stdlib_h" >&5
echo "${ECHO_T}$ac_cv_header_stdlib_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking stdlib.h usability" >&5
echo $ECHO_N "checking stdlib.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <stdlib.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking stdlib.h presence" >&5
echo $ECHO_N "checking stdlib.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: stdlib.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: stdlib.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: stdlib.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: stdlib.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: stdlib.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: stdlib.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: stdlib.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: stdlib.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: stdlib.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: stdlib.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: stdlib.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for stdlib.h" >&5
echo $ECHO_N "checking for stdlib.h... $ECHO_C" >&6; }
if test "${ac_cv_header_stdlib_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_stdlib_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_stdlib_h" >&5
echo "${ECHO_T}$ac_cv_header_stdlib_h" >&6; }

fi
if test $ac_cv_header_stdlib_h = yes; then
  tcl_ok=1
else
  tcl_ok=0
fi


    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "strtol" >/dev/null 2>&1; then
  :
else
  tcl_ok=0
fi
rm -f conftest*

    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "strtoul" >/dev/null 2>&1; then
  :
else
  tcl_ok=0
fi
rm -f conftest*

    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "strtod" >/dev/null 2>&1; then
  :
else
  tcl_ok=0
fi
rm -f conftest*

    if test $tcl_ok = 0; then

cat >>confdefs.h <<\_ACEOF
#define NO_STDLIB_H 1
_ACEOF

    fi
    if test "${ac_cv_header_string_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for string.h" >&5
echo $ECHO_N "checking for string.h... $ECHO_C" >&6; }
if test "${ac_cv_header_string_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_string_h" >&5
echo "${ECHO_T}$ac_cv_header_string_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking string.h usability" >&5
echo $ECHO_N "checking string.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <string.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking string.h presence" >&5
echo $ECHO_N "checking string.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <string.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: string.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: string.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: string.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: string.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: string.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: string.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: string.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: string.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: string.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: string.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: string.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for string.h" >&5
echo $ECHO_N "checking for string.h... $ECHO_C" >&6; }
if test "${ac_cv_header_string_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_string_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_string_h" >&5
echo "${ECHO_T}$ac_cv_header_string_h" >&6; }

fi
if test $ac_cv_header_string_h = yes; then
  tcl_ok=1
else
  tcl_ok=0
fi


    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <string.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "strstr" >/dev/null 2>&1; then
  :
else
  tcl_ok=0
fi
rm -f conftest*

    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <string.h>

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "strerror" >/dev/null 2>&1; then
  :
else
  tcl_ok=0
fi
rm -f conftest*


    # See also memmove check below for a place where NO_STRING_H can be
    # set and why.

    if test $tcl_ok = 0; then

cat >>confdefs.h <<\_ACEOF
#define NO_STRING_H 1
_ACEOF

    fi

    if test "${ac_cv_header_sys_wait_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for sys/wait.h" >&5
echo $ECHO_N "checking for sys/wait.h... $ECHO_C" >&6; }
if test "${ac_cv_header_sys_wait_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_sys_wait_h" >&5
echo "${ECHO_T}$ac_cv_header_sys_wait_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking sys/wait.h usability" >&5
echo $ECHO_N "checking sys/wait.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <sys/wait.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking sys/wait.h presence" >&5
echo $ECHO_N "checking sys/wait.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/wait.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: sys/wait.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: sys/wait.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: sys/wait.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: sys/wait.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: sys/wait.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: sys/wait.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: sys/wait.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: sys/wait.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: sys/wait.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for sys/wait.h" >&5
echo $ECHO_N "checking for sys/wait.h... $ECHO_C" >&6; }
if test "${ac_cv_header_sys_wait_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_sys_wait_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_sys_wait_h" >&5
echo "${ECHO_T}$ac_cv_header_sys_wait_h" >&6; }

fi
if test $ac_cv_header_sys_wait_h = yes; then
  :
else

cat >>confdefs.h <<\_ACEOF
#define NO_SYS_WAIT_H 1
_ACEOF

fi


    if test "${ac_cv_header_dlfcn_h+set}" = set; then
  { echo "$as_me:$LINENO: checking for dlfcn.h" >&5
echo $ECHO_N "checking for dlfcn.h... $ECHO_C" >&6; }
if test "${ac_cv_header_dlfcn_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_dlfcn_h" >&5
echo "${ECHO_T}$ac_cv_header_dlfcn_h" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking dlfcn.h usability" >&5
echo $ECHO_N "checking dlfcn.h usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <dlfcn.h>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking dlfcn.h presence" >&5
echo $ECHO_N "checking dlfcn.h presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <dlfcn.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: dlfcn.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: dlfcn.h: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: present but cannot be compiled" >&5
echo "$as_me: WARNING: dlfcn.h: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: dlfcn.h:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: see the Autoconf documentation" >&5
echo "$as_me: WARNING: dlfcn.h: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: dlfcn.h:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: dlfcn.h: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: dlfcn.h: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: dlfcn.h: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for dlfcn.h" >&5
echo $ECHO_N "checking for dlfcn.h... $ECHO_C" >&6; }
if test "${ac_cv_header_dlfcn_h+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_cv_header_dlfcn_h=$ac_header_preproc
fi
{ echo "$as_me:$LINENO: result: $ac_cv_header_dlfcn_h" >&5
echo "${ECHO_T}$ac_cv_header_dlfcn_h" >&6; }

fi
if test $ac_cv_header_dlfcn_h = yes; then
  :
else

cat >>confdefs.h <<\_ACEOF
#define NO_DLFCN_H 1
_ACEOF

fi



    # OS/390 lacks sys/param.h (and doesn't need it, by chance).

for ac_header in sys/param.h
do
as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
  { echo "$as_me:$LINENO: checking for $ac_header" >&5
echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
fi
ac_res=`eval echo '${'$as_ac_Header'}'`
	       { echo "$as_me:$LINENO: result: $ac_res" >&5
echo "${ECHO_T}$ac_res" >&6; }
else
  # Is the header compilable?
{ echo "$as_me:$LINENO: checking $ac_header usability" >&5
echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
$ac_includes_default
#include <$ac_header>
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  ac_header_compiler=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_header_compiler=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
echo "${ECHO_T}$ac_header_compiler" >&6; }

# Is the header present?
{ echo "$as_me:$LINENO: checking $ac_header presence" >&5
echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6; }
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <$ac_header>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  ac_header_preproc=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  ac_header_preproc=no
fi

rm -f conftest.err conftest.$ac_ext
{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
echo "${ECHO_T}$ac_header_preproc" >&6; }

# So?  What about this header?
case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
  yes:no: )
    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
    ac_header_preproc=yes
    ;;
  no:yes:* )
    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}

    ;;
esac
{ echo "$as_me:$LINENO: checking for $ac_header" >&5
echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6; }
if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  eval "$as_ac_Header=\$ac_header_preproc"
fi
ac_res=`eval echo '${'$as_ac_Header'}'`
	       { echo "$as_me:$LINENO: result: $ac_res" >&5
echo "${ECHO_T}$ac_res" >&6; }

fi
if test `eval echo '${'$as_ac_Header'}'` = yes; then
  cat >>confdefs.h <<_ACEOF
#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
_ACEOF

fi

done


	# Let the user call this, because if it triggers, they will
	# need a compat/strtod.c that is correct.  Users can also
	# use Tcl_GetDouble(FromObj) instead.
	#TEA_BUGGY_STRTOD
    fi


#-----------------------------------------------------------------------
# __CHANGE__
# Specify the C source files to compile in TEA_ADD_SOURCES,
# public headers that need to be installed in TEA_ADD_HEADERS,
# stub library C source files to compile in TEA_ADD_STUB_SOURCES,
# and runtime Tcl library files in TEA_ADD_TCL_SOURCES.
# This defines PKG(_STUB)_SOURCES, PKG(_STUB)_OBJECTS, PKG_HEADERS
# and PKG_TCL_SOURCES.
#-----------------------------------------------------------------------


    { echo "$as_me:$LINENO: checking whether to link with stubs library" >&5
echo $ECHO_N "checking whether to link with stubs library... $ECHO_C" >&6; }
    # Check whether --enable-stubs was given.
if test "${enable_stubs+set}" = set; then
  enableval=$enable_stubs; tcl_ok=$enableval
else
  tcl_ok=yes
fi


    if test "${enable_stubs+set}" = set; then
	enableval="$enable_stubs"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" ; then
	{ echo "$as_me:$LINENO: result: stubs" >&5
echo "${ECHO_T}stubs" >&6; }
	USE_STUBS=1
    else
	{ echo "$as_me:$LINENO: result: no stubs" >&5
echo "${ECHO_T}no stubs" >&6; }
	USE_STUBS=0
    fi



    vars="togl.c toglProcAddr.c toglStubInit.c"
    for i in $vars; do
	case $i in
	    \$*)
		# allow $-var names
		PKG_SOURCES="$PKG_SOURCES $i"
		PKG_OBJECTS="$PKG_OBJECTS $i"
		;;
	    *)
		# check for existence - allows for generic/win/unix VPATH
		# To add more dirs here (like 'src'), you have to update VPATH
		# in Makefile.in as well
		if test ! -f "${srcdir}/$i" -a ! -f "${srcdir}/generic/$i" \
		    -a ! -f "${srcdir}/win/$i" -a ! -f "${srcdir}/unix/$i" \
		    ; then
		    { { echo "$as_me:$LINENO: error: could not find source file '$i'" >&5
echo "$as_me: error: could not find source file '$i'" >&2;}
   { (exit 1); exit 1; }; }
		fi
		PKG_SOURCES="$PKG_SOURCES $i"
		# this assumes it is in a VPATH dir
		i=`basename $i`
		# handle user calling this before or after TEA_SETUP_COMPILER
		if test x"${OBJEXT}" != x ; then
		    j="`echo $i | sed -e 's/\.[^.]*$//'`.${OBJEXT}"
		else
		    j="`echo $i | sed -e 's/\.[^.]*$//'`.\${OBJEXT}"
		fi
		PKG_OBJECTS="$PKG_OBJECTS $j"
		;;
	esac
    done



# togl_ws.h is added in Makefile.in because it is generated

    vars="togl.h toglDecls.h"
    for i in $vars; do
	# check for existence, be strict because it is installed
	if test ! -f "${srcdir}/$i" ; then
	    { { echo "$as_me:$LINENO: error: could not find header file '${srcdir}/$i'" >&5
echo "$as_me: error: could not find header file '${srcdir}/$i'" >&2;}
   { (exit 1); exit 1; }; }
	fi
	PKG_HEADERS="$PKG_HEADERS $i"
    done



    vars=""
    for i in $vars; do
	PKG_INCLUDES="$PKG_INCLUDES $i"
    done



    vars=""
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done



    PKG_CFLAGS="$PKG_CFLAGS "


if test "${USE_STUBS}" = "1" ; then

    vars="toglStubLib.c"
    for i in $vars; do
	# check for existence - allows for generic/win/unix VPATH
	if test ! -f "${srcdir}/$i" -a ! -f "${srcdir}/generic/$i" \
	    -a ! -f "${srcdir}/win/$i" -a ! -f "${srcdir}/unix/$i" \
	    ; then
	    { { echo "$as_me:$LINENO: error: could not find stub source file '$i'" >&5
echo "$as_me: error: could not find stub source file '$i'" >&2;}
   { (exit 1); exit 1; }; }
	fi
	PKG_STUB_SOURCES="$PKG_STUB_SOURCES $i"
	# this assumes it is in a VPATH dir
	i=`basename $i`
	# handle user calling this before or after TEA_SETUP_COMPILER
	if test x"${OBJEXT}" != x ; then
	    j="`echo $i | sed -e 's/\.[^.]*$//'`.${OBJEXT}"
	else
	    j="`echo $i | sed -e 's/\.[^.]*$//'`.\${OBJEXT}"
	fi
	PKG_STUB_OBJECTS="$PKG_STUB_OBJECTS $j"
    done



fi

    vars=""
    for i in $vars; do
	# check for existence, be strict because it is installed
	if test ! -f "${srcdir}/$i" ; then
	    { { echo "$as_me:$LINENO: error: could not find tcl source file '${srcdir}/$i'" >&5
echo "$as_me: error: could not find tcl source file '${srcdir}/$i'" >&2;}
   { (exit 1); exit 1; }; }
	fi
	PKG_TCL_SOURCES="$PKG_TCL_SOURCES $i"
    done



#--------------------------------------------------------------------
# __CHANGE__
# A few miscellaneous platform-specific items:
#
# Define a special symbol for Windows (BUILD_sample in this case) so
# that we create the export library with the dll.
#
# Windows creates a few extra files that need to be cleaned up.
# You can add more files to clean if your extension creates any extra
# files.
#
# TEA_ADD_* any platform specific compiler/build info here.
#--------------------------------------------------------------------

if test "${TEA_PLATFORM}" = "windows" ; then

cat >>confdefs.h <<\_ACEOF
#define BUILD_togl 1
_ACEOF

    CLEANFILES="*.lib *.dll *.exp *.ilk *.pdb vc*.pch"
    if test "$GCC" != "yes" ; then

    vars="StereoI/StereoI.lib"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done


    fi
    #TEA_ADD_SOURCES([win/winFile.c])
    #TEA_ADD_INCLUDES([-I\"$(${CYGPATH} ${srcdir}/win)\"])
else
    CLEANFILES="so_locations"
    #TEA_ADD_SOURCES([unix/unixFile.c])
    #TEA_ADD_LIBS([-lsuperfly])
fi


#--------------------------------------------------------------------
# __CHANGE__
# Choose which headers you need.  Extension authors should try very
# hard to only rely on the Tcl public header files.  Internal headers
# contain private data structures and are subject to change without
# notice.
# This MUST be called after TEA_LOAD_TCLCONFIG / TEA_LOAD_TKCONFIG
#--------------------------------------------------------------------

# find autostereo header, lib, and daemon

# Check whether --with-autostereo was given.
if test "${with_autostereo+set}" = set; then
  withval=$with_autostereo; with_autostereo=${withval}
fi


# Check whether --with-autostereod was given.
if test "${with_autostereod+set}" = set; then
  withval=$with_autostereod; with_autostereod=${withval}
fi



{ echo "$as_me:$LINENO: checking for autostereo directory" >&5
echo $ECHO_N "checking for autostereo directory... $ECHO_C" >&6; }
if test x"${with_autostereo}" != x ; then
	if test -f "${with_autostereo}/lib/autostereo.h" ; then
		with_autostereo=`(cd ${with_autostereo}; pwd)`

    vars="-I${with_autostereo}/lib"
    for i in $vars; do
	PKG_INCLUDES="$PKG_INCLUDES $i"
    done



    vars="-L${with_autostereo}/lib -lautostereo"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done



cat >>confdefs.h <<_ACEOF
#define HAVE_AUTOSTEREO 1
_ACEOF

	else
		{ { echo "$as_me:$LINENO: error: ${with_autostereo} directory doesn't contain lib/autostereo.h" >&5
echo "$as_me: error: ${with_autostereo} directory doesn't contain lib/autostereo.h" >&2;}
   { (exit 1); exit 1; }; }
	fi
fi

# Extract the first word of "autostereod", so it can be a program name with args.
set dummy autostereod; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_path_AUTOSTEREOD+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  case $AUTOSTEREOD in
  [\\/]* | ?:[\\/]*)
  ac_cv_path_AUTOSTEREOD="$AUTOSTEREOD" # Let the user override the test with a path.
  ;;
  *)
  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
as_dummy="`eval \"echo $sbindir\"`:$PATH:/sbin:/usr/sbin"
for as_dir in $as_dummy
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_path_AUTOSTEREOD="$as_dir/$ac_word$ac_exec_ext"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

  ;;
esac
fi
AUTOSTEREOD=$ac_cv_path_AUTOSTEREOD
if test -n "$AUTOSTEREOD"; then
  { echo "$as_me:$LINENO: result: $AUTOSTEREOD" >&5
echo "${ECHO_T}$AUTOSTEREOD" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi




# Choose OpenGL platform
case "${TEA_WINDOWINGSYSTEM}" in
	aqua)
		TOGL_WINDOWINGSYSTEM=TOGL_AGL


    vars="-framework AGL -framework OpenGL -framework ApplicationServices"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done


		# libGLU is implicit in OpenGL framework
		LIBGLU=
		;;
	x11)
		TOGL_WINDOWINGSYSTEM=TOGL_X11


    vars="-lGL -lXmu"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done


		LIBGLU=-lGLU
		;;
	win32)
		TOGL_WINDOWINGSYSTEM=TOGL_WGL


    vars="opengl32.lib user32.lib gdi32.lib"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done


		if test "$GCC" = "yes" ; then
			LIBGLU=-lglu32
		else
			# assume Microsoft compiler
			LIBGLU=glu32.lib

    PKG_CFLAGS="$PKG_CFLAGS -TP"


		fi
		;;
	*)
		{ { echo "$as_me:$LINENO: error: Unsupported windowing system: ${TEA_WINDOWINGSYSTEM}" >&5
echo "$as_me: error: Unsupported windowing system: ${TEA_WINDOWINGSYSTEM}" >&2;}
   { (exit 1); exit 1; }; }
		;;
esac



# find Tcl, Tk, and X11 headers
#TEA_PUBLIC_TCL_HEADERS

    { echo "$as_me:$LINENO: checking for Tcl private include files" >&5
echo $ECHO_N "checking for Tcl private include files... $ECHO_C" >&6; }

    TCL_SRC_DIR_NATIVE=`${CYGPATH} ${TCL_SRC_DIR}`
    TCL_TOP_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}\"
    TCL_GENERIC_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/generic\"
    TCL_UNIX_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/unix\"
    TCL_WIN_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/win\"
    TCL_BMAP_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/bitmaps\"
    TCL_TOOL_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/tools\"
    TCL_COMPAT_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/compat\"

    if test "${TEA_PLATFORM}" = "windows"; then
	TCL_PLATFORM_DIR_NATIVE=${TCL_WIN_DIR_NATIVE}
    else
	TCL_PLATFORM_DIR_NATIVE=${TCL_UNIX_DIR_NATIVE}
    fi
    # We want to ensure these are substituted so as not to require
    # any *_NATIVE vars be defined in the Makefile
    TCL_INCLUDES="-I${TCL_GENERIC_DIR_NATIVE} -I${TCL_PLATFORM_DIR_NATIVE}"
    if test "`uname -s`" = "Darwin"; then
        # If Tcl was built as a framework, attempt to use
        # the framework's Headers and PrivateHeaders directories
        case ${TCL_DEFS} in
	    *TCL_FRAMEWORK*)
	        if test -d "${TCL_BIN_DIR}/Headers" -a -d "${TCL_BIN_DIR}/PrivateHeaders"; then
	        TCL_INCLUDES="-I\"${TCL_BIN_DIR}/Headers\" -I\"${TCL_BIN_DIR}/PrivateHeaders\" ${TCL_INCLUDES}"; else
	        TCL_INCLUDES="${TCL_INCLUDES} ${TCL_INCLUDE_SPEC} `echo "${TCL_INCLUDE_SPEC}" | sed -e 's/Headers/PrivateHeaders/'`"; fi
	        ;;
	esac
    else
	if test ! -f "${TCL_SRC_DIR}/generic/tclInt.h" ; then
	    { { echo "$as_me:$LINENO: error: Cannot find private header tclInt.h in ${TCL_SRC_DIR}" >&5
echo "$as_me: error: Cannot find private header tclInt.h in ${TCL_SRC_DIR}" >&2;}
   { (exit 1); exit 1; }; }
	fi
    fi











    { echo "$as_me:$LINENO: result: Using srcdir found in tclConfig.sh: ${TCL_SRC_DIR}" >&5
echo "${ECHO_T}Using srcdir found in tclConfig.sh: ${TCL_SRC_DIR}" >&6; }


#TEA_PUBLIC_TK_HEADERS

    { echo "$as_me:$LINENO: checking for Tk private include files" >&5
echo $ECHO_N "checking for Tk private include files... $ECHO_C" >&6; }

    TK_SRC_DIR_NATIVE=`${CYGPATH} ${TK_SRC_DIR}`
    TK_TOP_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}\"
    TK_UNIX_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/unix\"
    TK_WIN_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/win\"
    TK_GENERIC_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/generic\"
    TK_XLIB_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/xlib\"
    if test "${TEA_PLATFORM}" = "windows"; then
	TK_PLATFORM_DIR_NATIVE=${TK_WIN_DIR_NATIVE}
    else
	TK_PLATFORM_DIR_NATIVE=${TK_UNIX_DIR_NATIVE}
    fi
    # We want to ensure these are substituted so as not to require
    # any *_NATIVE vars be defined in the Makefile
    TK_INCLUDES="-I${TK_GENERIC_DIR_NATIVE} -I${TK_PLATFORM_DIR_NATIVE}"
    # Detect and add ttk subdir
    if test -d ${TK_SRC_DIR_NATIVE}/generic/ttk; then
	TK_INCLUDES="${TK_INCLUDES} -I\"${TK_SRC_DIR_NATIVE}/generic/ttk\""
    fi
    if test "${TEA_WINDOWINGSYSTEM}" = "win32" \
	-o "${TEA_WINDOWINGSYSTEM}" = "aqua"; then
	TK_INCLUDES="${TK_INCLUDES} -I${TK_XLIB_DIR_NATIVE}"
    fi
    if test "${TEA_WINDOWINGSYSTEM}" = "aqua"; then
	TK_INCLUDES="${TK_INCLUDES} -I${TK_SRC_DIR_NATIVE}/macosx"
    fi
    if test "`uname -s`" = "Darwin"; then
        # If Tk was built as a framework, attempt to use
        # the framework's Headers and PrivateHeaders directories
        case ${TK_DEFS} in
	    *TK_FRAMEWORK*)
	        if test -d "${TK_BIN_DIR}/Headers" -a -d "${TK_BIN_DIR}/PrivateHeaders"; then
	        TK_INCLUDES="-I\"${TK_BIN_DIR}/Headers\" -I\"${TK_BIN_DIR}/PrivateHeaders\" ${TK_INCLUDES}"; fi
	        ;;
	esac
    else
	if test ! -f "${TK_SRC_DIR}/generic/tkInt.h" ; then
	    { { echo "$as_me:$LINENO: error: Cannot find private header tkInt.h in ${TK_SRC_DIR}" >&5
echo "$as_me: error: Cannot find private header tkInt.h in ${TK_SRC_DIR}" >&2;}
   { (exit 1); exit 1; }; }
	fi
    fi









    { echo "$as_me:$LINENO: result: Using srcdir found in tkConfig.sh: ${TK_SRC_DIR}" >&5
echo "${ECHO_T}Using srcdir found in tkConfig.sh: ${TK_SRC_DIR}" >&6; }


    if test "${TEA_WINDOWINGSYSTEM}" = "x11" ; then

    { echo "$as_me:$LINENO: checking for X" >&5
echo $ECHO_N "checking for X... $ECHO_C" >&6; }


# Check whether --with-x was given.
if test "${with_x+set}" = set; then
  withval=$with_x;
fi

# $have_x is `yes', `no', `disabled', or empty when we do not yet know.
if test "x$with_x" = xno; then
  # The user explicitly disabled X.
  have_x=disabled
else
  case $x_includes,$x_libraries in #(
    *\'*) { { echo "$as_me:$LINENO: error: Cannot use X directory names containing '" >&5
echo "$as_me: error: Cannot use X directory names containing '" >&2;}
   { (exit 1); exit 1; }; };; #(
    *,NONE | NONE,*) if test "${ac_cv_have_x+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  # One or both of the vars are not set, and there is no cached value.
ac_x_includes=no ac_x_libraries=no
rm -f -r conftest.dir
if mkdir conftest.dir; then
  cd conftest.dir
  cat >Imakefile <<'_ACEOF'
incroot:
	@echo incroot='${INCROOT}'
usrlibdir:
	@echo usrlibdir='${USRLIBDIR}'
libdir:
	@echo libdir='${LIBDIR}'
_ACEOF
  if (export CC; ${XMKMF-xmkmf}) >/dev/null 2>/dev/null && test -f Makefile; then
    # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
    for ac_var in incroot usrlibdir libdir; do
      eval "ac_im_$ac_var=\`\${MAKE-make} $ac_var 2>/dev/null | sed -n 's/^$ac_var=//p'\`"
    done
    # Open Windows xmkmf reportedly sets LIBDIR instead of USRLIBDIR.
    for ac_extension in a so sl; do
      if test ! -f "$ac_im_usrlibdir/libX11.$ac_extension" &&
	 test -f "$ac_im_libdir/libX11.$ac_extension"; then
	ac_im_usrlibdir=$ac_im_libdir; break
      fi
    done
    # Screen out bogus values from the imake configuration.  They are
    # bogus both because they are the default anyway, and because
    # using them would break gcc on systems where it needs fixed includes.
    case $ac_im_incroot in
	/usr/include) ac_x_includes= ;;
	*) test -f "$ac_im_incroot/X11/Xos.h" && ac_x_includes=$ac_im_incroot;;
    esac
    case $ac_im_usrlibdir in
	/usr/lib | /lib) ;;
	*) test -d "$ac_im_usrlibdir" && ac_x_libraries=$ac_im_usrlibdir ;;
    esac
  fi
  cd ..
  rm -f -r conftest.dir
fi

# Standard set of common directories for X headers.
# Check X11 before X11Rn because it is often a symlink to the current release.
ac_x_header_dirs='
/usr/X11/include
/usr/X11R6/include
/usr/X11R5/include
/usr/X11R4/include

/usr/include/X11
/usr/include/X11R6
/usr/include/X11R5
/usr/include/X11R4

/usr/local/X11/include
/usr/local/X11R6/include
/usr/local/X11R5/include
/usr/local/X11R4/include

/usr/local/include/X11
/usr/local/include/X11R6
/usr/local/include/X11R5
/usr/local/include/X11R4

/usr/X386/include
/usr/x386/include
/usr/XFree86/include/X11

/usr/include
/usr/local/include
/usr/unsupported/include
/usr/athena/include
/usr/local/x11r5/include
/usr/lpp/Xamples/include

/usr/openwin/include
/usr/openwin/share/include'

if test "$ac_x_includes" = no; then
  # Guess where to find include files, by looking for Xlib.h.
  # First, try using that file with no special directory specified.
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <X11/Xlib.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  # We can compile using X headers with no special include directory.
ac_x_includes=
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  for ac_dir in $ac_x_header_dirs; do
  if test -r "$ac_dir/X11/Xlib.h"; then
    ac_x_includes=$ac_dir
    break
  fi
done
fi

rm -f conftest.err conftest.$ac_ext
fi # $ac_x_includes = no

if test "$ac_x_libraries" = no; then
  # Check for the libraries.
  # See if we find them without any special options.
  # Don't add to $LIBS permanently.
  ac_save_LIBS=$LIBS
  LIBS="-lX11 $LIBS"
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <X11/Xlib.h>
int
main ()
{
XrmInitialize ()
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  LIBS=$ac_save_LIBS
# We can link X programs with no special library path.
ac_x_libraries=
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	LIBS=$ac_save_LIBS
for ac_dir in `echo "$ac_x_includes $ac_x_header_dirs" | sed s/include/lib/g`
do
  # Don't even attempt the hair of trying to link an X program!
  for ac_extension in a so sl; do
    if test -r "$ac_dir/libX11.$ac_extension"; then
      ac_x_libraries=$ac_dir
      break 2
    fi
  done
done
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi # $ac_x_libraries = no

case $ac_x_includes,$ac_x_libraries in #(
  no,* | *,no | *\'*)
    # Didn't find X, or a directory has "'" in its name.
    ac_cv_have_x="have_x=no";; #(
  *)
    # Record where we found X for the cache.
    ac_cv_have_x="have_x=yes\
	ac_x_includes='$ac_x_includes'\
	ac_x_libraries='$ac_x_libraries'"
esac
fi
;; #(
    *) have_x=yes;;
  esac
  eval "$ac_cv_have_x"
fi # $with_x != no

if test "$have_x" != yes; then
  { echo "$as_me:$LINENO: result: $have_x" >&5
echo "${ECHO_T}$have_x" >&6; }
  no_x=yes
else
  # If each of the values was on the command line, it overrides each guess.
  test "x$x_includes" = xNONE && x_includes=$ac_x_includes
  test "x$x_libraries" = xNONE && x_libraries=$ac_x_libraries
  # Update the cache value to reflect the command line values.
  ac_cv_have_x="have_x=yes\
	ac_x_includes='$x_includes'\
	ac_x_libraries='$x_libraries'"
  { echo "$as_me:$LINENO: result: libraries $x_libraries, headers $x_includes" >&5
echo "${ECHO_T}libraries $x_libraries, headers $x_includes" >&6; }
fi

    not_really_there=""
    if test "$no_x" = ""; then
	if test "$x_includes" = ""; then
	    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <X11/XIntrinsic.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  :
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  not_really_there="yes"
fi

rm -f conftest.err conftest.$ac_ext
	else
	    if test ! -r $x_includes/X11/Intrinsic.h; then
		not_really_there="yes"
	    fi
	fi
    fi
    if test "$no_x" = "yes" -o "$not_really_there" = "yes"; then
	{ echo "$as_me:$LINENO: checking for X11 header files" >&5
echo $ECHO_N "checking for X11 header files... $ECHO_C" >&6; }
	found_xincludes="no"
	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <X11/Intrinsic.h>
_ACEOF
if { (ac_try="$ac_cpp conftest.$ac_ext"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } >/dev/null && {
	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
	 test ! -s conftest.err
       }; then
  found_xincludes="yes"
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

  found_xincludes="no"
fi

rm -f conftest.err conftest.$ac_ext
	if test "$found_xincludes" = "no"; then
	    dirs="/usr/unsupported/include /usr/local/include /usr/X386/include /usr/X11R6/include /usr/X11R5/include /usr/include/X11R5 /usr/include/X11R4 /usr/openwin/include /usr/X11/include /usr/sww/include"
	    for i in $dirs ; do
		if test -r $i/X11/Intrinsic.h; then
		    { echo "$as_me:$LINENO: result: $i" >&5
echo "${ECHO_T}$i" >&6; }
		    XINCLUDES=" -I$i"
		    found_xincludes="yes"
		    break
		fi
	    done
	fi
    else
	if test "$x_includes" != ""; then
	    XINCLUDES="-I$x_includes"
	    found_xincludes="yes"
	fi
    fi
    if test found_xincludes = "no"; then
	{ echo "$as_me:$LINENO: result: couldn't find any!" >&5
echo "${ECHO_T}couldn't find any!" >&6; }
    fi

    if test "$no_x" = yes; then
	{ echo "$as_me:$LINENO: checking for X11 libraries" >&5
echo $ECHO_N "checking for X11 libraries... $ECHO_C" >&6; }
	XLIBSW=nope
	dirs="/usr/unsupported/lib /usr/local/lib /usr/X386/lib /usr/X11R6/lib /usr/X11R5/lib /usr/lib/X11R5 /usr/lib/X11R4 /usr/openwin/lib /usr/X11/lib /usr/sww/X11/lib"
	for i in $dirs ; do
	    if test -r $i/libX11.a -o -r $i/libX11.so -o -r $i/libX11.sl; then
		{ echo "$as_me:$LINENO: result: $i" >&5
echo "${ECHO_T}$i" >&6; }
		XLIBSW="-L$i -lX11"
		x_libraries="$i"
		break
	    fi
	done
    else
	if test "$x_libraries" = ""; then
	    XLIBSW=-lX11
	else
	    XLIBSW="-L$x_libraries -lX11"
	fi
    fi
    if test "$XLIBSW" = nope ; then
	{ echo "$as_me:$LINENO: checking for XCreateWindow in -lXwindow" >&5
echo $ECHO_N "checking for XCreateWindow in -lXwindow... $ECHO_C" >&6; }
if test "${ac_cv_lib_Xwindow_XCreateWindow+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lXwindow  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char XCreateWindow ();
int
main ()
{
return XCreateWindow ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_Xwindow_XCreateWindow=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_Xwindow_XCreateWindow=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_Xwindow_XCreateWindow" >&5
echo "${ECHO_T}$ac_cv_lib_Xwindow_XCreateWindow" >&6; }
if test $ac_cv_lib_Xwindow_XCreateWindow = yes; then
  XLIBSW=-lXwindow
fi

    fi
    if test "$XLIBSW" = nope ; then
	{ echo "$as_me:$LINENO: result: could not find any!  Using -lX11." >&5
echo "${ECHO_T}could not find any!  Using -lX11." >&6; }
	XLIBSW=-lX11
    fi
    # TEA specific:
    if test x"${XLIBSW}" != x ; then
	PKG_LIBS="${PKG_LIBS} ${XLIBSW}"
    fi

    fi


#--------------------------------------------------------------------
# Check whether --enable-threads or --disable-threads was given.
# This auto-enables if Tcl was compiled threaded.
#--------------------------------------------------------------------


    # Check whether --enable-threads was given.
if test "${enable_threads+set}" = set; then
  enableval=$enable_threads; tcl_ok=$enableval
else
  tcl_ok=yes
fi


    if test "${enable_threads+set}" = set; then
	enableval="$enable_threads"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" -o "${TCL_THREADS}" = 1; then
	TCL_THREADS=1

	if test "${TEA_PLATFORM}" != "windows" ; then
	    # We are always OK on Windows, so check what this platform wants:

	    # USE_THREAD_ALLOC tells us to try the special thread-based
	    # allocator that significantly reduces lock contention

cat >>confdefs.h <<\_ACEOF
#define USE_THREAD_ALLOC 1
_ACEOF


cat >>confdefs.h <<\_ACEOF
#define _REENTRANT 1
_ACEOF

	    if test "`uname -s`" = "SunOS" ; then

cat >>confdefs.h <<\_ACEOF
#define _POSIX_PTHREAD_SEMANTICS 1
_ACEOF

	    fi

cat >>confdefs.h <<\_ACEOF
#define _THREAD_SAFE 1
_ACEOF

	    { echo "$as_me:$LINENO: checking for pthread_mutex_init in -lpthread" >&5
echo $ECHO_N "checking for pthread_mutex_init in -lpthread... $ECHO_C" >&6; }
if test "${ac_cv_lib_pthread_pthread_mutex_init+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lpthread  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char pthread_mutex_init ();
int
main ()
{
return pthread_mutex_init ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_pthread_pthread_mutex_init=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_pthread_pthread_mutex_init=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_pthread_mutex_init" >&5
echo "${ECHO_T}$ac_cv_lib_pthread_pthread_mutex_init" >&6; }
if test $ac_cv_lib_pthread_pthread_mutex_init = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

	    if test "$tcl_ok" = "no"; then
		# Check a little harder for __pthread_mutex_init in the same
		# library, as some systems hide it there until pthread.h is
		# defined.  We could alternatively do an AC_TRY_COMPILE with
		# pthread.h, but that will work with libpthread really doesn't
		# exist, like AIX 4.2.  [Bug: 4359]
		{ echo "$as_me:$LINENO: checking for __pthread_mutex_init in -lpthread" >&5
echo $ECHO_N "checking for __pthread_mutex_init in -lpthread... $ECHO_C" >&6; }
if test "${ac_cv_lib_pthread___pthread_mutex_init+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lpthread  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char __pthread_mutex_init ();
int
main ()
{
return __pthread_mutex_init ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_pthread___pthread_mutex_init=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_pthread___pthread_mutex_init=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_pthread___pthread_mutex_init" >&5
echo "${ECHO_T}$ac_cv_lib_pthread___pthread_mutex_init" >&6; }
if test $ac_cv_lib_pthread___pthread_mutex_init = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

	    fi

	    if test "$tcl_ok" = "yes"; then
		# The space is needed
		THREADS_LIBS=" -lpthread"
	    else
		{ echo "$as_me:$LINENO: checking for pthread_mutex_init in -lpthreads" >&5
echo $ECHO_N "checking for pthread_mutex_init in -lpthreads... $ECHO_C" >&6; }
if test "${ac_cv_lib_pthreads_pthread_mutex_init+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lpthreads  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char pthread_mutex_init ();
int
main ()
{
return pthread_mutex_init ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_pthreads_pthread_mutex_init=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_pthreads_pthread_mutex_init=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_pthreads_pthread_mutex_init" >&5
echo "${ECHO_T}$ac_cv_lib_pthreads_pthread_mutex_init" >&6; }
if test $ac_cv_lib_pthreads_pthread_mutex_init = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

		if test "$tcl_ok" = "yes"; then
		    # The space is needed
		    THREADS_LIBS=" -lpthreads"
		else
		    { echo "$as_me:$LINENO: checking for pthread_mutex_init in -lc" >&5
echo $ECHO_N "checking for pthread_mutex_init in -lc... $ECHO_C" >&6; }
if test "${ac_cv_lib_c_pthread_mutex_init+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lc  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char pthread_mutex_init ();
int
main ()
{
return pthread_mutex_init ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_c_pthread_mutex_init=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_c_pthread_mutex_init=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_c_pthread_mutex_init" >&5
echo "${ECHO_T}$ac_cv_lib_c_pthread_mutex_init" >&6; }
if test $ac_cv_lib_c_pthread_mutex_init = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

		    if test "$tcl_ok" = "no"; then
			{ echo "$as_me:$LINENO: checking for pthread_mutex_init in -lc_r" >&5
echo $ECHO_N "checking for pthread_mutex_init in -lc_r... $ECHO_C" >&6; }
if test "${ac_cv_lib_c_r_pthread_mutex_init+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lc_r  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char pthread_mutex_init ();
int
main ()
{
return pthread_mutex_init ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_c_r_pthread_mutex_init=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_c_r_pthread_mutex_init=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_c_r_pthread_mutex_init" >&5
echo "${ECHO_T}$ac_cv_lib_c_r_pthread_mutex_init" >&6; }
if test $ac_cv_lib_c_r_pthread_mutex_init = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

			if test "$tcl_ok" = "yes"; then
			    # The space is needed
			    THREADS_LIBS=" -pthread"
			else
			    TCL_THREADS=0
			    { echo "$as_me:$LINENO: WARNING: Do not know how to find pthread lib on your system - thread support disabled" >&5
echo "$as_me: WARNING: Do not know how to find pthread lib on your system - thread support disabled" >&2;}
			fi
		    fi
		fi
	    fi
	fi
    else
	TCL_THREADS=0
    fi
    # Do checking message here to not mess up interleaved configure output
    { echo "$as_me:$LINENO: checking for building with threads" >&5
echo $ECHO_N "checking for building with threads... $ECHO_C" >&6; }
    if test "${TCL_THREADS}" = 1; then

cat >>confdefs.h <<\_ACEOF
#define TCL_THREADS 1
_ACEOF

	{ echo "$as_me:$LINENO: result: yes (default)" >&5
echo "${ECHO_T}yes (default)" >&6; }
    else
	{ echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
    fi
    # TCL_THREADS sanity checking.  See if our request for building with
    # threads is the same as the way Tcl was built.  If not, warn the user.
    case ${TCL_DEFS} in
	*THREADS=1*)
	    if test "${TCL_THREADS}" = "0"; then
		{ echo "$as_me:$LINENO: WARNING:
    Building ${PACKAGE_NAME} without threads enabled, but building against Tcl
    that IS thread-enabled.  It is recommended to use --enable-threads." >&5
echo "$as_me: WARNING:
    Building ${PACKAGE_NAME} without threads enabled, but building against Tcl
    that IS thread-enabled.  It is recommended to use --enable-threads." >&2;}
	    fi
	    ;;
	*)
	    if test "${TCL_THREADS}" = "1"; then
		{ echo "$as_me:$LINENO: WARNING:
    --enable-threads requested, but building against a Tcl that is NOT
    thread-enabled.  This is an OK configuration that will also run in
    a thread-enabled core." >&5
echo "$as_me: WARNING:
    --enable-threads requested, but building against a Tcl that is NOT
    thread-enabled.  This is an OK configuration that will also run in
    a thread-enabled core." >&2;}
	    fi
	    ;;
    esac



#--------------------------------------------------------------------
# The statement below defines a collection of symbols related to
# building as a shared library instead of a static library.
#--------------------------------------------------------------------


    { echo "$as_me:$LINENO: checking how to build libraries" >&5
echo $ECHO_N "checking how to build libraries... $ECHO_C" >&6; }
    # Check whether --enable-shared was given.
if test "${enable_shared+set}" = set; then
  enableval=$enable_shared; tcl_ok=$enableval
else
  tcl_ok=yes
fi


    if test "${enable_shared+set}" = set; then
	enableval="$enable_shared"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" ; then
	{ echo "$as_me:$LINENO: result: shared" >&5
echo "${ECHO_T}shared" >&6; }
	SHARED_BUILD=1
    else
	{ echo "$as_me:$LINENO: result: static" >&5
echo "${ECHO_T}static" >&6; }
	SHARED_BUILD=0

cat >>confdefs.h <<\_ACEOF
#define STATIC_BUILD 1
_ACEOF

    fi



#--------------------------------------------------------------------
# This macro figures out what flags to use with the compiler/linker
# when building shared/static debug/optimized objects.  This information
# can be taken from the tclConfig.sh file, but this figures it all out.
#--------------------------------------------------------------------




    # Step 0.a: Enable 64 bit support?

    { echo "$as_me:$LINENO: checking if 64bit support is requested" >&5
echo $ECHO_N "checking if 64bit support is requested... $ECHO_C" >&6; }
    # Check whether --enable-64bit was given.
if test "${enable_64bit+set}" = set; then
  enableval=$enable_64bit; do64bit=$enableval
else
  do64bit=no
fi

    { echo "$as_me:$LINENO: result: $do64bit" >&5
echo "${ECHO_T}$do64bit" >&6; }

    # Step 0.b: Enable Solaris 64 bit VIS support?

    { echo "$as_me:$LINENO: checking if 64bit Sparc VIS support is requested" >&5
echo $ECHO_N "checking if 64bit Sparc VIS support is requested... $ECHO_C" >&6; }
    # Check whether --enable-64bit-vis was given.
if test "${enable_64bit_vis+set}" = set; then
  enableval=$enable_64bit_vis; do64bitVIS=$enableval
else
  do64bitVIS=no
fi

    { echo "$as_me:$LINENO: result: $do64bitVIS" >&5
echo "${ECHO_T}$do64bitVIS" >&6; }
    # Force 64bit on with VIS
    if test "$do64bitVIS" = "yes"; then
  do64bit=yes
fi


    # Step 0.c: Check if visibility support is available. Do this here so
    # that platform specific alternatives can be used below if this fails.

    { echo "$as_me:$LINENO: checking if compiler supports visibility \"hidden\"" >&5
echo $ECHO_N "checking if compiler supports visibility \"hidden\"... $ECHO_C" >&6; }
if test "${tcl_cv_cc_visibility_hidden+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	hold_cflags=$CFLAGS; CFLAGS="$CFLAGS -Werror"
	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

	    extern __attribute__((__visibility__("hidden"))) void f(void);
	    void f(void) {}
int
main ()
{
f();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_cc_visibility_hidden=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_cc_visibility_hidden=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
	CFLAGS=$hold_cflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_cc_visibility_hidden" >&5
echo "${ECHO_T}$tcl_cv_cc_visibility_hidden" >&6; }
    if test $tcl_cv_cc_visibility_hidden = yes; then


cat >>confdefs.h <<\_ACEOF
#define MODULE_SCOPE extern __attribute__((__visibility__("hidden")))
_ACEOF


fi


    # Step 0.d: Disable -rpath support?

    { echo "$as_me:$LINENO: checking if rpath support is requested" >&5
echo $ECHO_N "checking if rpath support is requested... $ECHO_C" >&6; }
    # Check whether --enable-rpath was given.
if test "${enable_rpath+set}" = set; then
  enableval=$enable_rpath; doRpath=$enableval
else
  doRpath=yes
fi

    { echo "$as_me:$LINENO: result: $doRpath" >&5
echo "${ECHO_T}$doRpath" >&6; }

    # TEA specific: Cross-compiling options for Windows/CE builds?

    if test "${TEA_PLATFORM}" = windows; then

	{ echo "$as_me:$LINENO: checking if Windows/CE build is requested" >&5
echo $ECHO_N "checking if Windows/CE build is requested... $ECHO_C" >&6; }
	# Check whether --enable-wince was given.
if test "${enable_wince+set}" = set; then
  enableval=$enable_wince; doWince=$enableval
else
  doWince=no
fi

	{ echo "$as_me:$LINENO: result: $doWince" >&5
echo "${ECHO_T}$doWince" >&6; }

fi


    # Step 1: set the variable "system" to hold the name and version number
    # for the system.


    { echo "$as_me:$LINENO: checking system version" >&5
echo $ECHO_N "checking system version... $ECHO_C" >&6; }
if test "${tcl_cv_sys_version+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	# TEA specific:
	if test "${TEA_PLATFORM}" = "windows" ; then
	    tcl_cv_sys_version=windows
	elif test -f /usr/lib/NextStep/software_version; then
	    tcl_cv_sys_version=NEXTSTEP-`awk '/3/,/3/' /usr/lib/NextStep/software_version`
	else
	    tcl_cv_sys_version=`uname -s`-`uname -r`
	    if test "$?" -ne 0 ; then
		{ echo "$as_me:$LINENO: WARNING: can't find uname command" >&5
echo "$as_me: WARNING: can't find uname command" >&2;}
		tcl_cv_sys_version=unknown
	    else
		# Special check for weird MP-RAS system (uname returns weird
		# results, and the version is kept in special file).

		if test -r /etc/.relid -a "X`uname -n`" = "X`uname -s`" ; then
		    tcl_cv_sys_version=MP-RAS-`awk '{print $3}' /etc/.relid`
		fi
		if test "`uname -s`" = "AIX" ; then
		    tcl_cv_sys_version=AIX-`uname -v`.`uname -r`
		fi
	    fi
	fi

fi
{ echo "$as_me:$LINENO: result: $tcl_cv_sys_version" >&5
echo "${ECHO_T}$tcl_cv_sys_version" >&6; }
    system=$tcl_cv_sys_version


    # Step 2: check for existence of -ldl library.  This is needed because
    # Linux can use either -ldl or -ldld for dynamic loading.

    { echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6; }
if test "${ac_cv_lib_dl_dlopen+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-ldl  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char dlopen ();
int
main ()
{
return dlopen ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_dl_dlopen=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_dl_dlopen=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6; }
if test $ac_cv_lib_dl_dlopen = yes; then
  have_dl=yes
else
  have_dl=no
fi


    # Require ranlib early so we can override it in special cases below.



    # Step 3: set configuration options based on system name and version.
    # This is similar to Tcl's unix/tcl.m4 except that we've added a
    # "windows" case.

    do64bit_ok=no
    LDFLAGS_ORIG="$LDFLAGS"
    # When ld needs options to work in 64-bit mode, put them in
    # LDFLAGS_ARCH so they eventually end up in LDFLAGS even if [load]
    # is disabled by the user. [Bug 1016796]
    LDFLAGS_ARCH=""
    TCL_EXPORT_FILE_SUFFIX=""
    UNSHARED_LIB_SUFFIX=""
    # TEA specific: use PACKAGE_VERSION instead of VERSION
    TCL_TRIM_DOTS='`echo ${PACKAGE_VERSION} | tr -d .`'
    ECHO_VERSION='`echo ${PACKAGE_VERSION}`'
    TCL_LIB_VERSIONS_OK=ok
    CFLAGS_DEBUG=-g
    CFLAGS_OPTIMIZE=-O
    if test "$GCC" = yes; then

	# TEA specific:
	CFLAGS_OPTIMIZE=-O2
	CFLAGS_WARNING="-Wall -Wno-implicit-int"

else
  CFLAGS_WARNING=""
fi

    TCL_NEEDS_EXP_FILE=0
    TCL_BUILD_EXP_FILE=""
    TCL_EXP_FILE=""
    # Extract the first word of "ar", so it can be a program name with args.
set dummy ar; ac_word=$2
{ echo "$as_me:$LINENO: checking for $ac_word" >&5
echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
if test "${ac_cv_prog_AR+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  if test -n "$AR"; then
  ac_cv_prog_AR="$AR" # Let the user override the test.
else
as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  for ac_exec_ext in '' $ac_executable_extensions; do
  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
    ac_cv_prog_AR="ar"
    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
    break 2
  fi
done
done
IFS=$as_save_IFS

fi
fi
AR=$ac_cv_prog_AR
if test -n "$AR"; then
  { echo "$as_me:$LINENO: result: $AR" >&5
echo "${ECHO_T}$AR" >&6; }
else
  { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
fi


    STLIB_LD='${AR} cr'
    LD_LIBRARY_PATH_VAR="LD_LIBRARY_PATH"
    case $system in
	# TEA specific:
	windows)
	    # This is a 2-stage check to make sure we have the 64-bit SDK
	    # We have to know where the SDK is installed.
	    # This magic is based on MS Platform SDK for Win2003 SP1 - hobbs
	    # MACHINE is IX86 for LINK, but this is used by the manifest,
	    # which requires x86|amd64|ia64.
	    MACHINE="X86"
	    if test "$do64bit" != "no" ; then
		if test "x${MSSDK}x" = "xx" ; then
		    MSSDK="C:/Progra~1/Microsoft Platform SDK"
		fi
		MSSDK=`echo "$MSSDK" | sed -e  's!\\\!/!g'`
		PATH64=""
		case "$do64bit" in
		    amd64|x64|yes)
			MACHINE="AMD64" ; # default to AMD64 64-bit build
			PATH64="${MSSDK}/Bin/Win64/x86/AMD64"
			;;
		    ia64)
			MACHINE="IA64"
			PATH64="${MSSDK}/Bin/Win64"
			;;
		esac
		if test ! -d "${PATH64}" ; then
		    { echo "$as_me:$LINENO: WARNING: Could not find 64-bit $MACHINE SDK to enable 64bit mode" >&5
echo "$as_me: WARNING: Could not find 64-bit $MACHINE SDK to enable 64bit mode" >&2;}
		    { echo "$as_me:$LINENO: WARNING: Ensure latest Platform SDK is installed" >&5
echo "$as_me: WARNING: Ensure latest Platform SDK is installed" >&2;}
		    do64bit="no"
		else
		    { echo "$as_me:$LINENO: result:    Using 64-bit $MACHINE mode" >&5
echo "${ECHO_T}   Using 64-bit $MACHINE mode" >&6; }
		    do64bit_ok="yes"
		fi
	    fi

	    if test "$doWince" != "no" ; then
		if test "$do64bit" != "no" ; then
		    { { echo "$as_me:$LINENO: error: Windows/CE and 64-bit builds incompatible" >&5
echo "$as_me: error: Windows/CE and 64-bit builds incompatible" >&2;}
   { (exit 1); exit 1; }; }
		fi
		if test "$GCC" = "yes" ; then
		    { { echo "$as_me:$LINENO: error: Windows/CE and GCC builds incompatible" >&5
echo "$as_me: error: Windows/CE and GCC builds incompatible" >&2;}
   { (exit 1); exit 1; }; }
		fi

    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-celib

    if test x"${no_celib}" = x ; then
	# we reset no_celib in case something fails here
	no_celib=true

# Check whether --with-celib was given.
if test "${with_celib+set}" = set; then
  withval=$with_celib; with_celibconfig=${withval}
fi

	{ echo "$as_me:$LINENO: checking for Windows/CE celib directory" >&5
echo $ECHO_N "checking for Windows/CE celib directory... $ECHO_C" >&6; }
	if test "${ac_cv_c_celibconfig+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	    # First check to see if --with-celibconfig was specified.
	    if test x"${with_celibconfig}" != x ; then
		if test -d "${with_celibconfig}/inc" ; then
		    ac_cv_c_celibconfig=`(cd ${with_celibconfig}; pwd)`
		else
		    { { echo "$as_me:$LINENO: error: ${with_celibconfig} directory doesn't contain inc directory" >&5
echo "$as_me: error: ${with_celibconfig} directory doesn't contain inc directory" >&2;}
   { (exit 1); exit 1; }; }
		fi
	    fi

	    # then check for a celib library
	    if test x"${ac_cv_c_celibconfig}" = x ; then
		for i in \
			../celib-palm-3.0 \
			../celib \
			../../celib-palm-3.0 \
			../../celib \
			`ls -dr ../celib-*3.[0-9]* 2>/dev/null` \
			${srcdir}/../celib-palm-3.0 \
			${srcdir}/../celib \
			`ls -dr ${srcdir}/../celib-*3.[0-9]* 2>/dev/null` \
			; do
		    if test -d "$i/inc" ; then
			ac_cv_c_celibconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

fi

	if test x"${ac_cv_c_celibconfig}" = x ; then
	    { { echo "$as_me:$LINENO: error: Cannot find celib support library directory" >&5
echo "$as_me: error: Cannot find celib support library directory" >&2;}
   { (exit 1); exit 1; }; }
	else
	    no_celib=
	    CELIB_DIR=${ac_cv_c_celibconfig}
	    CELIB_DIR=`echo "$CELIB_DIR" | sed -e 's!\\\!/!g'`
	    { echo "$as_me:$LINENO: result: found $CELIB_DIR" >&5
echo "${ECHO_T}found $CELIB_DIR" >&6; }
	fi
    fi

		# Set defaults for common evc4/PPC2003 setup
		# Currently Tcl requires 300+, possibly 420+ for sockets
		CEVERSION=420; 		# could be 211 300 301 400 420 ...
		TARGETCPU=ARMV4;	# could be ARMV4 ARM MIPS SH3 X86 ...
		ARCH=ARM;		# could be ARM MIPS X86EM ...
		PLATFORM="Pocket PC 2003"; # or "Pocket PC 2002"
		if test "$doWince" != "yes"; then
		    # If !yes then the user specified something
		    # Reset ARCH to allow user to skip specifying it
		    ARCH=
		    eval `echo $doWince | awk -F, '{ \
	    if (length($1)) { printf "CEVERSION=\"%s\"\n", $1; \
	    if ($1 < 400)   { printf "PLATFORM=\"Pocket PC 2002\"\n" } }; \
	    if (length($2)) { printf "TARGETCPU=\"%s\"\n", toupper($2) }; \
	    if (length($3)) { printf "ARCH=\"%s\"\n", toupper($3) }; \
	    if (length($4)) { printf "PLATFORM=\"%s\"\n", $4 }; \
		    }'`
		    if test "x${ARCH}" = "x" ; then
			ARCH=$TARGETCPU;
		    fi
		fi
		OSVERSION=WCE$CEVERSION;
	    	if test "x${WCEROOT}" = "x" ; then
			WCEROOT="C:/Program Files/Microsoft eMbedded C++ 4.0"
		    if test ! -d "${WCEROOT}" ; then
			WCEROOT="C:/Program Files/Microsoft eMbedded Tools"
		    fi
		fi
		if test "x${SDKROOT}" = "x" ; then
		    SDKROOT="C:/Program Files/Windows CE Tools"
		    if test ! -d "${SDKROOT}" ; then
			SDKROOT="C:/Windows CE Tools"
		    fi
		fi
		WCEROOT=`echo "$WCEROOT" | sed -e 's!\\\!/!g'`
		SDKROOT=`echo "$SDKROOT" | sed -e 's!\\\!/!g'`
		if test ! -d "${SDKROOT}/${OSVERSION}/${PLATFORM}/Lib/${TARGETCPU}" \
		    -o ! -d "${WCEROOT}/EVC/${OSVERSION}/bin"; then
		    { { echo "$as_me:$LINENO: error: could not find PocketPC SDK or target compiler to enable WinCE mode $CEVERSION,$TARGETCPU,$ARCH,$PLATFORM" >&5
echo "$as_me: error: could not find PocketPC SDK or target compiler to enable WinCE mode $CEVERSION,$TARGETCPU,$ARCH,$PLATFORM" >&2;}
   { (exit 1); exit 1; }; }
		    doWince="no"
		else
		    # We could PATH_NOSPACE these, but that's not important,
		    # as long as we quote them when used.
		    CEINCLUDE="${SDKROOT}/${OSVERSION}/${PLATFORM}/include"
		    if test -d "${CEINCLUDE}/${TARGETCPU}" ; then
			CEINCLUDE="${CEINCLUDE}/${TARGETCPU}"
		    fi
		    CELIBPATH="${SDKROOT}/${OSVERSION}/${PLATFORM}/Lib/${TARGETCPU}"
    		fi
	    fi

	    if test "$GCC" != "yes" ; then
	        if test "${SHARED_BUILD}" = "0" ; then
		    runtime=-MT
	        else
		    runtime=-MD
	        fi

                if test "$do64bit" != "no" ; then
		    # All this magic is necessary for the Win64 SDK RC1 - hobbs
		    CC="\"${PATH64}/cl.exe\""
		    CFLAGS="${CFLAGS} -I\"${MSSDK}/Include\" -I\"${MSSDK}/Include/crt\" -I\"${MSSDK}/Include/crt/sys\""
		    RC="\"${MSSDK}/bin/rc.exe\""
		    lflags="-nologo -MACHINE:${MACHINE} -LIBPATH:\"${MSSDK}/Lib/${MACHINE}\""
		    LINKBIN="\"${PATH64}/link.exe\""
		    CFLAGS_DEBUG="-nologo -Zi -Od -W3 ${runtime}d"
		    CFLAGS_OPTIMIZE="-nologo -O2 -W2 ${runtime}"
		    # Avoid 'unresolved external symbol __security_cookie'
		    # errors, c.f. http://support.microsoft.com/?id=894573

    vars="bufferoverflowU.lib"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([^-].*\)\.lib$/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done


		elif test "$doWince" != "no" ; then
		    CEBINROOT="${WCEROOT}/EVC/${OSVERSION}/bin"
		    if test "${TARGETCPU}" = "X86"; then
			CC="\"${CEBINROOT}/cl.exe\""
		    else
			CC="\"${CEBINROOT}/cl${ARCH}.exe\""
		    fi
		    CFLAGS="$CFLAGS -I\"${CELIB_DIR}/inc\" -I\"${CEINCLUDE}\""
		    RC="\"${WCEROOT}/Common/EVC/bin/rc.exe\""
		    arch=`echo ${ARCH} | awk '{print tolower($0)}'`
		    defs="${ARCH} _${ARCH}_ ${arch} PALM_SIZE _MT _WINDOWS"
		    if test "${SHARED_BUILD}" = "1" ; then
			# Static CE builds require static celib as well
		    	defs="${defs} _DLL"
		    fi
		    for i in $defs ; do

cat >>confdefs.h <<_ACEOF
#define $i 1
_ACEOF

		    done

cat >>confdefs.h <<_ACEOF
#define _WIN32_WCE $CEVERSION
_ACEOF


cat >>confdefs.h <<_ACEOF
#define UNDER_CE $CEVERSION
_ACEOF

		    CFLAGS_DEBUG="-nologo -Zi -Od"
		    CFLAGS_OPTIMIZE="-nologo -Ox"
		    lversion=`echo ${CEVERSION} | sed -e 's/\(.\)\(..\)/\1\.\2/'`
		    lflags="-MACHINE:${ARCH} -LIBPATH:\"${CELIBPATH}\" -subsystem:windowsce,${lversion} -nologo"
		    LINKBIN="\"${CEBINROOT}/link.exe\""

		else
		    RC="rc"
		    lflags="-nologo"
    		    LINKBIN="link"
		    CFLAGS_DEBUG="-nologo -Z7 -Od -W3 -WX ${runtime}d"
		    CFLAGS_OPTIMIZE="-nologo -O2 -W2 ${runtime}"
		fi
	    fi

	    if test "$GCC" = "yes"; then
		# mingw gcc mode
		RC="windres"
		CFLAGS_DEBUG="-g"
		CFLAGS_OPTIMIZE="-O2 -fomit-frame-pointer"
		SHLIB_LD="$CC -shared"
		UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
		LDFLAGS_CONSOLE="-wl,--subsystem,console ${lflags}"
		LDFLAGS_WINDOW="-wl,--subsystem,windows ${lflags}"
	    else
		SHLIB_LD="${LINKBIN} -dll ${lflags}"
		# link -lib only works when -lib is the first arg
		STLIB_LD="${LINKBIN} -lib ${lflags}"
		UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.lib'
		PATHTYPE=-w
		# For information on what debugtype is most useful, see:
		# http://msdn.microsoft.com/library/en-us/dnvc60/html/gendepdebug.asp
		# This essentially turns it all on.
		LDFLAGS_DEBUG="-debug:full -debugtype:both -warn:2"
		LDFLAGS_OPTIMIZE="-release"
		if test "$doWince" != "no" ; then
		    LDFLAGS_CONSOLE="-link ${lflags}"
		    LDFLAGS_WINDOW=${LDFLAGS_CONSOLE}
		else
		    LDFLAGS_CONSOLE="-link -subsystem:console ${lflags}"
		    LDFLAGS_WINDOW="-link -subsystem:windows ${lflags}"
		fi
	    fi

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".dll"
	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.dll'

	    TCL_LIB_VERSIONS_OK=nodots
	    # Bogus to avoid getting this turned off
	    DL_OBJS="tclLoadNone.obj"
    	    ;;
	AIX-*)
	    if test "${TCL_THREADS}" = "1" -a "$GCC" != "yes"; then

		# AIX requires the _r compiler when gcc isn't being used
		case "${CC}" in
		    *_r)
			# ok ...
			;;
		    *)
			CC=${CC}_r
			;;
		esac
		{ echo "$as_me:$LINENO: result: Using $CC for compiling with threads" >&5
echo "${ECHO_T}Using $CC for compiling with threads" >&6; }

fi

	    LIBS="$LIBS -lc"
	    SHLIB_CFLAGS=""
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    DL_OBJS="tclLoadDl.o"
	    LD_LIBRARY_PATH_VAR="LIBPATH"

	    # Check to enable 64-bit flags for compiler/linker on AIX 4+
	    if test "$do64bit" = yes -a "`uname -v`" -gt 3; then

		if test "$GCC" = yes; then

		    { echo "$as_me:$LINENO: WARNING: 64bit mode not supported with GCC on $system" >&5
echo "$as_me: WARNING: 64bit mode not supported with GCC on $system" >&2;}

else

		    do64bit_ok=yes
		    CFLAGS="$CFLAGS -q64"
		    LDFLAGS_ARCH="-q64"
		    RANLIB="${RANLIB} -X64"
		    AR="${AR} -X64"
		    SHLIB_LD_FLAGS="-b64"

fi


fi


	    if test "`uname -m`" = ia64; then

		# AIX-5 uses ELF style dynamic libraries on IA-64, but not PPC
		SHLIB_LD="/usr/ccs/bin/ld -G -z text"
		# AIX-5 has dl* in libc.so
		DL_LIBS=""
		if test "$GCC" = yes; then

		    CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'

else

		    CC_SEARCH_FLAGS='-R${LIB_RUNTIME_DIR}'

fi

		LD_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'

else

		if test "$GCC" = yes; then
  SHLIB_LD='${CC} -shared'
else

		    SHLIB_LD="/bin/ld -bhalt:4 -bM:SRE -bE:lib.exp -H512 -T512 -bnoentry"

fi

		SHLIB_LD="${TCL_SRC_DIR}/unix/ldAix ${SHLIB_LD} ${SHLIB_LD_FLAGS}"
		DL_LIBS="-ldl"
		CC_SEARCH_FLAGS='-L${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
		TCL_NEEDS_EXP_FILE=1
		# TEA specific: use PACKAGE_VERSION instead of VERSION
		TCL_EXPORT_FILE_SUFFIX='${PACKAGE_VERSION}.exp'

fi


	    # AIX v<=4.1 has some different flags than 4.2+
	    if test "$system" = "AIX-4.1" -o "`uname -v`" -lt 4; then

		case " $LIBOBJS " in
  *" tclLoadAix.$ac_objext "* ) ;;
  *) LIBOBJS="$LIBOBJS tclLoadAix.$ac_objext"
 ;;
esac

		DL_LIBS="-lld"

fi


	    # On AIX <=v4 systems, libbsd.a has to be linked in to support
	    # non-blocking file IO.  This library has to be linked in after
	    # the MATH_LIBS or it breaks the pow() function.  The way to
	    # insure proper sequencing, is to add it to the tail of MATH_LIBS.
	    # This library also supplies gettimeofday.
	    #
	    # AIX does not have a timezone field in struct tm. When the AIX
	    # bsd library is used, the timezone global and the gettimeofday
	    # methods are to be avoided for timezone deduction instead, we
	    # deduce the timezone by comparing the localtime result on a
	    # known GMT value.

	    { echo "$as_me:$LINENO: checking for gettimeofday in -lbsd" >&5
echo $ECHO_N "checking for gettimeofday in -lbsd... $ECHO_C" >&6; }
if test "${ac_cv_lib_bsd_gettimeofday+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lbsd  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char gettimeofday ();
int
main ()
{
return gettimeofday ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_bsd_gettimeofday=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_bsd_gettimeofday=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_bsd_gettimeofday" >&5
echo "${ECHO_T}$ac_cv_lib_bsd_gettimeofday" >&6; }
if test $ac_cv_lib_bsd_gettimeofday = yes; then
  libbsd=yes
else
  libbsd=no
fi

	    if test $libbsd = yes; then

	    	MATH_LIBS="$MATH_LIBS -lbsd"

cat >>confdefs.h <<\_ACEOF
#define USE_DELTA_FOR_TZ 1
_ACEOF


fi

	    ;;
	BeOS*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -nostart'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"

	    #-----------------------------------------------------------
	    # Check for inet_ntoa in -lbind, for BeOS (which also needs
	    # -lsocket, even if the network functions are in -lnet which
	    # is always linked to, for compatibility.
	    #-----------------------------------------------------------
	    { echo "$as_me:$LINENO: checking for inet_ntoa in -lbind" >&5
echo $ECHO_N "checking for inet_ntoa in -lbind... $ECHO_C" >&6; }
if test "${ac_cv_lib_bind_inet_ntoa+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lbind  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char inet_ntoa ();
int
main ()
{
return inet_ntoa ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_bind_inet_ntoa=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_bind_inet_ntoa=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_bind_inet_ntoa" >&5
echo "${ECHO_T}$ac_cv_lib_bind_inet_ntoa" >&6; }
if test $ac_cv_lib_bind_inet_ntoa = yes; then
  LIBS="$LIBS -lbind -lsocket"
fi

	    ;;
	BSD/OS-2.1*|BSD/OS-3*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="shlicc -r"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	BSD/OS-4.*)
	    SHLIB_CFLAGS="-export-dynamic -fPIC"
	    SHLIB_LD='${CC} -shared'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -export-dynamic"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	dgux*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	HP-UX-*.11.*)
	    # Use updated header definitions where possible

cat >>confdefs.h <<\_ACEOF
#define _XOPEN_SOURCE_EXTENDED 1
_ACEOF

	    # TEA specific: Needed by Tcl, but not most extensions
	    #AC_DEFINE(_XOPEN_SOURCE, 1, [Do we want to use the XOPEN network library?])
	    #LIBS="$LIBS -lxnet"               # Use the XOPEN network library

	    if test "`uname -m`" = ia64; then

		SHLIB_SUFFIX=".so"
		# Use newer C++ library for C++ extensions
		#if test "$GCC" != "yes" ; then
		#   CPPFLAGS="-AA"
		#fi

else

		SHLIB_SUFFIX=".sl"

fi

	    { echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6; }
if test "${ac_cv_lib_dld_shl_load+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-ldld  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char shl_load ();
int
main ()
{
return shl_load ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_dld_shl_load=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_dld_shl_load=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6; }
if test $ac_cv_lib_dld_shl_load = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

	    if test "$tcl_ok" = yes; then

		SHLIB_CFLAGS="+z"
		SHLIB_LD="ld -b"
		SHLIB_LD_LIBS='${LIBS}'
		DL_OBJS="tclLoadShl.o"
		DL_LIBS="-ldld"
		LDFLAGS="$LDFLAGS -Wl,-E"
		CC_SEARCH_FLAGS='-Wl,+s,+b,${LIB_RUNTIME_DIR}:.'
		LD_SEARCH_FLAGS='+s +b ${LIB_RUNTIME_DIR}:.'
		LD_LIBRARY_PATH_VAR="SHLIB_PATH"

fi

	    if test "$GCC" = yes; then

		SHLIB_LD='${CC} -shared'
		SHLIB_LD_LIBS='${LIBS}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}

fi


	    # Users may want PA-RISC 1.1/2.0 portable code - needs HP cc
	    #CFLAGS="$CFLAGS +DAportable"

	    # Check to enable 64-bit flags for compiler/linker
	    if test "$do64bit" = "yes"; then

		if test "$GCC" = yes; then

		    case `${CC} -dumpmachine` in
			hppa64*)
			    # 64-bit gcc in use.  Fix flags for GNU ld.
			    do64bit_ok=yes
			    SHLIB_LD='${CC} -shared'
			    SHLIB_LD_LIBS='${LIBS}'
			    if test $doRpath = yes; then

				CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
fi

			    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
			    ;;
			*)
			    { echo "$as_me:$LINENO: WARNING: 64bit mode not supported with GCC on $system" >&5
echo "$as_me: WARNING: 64bit mode not supported with GCC on $system" >&2;}
			    ;;
		    esac

else

		    do64bit_ok=yes
		    CFLAGS="$CFLAGS +DD64"
		    LDFLAGS_ARCH="+DD64"

fi


fi
 ;;
	HP-UX-*.08.*|HP-UX-*.09.*|HP-UX-*.10.*)
	    SHLIB_SUFFIX=".sl"
	    { echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6; }
if test "${ac_cv_lib_dld_shl_load+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-ldld  $LIBS"
cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char shl_load ();
int
main ()
{
return shl_load ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  ac_cv_lib_dld_shl_load=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	ac_cv_lib_dld_shl_load=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6; }
if test $ac_cv_lib_dld_shl_load = yes; then
  tcl_ok=yes
else
  tcl_ok=no
fi

	    if test "$tcl_ok" = yes; then

		SHLIB_CFLAGS="+z"
		SHLIB_LD="ld -b"
		SHLIB_LD_LIBS=""
		DL_OBJS="tclLoadShl.o"
		DL_LIBS="-ldld"
		LDFLAGS="$LDFLAGS -Wl,-E"
		CC_SEARCH_FLAGS='-Wl,+s,+b,${LIB_RUNTIME_DIR}:.'
		LD_SEARCH_FLAGS='+s +b ${LIB_RUNTIME_DIR}:.'
		LD_LIBRARY_PATH_VAR="SHLIB_PATH"

fi
 ;;
	IRIX-5.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'
fi

	    ;;
	IRIX-6.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -n32 -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'
fi

	    if test "$GCC" = yes; then

		CFLAGS="$CFLAGS -mabi=n32"
		LDFLAGS="$LDFLAGS -mabi=n32"

else

		case $system in
		    IRIX-6.3)
			# Use to build 6.2 compatible binaries on 6.3.
			CFLAGS="$CFLAGS -n32 -D_OLD_TERMIOS"
			;;
		    *)
			CFLAGS="$CFLAGS -n32"
			;;
		esac
		LDFLAGS="$LDFLAGS -n32"

fi

	    ;;
	IRIX64-6.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -n32 -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'
fi


	    # Check to enable 64-bit flags for compiler/linker

	    if test "$do64bit" = yes; then

	        if test "$GCC" = yes; then

	            { echo "$as_me:$LINENO: WARNING: 64bit mode not supported by gcc" >&5
echo "$as_me: WARNING: 64bit mode not supported by gcc" >&2;}

else

	            do64bit_ok=yes
	            SHLIB_LD="ld -64 -shared -rdata_shared"
	            CFLAGS="$CFLAGS -64"
	            LDFLAGS_ARCH="-64"

fi


fi

	    ;;
	Linux*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    # TEA specific:
	    CFLAGS_OPTIMIZE="-O2 -fomit-frame-pointer"
	    # egcs-2.91.66 on Redhat Linux 6.0 generates lots of warnings
	    # when you inline the string and math operations.  Turn this off to
	    # get rid of the warnings.
	    #CFLAGS_OPTIMIZE="${CFLAGS_OPTIMIZE} -D__NO_STRING_INLINES -D__NO_MATH_INLINES"

	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
	    SHLIB_LD='${CC} -shared ${CFLAGS} ${LDFLAGS_DEFAULT}'
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
fi

	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    if test "`uname -m`" = "alpha"; then
  CFLAGS="$CFLAGS -mieee"
fi

	    if test $do64bit = yes; then

		{ echo "$as_me:$LINENO: checking if compiler accepts -m64 flag" >&5
echo $ECHO_N "checking if compiler accepts -m64 flag... $ECHO_C" >&6; }
if test "${tcl_cv_cc_m64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		    hold_cflags=$CFLAGS
		    CFLAGS="$CFLAGS -m64"
		    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_cc_m64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_cc_m64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
		    CFLAGS=$hold_cflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_cc_m64" >&5
echo "${ECHO_T}$tcl_cv_cc_m64" >&6; }
		if test $tcl_cv_cc_m64 = yes; then

		    CFLAGS="$CFLAGS -m64"
		    do64bit_ok=yes

fi


fi


	    # The combo of gcc + glibc has a bug related to inlining of
	    # functions like strtod(). The -fno-builtin flag should address
	    # this problem but it does not work. The -fno-inline flag is kind
	    # of overkill but it works. Disable inlining only when one of the
	    # files in compat/*.c is being linked in.

	    if test x"${USE_COMPAT}" != x; then
  CFLAGS="$CFLAGS -fno-inline"
fi


	    ;;
	GNU*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    SHLIB_LD='${CC} -shared'
	    DL_OBJS=""
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    if test "`uname -m`" = "alpha"; then
  CFLAGS="$CFLAGS -mieee"
fi

	    ;;
	Lynx*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    CFLAGS_OPTIMIZE=-02
	    SHLIB_LD='${CC} -shared'
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-mshared -ldl"
	    LD_FLAGS="-Wl,--export-dynamic"
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
fi

	    ;;
	MP-RAS-02*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	MP-RAS-*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,-Bexport"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	NetBSD-1.*|FreeBSD-[1-2].*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD="ld -Bshareable -x"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'
fi

	    { echo "$as_me:$LINENO: checking for ELF" >&5
echo $ECHO_N "checking for ELF... $ECHO_C" >&6; }
if test "${tcl_cv_ld_elf+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

#ifdef __ELF__
	yes
#endif

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "yes" >/dev/null 2>&1; then
  tcl_cv_ld_elf=yes
else
  tcl_cv_ld_elf=no
fi
rm -f conftest*

fi
{ echo "$as_me:$LINENO: result: $tcl_cv_ld_elf" >&5
echo "${ECHO_T}$tcl_cv_ld_elf" >&6; }
	    if test $tcl_cv_ld_elf = yes; then

		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so'

else

		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'

fi


	    # Ancient FreeBSD doesn't handle version numbers with dots.

	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	OpenBSD-*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -shared ${SHLIB_CFLAGS}'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
fi

	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'
	    { echo "$as_me:$LINENO: checking for ELF" >&5
echo $ECHO_N "checking for ELF... $ECHO_C" >&6; }
if test "${tcl_cv_ld_elf+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

#ifdef __ELF__
	yes
#endif

_ACEOF
if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
  $EGREP "yes" >/dev/null 2>&1; then
  tcl_cv_ld_elf=yes
else
  tcl_cv_ld_elf=no
fi
rm -f conftest*

fi
{ echo "$as_me:$LINENO: result: $tcl_cv_ld_elf" >&5
echo "${ECHO_T}$tcl_cv_ld_elf" >&6; }
	    if test $tcl_cv_ld_elf = yes; then

		LDFLAGS=-Wl,-export-dynamic

else
  LDFLAGS=""
fi


	    # OpenBSD doesn't do version numbers with dots.
	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	NetBSD-*|FreeBSD-*)
	    # FreeBSD 3.* and greater have ELF.
	    # NetBSD 2.* has ELF and can use 'cc -shared' to build shared libs
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -shared ${SHLIB_CFLAGS}'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    LDFLAGS="$LDFLAGS -export-dynamic"
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
fi

	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    if test "${TCL_THREADS}" = "1"; then

		# The -pthread needs to go in the CFLAGS, not LIBS
		LIBS=`echo $LIBS | sed s/-pthread//`
		CFLAGS="$CFLAGS -pthread"
	    	LDFLAGS="$LDFLAGS -pthread"

fi

	    case $system in
	    FreeBSD-3.*)
	    	# FreeBSD-3 doesn't handle version numbers with dots.
	    	UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    	SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so'
	    	TCL_LIB_VERSIONS_OK=nodots
		;;
	    esac
	    ;;
	Darwin-*)
	    CFLAGS_OPTIMIZE="-Os"
	    SHLIB_CFLAGS="-fno-common"
	    # To avoid discrepancies between what headers configure sees during
	    # preprocessing tests and compiling tests, move any -isysroot and
	    # -mmacosx-version-min flags from CFLAGS to CPPFLAGS:
	    CPPFLAGS="${CPPFLAGS} `echo " ${CFLAGS}" | \
		awk 'BEGIN {FS=" +-";ORS=" "}; {for (i=2;i<=NF;i++) \
		if ($i~/^(isysroot|mmacosx-version-min)/) print "-"$i}'`"
	    CFLAGS="`echo " ${CFLAGS}" | \
		awk 'BEGIN {FS=" +-";ORS=" "}; {for (i=2;i<=NF;i++) \
		if (!($i~/^(isysroot|mmacosx-version-min)/)) print "-"$i}'`"
	    if test $do64bit = yes; then

		case `arch` in
		    ppc)
			{ echo "$as_me:$LINENO: checking if compiler accepts -arch ppc64 flag" >&5
echo $ECHO_N "checking if compiler accepts -arch ppc64 flag... $ECHO_C" >&6; }
if test "${tcl_cv_cc_arch_ppc64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

			    hold_cflags=$CFLAGS
			    CFLAGS="$CFLAGS -arch ppc64 -mpowerpc64 -mcpu=G5"
			    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_cc_arch_ppc64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_cc_arch_ppc64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
			    CFLAGS=$hold_cflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_cc_arch_ppc64" >&5
echo "${ECHO_T}$tcl_cv_cc_arch_ppc64" >&6; }
			if test $tcl_cv_cc_arch_ppc64 = yes; then

			    CFLAGS="$CFLAGS -arch ppc64 -mpowerpc64 -mcpu=G5"
			    do64bit_ok=yes

fi
;;
		    i386)
			{ echo "$as_me:$LINENO: checking if compiler accepts -arch x86_64 flag" >&5
echo $ECHO_N "checking if compiler accepts -arch x86_64 flag... $ECHO_C" >&6; }
if test "${tcl_cv_cc_arch_x86_64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

			    hold_cflags=$CFLAGS
			    CFLAGS="$CFLAGS -arch x86_64"
			    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_cc_arch_x86_64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_cc_arch_x86_64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
			    CFLAGS=$hold_cflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_cc_arch_x86_64" >&5
echo "${ECHO_T}$tcl_cv_cc_arch_x86_64" >&6; }
			if test $tcl_cv_cc_arch_x86_64 = yes; then

			    CFLAGS="$CFLAGS -arch x86_64"
			    do64bit_ok=yes

fi
;;
		    *)
			{ echo "$as_me:$LINENO: WARNING: Don't know how enable 64-bit on architecture \`arch\`" >&5
echo "$as_me: WARNING: Don't know how enable 64-bit on architecture \`arch\`" >&2;};;
		esac

else

		# Check for combined 32-bit and 64-bit fat build
		if echo "$CFLAGS " |grep -E -q -- '-arch (ppc64|x86_64) ' \
		    && echo "$CFLAGS " |grep -E -q -- '-arch (ppc|i386) '; then

		    fat_32_64=yes
fi


fi

	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
	    SHLIB_LD='${CC} -dynamiclib ${CFLAGS} ${LDFLAGS_DEFAULT}'
	    { echo "$as_me:$LINENO: checking if ld accepts -single_module flag" >&5
echo $ECHO_N "checking if ld accepts -single_module flag... $ECHO_C" >&6; }
if test "${tcl_cv_ld_single_module+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -dynamiclib -Wl,-single_module"
		cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
int i;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_ld_single_module=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_ld_single_module=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
		LDFLAGS=$hold_ldflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_ld_single_module" >&5
echo "${ECHO_T}$tcl_cv_ld_single_module" >&6; }
	    if test $tcl_cv_ld_single_module = yes; then

		SHLIB_LD="${SHLIB_LD} -Wl,-single_module"

fi

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".dylib"
	    DL_OBJS="tclLoadDyld.o"
	    DL_LIBS=""
	    # Don't use -prebind when building for Mac OS X 10.4 or later only:
	    if test "`echo "${MACOSX_DEPLOYMENT_TARGET}" | awk -F '10\\.' '{print int($2)}'`" -lt 4 -a \
		"`echo "${CPPFLAGS}" | awk -F '-mmacosx-version-min=10\\.' '{print int($2)}'`" -lt 4; then

		LDFLAGS="$LDFLAGS -prebind"
fi

	    LDFLAGS="$LDFLAGS -headerpad_max_install_names"
	    { echo "$as_me:$LINENO: checking if ld accepts -search_paths_first flag" >&5
echo $ECHO_N "checking if ld accepts -search_paths_first flag... $ECHO_C" >&6; }
if test "${tcl_cv_ld_search_paths_first+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -Wl,-search_paths_first"
		cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
int i;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_ld_search_paths_first=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_ld_search_paths_first=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
		LDFLAGS=$hold_ldflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_ld_search_paths_first" >&5
echo "${ECHO_T}$tcl_cv_ld_search_paths_first" >&6; }
	    if test $tcl_cv_ld_search_paths_first = yes; then

		LDFLAGS="$LDFLAGS -Wl,-search_paths_first"

fi

	    if test "$tcl_cv_cc_visibility_hidden" != yes; then


cat >>confdefs.h <<\_ACEOF
#define MODULE_SCOPE __private_extern__
_ACEOF


fi

	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    LD_LIBRARY_PATH_VAR="DYLD_LIBRARY_PATH"
	    # TEA specific: for combined 32 & 64 bit fat builds of Tk
	    # extensions, verify that 64-bit build is possible.
	    if test "$fat_32_64" = yes && test -n "${TK_BIN_DIR}"; then

		if test "${TEA_WINDOWINGSYSTEM}" = x11; then

		    { echo "$as_me:$LINENO: checking for 64-bit X11" >&5
echo $ECHO_N "checking for 64-bit X11... $ECHO_C" >&6; }
if test "${tcl_cv_lib_x11_64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

			for v in CFLAGS CPPFLAGS LDFLAGS; do
			    eval 'hold_'$v'="$'$v'";'$v'="`echo "$'$v' "|sed -e "s/-arch ppc / /g" -e "s/-arch i386 / /g"`"'
			done
			CPPFLAGS="$CPPFLAGS -I/usr/X11R6/include"
			LDFLAGS="$LDFLAGS -L/usr/X11R6/lib -lX11"
			cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <X11/Xlib.h>
int
main ()
{
XrmInitialize();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_lib_x11_64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_lib_x11_64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
			for v in CFLAGS CPPFLAGS LDFLAGS; do
			    eval $v'="$hold_'$v'"'
			done
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_lib_x11_64" >&5
echo "${ECHO_T}$tcl_cv_lib_x11_64" >&6; }

fi

		# remove 64-bit arch flags from CFLAGS et al. if configuration
		# does not support 64-bit.
		if test "${TEA_WINDOWINGSYSTEM}" = aqua -o "$tcl_cv_lib_x11_64" = no; then

		    { echo "$as_me:$LINENO: Removing 64-bit architectures from compiler & linker flags" >&5
echo "$as_me: Removing 64-bit architectures from compiler & linker flags" >&6;}
		    for v in CFLAGS CPPFLAGS LDFLAGS; do
			eval $v'="`echo "$'$v' "|sed -e "s/-arch ppc64 / /g" -e "s/-arch x86_64 / /g"`"'
		    done
fi


fi

	    ;;
	NEXTSTEP-*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD='${CC} -nostdlib -r'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadNext.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OS/390-*)
	    CFLAGS_OPTIMIZE=""		# Optimizer is buggy

cat >>confdefs.h <<\_ACEOF
#define _OE_SOCKETS 1
_ACEOF

	    ;;
	OSF1-1.0|OSF1-1.1|OSF1-1.2)
	    # OSF/1 1.[012] from OSF, and derivatives, including Paragon OSF/1
	    SHLIB_CFLAGS=""
	    # Hack: make package name same as library name
	    SHLIB_LD='ld -R -export :'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadOSF.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OSF1-1.*)
	    # OSF/1 1.3 from OSF using ELF, and derivatives, including AD2
	    SHLIB_CFLAGS="-fPIC"
	    if test "$SHARED_BUILD" = 1; then
  SHLIB_LD="ld -shared"
else

	        SHLIB_LD="ld -non_shared"

fi

	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OSF1-V*)
	    # Digital OSF/1
	    SHLIB_CFLAGS=""
	    if test "$SHARED_BUILD" = 1; then

	        SHLIB_LD="${CC} -shared"

else

	        SHLIB_LD="${CC} -non_shared"

fi

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    if test $doRpath = yes; then

		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'
fi

	    if test "$GCC" = yes; then
  CFLAGS="$CFLAGS -mieee"
else

		CFLAGS="$CFLAGS -DHAVE_TZSET -std1 -ieee"
fi

	    # see pthread_intro(3) for pthread support on osf1, k.furukawa
	    if test "${TCL_THREADS}" = 1; then

		CFLAGS="$CFLAGS -DHAVE_PTHREAD_ATTR_SETSTACKSIZE"
		CFLAGS="$CFLAGS -DTCL_THREAD_STACK_MIN=PTHREAD_STACK_MIN*64"
		LIBS=`echo $LIBS | sed s/-lpthreads//`
		if test "$GCC" = yes; then

		    LIBS="$LIBS -lpthread -lmach -lexc"

else

		    CFLAGS="$CFLAGS -pthread"
		    LDFLAGS="$LDFLAGS -pthread"

fi


fi

	    ;;
	QNX-6*)
	    # QNX RTP
	    # This may work for all QNX, but it was only reported for v6.
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD="ld -Bshareable -x"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    # dlopen is in -lc on QNX
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SCO_SV-3.2*)
	    # Note, dlopen is available only on SCO 3.2.5 and greater. However,
	    # this test works, since "uname -s" was non-standard in 3.2.4 and
	    # below.
	    if test "$GCC" = yes; then

	    	SHLIB_CFLAGS="-fPIC -melf"
	    	LDFLAGS="$LDFLAGS -melf -Wl,-Bexport"

else

	    	SHLIB_CFLAGS="-Kpic -belf"
	    	LDFLAGS="$LDFLAGS -belf -Wl,-Bexport"

fi

	    SHLIB_LD="ld -G"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SINIX*5.4*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SunOS-4*)
	    SHLIB_CFLAGS="-PIC"
	    SHLIB_LD="ld"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS='-L${LIB_RUNTIME_DIR}'
	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}

	    # SunOS can't handle version numbers with dots in them in library
	    # specs, like -ltcl7.5, so use -ltcl75 instead.  Also, it
	    # requires an extra version number at the end of .so file names.
	    # So, the library has to have a name like libtcl75.so.1.0

	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'
	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	SunOS-5.[0-6])
	    # Careful to not let 5.10+ fall into this case

	    # Note: If _REENTRANT isn't defined, then Solaris
	    # won't define thread-safe library routines.


cat >>confdefs.h <<\_ACEOF
#define _REENTRANT 1
_ACEOF


cat >>confdefs.h <<\_ACEOF
#define _POSIX_PTHREAD_SEMANTICS 1
_ACEOF


	    SHLIB_CFLAGS="-KPIC"

	    # Note: need the LIBS below, otherwise Tk won't find Tcl's
	    # symbols when dynamically loaded into tclsh.

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    if test "$GCC" = yes; then

		SHLIB_LD='${CC} -shared'
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}

else

		SHLIB_LD="/usr/ccs/bin/ld -G -z text"
		CC_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}

fi

	    ;;
	SunOS-5*)
	    # Note: If _REENTRANT isn't defined, then Solaris
	    # won't define thread-safe library routines.


cat >>confdefs.h <<\_ACEOF
#define _REENTRANT 1
_ACEOF


cat >>confdefs.h <<\_ACEOF
#define _POSIX_PTHREAD_SEMANTICS 1
_ACEOF


	    SHLIB_CFLAGS="-KPIC"

	    # Check to enable 64-bit flags for compiler/linker
	    if test "$do64bit" = yes; then

		arch=`isainfo`
		if test "$arch" = "sparcv9 sparc"; then

		    if test "$GCC" = yes; then

			if test "`${CC} -dumpversion | awk -F. '{print $1}'`" -lt 3; then

			    { echo "$as_me:$LINENO: WARNING: 64bit mode not supported with GCC < 3.2 on $system" >&5
echo "$as_me: WARNING: 64bit mode not supported with GCC < 3.2 on $system" >&2;}

else

			    do64bit_ok=yes
			    CFLAGS="$CFLAGS -m64 -mcpu=v9"
			    LDFLAGS="$LDFLAGS -m64 -mcpu=v9"
			    SHLIB_CFLAGS="-fPIC"

fi


else

			do64bit_ok=yes
			if test "$do64bitVIS" = yes; then

			    CFLAGS="$CFLAGS -xarch=v9a"
			    LDFLAGS_ARCH="-xarch=v9a"

else

			    CFLAGS="$CFLAGS -xarch=v9"
			    LDFLAGS_ARCH="-xarch=v9"

fi

			# Solaris 64 uses this as well
			#LD_LIBRARY_PATH_VAR="LD_LIBRARY_PATH_64"

fi


else
  if test "$arch" = "amd64 i386"; then

		    if test "$GCC" = yes; then

			{ echo "$as_me:$LINENO: WARNING: 64bit mode not supported with GCC on $system" >&5
echo "$as_me: WARNING: 64bit mode not supported with GCC on $system" >&2;}

else

			do64bit_ok=yes
			CFLAGS="$CFLAGS -xarch=amd64"
			LDFLAGS="$LDFLAGS -xarch=amd64"

fi


else
  { echo "$as_me:$LINENO: WARNING: 64bit mode not supported for $arch" >&5
echo "$as_me: WARNING: 64bit mode not supported for $arch" >&2;}
fi

fi


fi


	    # Note: need the LIBS below, otherwise Tk won't find Tcl's
	    # symbols when dynamically loaded into tclsh.

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    if test "$GCC" = yes; then

		SHLIB_LD='${CC} -shared'
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
		if test "$do64bit_ok" = yes; then

		    # We need to specify -static-libgcc or we need to
		    # add the path to the sparv9 libgcc.
		    # JH: static-libgcc is necessary for core Tcl, but may
		    # not be necessary for extensions.
		    SHLIB_LD="$SHLIB_LD -m64 -mcpu=v9 -static-libgcc"
		    # for finding sparcv9 libgcc, get the regular libgcc
		    # path, remove so name and append 'sparcv9'
		    #v9gcclibdir="`gcc -print-file-name=libgcc_s.so` | ..."
		    #CC_SEARCH_FLAGS="${CC_SEARCH_FLAGS},-R,$v9gcclibdir"

fi


else

		case $system in
		    SunOS-5.[1-9][0-9]*)
			SHLIB_LD='${CC} -G -z text ${LDFLAGS}';;
		    *)
			SHLIB_LD='/usr/ccs/bin/ld -G -z text';;
		esac
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'

fi

	    ;;
	UNIX_SV* | UnixWare-5*)
	    SHLIB_CFLAGS="-KPIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    # Some UNIX_SV* systems (unixware 1.1.2 for example) have linkers
	    # that don't grok the -Bexport option.  Test that it does.
	    { echo "$as_me:$LINENO: checking for ld accepts -Bexport flag" >&5
echo $ECHO_N "checking for ld accepts -Bexport flag... $ECHO_C" >&6; }
if test "${tcl_cv_ld_Bexport+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -Wl,-Bexport"
		cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
int i;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  tcl_cv_ld_Bexport=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_ld_Bexport=no
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
	        LDFLAGS=$hold_ldflags
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_ld_Bexport" >&5
echo "${ECHO_T}$tcl_cv_ld_Bexport" >&6; }
	    if test $tcl_cv_ld_Bexport = yes; then

		LDFLAGS="$LDFLAGS -Wl,-Bexport"

fi

	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
    esac

    if test "$do64bit" = yes -a "$do64bit_ok" = no; then

	{ echo "$as_me:$LINENO: WARNING: 64bit support being disabled -- don't know magic for this platform" >&5
echo "$as_me: WARNING: 64bit support being disabled -- don't know magic for this platform" >&2;}

fi




    # Step 4: disable dynamic loading if requested via a command-line switch.

    # Check whether --enable-load was given.
if test "${enable_load+set}" = set; then
  enableval=$enable_load; tcl_ok=$enableval
else
  tcl_ok=yes
fi

    if test "$tcl_ok" = no; then
  DL_OBJS=""
fi


    if test "x$DL_OBJS" != x; then
  BUILD_DLTEST="\$(DLTEST_TARGETS)"
else

	{ echo "$as_me:$LINENO: WARNING: Can't figure out how to do dynamic loading or shared libraries on this system." >&5
echo "$as_me: WARNING: Can't figure out how to do dynamic loading or shared libraries on this system." >&2;}
	SHLIB_CFLAGS=""
	SHLIB_LD=""
	SHLIB_SUFFIX=""
	DL_OBJS="tclLoadNone.o"
	DL_LIBS=""
	LDFLAGS="$LDFLAGS_ORIG"
	CC_SEARCH_FLAGS=""
	LD_SEARCH_FLAGS=""
	BUILD_DLTEST=""

fi

    LDFLAGS="$LDFLAGS $LDFLAGS_ARCH"

    # If we're running gcc, then change the C flags for compiling shared
    # libraries to the right flags for gcc, instead of those for the
    # standard manufacturer compiler.

    if test "$DL_OBJS" != "tclLoadNone.o" -a "$GCC" = yes; then

	case $system in
	    AIX-*) ;;
	    BSD/OS*) ;;
	    IRIX*) ;;
	    NetBSD-*|FreeBSD-*) ;;
	    Darwin-*) ;;
	    SCO_SV-3.2*) ;;
	    *) SHLIB_CFLAGS="-fPIC" ;;
	esac
fi


    if test "$SHARED_LIB_SUFFIX" = ""; then

	# TEA specific: use PACKAGE_VERSION instead of VERSION
	SHARED_LIB_SUFFIX='${PACKAGE_VERSION}${SHLIB_SUFFIX}'
fi

    if test "$UNSHARED_LIB_SUFFIX" = ""; then

	# TEA specific: use PACKAGE_VERSION instead of VERSION
	UNSHARED_LIB_SUFFIX='${PACKAGE_VERSION}.a'
fi
















    # These must be called after we do the basic CFLAGS checks and
    # verify any possible 64-bit or similar switches are necessary

    { echo "$as_me:$LINENO: checking for required early compiler flags" >&5
echo $ECHO_N "checking for required early compiler flags... $ECHO_C" >&6; }
    tcl_flags=""

    if test "${tcl_cv_flag__isoc99_source+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <stdlib.h>
int
main ()
{
char *p = (char *)strtoll; char *q = (char *)strtoull;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__isoc99_source=no
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#define _ISOC99_SOURCE 1
#include <stdlib.h>
int
main ()
{
char *p = (char *)strtoll; char *q = (char *)strtoull;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__isoc99_source=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_flag__isoc99_source=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

    if test "x${tcl_cv_flag__isoc99_source}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define _ISOC99_SOURCE 1
_ACEOF

	tcl_flags="$tcl_flags _ISOC99_SOURCE"
    fi


    if test "${tcl_cv_flag__largefile64_source+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/stat.h>
int
main ()
{
struct stat64 buf; int i = stat64("/", &buf);
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__largefile64_source=no
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#define _LARGEFILE64_SOURCE 1
#include <sys/stat.h>
int
main ()
{
struct stat64 buf; int i = stat64("/", &buf);
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__largefile64_source=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_flag__largefile64_source=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

    if test "x${tcl_cv_flag__largefile64_source}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define _LARGEFILE64_SOURCE 1
_ACEOF

	tcl_flags="$tcl_flags _LARGEFILE64_SOURCE"
    fi


    if test "${tcl_cv_flag__largefile_source64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/stat.h>
int
main ()
{
char *p = (char *)open64;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__largefile_source64=no
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#define _LARGEFILE_SOURCE64 1
#include <sys/stat.h>
int
main ()
{
char *p = (char *)open64;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_flag__largefile_source64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_flag__largefile_source64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

    if test "x${tcl_cv_flag__largefile_source64}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define _LARGEFILE_SOURCE64 1
_ACEOF

	tcl_flags="$tcl_flags _LARGEFILE_SOURCE64"
    fi

    if test "x${tcl_flags}" = "x" ; then
	{ echo "$as_me:$LINENO: result: none" >&5
echo "${ECHO_T}none" >&6; }
    else
	{ echo "$as_me:$LINENO: result: ${tcl_flags}" >&5
echo "${ECHO_T}${tcl_flags}" >&6; }
    fi


    { echo "$as_me:$LINENO: checking for 64-bit integer type" >&5
echo $ECHO_N "checking for 64-bit integer type... $ECHO_C" >&6; }
    if test "${tcl_cv_type_64bit+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	tcl_cv_type_64bit=none
	# See if the compiler knows natively about __int64
	cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
__int64 value = (__int64) 0;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_type_64bit=__int64
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_type_64bit="long long"
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
	# See if we should use long anyway  Note that we substitute in the
	# type that is our current guess for a 64-bit type inside this check
	# program, so it should be modified only carefully...
        cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */

int
main ()
{
switch (0) {
            case 1: case (sizeof(${tcl_type_64bit})==sizeof(long)): ;
        }
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_type_64bit=${tcl_type_64bit}
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5


fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

    if test "${tcl_cv_type_64bit}" = none ; then

cat >>confdefs.h <<\_ACEOF
#define TCL_WIDE_INT_IS_LONG 1
_ACEOF

	{ echo "$as_me:$LINENO: result: using long" >&5
echo "${ECHO_T}using long" >&6; }
    elif test "${tcl_cv_type_64bit}" = "__int64" \
		-a "${TEA_PLATFORM}" = "windows" ; then
	# TEA specific: We actually want to use the default tcl.h checks in
	# this case to handle both TCL_WIDE_INT_TYPE and TCL_LL_MODIFIER*
	{ echo "$as_me:$LINENO: result: using Tcl header defaults" >&5
echo "${ECHO_T}using Tcl header defaults" >&6; }
    else

cat >>confdefs.h <<_ACEOF
#define TCL_WIDE_INT_TYPE ${tcl_cv_type_64bit}
_ACEOF

	{ echo "$as_me:$LINENO: result: ${tcl_cv_type_64bit}" >&5
echo "${ECHO_T}${tcl_cv_type_64bit}" >&6; }

	# Now check for auxiliary declarations
	{ echo "$as_me:$LINENO: checking for struct dirent64" >&5
echo $ECHO_N "checking for struct dirent64... $ECHO_C" >&6; }
if test "${tcl_cv_struct_dirent64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/types.h>
#include <sys/dirent.h>
int
main ()
{
struct dirent64 p;
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_struct_dirent64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_struct_dirent64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_struct_dirent64" >&5
echo "${ECHO_T}$tcl_cv_struct_dirent64" >&6; }
	if test "x${tcl_cv_struct_dirent64}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define HAVE_STRUCT_DIRENT64 1
_ACEOF

	fi

	{ echo "$as_me:$LINENO: checking for struct stat64" >&5
echo $ECHO_N "checking for struct stat64... $ECHO_C" >&6; }
if test "${tcl_cv_struct_stat64+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/stat.h>
int
main ()
{
struct stat64 p;

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_struct_stat64=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_struct_stat64=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi
{ echo "$as_me:$LINENO: result: $tcl_cv_struct_stat64" >&5
echo "${ECHO_T}$tcl_cv_struct_stat64" >&6; }
	if test "x${tcl_cv_struct_stat64}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define HAVE_STRUCT_STAT64 1
_ACEOF

	fi



for ac_func in open64 lseek64
do
as_ac_var=`echo "ac_cv_func_$ac_func" | $as_tr_sh`
{ echo "$as_me:$LINENO: checking for $ac_func" >&5
echo $ECHO_N "checking for $ac_func... $ECHO_C" >&6; }
if { as_var=$as_ac_var; eval "test \"\${$as_var+set}\" = set"; }; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else
  cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
/* Define $ac_func to an innocuous variant, in case <limits.h> declares $ac_func.
   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
#define $ac_func innocuous_$ac_func

/* System header to define __stub macros and hopefully few prototypes,
    which can conflict with char $ac_func (); below.
    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
    <limits.h> exists even on freestanding compilers.  */

#ifdef __STDC__
# include <limits.h>
#else
# include <assert.h>
#endif

#undef $ac_func

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char $ac_func ();
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined __stub_$ac_func || defined __stub___$ac_func
choke me
#endif

int
main ()
{
return $ac_func ();
  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext conftest$ac_exeext
if { (ac_try="$ac_link"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_link") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest$ac_exeext &&
       $as_test_x conftest$ac_exeext; then
  eval "$as_ac_var=yes"
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	eval "$as_ac_var=no"
fi

rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
      conftest$ac_exeext conftest.$ac_ext
fi
ac_res=`eval echo '${'$as_ac_var'}'`
	       { echo "$as_me:$LINENO: result: $ac_res" >&5
echo "${ECHO_T}$ac_res" >&6; }
if test `eval echo '${'$as_ac_var'}'` = yes; then
  cat >>confdefs.h <<_ACEOF
#define `echo "HAVE_$ac_func" | $as_tr_cpp` 1
_ACEOF

fi
done

	{ echo "$as_me:$LINENO: checking for off64_t" >&5
echo $ECHO_N "checking for off64_t... $ECHO_C" >&6; }
	if test "${tcl_cv_type_off64_t+set}" = set; then
  echo $ECHO_N "(cached) $ECHO_C" >&6
else

	    cat >conftest.$ac_ext <<_ACEOF
/* confdefs.h.  */
_ACEOF
cat confdefs.h >>conftest.$ac_ext
cat >>conftest.$ac_ext <<_ACEOF
/* end confdefs.h.  */
#include <sys/types.h>
int
main ()
{
off64_t offset;

  ;
  return 0;
}
_ACEOF
rm -f conftest.$ac_objext
if { (ac_try="$ac_compile"
case "(($ac_try" in
  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
  *) ac_try_echo=$ac_try;;
esac
eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
  (eval "$ac_compile") 2>conftest.er1
  ac_status=$?
  grep -v '^ *+' conftest.er1 >conftest.err
  rm -f conftest.er1
  cat conftest.err >&5
  echo "$as_me:$LINENO: \$? = $ac_status" >&5
  (exit $ac_status); } && {
	 test -z "$ac_c_werror_flag" ||
	 test ! -s conftest.err
       } && test -s conftest.$ac_objext; then
  tcl_cv_type_off64_t=yes
else
  echo "$as_me: failed program was:" >&5
sed 's/^/| /' conftest.$ac_ext >&5

	tcl_cv_type_off64_t=no
fi

rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
fi

			if test "x${tcl_cv_type_off64_t}" = "xyes" && \
	        test "x${ac_cv_func_lseek64}" = "xyes" && \
	        test "x${ac_cv_func_open64}" = "xyes" ; then

cat >>confdefs.h <<\_ACEOF
#define HAVE_TYPE_OFF64_T 1
_ACEOF

	    { echo "$as_me:$LINENO: result: yes" >&5
echo "${ECHO_T}yes" >&6; }
	else
	    { echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
	fi
    fi


# should be part of TEA_CONFIG_CFLAGS, but more visible modification here


#--------------------------------------------------------------------
# Set the default compiler switches based on the --enable-symbols option.
#--------------------------------------------------------------------



    { echo "$as_me:$LINENO: checking for build with symbols" >&5
echo $ECHO_N "checking for build with symbols... $ECHO_C" >&6; }
    # Check whether --enable-symbols was given.
if test "${enable_symbols+set}" = set; then
  enableval=$enable_symbols; tcl_ok=$enableval
else
  tcl_ok=no
fi

    DBGX=""
    if test "$tcl_ok" = "no"; then
	CFLAGS_DEFAULT="${CFLAGS_OPTIMIZE}"
	LDFLAGS_DEFAULT="${LDFLAGS_OPTIMIZE}"
	{ echo "$as_me:$LINENO: result: no" >&5
echo "${ECHO_T}no" >&6; }
    else
	CFLAGS_DEFAULT="${CFLAGS_DEBUG}"
	LDFLAGS_DEFAULT="${LDFLAGS_DEBUG}"
	if test "$tcl_ok" = "yes"; then
	    { echo "$as_me:$LINENO: result: yes (standard debugging)" >&5
echo "${ECHO_T}yes (standard debugging)" >&6; }
	fi
    fi
    # TEA specific:
    if test "${TEA_PLATFORM}" != "windows" ; then
	LDFLAGS_DEFAULT="${LDFLAGS}"
    fi




    if test "$tcl_ok" = "mem" -o "$tcl_ok" = "all"; then

cat >>confdefs.h <<\_ACEOF
#define TCL_MEM_DEBUG 1
_ACEOF

    fi

    if test "$tcl_ok" != "yes" -a "$tcl_ok" != "no"; then
	if test "$tcl_ok" = "all"; then
	    { echo "$as_me:$LINENO: result: enabled symbols mem debugging" >&5
echo "${ECHO_T}enabled symbols mem debugging" >&6; }
	else
	    { echo "$as_me:$LINENO: result: enabled $tcl_ok debugging" >&5
echo "${ECHO_T}enabled $tcl_ok debugging" >&6; }
	fi
    fi


#--------------------------------------------------------------------
# Everyone should be linking against the Tcl stub library.  If you
# can't for some reason, remove this definition.  If you aren't using
# stubs, you also need to modify the SHLIB_LD_LIBS setting below to
# link against the non-stubbed Tcl library.  Add Tk too if necessary.
#--------------------------------------------------------------------

if test "${USE_STUBS}" = "1" ; then

cat >>confdefs.h <<\_ACEOF
#define USE_TCL_STUBS 1
_ACEOF


cat >>confdefs.h <<\_ACEOF
#define USE_TK_STUBS 1
_ACEOF

fi

#--------------------------------------------------------------------
# This macro generates a line to use when building a library.  It
# depends on values set by the TEA_ENABLE_SHARED, TEA_ENABLE_SYMBOLS,
# and TEA_LOAD_TCLCONFIG macros above.
#--------------------------------------------------------------------


    if test "${TEA_PLATFORM}" = "windows" -a "$GCC" != "yes"; then
	MAKE_STATIC_LIB="\${STLIB_LD} -out:\$@ \$(PKG_OBJECTS)"
	MAKE_SHARED_LIB="\${SHLIB_LD} \${SHLIB_LD_LIBS} \${LDFLAGS_DEFAULT} -out:\$@ \$(PKG_OBJECTS)"
	MAKE_STUB_LIB="\${STLIB_LD} -out:\$@ \$(PKG_STUB_OBJECTS)"
    else
	MAKE_STATIC_LIB="\${STLIB_LD} \$@ \$(PKG_OBJECTS)"
	MAKE_SHARED_LIB="\${SHLIB_LD} -o \$@ \$(PKG_OBJECTS) \${SHLIB_LD_LIBS}"
	MAKE_STUB_LIB="\${STLIB_LD} \$@ \$(PKG_STUB_OBJECTS)"
    fi

    if test "${SHARED_BUILD}" = "1" ; then
	MAKE_LIB="${MAKE_SHARED_LIB} "
    else
	MAKE_LIB="${MAKE_STATIC_LIB} "
    fi

    #--------------------------------------------------------------------
    # Shared libraries and static libraries have different names.
    # Use the double eval to make sure any variables in the suffix is
    # substituted. (@@@ Might not be necessary anymore)
    #--------------------------------------------------------------------

    if test "${TEA_PLATFORM}" = "windows" ; then
	if test "${SHARED_BUILD}" = "1" ; then
	    # We force the unresolved linking of symbols that are really in
	    # the private libraries of Tcl and Tk.
	    SHLIB_LD_LIBS="${SHLIB_LD_LIBS} \"`${CYGPATH} ${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}`\""
	    if test x"${TK_BIN_DIR}" != x ; then
		SHLIB_LD_LIBS="${SHLIB_LD_LIBS} \"`${CYGPATH} ${TK_BIN_DIR}/${TK_STUB_LIB_FILE}`\""
	    fi
	    eval eval "PKG_LIB_FILE=${PACKAGE_NAME}${SHARED_LIB_SUFFIX}"
	else
	    eval eval "PKG_LIB_FILE=${PACKAGE_NAME}${UNSHARED_LIB_SUFFIX}"
	fi
	# Some packages build their own stubs libraries
	eval eval "PKG_STUB_LIB_FILE=${PACKAGE_NAME}stub${UNSHARED_LIB_SUFFIX}"
	if test "$GCC" = "yes"; then
	    PKG_STUB_LIB_FILE=lib${PKG_STUB_LIB_FILE}
	fi
	# These aren't needed on Windows (either MSVC or gcc)
	RANLIB=:
	RANLIB_STUB=:
    else
	RANLIB_STUB="${RANLIB}"
	if test "${SHARED_BUILD}" = "1" ; then
	    SHLIB_LD_LIBS="${SHLIB_LD_LIBS} ${TCL_STUB_LIB_SPEC}"
	    if test x"${TK_BIN_DIR}" != x ; then
		SHLIB_LD_LIBS="${SHLIB_LD_LIBS} ${TK_STUB_LIB_SPEC}"
	    fi
	    eval eval "PKG_LIB_FILE=lib${PACKAGE_NAME}${SHARED_LIB_SUFFIX}"
	    RANLIB=:
	else
	    eval eval "PKG_LIB_FILE=lib${PACKAGE_NAME}${UNSHARED_LIB_SUFFIX}"
	fi
	# Some packages build their own stubs libraries
	eval eval "PKG_STUB_LIB_FILE=lib${PACKAGE_NAME}stub${UNSHARED_LIB_SUFFIX}"
    fi

    # These are escaped so that only CFLAGS is picked up at configure time.
    # The other values will be substituted at make time.
    CFLAGS="${CFLAGS} \${CFLAGS_DEFAULT} \${CFLAGS_WARNING}"
    if test "${SHARED_BUILD}" = "1" ; then
	CFLAGS="${CFLAGS} \${SHLIB_CFLAGS}"
    fi








if test "${USE_STUBS}" = "0" ; then
	SHLIB_LD_LIBS=`echo "$SHLIB_LD_LIBS" | sed -e 's!stub!!g'`
fi

#--------------------------------------------------------------------
# Determine the name of the tclsh and/or wish executables in the
# Tcl and Tk build directories or the location they were installed
# into. These paths are used to support running test cases only,
# the Makefile should not be making use of these paths to generate
# a pkgIndex.tcl file or anything else at extension build time.
#--------------------------------------------------------------------


    { echo "$as_me:$LINENO: checking for tclsh" >&5
echo $ECHO_N "checking for tclsh... $ECHO_C" >&6; }
    if test -f "${TCL_BIN_DIR}/Makefile" ; then
        # tclConfig.sh is in Tcl build directory
        if test "${TEA_PLATFORM}" = "windows"; then
            TCLSH_PROG="${TCL_BIN_DIR}/tclsh${TCL_MAJOR_VERSION}${TCL_MINOR_VERSION}${TCL_DBGX}${EXEEXT}"
        else
            TCLSH_PROG="${TCL_BIN_DIR}/tclsh"
        fi
    else
        # tclConfig.sh is in install location
        if test "${TEA_PLATFORM}" = "windows"; then
            TCLSH_PROG="tclsh${TCL_MAJOR_VERSION}${TCL_MINOR_VERSION}${TCL_DBGX}${EXEEXT}"
        else
            TCLSH_PROG="tclsh${TCL_MAJOR_VERSION}.${TCL_MINOR_VERSION}${TCL_DBGX}"
        fi
        list="`ls -d ${TCL_BIN_DIR}/../bin 2>/dev/null` \
              `ls -d ${TCL_BIN_DIR}/..     2>/dev/null` \
              `ls -d ${TCL_PREFIX}/bin     2>/dev/null`"
        for i in $list ; do
            if test -f "$i/${TCLSH_PROG}" ; then
                REAL_TCL_BIN_DIR="`cd "$i"; pwd`/"
                break
            fi
        done
        TCLSH_PROG="${REAL_TCL_BIN_DIR}${TCLSH_PROG}"
    fi
    { echo "$as_me:$LINENO: result: ${TCLSH_PROG}" >&5
echo "${ECHO_T}${TCLSH_PROG}" >&6; }



    { echo "$as_me:$LINENO: checking for wish" >&5
echo $ECHO_N "checking for wish... $ECHO_C" >&6; }
    if test -f "${TK_BIN_DIR}/Makefile" ; then
        # tkConfig.sh is in Tk build directory
        if test "${TEA_PLATFORM}" = "windows"; then
            WISH_PROG="${TK_BIN_DIR}/wish${TK_MAJOR_VERSION}${TK_MINOR_VERSION}${TK_DBGX}${EXEEXT}"
        else
            WISH_PROG="${TK_BIN_DIR}/wish"
        fi
    else
        # tkConfig.sh is in install location
        if test "${TEA_PLATFORM}" = "windows"; then
            WISH_PROG="wish${TK_MAJOR_VERSION}${TK_MINOR_VERSION}${TK_DBGX}${EXEEXT}"
        else
            WISH_PROG="wish${TK_MAJOR_VERSION}.${TK_MINOR_VERSION}${TK_DBGX}"
        fi
        list="`ls -d ${TK_BIN_DIR}/../bin 2>/dev/null` \
              `ls -d ${TK_BIN_DIR}/..     2>/dev/null` \
              `ls -d ${TK_PREFIX}/bin     2>/dev/null`"
        for i in $list ; do
            if test -f "$i/${WISH_PROG}" ; then
                REAL_TK_BIN_DIR="`cd "$i"; pwd`/"
                break
            fi
        done
        WISH_PROG="${REAL_TK_BIN_DIR}${WISH_PROG}"
    fi
    { echo "$as_me:$LINENO: result: ${WISH_PROG}" >&5
echo "${ECHO_T}${WISH_PROG}" >&6; }



#--------------------------------------------------------------------
# Finally, substitute all of the various values into the Makefile.
# You may alternatively have a special pkgIndex.tcl.in or other files
# which require substituting th AC variables in.  Include these here.
#--------------------------------------------------------------------

ac_config_files="$ac_config_files Makefile pkgIndex.tcl togl_ws.h"

cat >confcache <<\_ACEOF
# This file is a shell script that caches the results of configure
# tests run on this system so they can be shared between configure
# scripts and configure runs, see configure's option --config-cache.
# It is not useful on other systems.  If it contains results you don't
# want to keep, you may remove or edit it.
#
# config.status only pays attention to the cache file if you give it
# the --recheck option to rerun configure.
#
# `ac_cv_env_foo' variables (set or unset) will be overridden when
# loading this file, other *unset* `ac_cv_foo' will be assigned the
# following values.

_ACEOF

# The following way of writing the cache mishandles newlines in values,
# but we know of no workaround that is simple, portable, and efficient.
# So, we kill variables containing newlines.
# Ultrix sh set writes to stderr and can't be redirected directly,
# and sets the high bit in the cache file unless we assign to the vars.
(
  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
    eval ac_val=\$$ac_var
    case $ac_val in #(
    *${as_nl}*)
      case $ac_var in #(
      *_cv_*) { echo "$as_me:$LINENO: WARNING: Cache variable $ac_var contains a newline." >&5
echo "$as_me: WARNING: Cache variable $ac_var contains a newline." >&2;} ;;
      esac
      case $ac_var in #(
      _ | IFS | as_nl) ;; #(
      *) $as_unset $ac_var ;;
      esac ;;
    esac
  done

  (set) 2>&1 |
    case $as_nl`(ac_space=' '; set) 2>&1` in #(
    *${as_nl}ac_space=\ *)
      # `set' does not quote correctly, so add quotes (double-quote
      # substitution turns \\\\ into \\, and sed turns \\ into \).
      sed -n \
	"s/'/'\\\\''/g;
	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
      ;; #(
    *)
      # `set' quotes correctly as required by POSIX, so do not add quotes.
      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
      ;;
    esac |
    sort
) |
  sed '
     /^ac_cv_env_/b end
     t clear
     :clear
     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
     t end
     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
     :end' >>confcache
if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
  if test -w "$cache_file"; then
    test "x$cache_file" != "x/dev/null" &&
      { echo "$as_me:$LINENO: updating cache $cache_file" >&5
echo "$as_me: updating cache $cache_file" >&6;}
    cat confcache >$cache_file
  else
    { echo "$as_me:$LINENO: not updating unwritable cache $cache_file" >&5
echo "$as_me: not updating unwritable cache $cache_file" >&6;}
  fi
fi
rm -f confcache

test "x$prefix" = xNONE && prefix=$ac_default_prefix
# Let make expand exec_prefix.
test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'

# Transform confdefs.h into DEFS.
# Protect against shell expansion while executing Makefile rules.
# Protect against Makefile macro expansion.
#
# If the first sed substitution is executed (which looks for macros that
# take arguments), then branch to the quote section.  Otherwise,
# look for a macro that doesn't take arguments.
ac_script='
t clear
:clear
s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*([^)]*)\)[	 ]*\(.*\)/-D\1=\2/g
t quote
s/^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)/-D\1=\2/g
t quote
b any
:quote
s/[	 `~#$^&*(){}\\|;'\''"<>?]/\\&/g
s/\[/\\&/g
s/\]/\\&/g
s/\$/$$/g
H
:any
${
	g
	s/^\n//
	s/\n/ /g
	p
}
'
DEFS=`sed -n "$ac_script" confdefs.h`


ac_libobjs=
ac_ltlibobjs=
for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
  # 1. Remove the extension, and $U if already installed.
  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
  ac_i=`echo "$ac_i" | sed "$ac_script"`
  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
  #    will be set to the directory where LIBOBJS objects are built.
  ac_libobjs="$ac_libobjs \${LIBOBJDIR}$ac_i\$U.$ac_objext"
  ac_ltlibobjs="$ac_ltlibobjs \${LIBOBJDIR}$ac_i"'$U.lo'
done
LIBOBJS=$ac_libobjs

LTLIBOBJS=$ac_ltlibobjs


CFLAGS="${CFLAGS} ${CPPFLAGS}"; CPPFLAGS=""

: ${CONFIG_STATUS=./config.status}
ac_clean_files_save=$ac_clean_files
ac_clean_files="$ac_clean_files $CONFIG_STATUS"
{ echo "$as_me:$LINENO: creating $CONFIG_STATUS" >&5
echo "$as_me: creating $CONFIG_STATUS" >&6;}
cat >$CONFIG_STATUS <<_ACEOF
#! $SHELL
# Generated by $as_me.
# Run this file to recreate the current configuration.
# Compiler output produced by configure, useful for debugging
# configure, is in config.log if it exists.

debug=false
ac_cs_recheck=false
ac_cs_silent=false
SHELL=\${CONFIG_SHELL-$SHELL}
_ACEOF

cat >>$CONFIG_STATUS <<\_ACEOF
## --------------------- ##
## M4sh Initialization.  ##
## --------------------- ##

# Be more Bourne compatible
DUALCASE=1; export DUALCASE # for MKS sh
if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
  emulate sh
  NULLCMD=:
  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
  # is contrary to our usage.  Disable this feature.
  alias -g '${1+"$@"}'='"$@"'
  setopt NO_GLOB_SUBST
else
  case `(set -o) 2>/dev/null` in
  *posix*) set -o posix ;;
esac

fi




# PATH needs CR
# Avoid depending upon Character Ranges.
as_cr_letters='abcdefghijklmnopqrstuvwxyz'
as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
as_cr_Letters=$as_cr_letters$as_cr_LETTERS
as_cr_digits='0123456789'
as_cr_alnum=$as_cr_Letters$as_cr_digits

# The user is always right.
if test "${PATH_SEPARATOR+set}" != set; then
  echo "#! /bin/sh" >conf$$.sh
  echo  "exit 0"   >>conf$$.sh
  chmod +x conf$$.sh
  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
    PATH_SEPARATOR=';'
  else
    PATH_SEPARATOR=:
  fi
  rm -f conf$$.sh
fi

# Support unset when possible.
if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
  as_unset=unset
else
  as_unset=false
fi


# IFS
# We need space, tab and new line, in precisely that order.  Quoting is
# there to prevent editors from complaining about space-tab.
# (If _AS_PATH_WALK were called with IFS unset, it would disable word
# splitting by setting IFS to empty value.)
as_nl='
'
IFS=" ""	$as_nl"

# Find who we are.  Look in the path if we contain no directory separator.
case $0 in
  *[\\/]* ) as_myself=$0 ;;
  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
for as_dir in $PATH
do
  IFS=$as_save_IFS
  test -z "$as_dir" && as_dir=.
  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
done
IFS=$as_save_IFS

     ;;
esac
# We did not find ourselves, most probably we were run as `sh COMMAND'
# in which case we are not to be found in the path.
if test "x$as_myself" = x; then
  as_myself=$0
fi
if test ! -f "$as_myself"; then
  echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
  { (exit 1); exit 1; }
fi

# Work around bugs in pre-3.0 UWIN ksh.
for as_var in ENV MAIL MAILPATH
do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
done
PS1='$ '
PS2='> '
PS4='+ '

# NLS nuisances.
for as_var in \
  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
  LC_TELEPHONE LC_TIME
do
  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
    eval $as_var=C; export $as_var
  else
    ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
  fi
done

# Required to use basename.
if expr a : '\(a\)' >/dev/null 2>&1 &&
   test "X`expr 00001 : '.*\(...\)'`" = X001; then
  as_expr=expr
else
  as_expr=false
fi

if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
  as_basename=basename
else
  as_basename=false
fi


# Name of the executable.
as_me=`$as_basename -- "$0" ||
$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
	 X"$0" : 'X\(//\)$' \| \
	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
echo X/"$0" |
    sed '/^.*\/\([^/][^/]*\)\/*$/{
	    s//\1/
	    q
	  }
	  /^X\/\(\/\/\)$/{
	    s//\1/
	    q
	  }
	  /^X\/\(\/\).*/{
	    s//\1/
	    q
	  }
	  s/.*/./; q'`

# CDPATH.
$as_unset CDPATH



  as_lineno_1=$LINENO
  as_lineno_2=$LINENO
  test "x$as_lineno_1" != "x$as_lineno_2" &&
  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {

  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
  # uniformly replaced by the line number.  The first 'sed' inserts a
  # line-number line after each line using $LINENO; the second 'sed'
  # does the real work.  The second script uses 'N' to pair each
  # line-number line with the line containing $LINENO, and appends
  # trailing '-' during substitution so that $LINENO is not a special
  # case at line end.
  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
  # scripts with optimization help from Paolo Bonzini.  Blame Lee
  # E. McMahon (1931-1989) for sed's syntax.  :-)
  sed -n '
    p
    /[$]LINENO/=
  ' <$as_myself |
    sed '
      s/[$]LINENO.*/&-/
      t lineno
      b
      :lineno
      N
      :loop
      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
      t loop
      s/-\n.*//
    ' >$as_me.lineno &&
  chmod +x "$as_me.lineno" ||
    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
   { (exit 1); exit 1; }; }

  # Don't try to exec as it changes $[0], causing all sort of problems
  # (the dirname of $[0] is not the place where we might find the
  # original and so on.  Autoconf is especially sensitive to this).
  . "./$as_me.lineno"
  # Exit status is that of the last command.
  exit
}


if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
  as_dirname=dirname
else
  as_dirname=false
fi

ECHO_C= ECHO_N= ECHO_T=
case `echo -n x` in
-n*)
  case `echo 'x\c'` in
  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
  *)   ECHO_C='\c';;
  esac;;
*)
  ECHO_N='-n';;
esac

if expr a : '\(a\)' >/dev/null 2>&1 &&
   test "X`expr 00001 : '.*\(...\)'`" = X001; then
  as_expr=expr
else
  as_expr=false
fi

rm -f conf$$ conf$$.exe conf$$.file
if test -d conf$$.dir; then
  rm -f conf$$.dir/conf$$.file
else
  rm -f conf$$.dir
  mkdir conf$$.dir
fi
echo >conf$$.file
if ln -s conf$$.file conf$$ 2>/dev/null; then
  as_ln_s='ln -s'
  # ... but there are two gotchas:
  # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
  # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
  # In both cases, we have to default to `cp -p'.
  ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
    as_ln_s='cp -p'
elif ln conf$$.file conf$$ 2>/dev/null; then
  as_ln_s=ln
else
  as_ln_s='cp -p'
fi
rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
rmdir conf$$.dir 2>/dev/null

if mkdir -p . 2>/dev/null; then
  as_mkdir_p=:
else
  test -d ./-p && rmdir ./-p
  as_mkdir_p=false
fi

if test -x / >/dev/null 2>&1; then
  as_test_x='test -x'
else
  if ls -dL / >/dev/null 2>&1; then
    as_ls_L_option=L
  else
    as_ls_L_option=
  fi
  as_test_x='
    eval sh -c '\''
      if test -d "$1"; then
        test -d "$1/.";
      else
	case $1 in
        -*)set "./$1";;
	esac;
	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
	???[sx]*):;;*)false;;esac;fi
    '\'' sh
  '
fi
as_executable_p=$as_test_x

# Sed expression to map a string onto a valid CPP name.
as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"

# Sed expression to map a string onto a valid variable name.
as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"


exec 6>&1

# Save the log message, to keep $[0] and so on meaningful, and to
# report actual input values of CONFIG_FILES etc. instead of their
# values after options handling.
ac_log="
This file was extended by Togl $as_me 2.0, which was
generated by GNU Autoconf 2.61.  Invocation command line was

  CONFIG_FILES    = $CONFIG_FILES
  CONFIG_HEADERS  = $CONFIG_HEADERS
  CONFIG_LINKS    = $CONFIG_LINKS
  CONFIG_COMMANDS = $CONFIG_COMMANDS
  $ $0 $@

on `(hostname || uname -n) 2>/dev/null | sed 1q`
"

_ACEOF

cat >>$CONFIG_STATUS <<_ACEOF
# Files that config.status was made for.
config_files="$ac_config_files"

_ACEOF

cat >>$CONFIG_STATUS <<\_ACEOF
ac_cs_usage="\
\`$as_me' instantiates files from templates according to the
current configuration.

Usage: $0 [OPTIONS] [FILE]...

  -h, --help       print this help, then exit
  -V, --version    print version number and configuration settings, then exit
  -q, --quiet      do not print progress messages
  -d, --debug      don't remove temporary files
      --recheck    update $as_me by reconfiguring in the same conditions
  --file=FILE[:TEMPLATE]
		   instantiate the configuration file FILE

Configuration files:
$config_files

Report bugs to <bug-autoconf@gnu.org>."

_ACEOF
cat >>$CONFIG_STATUS <<_ACEOF
ac_cs_version="\\
Togl config.status 2.0
configured by $0, generated by GNU Autoconf 2.61,
  with options \\"`echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`\\"

Copyright (C) 2006 Free Software Foundation, Inc.
This config.status script is free software; the Free Software Foundation
gives unlimited permission to copy, distribute and modify it."

ac_pwd='$ac_pwd'
srcdir='$srcdir'
INSTALL='$INSTALL'
_ACEOF

cat >>$CONFIG_STATUS <<\_ACEOF
# If no file are specified by the user, then we need to provide default
# value.  By we need to know if files were specified by the user.
ac_need_defaults=:
while test $# != 0
do
  case $1 in
  --*=*)
    ac_option=`expr "X$1" : 'X\([^=]*\)='`
    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
    ac_shift=:
    ;;
  *)
    ac_option=$1
    ac_optarg=$2
    ac_shift=shift
    ;;
  esac

  case $ac_option in
  # Handling of the options.
  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
    ac_cs_recheck=: ;;
  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
    echo "$ac_cs_version"; exit ;;
  --debug | --debu | --deb | --de | --d | -d )
    debug=: ;;
  --file | --fil | --fi | --f )
    $ac_shift
    CONFIG_FILES="$CONFIG_FILES $ac_optarg"
    ac_need_defaults=false;;
  --he | --h |  --help | --hel | -h )
    echo "$ac_cs_usage"; exit ;;
  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
  | -silent | --silent | --silen | --sile | --sil | --si | --s)
    ac_cs_silent=: ;;

  # This is an error.
  -*) { echo "$as_me: error: unrecognized option: $1
Try \`$0 --help' for more information." >&2
   { (exit 1); exit 1; }; } ;;

  *) ac_config_targets="$ac_config_targets $1"
     ac_need_defaults=false ;;

  esac
  shift
done

ac_configure_extra_args=

if $ac_cs_silent; then
  exec 6>/dev/null
  ac_configure_extra_args="$ac_configure_extra_args --silent"
fi

_ACEOF
cat >>$CONFIG_STATUS <<_ACEOF
if \$ac_cs_recheck; then
  echo "running CONFIG_SHELL=$SHELL $SHELL $0 "$ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
  CONFIG_SHELL=$SHELL
  export CONFIG_SHELL
  exec $SHELL "$0"$ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
fi

_ACEOF
cat >>$CONFIG_STATUS <<\_ACEOF
exec 5>>config.log
{
  echo
  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
## Running $as_me. ##
_ASBOX
  echo "$ac_log"
} >&5

_ACEOF
cat >>$CONFIG_STATUS <<_ACEOF
_ACEOF

cat >>$CONFIG_STATUS <<\_ACEOF

# Handling of arguments.
for ac_config_target in $ac_config_targets
do
  case $ac_config_target in
    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
    "pkgIndex.tcl") CONFIG_FILES="$CONFIG_FILES pkgIndex.tcl" ;;
    "togl_ws.h") CONFIG_FILES="$CONFIG_FILES togl_ws.h" ;;

  *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
   { (exit 1); exit 1; }; };;
  esac
done


# If the user did not use the arguments to specify the items to instantiate,
# then the envvar interface is used.  Set only those that are not.
# We use the long form for the default assignment because of an extremely
# bizarre bug on SunOS 4.1.3.
if $ac_need_defaults; then
  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
fi

# Have a temporary directory for convenience.  Make it in the build tree
# simply because there is no reason against having it here, and in addition,
# creating and moving files from /tmp can sometimes cause problems.
# Hook for its removal unless debugging.
# Note that there is a small window in which the directory will not be cleaned:
# after its creation but before its name has been assigned to `$tmp'.
$debug ||
{
  tmp=
  trap 'exit_status=$?
  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
' 0
  trap '{ (exit 1); exit 1; }' 1 2 13 15
}
# Create a (secure) tmp directory for tmp files.

{
  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
  test -n "$tmp" && test -d "$tmp"
}  ||
{
  tmp=./conf$$-$RANDOM
  (umask 077 && mkdir "$tmp")
} ||
{
   echo "$me: cannot create a temporary directory in ." >&2
   { (exit 1); exit 1; }
}

#
# Set up the sed scripts for CONFIG_FILES section.
#

# No need to generate the scripts if there are no CONFIG_FILES.
# This happens for instance when ./config.status config.h
if test -n "$CONFIG_FILES"; then

_ACEOF



ac_delim='%!_!# '
for ac_last_try in false false false false false :; do
  cat >conf$$subs.sed <<_ACEOF
SHELL!$SHELL$ac_delim
PATH_SEPARATOR!$PATH_SEPARATOR$ac_delim
PACKAGE_NAME!$PACKAGE_NAME$ac_delim
PACKAGE_TARNAME!$PACKAGE_TARNAME$ac_delim
PACKAGE_VERSION!$PACKAGE_VERSION$ac_delim
PACKAGE_STRING!$PACKAGE_STRING$ac_delim
PACKAGE_BUGREPORT!$PACKAGE_BUGREPORT$ac_delim
exec_prefix!$exec_prefix$ac_delim
prefix!$prefix$ac_delim
program_transform_name!$program_transform_name$ac_delim
bindir!$bindir$ac_delim
sbindir!$sbindir$ac_delim
libexecdir!$libexecdir$ac_delim
datarootdir!$datarootdir$ac_delim
datadir!$datadir$ac_delim
sysconfdir!$sysconfdir$ac_delim
sharedstatedir!$sharedstatedir$ac_delim
localstatedir!$localstatedir$ac_delim
includedir!$includedir$ac_delim
oldincludedir!$oldincludedir$ac_delim
docdir!$docdir$ac_delim
infodir!$infodir$ac_delim
htmldir!$htmldir$ac_delim
dvidir!$dvidir$ac_delim
pdfdir!$pdfdir$ac_delim
psdir!$psdir$ac_delim
libdir!$libdir$ac_delim
localedir!$localedir$ac_delim
mandir!$mandir$ac_delim
DEFS!$DEFS$ac_delim
ECHO_C!$ECHO_C$ac_delim
ECHO_N!$ECHO_N$ac_delim
ECHO_T!$ECHO_T$ac_delim
LIBS!$LIBS$ac_delim
build_alias!$build_alias$ac_delim
host_alias!$host_alias$ac_delim
target_alias!$target_alias$ac_delim
CYGPATH!$CYGPATH$ac_delim
EXEEXT!$EXEEXT$ac_delim
PKG_LIB_FILE!$PKG_LIB_FILE$ac_delim
PKG_STUB_LIB_FILE!$PKG_STUB_LIB_FILE$ac_delim
PKG_STUB_SOURCES!$PKG_STUB_SOURCES$ac_delim
PKG_STUB_OBJECTS!$PKG_STUB_OBJECTS$ac_delim
PKG_TCL_SOURCES!$PKG_TCL_SOURCES$ac_delim
PKG_HEADERS!$PKG_HEADERS$ac_delim
PKG_INCLUDES!$PKG_INCLUDES$ac_delim
PKG_LIBS!$PKG_LIBS$ac_delim
PKG_CFLAGS!$PKG_CFLAGS$ac_delim
TCL_VERSION!$TCL_VERSION$ac_delim
TCL_BIN_DIR!$TCL_BIN_DIR$ac_delim
TCL_SRC_DIR!$TCL_SRC_DIR$ac_delim
TCL_LIB_FILE!$TCL_LIB_FILE$ac_delim
TCL_LIB_FLAG!$TCL_LIB_FLAG$ac_delim
TCL_LIB_SPEC!$TCL_LIB_SPEC$ac_delim
TCL_STUB_LIB_FILE!$TCL_STUB_LIB_FILE$ac_delim
TCL_STUB_LIB_FLAG!$TCL_STUB_LIB_FLAG$ac_delim
TCL_STUB_LIB_SPEC!$TCL_STUB_LIB_SPEC$ac_delim
TCL_LIBS!$TCL_LIBS$ac_delim
TCL_DEFS!$TCL_DEFS$ac_delim
TCL_EXTRA_CFLAGS!$TCL_EXTRA_CFLAGS$ac_delim
TCL_LD_FLAGS!$TCL_LD_FLAGS$ac_delim
TCL_SHLIB_LD_LIBS!$TCL_SHLIB_LD_LIBS$ac_delim
TK_VERSION!$TK_VERSION$ac_delim
TK_BIN_DIR!$TK_BIN_DIR$ac_delim
TK_SRC_DIR!$TK_SRC_DIR$ac_delim
TK_LIB_FILE!$TK_LIB_FILE$ac_delim
TK_LIB_FLAG!$TK_LIB_FLAG$ac_delim
TK_LIB_SPEC!$TK_LIB_SPEC$ac_delim
TK_STUB_LIB_FILE!$TK_STUB_LIB_FILE$ac_delim
TK_STUB_LIB_FLAG!$TK_STUB_LIB_FLAG$ac_delim
TK_STUB_LIB_SPEC!$TK_STUB_LIB_SPEC$ac_delim
TK_LIBS!$TK_LIBS$ac_delim
TK_XINCLUDES!$TK_XINCLUDES$ac_delim
CC!$CC$ac_delim
CFLAGS!$CFLAGS$ac_delim
LDFLAGS!$LDFLAGS$ac_delim
CPPFLAGS!$CPPFLAGS$ac_delim
ac_ct_CC!$ac_ct_CC$ac_delim
OBJEXT!$OBJEXT$ac_delim
CPP!$CPP$ac_delim
INSTALL_PROGRAM!$INSTALL_PROGRAM$ac_delim
INSTALL_SCRIPT!$INSTALL_SCRIPT$ac_delim
INSTALL_DATA!$INSTALL_DATA$ac_delim
SET_MAKE!$SET_MAKE$ac_delim
RANLIB!$RANLIB$ac_delim
GREP!$GREP$ac_delim
EGREP!$EGREP$ac_delim
MATH_LIBS!$MATH_LIBS$ac_delim
PKG_SOURCES!$PKG_SOURCES$ac_delim
PKG_OBJECTS!$PKG_OBJECTS$ac_delim
CLEANFILES!$CLEANFILES$ac_delim
AUTOSTEREOD!$AUTOSTEREOD$ac_delim
TOGL_WINDOWINGSYSTEM!$TOGL_WINDOWINGSYSTEM$ac_delim
LIBGLU!$LIBGLU$ac_delim
TEA_WINDOWINGSYSTEM!$TEA_WINDOWINGSYSTEM$ac_delim
TCL_TOP_DIR_NATIVE!$TCL_TOP_DIR_NATIVE$ac_delim
TCL_GENERIC_DIR_NATIVE!$TCL_GENERIC_DIR_NATIVE$ac_delim
_ACEOF

  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 97; then
    break
  elif $ac_last_try; then
    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
   { (exit 1); exit 1; }; }
  else
    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
  fi
done

ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
if test -n "$ac_eof"; then
  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
  ac_eof=`expr $ac_eof + 1`
fi

cat >>$CONFIG_STATUS <<_ACEOF
cat >"\$tmp/subs-1.sed" <<\CEOF$ac_eof
/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
_ACEOF
sed '
s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
s/^/s,@/; s/!/@,|#_!!_#|/
:n
t n
s/'"$ac_delim"'$/,g/; t
s/$/\\/; p
N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
' >>$CONFIG_STATUS <conf$$subs.sed
rm -f conf$$subs.sed
cat >>$CONFIG_STATUS <<_ACEOF
CEOF$ac_eof
_ACEOF


ac_delim='%!_!# '
for ac_last_try in false false false false false :; do
  cat >conf$$subs.sed <<_ACEOF
TCL_UNIX_DIR_NATIVE!$TCL_UNIX_DIR_NATIVE$ac_delim
TCL_WIN_DIR_NATIVE!$TCL_WIN_DIR_NATIVE$ac_delim
TCL_BMAP_DIR_NATIVE!$TCL_BMAP_DIR_NATIVE$ac_delim
TCL_TOOL_DIR_NATIVE!$TCL_TOOL_DIR_NATIVE$ac_delim
TCL_PLATFORM_DIR_NATIVE!$TCL_PLATFORM_DIR_NATIVE$ac_delim
TCL_INCLUDES!$TCL_INCLUDES$ac_delim
TK_TOP_DIR_NATIVE!$TK_TOP_DIR_NATIVE$ac_delim
TK_UNIX_DIR_NATIVE!$TK_UNIX_DIR_NATIVE$ac_delim
TK_WIN_DIR_NATIVE!$TK_WIN_DIR_NATIVE$ac_delim
TK_GENERIC_DIR_NATIVE!$TK_GENERIC_DIR_NATIVE$ac_delim
TK_XLIB_DIR_NATIVE!$TK_XLIB_DIR_NATIVE$ac_delim
TK_PLATFORM_DIR_NATIVE!$TK_PLATFORM_DIR_NATIVE$ac_delim
TK_INCLUDES!$TK_INCLUDES$ac_delim
XMKMF!$XMKMF$ac_delim
TCL_THREADS!$TCL_THREADS$ac_delim
SHARED_BUILD!$SHARED_BUILD$ac_delim
AR!$AR$ac_delim
CELIB_DIR!$CELIB_DIR$ac_delim
LIBOBJS!$LIBOBJS$ac_delim
DL_LIBS!$DL_LIBS$ac_delim
CFLAGS_DEBUG!$CFLAGS_DEBUG$ac_delim
CFLAGS_OPTIMIZE!$CFLAGS_OPTIMIZE$ac_delim
CFLAGS_WARNING!$CFLAGS_WARNING$ac_delim
STLIB_LD!$STLIB_LD$ac_delim
SHLIB_LD!$SHLIB_LD$ac_delim
SHLIB_LD_LIBS!$SHLIB_LD_LIBS$ac_delim
SHLIB_CFLAGS!$SHLIB_CFLAGS$ac_delim
LD_LIBRARY_PATH_VAR!$LD_LIBRARY_PATH_VAR$ac_delim
SHLIB_SUFFIX!$SHLIB_SUFFIX$ac_delim
CFLAGS_DEFAULT!$CFLAGS_DEFAULT$ac_delim
LDFLAGS_DEFAULT!$LDFLAGS_DEFAULT$ac_delim
TCL_DBGX!$TCL_DBGX$ac_delim
MAKE_LIB!$MAKE_LIB$ac_delim
MAKE_SHARED_LIB!$MAKE_SHARED_LIB$ac_delim
MAKE_STATIC_LIB!$MAKE_STATIC_LIB$ac_delim
MAKE_STUB_LIB!$MAKE_STUB_LIB$ac_delim
RANLIB_STUB!$RANLIB_STUB$ac_delim
TCLSH_PROG!$TCLSH_PROG$ac_delim
WISH_PROG!$WISH_PROG$ac_delim
LTLIBOBJS!$LTLIBOBJS$ac_delim
_ACEOF

  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 40; then
    break
  elif $ac_last_try; then
    { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
echo "$as_me: error: could not make $CONFIG_STATUS" >&2;}
   { (exit 1); exit 1; }; }
  else
    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
  fi
done

ac_eof=`sed -n '/^CEOF[0-9]*$/s/CEOF/0/p' conf$$subs.sed`
if test -n "$ac_eof"; then
  ac_eof=`echo "$ac_eof" | sort -nru | sed 1q`
  ac_eof=`expr $ac_eof + 1`
fi

cat >>$CONFIG_STATUS <<_ACEOF
cat >"\$tmp/subs-2.sed" <<\CEOF$ac_eof
/@[a-zA-Z_][a-zA-Z_0-9]*@/!b end
_ACEOF
sed '
s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g
s/^/s,@/; s/!/@,|#_!!_#|/
:n
t n
s/'"$ac_delim"'$/,g/; t
s/$/\\/; p
N; s/^.*\n//; s/[,\\&]/\\&/g; s/@/@|#_!!_#|/g; b n
' >>$CONFIG_STATUS <conf$$subs.sed
rm -f conf$$subs.sed
cat >>$CONFIG_STATUS <<_ACEOF
:end
s/|#_!!_#|//g
CEOF$ac_eof
_ACEOF


# VPATH may cause trouble with some makes, so we remove $(srcdir),
# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
# trailing colons and then remove the whole line if VPATH becomes empty
# (actually we leave an empty line to preserve line numbers).
if test "x$srcdir" = x.; then
  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
s/:*\$(srcdir):*/:/
s/:*\${srcdir}:*/:/
s/:*@srcdir@:*/:/
s/^\([^=]*=[	 ]*\):*/\1/
s/:*$//
s/^[^=]*=[	 ]*$//
}'
fi

cat >>$CONFIG_STATUS <<\_ACEOF
fi # test -n "$CONFIG_FILES"


for ac_tag in  :F $CONFIG_FILES
do
  case $ac_tag in
  :[FHLC]) ac_mode=$ac_tag; continue;;
  esac
  case $ac_mode$ac_tag in
  :[FHL]*:*);;
  :L* | :C*:*) { { echo "$as_me:$LINENO: error: Invalid tag $ac_tag." >&5
echo "$as_me: error: Invalid tag $ac_tag." >&2;}
   { (exit 1); exit 1; }; };;
  :[FH]-) ac_tag=-:-;;
  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
  esac
  ac_save_IFS=$IFS
  IFS=:
  set x $ac_tag
  IFS=$ac_save_IFS
  shift
  ac_file=$1
  shift

  case $ac_mode in
  :L) ac_source=$1;;
  :[FH])
    ac_file_inputs=
    for ac_f
    do
      case $ac_f in
      -) ac_f="$tmp/stdin";;
      *) # Look for the file first in the build tree, then in the source tree
	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
	 # because $ac_f cannot contain `:'.
	 test -f "$ac_f" ||
	   case $ac_f in
	   [\\/$]*) false;;
	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
	   esac ||
	   { { echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
echo "$as_me: error: cannot find input file: $ac_f" >&2;}
   { (exit 1); exit 1; }; };;
      esac
      ac_file_inputs="$ac_file_inputs $ac_f"
    done

    # Let's still pretend it is `configure' which instantiates (i.e., don't
    # use $as_me), people would be surprised to read:
    #    /* config.h.  Generated by config.status.  */
    configure_input="Generated from "`IFS=:
	  echo $* | sed 's|^[^:]*/||;s|:[^:]*/|, |g'`" by configure."
    if test x"$ac_file" != x-; then
      configure_input="$ac_file.  $configure_input"
      { echo "$as_me:$LINENO: creating $ac_file" >&5
echo "$as_me: creating $ac_file" >&6;}
    fi

    case $ac_tag in
    *:-:* | *:-) cat >"$tmp/stdin";;
    esac
    ;;
  esac

  ac_dir=`$as_dirname -- "$ac_file" ||
$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
	 X"$ac_file" : 'X\(//\)[^/]' \| \
	 X"$ac_file" : 'X\(//\)$' \| \
	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
echo X"$ac_file" |
    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)[^/].*/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\).*/{
	    s//\1/
	    q
	  }
	  s/.*/./; q'`
  { as_dir="$ac_dir"
  case $as_dir in #(
  -*) as_dir=./$as_dir;;
  esac
  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
    as_dirs=
    while :; do
      case $as_dir in #(
      *\'*) as_qdir=`echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #(
      *) as_qdir=$as_dir;;
      esac
      as_dirs="'$as_qdir' $as_dirs"
      as_dir=`$as_dirname -- "$as_dir" ||
$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
	 X"$as_dir" : 'X\(//\)[^/]' \| \
	 X"$as_dir" : 'X\(//\)$' \| \
	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
echo X"$as_dir" |
    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)[^/].*/{
	    s//\1/
	    q
	  }
	  /^X\(\/\/\)$/{
	    s//\1/
	    q
	  }
	  /^X\(\/\).*/{
	    s//\1/
	    q
	  }
	  s/.*/./; q'`
      test -d "$as_dir" && break
    done
    test -z "$as_dirs" || eval "mkdir $as_dirs"
  } || test -d "$as_dir" || { { echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
echo "$as_me: error: cannot create directory $as_dir" >&2;}
   { (exit 1); exit 1; }; }; }
  ac_builddir=.

case "$ac_dir" in
.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
*)
  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
  # A ".." for each directory in $ac_dir_suffix.
  ac_top_builddir_sub=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,/..,g;s,/,,'`
  case $ac_top_builddir_sub in
  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
  esac ;;
esac
ac_abs_top_builddir=$ac_pwd
ac_abs_builddir=$ac_pwd$ac_dir_suffix
# for backward compatibility:
ac_top_builddir=$ac_top_build_prefix

case $srcdir in
  .)  # We are building in place.
    ac_srcdir=.
    ac_top_srcdir=$ac_top_builddir_sub
    ac_abs_top_srcdir=$ac_pwd ;;
  [\\/]* | ?:[\\/]* )  # Absolute name.
    ac_srcdir=$srcdir$ac_dir_suffix;
    ac_top_srcdir=$srcdir
    ac_abs_top_srcdir=$srcdir ;;
  *) # Relative name.
    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
    ac_top_srcdir=$ac_top_build_prefix$srcdir
    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
esac
ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix


  case $ac_mode in
  :F)
  #
  # CONFIG_FILE
  #

  case $INSTALL in
  [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
  esac
_ACEOF

cat >>$CONFIG_STATUS <<\_ACEOF
# If the template does not know about datarootdir, expand it.
# FIXME: This hack should be removed a few years after 2.60.
ac_datarootdir_hack=; ac_datarootdir_seen=

case `sed -n '/datarootdir/ {
  p
  q
}
/@datadir@/p
/@docdir@/p
/@infodir@/p
/@localedir@/p
/@mandir@/p
' $ac_file_inputs` in
*datarootdir*) ac_datarootdir_seen=yes;;
*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
  { echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
_ACEOF
cat >>$CONFIG_STATUS <<_ACEOF
  ac_datarootdir_hack='
  s&@datadir@&$datadir&g
  s&@docdir@&$docdir&g
  s&@infodir@&$infodir&g
  s&@localedir@&$localedir&g
  s&@mandir@&$mandir&g
    s&\\\${datarootdir}&$datarootdir&g' ;;
esac
_ACEOF

# Neutralize VPATH when `$srcdir' = `.'.
# Shell code in configure.ac might set extrasub.
# FIXME: do we really want to maintain this feature?
cat >>$CONFIG_STATUS <<_ACEOF
  sed "$ac_vpsub
$extrasub
_ACEOF
cat >>$CONFIG_STATUS <<\_ACEOF
:t
/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
s&@configure_input@&$configure_input&;t t
s&@top_builddir@&$ac_top_builddir_sub&;t t
s&@srcdir@&$ac_srcdir&;t t
s&@abs_srcdir@&$ac_abs_srcdir&;t t
s&@top_srcdir@&$ac_top_srcdir&;t t
s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
s&@builddir@&$ac_builddir&;t t
s&@abs_builddir@&$ac_abs_builddir&;t t
s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
s&@INSTALL@&$ac_INSTALL&;t t
$ac_datarootdir_hack
" $ac_file_inputs | sed -f "$tmp/subs-1.sed" | sed -f "$tmp/subs-2.sed" >$tmp/out

test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
  { echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
which seems to be undefined.  Please make sure it is defined." >&5
echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
which seems to be undefined.  Please make sure it is defined." >&2;}

  rm -f "$tmp/stdin"
  case $ac_file in
  -) cat "$tmp/out"; rm -f "$tmp/out";;
  *) rm -f "$ac_file"; mv "$tmp/out" $ac_file;;
  esac
 ;;



  esac

done # for ac_tag


{ (exit 0); exit 0; }
_ACEOF
chmod +x $CONFIG_STATUS
ac_clean_files=$ac_clean_files_save


# configure is writing to config.log, and then calls config.status.
# config.status does its own redirection, appending to config.log.
# Unfortunately, on DOS this fails, as config.log is still kept open
# by configure, so config.status won't be able to write to it; its
# output is simply discarded.  So we exec the FD to /dev/null,
# effectively closing config.log, so it can be properly (re)opened and
# appended to by config.status.  When coming back to configure, we
# need to make the FD available again.
if test "$no_create" != yes; then
  ac_cs_success=:
  ac_config_status_args=
  test "$silent" = yes &&
    ac_config_status_args="$ac_config_status_args --quiet"
  exec 5>/dev/null
  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
  exec 5>>config.log
  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
  # would make configure fail if this is the last instruction.
  $ac_cs_success || { (exit 1); exit 1; }
fi


blob
data 9713
#!/bin/bash -norc
dnl	This file is an input file used by the GNU "autoconf" program to
dnl	generate the file "configure", which is run during Tcl installation
dnl	to configure the system for the local environment.
#
# RCS: @(#) $Id$

#-----------------------------------------------------------------------
# Sample configure.in for Tcl Extensions.  The only places you should
# need to modify this file are marked by the string __CHANGE__
#-----------------------------------------------------------------------

#-----------------------------------------------------------------------
# __CHANGE__
# Set your package name and version numbers here.
#
# This initializes the environment with PACKAGE_NAME and PACKAGE_VERSION
# set as provided.  These will also be added as -D defs in your Makefile
# so you can encode the package version directly into the source files.
#-----------------------------------------------------------------------

AC_INIT([Togl], [2.0])

#--------------------------------------------------------------------
# Call TEA_INIT as the first TEA_ macro to set up initial vars.
# This will define a ${TEA_PLATFORM} variable == "unix" or "windows"
# as well as PKG_LIB_FILE and PKG_STUB_LIB_FILE.
#--------------------------------------------------------------------

TEA_INIT([3.6])

AC_CONFIG_AUX_DIR(tclconfig)

#--------------------------------------------------------------------
# Load the tclConfig.sh file
#--------------------------------------------------------------------

TEA_PATH_TCLCONFIG
TEA_LOAD_TCLCONFIG

#--------------------------------------------------------------------
# Load the tkConfig.sh file if necessary (Tk extension)
#--------------------------------------------------------------------

TEA_PATH_TKCONFIG
TEA_LOAD_TKCONFIG

#-----------------------------------------------------------------------
# Handle the --prefix=... option by defaulting to what Tcl gave.
# Must be called after TEA_LOAD_TCLCONFIG and before TEA_SETUP_COMPILER.
#-----------------------------------------------------------------------

TEA_PREFIX

#-----------------------------------------------------------------------
# Standard compiler checks.
# This sets up CC by using the CC env var, or looks for gcc otherwise.
# This also calls AC_PROG_CC, AC_PROG_INSTALL and a few others to create
# the basic setup necessary to compile executables.
#-----------------------------------------------------------------------

TEA_SETUP_COMPILER

#-----------------------------------------------------------------------
# __CHANGE__
# Specify the C source files to compile in TEA_ADD_SOURCES,
# public headers that need to be installed in TEA_ADD_HEADERS,
# stub library C source files to compile in TEA_ADD_STUB_SOURCES,
# and runtime Tcl library files in TEA_ADD_TCL_SOURCES.
# This defines PKG(_STUB)_SOURCES, PKG(_STUB)_OBJECTS, PKG_HEADERS
# and PKG_TCL_SOURCES.
#-----------------------------------------------------------------------

TOGL_ENABLE_STUBS

TEA_ADD_SOURCES([togl.c toglProcAddr.c toglStubInit.c])
# togl_ws.h is added in Makefile.in because it is generated
TEA_ADD_HEADERS([togl.h toglDecls.h])
TEA_ADD_INCLUDES([])
TEA_ADD_LIBS([])
TEA_ADD_CFLAGS([])
if test "${USE_STUBS}" = "1" ; then
	TEA_ADD_STUB_SOURCES([toglStubLib.c])
fi
TEA_ADD_TCL_SOURCES([])

#--------------------------------------------------------------------
# __CHANGE__
# A few miscellaneous platform-specific items:
#
# Define a special symbol for Windows (BUILD_sample in this case) so
# that we create the export library with the dll.
#
# Windows creates a few extra files that need to be cleaned up.
# You can add more files to clean if your extension creates any extra
# files.
#
# TEA_ADD_* any platform specific compiler/build info here.
#--------------------------------------------------------------------

if test "${TEA_PLATFORM}" = "windows" ; then
    AC_DEFINE(BUILD_togl, 1, [Build windows export dll])
    CLEANFILES="*.lib *.dll *.exp *.ilk *.pdb vc*.pch"
    if test "$GCC" != "yes" ; then
	    TEA_ADD_LIBS([StereoI/StereoI.lib])
    fi
    #TEA_ADD_SOURCES([win/winFile.c])
    #TEA_ADD_INCLUDES([-I\"$(${CYGPATH} ${srcdir}/win)\"])
else
    CLEANFILES="so_locations"
    #TEA_ADD_SOURCES([unix/unixFile.c])
    #TEA_ADD_LIBS([-lsuperfly])
fi
AC_SUBST(CLEANFILES)

#--------------------------------------------------------------------
# __CHANGE__
# Choose which headers you need.  Extension authors should try very
# hard to only rely on the Tcl public header files.  Internal headers
# contain private data structures and are subject to change without
# notice.
# This MUST be called after TEA_LOAD_TCLCONFIG / TEA_LOAD_TKCONFIG
#--------------------------------------------------------------------

# find autostereo header, lib, and daemon
AC_ARG_WITH([autostereo],
	[AS_HELP_STRING([--with-autostereo],
		[directory with autostereo source (for SGI)])],
	[with_autostereo=${withval}])
AC_ARG_WITH([autostereod],
	[AS_HELP_STRING([--with-autostereod],
		[path to autostereod daemon (for SGI)])],
	[with_autostereod=${withval}])
AC_ARG_VAR([AUTOSTEREOD], [Path to autostereod for SGI IRIX computers])

AC_MSG_CHECKING([for autostereo directory])
if test x"${with_autostereo}" != x ; then
	if test -f "${with_autostereo}/lib/autostereo.h" ; then
		with_autostereo=`(cd ${with_autostereo}; pwd)`
		TEA_ADD_INCLUDES([-I${with_autostereo}/lib])
		TEA_ADD_LIBS([-L${with_autostereo}/lib -lautostereo])
		AC_DEFINE_UNQUOTED(HAVE_AUTOSTEREO, 1,
			[Define this if you have the autostereo header])
	else
		AC_MSG_ERROR([${with_autostereo} directory doesn't contain lib/autostereo.h])
	fi
fi

AC_PATH_PROG([AUTOSTEREOD], [autostereod], [],
			[`eval \"echo $sbindir\"`:$PATH:/sbin:/usr/sbin])


# Choose OpenGL platform
case "${TEA_WINDOWINGSYSTEM}" in
	aqua)
		AC_SUBST(TOGL_WINDOWINGSYSTEM,TOGL_AGL)
		TEA_ADD_LIBS([-framework AGL -framework OpenGL -framework ApplicationServices])
		# libGLU is implicit in OpenGL framework
		LIBGLU=
		;;
	x11)
		AC_SUBST(TOGL_WINDOWINGSYSTEM,TOGL_X11)
		TEA_ADD_LIBS([-lGL -lXmu])
		LIBGLU=-lGLU
		;;
	win32)
		AC_SUBST(TOGL_WINDOWINGSYSTEM,TOGL_WGL)
		TEA_ADD_LIBS([opengl32.lib user32.lib gdi32.lib])
		if test "$GCC" = "yes" ; then
			LIBGLU=-lglu32
		else
			# assume Microsoft compiler
			LIBGLU=glu32.lib
			TEA_ADD_CFLAGS([-TP])
		fi
		;;
	*)
		AC_MSG_ERROR([Unsupported windowing system: ${TEA_WINDOWINGSYSTEM}])
		;;
esac
AC_SUBST(LIBGLU)
AC_SUBST(TEA_WINDOWINGSYSTEM)

# find Tcl, Tk, and X11 headers
#TEA_PUBLIC_TCL_HEADERS
TEA_PRIVATE_TCL_HEADERS

#TEA_PUBLIC_TK_HEADERS
TEA_PRIVATE_TK_HEADERS
TEA_PATH_X

#--------------------------------------------------------------------
# Check whether --enable-threads or --disable-threads was given.
# This auto-enables if Tcl was compiled threaded.
#--------------------------------------------------------------------

TEA_ENABLE_THREADS

#--------------------------------------------------------------------
# The statement below defines a collection of symbols related to
# building as a shared library instead of a static library.
#--------------------------------------------------------------------

TEA_ENABLE_SHARED

#--------------------------------------------------------------------
# This macro figures out what flags to use with the compiler/linker
# when building shared/static debug/optimized objects.  This information
# can be taken from the tclConfig.sh file, but this figures it all out.
#--------------------------------------------------------------------

TEA_CONFIG_CFLAGS
# should be part of TEA_CONFIG_CFLAGS, but more visible modification here
AC_SUBST(SHLIB_SUFFIX)

#--------------------------------------------------------------------
# Set the default compiler switches based on the --enable-symbols option.
#--------------------------------------------------------------------

TEA_ENABLE_SYMBOLS

#--------------------------------------------------------------------
# Everyone should be linking against the Tcl stub library.  If you
# can't for some reason, remove this definition.  If you aren't using
# stubs, you also need to modify the SHLIB_LD_LIBS setting below to
# link against the non-stubbed Tcl library.  Add Tk too if necessary.
#--------------------------------------------------------------------

if test "${USE_STUBS}" = "1" ; then
	AC_DEFINE(USE_TCL_STUBS, 1, [Use Tcl stubs])
	AC_DEFINE(USE_TK_STUBS, 1, [Use Tk stubs])
fi

#--------------------------------------------------------------------
# This macro generates a line to use when building a library.  It
# depends on values set by the TEA_ENABLE_SHARED, TEA_ENABLE_SYMBOLS,
# and TEA_LOAD_TCLCONFIG macros above.
#--------------------------------------------------------------------

TEA_MAKE_LIB

if test "${USE_STUBS}" = "0" ; then
	SHLIB_LD_LIBS=`echo "$SHLIB_LD_LIBS" | sed -e 's!stub!!g'`
fi

#--------------------------------------------------------------------
# Determine the name of the tclsh and/or wish executables in the
# Tcl and Tk build directories or the location they were installed
# into. These paths are used to support running test cases only,
# the Makefile should not be making use of these paths to generate
# a pkgIndex.tcl file or anything else at extension build time.
#--------------------------------------------------------------------

TEA_PROG_TCLSH
TEA_PROG_WISH

#--------------------------------------------------------------------
# Finally, substitute all of the various values into the Makefile.
# You may alternatively have a special pkgIndex.tcl.in or other files
# which require substituting th AC variables in.  Include these here.
#--------------------------------------------------------------------

AC_OUTPUT([Makefile pkgIndex.tcl togl_ws.h])

blob
data 143
This directory contains the documentation of Togl, the Tk OpenGL widget.
The documentation also doubles as the contents of the Togl home page.

blob
data 18891
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Togl C API</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Togl C API</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#compile">Compling and linking C Togl Functions</a>
      <li><a href="#setup">Setup and Initialization Functions</a>
      <ul>
	<li><code>Togl_Init</code>,
	<code>Togl_InitStubs</code>
      </ul>
      <li><a href="#drawing">Drawing-related Commands</a>
      <ul>
	<li><code>Togl_PostRedisplay</code>,
	<code>Togl_SwapBuffers</code>,
	<code>Togl_MakeCurrent</code>,
	<code>Togl_SwapInterval</code>
      </ul>
      <li><a href="#query">Query Functions</a>
      <ul>
	<li><code>Togl_Ident</code>,
	<code>Togl_Width</code>,
	<code>Togl_Height</code>,
	<code>Togl_Interp</code>,
	<code>Togl_TkWin</code>,
	<code>Togl_GetProcAddr</code>,
	<code>Togl_ContextTag</code>
	<code>Togl_UpdatePending</code>
      </ul>
      <li><a href="#index">Color Index Mode Functions</a>
      <ul>
	<li><code>Togl_AllocColor</code>,
	<code>Togl_FreeColor</code>,
	<code>Togl_SetColor</code>
      </ul>
      <li><a href="#font">Font Functions</a>
      <ul>
	<li><code>Togl_LoadBitmapFont</code>,
	<code>Togl_UnloadBitmapFont</code>,
	<code>Togl_WriteObj</code>,
	<code>Togl_WriteChars</code>
      </ul>
      <li><a href="#client">Client Data Functions</a>
      <ul>
	<li><code>Togl_SetClientData</code>,
	<code>Togl_GetClientData</code>
      </ul>
      <li><a href="#overlay">Overlay Functions</a>
      <ul>
	<li><code>Togl_UseLayer</code>,
	<code>Togl_ShowOverlay</code>,
	<code>Togl_HideOverlay</code>,
	<code>Togl_PostOveralyRedisplay</code>,
	<code>Togl_ExistsOverlay</code>,
	<code>Togl_GetOverlayTransparentValue</code>,
	<code>Togl_IsMappedOverlay</code>,
	<code>Togl_AllocColorOverlay</code>,
	<code>Togl_FreeColorOverlay</code>
      </ul>
      <li><a href="#stereo">Stereo Functions</a>
      <ul>
	<li><code>Togl_Drawbuffer</code>,
	<li><code>Togl_Clear</code>
	<li><code>Togl_Frustum</code>
	<li><code>Togl_Ortho</code>
	<li><code>Togl_NumEyes</code>
      </ul>
      <li><a href="#image">Image Functions</a>
      <ul>
	<li><code>Togl_TakePhoto</code>
      </ul>
      <li><a href="#convert">Conversion Functions</a>
      <ul>
	<li><code>Togl_GetToglFromObj</code>,
	<li><code>Togl_GetToglFromName</code>
      </ul>
    </ul>

    <hr>

    <h2><a name="compile">Compling and linking C Togl Functions</a></h2>

    <p>
    All Togl functions are found in the Togl header file.

    <blockquote>
      <code>
	#include "togl.h"
      </code>
    </blockquote>

    <p>
    For portability, you should include the <code>togl.h</code> header
    before any other OpenGL headers
    so it will compile on Microsoft Windows.

    <p>
    Before calling any Togl functions, you need to initialize it.
    Regardless if you're using stubs (by defining <code>USE_TOGL_STUBS</code>)
    or not, the following code will properly initialize togl:

    <blockquote><pre>
if (Tcl_InitStubs(interp, "8.1", 0) == NULL
|| Togl_InitStubs(interp, "2.0", 0) == NULL) {
    /* fail */
}
</pre></blockquote>

    <p>
    If you are using a prebuilt binary distribution,
    you should be sure to define <code>USE_TOGL_STUBS</code> beforehand.

    <p>
    See the source for the demo programs in the Togl source distribution
    for working examples.

    <h3>Linking</h3>

    <p>
    If you are using a prebuilt binary,
    be sure to link against the stub library.
    On Microsoft Windows,
    link against <code>Toglstub20.lib opengl32.lib user32.lib gdi32.lib</code>,
    on Apple Mac OS X,
    link against <code>-lToglstub2.0 -framework OpenGL</code>,
    on other platforms,
    link against <code>-lToglstub2.0 -lGLU -lGL -lm</code>.

    <p>
    If building your own Togl package,
    you can use the stubs interface or link in the Tcl and Tk libraries as well.
    If using the stubs interface, link as shown above.
    Otherwise:
    on Microsoft Windows,
    link against <code>Togl20.lib tk84.lib tcl84.lib opengl32.lib user32.lib gdi32.lib</code>,
    on Apple Mac OS X,
    link against <code>-lTogl2.0 -framework Tk -framework Tcl -framework OpenGL</code>,
    on other platforms,
    link against <code>-lTogl2.0 -ltk8.4 -ltcl8.4 -lGLU -lGL -lm</code>.

    <h2><a name="setup">Setup and Initialization Functions</a></h2>

    <dl>
      <dt><code>int Togl_Init(Tcl_Interp *interp)</code>
      <dd>
      Initializes the Togl module.  This is typically called from the
      Tk_Main() function
      or other Tcl package initialization function that is directly linked
      to the Togl (shared) library.
      It is also indirectly called via
      Tcl's <code>package require Togl</code> command.
    </dl>

    <dl>
      <dt>
      <code>const char *Togl_InitStubs(Tcl_Interp *interp, const char *version, int exact)</code>
      <dd>
      Loads the Togl package into the given <code>interp</code>reter
      and initializes it.
      <code>version</code> should be <code>"2.0"</code> or higher.
      This is typically called from C/C++ code that accesses Togl's C API
      and has installed Togl into the standard TCL hierarchy.
      See the Tcl InitStubs(3) or the Tk TkInitStubs(3) manual pages for
      more information.
    </dl>

    <h2><a name="drawing">Drawing-related Commands</a></h2>

    <dl>
      <dt><code>void Togl_PostRedisplay(Togl *togl)</code>
      <dd>
      Signals that the widget should be redrawn.  When Tk is next idle,
      the <code>displaycommand</code> callback will be invoked.
    </dl>

    <dl>
      <dt><code>void Togl_SwapBuffers(const Togl *togl)</code>
      <dd>
      Swaps the front and back color buffers for a double-buffered widget.
      glFlush() is executed if the window is single-buffered.  So this call
      works for both single- and double-buffered contexts.  This is
      typically called in the <code>displaycommand</code> callback function.
    </dl>

    <dl>
      <dt><code>void Togl_MakeCurrent(const Togl *togl)</code>
      <dd>
      Sets the current rendering context to the given widget.  This is done
      automatically before any Togl callback functions is called.  So the
      call is only needed if you have multiple widgets with separate OpenGL
      contexts.  If the argument is NULL, then the rendering context is cleared
      and subsequent OpenGL commands will fail.
    </dl>

    <dl>
      <dt><code>Bool Togl_SwapInterval(const Togl *togl, int interval)</code>
      <dd>
      Returns 1 (true) if sucessful.
      Attempts to change the maximum refresh rate
      by setting the minimum number of cycles between successive swap buffers.
      For benchmarking purposes, you should set the swap interval to 0.
    </dl>

    <h2><a name="query">Query Functions</a></h2>

    <dl>
      <dt><code>char *Togl_Ident(const Togl *togl)</code>
      <dd>
      Returns a pointer to the identification string associated with a Togl
      widget or NULL if there's no identifier string.
    </dl>

    <dl>
      <dt><code>int Togl_Width(const Togl *togl)</code>
      <dd>
      Returns the width of the given Togl widget.  Typically called in the
      <code>reshapecommand</code> callback function.
    </dl>

    <dl>
      <dt><code>int Togl_Height(const Togl *togl)</code>
      <dd>
      Returns the height of the given Togl widget.  Typically called in the
      <code>reshapecommand</code> callback function.
    </dl>

    <dl>
      <dt><code>Tcl_Interp *Togl_Interp(const Togl *togl)</code>
      <dd>
      Returns the Tcl interpreter associated with the given Togl widget.
    </dl>
    <dl>
      <dt>
      <code>Tk_Window Togl_TkWin(const Togl *togl)</code>
      <dd>
      Returns the Tk window associated with the given Togl widget.
    </dl>

    <dl>
      <dt><code>Togl_FuncPtr Togl_GetProcAddr(const char *funcname)</code>
      <dd>
      Platform-independent way to get OpenGL function pointers from a
      function name.
      Note that in Windows (WGL) versions that
      "the extension function addresses are unique for each pixel format.
      All rendering contexts of a given pixel format
      share the same extension function addresses."
      And on *nix (GLX/X11) platforms, 
      "the function pointers returned are context independent"
      (Linux ABI documentation).
      The Mac OS X (AGL) platform acts like a *nix platform.
    </dl>

    <dl>
      <dt><code>int Togl_ContextTag(const Togl *t)</code>
      <dd>
      Returns an integer that represents the context tag.
      All Togl widgets with the same context tag share display lists.
    </dl>

    <dl>
      <dt><code>Bool Togl_UpdatePending(const Togl *t)</code>
      <dd>
      Returns 1 (true) if the window should be redrawn.  See Togl_PostRedisplay.
    </dl>

    <h2><a name="index">Color Index Mode Functions</a></h2>

    <p>
    These functions are only used for color index mode.

    <dl>
      <dt><code>unsigned long Togl_AllocColor(Togl *togl, float red, float green, float blue)</code>
      <dd>
      Allocate a color from a read-only colormap.  Given a color specified
      by red, green, and blue return a colormap index (aka pixel value)
      whose entry most closely matches the red, green, blue color.  Red,
      green, and blue are values in [0,1].  This function is only used in
      color index mode when the <code>-privatecmap</code> option is false.
    </dl>

    <dl>
      <dt><code>void Togl_FreeColor(Togl *togl, unsigned long index)</code>
      <dd>
      Free a color in a read-only colormap.  Index is a value which was
      returned by the Togl_AllocColor() function.  This function is only
      used in color index mode when the <code>-privatecmap</code> option
      is false.
    </dl>

    <dl>
      <dt><code>void Togl_SetColor(Togl *togl,
	int index, float red, float green, float blue)</code>
      <dd>
      Load the colormap entry specified by index with the given red, green
      and blue values.  Red, green, and blue are values in [0,1].  This
      function is only used in color index mode when the
      <code>-privatecmap</code> option is true.
    </dl>


    <h2><a name="font">Font Functions</a></h2>

    <p>
    These functions provide an interface to the simple bitmap font capabilities
    that every OpenGL implementation provides.
    Better font support is found in other C APIs, <i>e.g.</i>,
    <a href="http://quesoglc.sourceforge.net/">QuesoGLC</a>
    or <a href="http://sourceforge.net/projects/ftgl">FTGL</a>.

    <dl>
      <dt><code>GLuint Togl_LoadBitmapFont(Togl *togl,
	const char *fontname)</code>
      <dd>
      Load the named font as a set of glBitmap display lists.
      <var>fontname</var> may be any of the font description styles
      accepted by the Tk font command.
      For maximum portability, one of the standard Tk fonts,
      <b>Courier</b>, <b>Times</b>, and <b>Helvetica</b>, should be used.
      Unicode fonts are treated as if they have only have an 8-bit index
      (so poorly).
      After Togl_LoadBitmapFont() has been called, returning <var>fontbase</var>,
      you can render a string <em>s</em> with:
      <blockquote>
	<code>
	  glListBase(fontbase);<br>
	  glCallLists(strlen(s), GL_BYTE, s);
	</code>
      </blockquote>
      Zero is returned if this function fails.
    </dl>

    <dl>
      <dt><code>int Togl_UnloadBitmapFont(Togl *togl, Tcl_Obj *toglfont)
      </code>
      <dd>
      Destroys the bitmap display lists created by by Togl_LoadBitmapFont().
    </dl>

    <dl>
      <dt><code>int Togl_WriteChars(const Togl *togl, const Tcl_Obj *toglfont, const char *str, int len)
      </code>
      <dd>
    </dl>

    <dl>
      <dt><code>int Togl_WriteObj(const Togl *togl, const Tcl_Obj *toglfont, Tcl_Obj *obj)
      </code>
      <dd>
      Tcl_Obj interface to <code>Tcl_WriteChars</code>.
    </dl>

    <h2><a name="client">Client Data Functions</a></h2>

    <dl>
      <dt><code>void Togl_SetClientData(Togl *togl, ClientData clientData)</code>
      <dd>
      <em>clientData</em> is a pointer to an arbitrary user data structure.
      Each Togl struct has such a pointer.
      This function sets the Togl widget's client data pointer.
    </dl>

    <dl>
      <dt><code>ClientData Togl_GetClientData(const Togl *togl)</code>
      <dd>
      <em>clientData</em> is a pointer to an arbitrary user data structure.
      Each Togl struct has such a pointer.
      This function returns the Togl widget's client data pointer.
    </dl>


    <h2><a name="overlay">Overlay Functions</a></h2>

    <p>
    These functions are modelled after GLUT's overlay sub-API.

    <dl>
      <dt><code>void Togl_UseLayer(Togl *togl, int layer)</code>
      <dd>
      Select the layer into which subsequent OpenGL rendering will be
      directed.  <em>layer</em> may be either <em>TOGL_OVERLAY</em> or
      <em>TOGL_NORMAL</em>.
    </dl>

    <dl>
      <dt><code>void Togl_ShowOverlay(Togl *togl)</code>
      <dd>
      Display the overlay planes, if any.
    </dl>

    <dl>
      <dt><code>void Togl_HideOverlay(Togl *togl)</code>
      <dd>
      Hide the overlay planes, if any.
    </dl>

    <dl>
      <dt><code>void Togl_PostOverlayRedisplay(Togl *togl)</code>
      <dd>
      Signal that the overlay planes should be redraw.  
      When Tk is next idle,
      the <code>overlaydisplaycommand</code> callback will be invoked.
    </dl>

    <dl>
      <dt><code>int Togl_ExistsOverlay(Togl *togl)</code>
      <dd>
      Returns 1 if overlay planes exist, 0 otherwise.
    </dl>

    <dl>
      <dt><code>int Togl_GetOverlayTransparentValue(const Togl *togl)</code>
      <dd>
      Returns the color index of the overlay's transparent pixel value.
    </dl>

    <dl>
      <dt><code>int Togl_IsMappedOverlay(const Togl *togl)</code>
      <dd>
      Returns 1 if the overlay planes are currently displayed, 0 otherwise.
    </dl>

    <dl>
      <dt><code>unsigned long Togl_AllocColorOverlay(const Togl *togl,
	float red, float green, float blue)</code>
      <dd>
      Allocate a color in the overlay planes.  Red, green, and blue are
      values in [0,1].  Return the color index or -1 if the allocation
      fails.
    </dl>

    <dl>
      <dt><code>void Togl_FreeColorOverlay(const Togl *togl, unsigned long index)</code>
      <dd>
      Free a color which was allocated with Togl_AllocColorOverlay().
    </dl>

    <h2><a name="stereo">Stereo Functions</a></h2>

    <p>
    Togl abstracts part of the stereo drawing process to seamlessly
    support quad-buffered stereo as well as various alternative stereo
    formats.

    <dl>
      <dt><code>void Togl_DrawBuffer(Togl *togl, GLenum mode)</code>
      <dd>
      Switch to OpenGL draw buffer.
      Should be one of GL_BACK_LEFT, GL_BACK_RIGHT, GL_FRONT_LEFT, or
      GL_FRONT_RIGHT.
      It is not possible to draw in the left and right buffers at the same
      time in the alternate stereo modes.
    </dl>

    <dl>
      <dt><code>void Togl_Clear(const Togl *togl, GLbitfield mask)</code>
      <dd>
      Replacement for OpenGL's glClear that takes into account
      the alternate stereo mode.
    </dl>

    <dl>
      <dt><code>void Togl_Frustum(const Togl *togl, GLfloat left, GLfloat right, GLfloat bottom, GLfloat top, GLfloat near, GLfloat far)</code>
      <dd>
      eyeOffset is the distance from the center line and is negative for the
      left eye and positive for right eye.
      eyeDist and eyeOffset need to be in the same units as your model space.
      In physical space, eyeDist might be 30 inches from the screen
      and eyeDist would be +/- 1.25 inch (for a total interocular distance
      of 2.5 inches).  So you need to convert those values.
    </dl>

    <dl>
      <dt><code>void Togl_Ortho(const Togl *togl, GLfloat left, GLfloat right, GLfloat bottom, GLfloat top, GLfloat near, GLfloat far)</code>
      <dd>
      eyeOffset is the distance from the center line and is negative for the
      left eye and positive for right eye.
      eyeDist and eyeOffset need to be in the same units as your model space.
      In physical space, eyeDist might be 30 inches from the screen
      and eyeDist would be +/- 1.25 inch (for a total interocular distance
      of 2.5 inches).  So you need to convert those values.
    </dl>

    <dl>
      <dt><code>int Togl_NumEyes(const Togl *togl)</code>
      <dd>
    </dl>

    <h3>Stereo Example</h3>

    <p>
    This code works for quad-buffered stereo,
    as well as the other stereo modes.

    <blockquote><pre>
if (Togl_NumEyes(togl) == 1) {
    Togl_DrawBuffer(togl, GL_BACK);
    Togl_Clear(togl);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    Togl_Frustum(togl, left, right, bottom, top, near, far);
    glMatrixMode(GL_MODELVIEW);
    <b><i>draw image</i></b>
} else {
    Togl_DrawBuffer(togl, GL_BACK_LEFT);
    Togl_Clear(togl);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    Togl_Frustum(togl, left, right, bottom, top, near, far);
    glMatrixMode(GL_MODELVIEW);
    <b><i>draw left-eye image</i></b>
    Togl_DrawBuffer(togl, GL_BACK_RIGHT);
    Togl_Clear(togl);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    Togl_Frustum(togl, left, right, bottom, top, near, far);
    glMatrixMode(GL_MODELVIEW);
    <b><i>draw right-eye image</i></b>
}
Togl_SwapBuffers(togl);
</pre></blockquote>

    <h2><a name="image">Image Functions</a></h2>

    <p>
    <!--description-->

    <dl>
      <dt><code>int Togl_TakePhoto(Togl *togl, Tk_PhotoHandle photo)</code>
      <dd>
      Take a photo image of the current Togl window and place it in the
      given <code>photo</code> object.
      If the window is partially obscured,
      either by other windows or by the edges of the display,
      the results are undefined in the obscured region. 
    </dl>

    <h2><a name="convert">Conversion Functions</a></h2>

    <p>
    These functions aid the programmer when writing Togl callback functions.

    <dl>
      <dt><code>int Togl_GetToglFromObj(Tcl_Interp *interp, Tcl_Obj *obj, Togl **toglPtr)</code>
      <dd>
      Attempt to return a Togl structure "toglPtr" from the Tcl object "obj".
    </dl>

    <dl>
      <dt><code>int Togl_GetToglFromName(Tcl_Interp *interp, const char *cmdName, Togl **toglPtr)</code>
      <dd>
      Attempt to return a Togl structure "toglPtr" from the Tcl command name "cmdName".
    </dl>

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 11489
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Downloading and Installing Togl</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Downloading and Installing Togl</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#prereq">Prerequisites</a>
      <li><a href="#getting">Downloading</a>
      <li><a href="#building">Installing</a>
      <ul>
	<li><a href="#x11">X11 usage</a>
	<li><a href="#windows">Windows 95/NT/2000/XP usage</a>
	<li><a href="#macosx">Mac OS X usage</a>
      </ul>
      <li><a href="#version">Version History</a>
    </ul>

    <hr>

    <h2><a name="prereq">Prerequisites</a></h2>

    <p>
    You should have
    <a href="http://www.tcl.tk/">Tcl and Tk</a>
    installed on your computer.
    Togl works with Tcl/Tk version 8.1 and up
    (all recent testing has been with version 8.4).
    The Mac OS X version requires version 8.4
    (note: versions 8.4.12 and 8.4.13 have a bug when unmapping Togl widgets).

    <p>
    You must also have
    <a href="http://www.opengl.org">OpenGL</a> or
    <a href="http://www.mesa3d.org">Mesa</a>
    (a free alternative to OpenGL with the same API)
    installed on your computer.

    <p>
    And one should be familiar with Tcl, Tk, OpenGL,
    and C programming to use Togl effectively.

    <br>
    <h2><a name="getting">Downloading Togl</a></h2>

    <p>
    Togl can be downloaded from
    <a href="http://sourceforge.net/project/showfiles.php?group_id=519">
      SourceForge</a> Files page.

    <p>
    Several prebuilt binary distributions are available
    as well as a source distribution.

    <h2><a name="building">Installing Togl</a></h2>

    <h3>Installing prebuild binaries</h3>

    <p>
    Prebuilt binaries provide a Togl2.0 directory,
    the togl.h, togl_ws.h and toglDecls.h include files,
    and the togl stub library
    (libToglstub2.0.a or Toglstub20.lib, <i>etc</i>).
    The Togl2.0 directory needs to copied
    into one of the directories on Tcl's package path
    (type <code>puts $auto_path</code> in the Tcl interpreter to see
    the list of directories).
    If you have C code that needs to access Togl's subroutines directly,
    place the include file in the same place as Tcl's include file and
    the stub library in the same place as Tcl's stub library.

    <h3>Installing from source</h3>

    <p>
    Togl uses the Tcl Extension Architecture to be able to build on the
    same platforms Tcl can be built on.
    In addition to the Togl source,
    you will need to have the Tcl and Tk source distributions
    because not all installations have the needed Tcl and Tk internal header files.

    <p>
    How you link with Togl depends on how you're planning to use it.
    There are basically three ways of using Togl with your application:
    <ul>
      <li>
      Install the Togl shared library and pkgIndex.tcl file
      (using <code>make install</code>)
      and link to the Togl stubs library with your executable or shared library.
      In this case you must call Togl_InitStubs() (and probably Tcl_InitStubs()
      &mdash; Tk_InitStubs is only needed if you call Tk functions).
      This is the way the included Togl examples are built.

      <li>
      Link to the Togl shared library
      or &quot;compile in&quot; the Togl object files
      with your executable or shared library.
      In this case you must call Togl_Init() from your C code
      to initialize Togl.

      <li>
      Install the Togl shared library and pkgIndex.tcl file
      (using <code>make install</code>)
      and then load it using Tcl commands or Tcl_PkgRequire().
      Then use Tcl commands to create and manipulate the Togl widget.
    </ul>

    Since Togl is compiled into a shared library using the Tcl/Tk stubs-interface,
    the same binary can be used with any version of Tck/Tk from 8.1 and up.
    See <code>README.stubs</code> for more info.

    <p>
    Specific platform notes follow:

    <h4><a name="x11">Unix/X11 usage</a></h4>

    <p>
    Unix/X systems only need the public Tcl/Tk include files.
    Just <code>configure</code>, <code>make</code>,
    and optionally <code>make install</code>.

    <h4><a name="windows">Windows 95/NT/2000/XP usage</a></h4>

    <p>
    Windows platforms need <code>tkWinInt.h</code>
    and other internal Tk header files.  So you need a Tcl/Tk
    source distribution in addition to the Togl distribution
    (or copy over the various include files).
    <p>
    Here's the minimal way to build Togl with Tcl/Tk
    using the <a href="http://gcc.gnu.org">gcc</a> that is distributed
    as part of the <a href="http://cygwin.com/">cygwin</a> tools
    (<a href="www.microsoft.com">Microsoft</a>'s compilers work too):
    <blockquote><code><pre>
VER=8.4.12
SRCDIR=`pwd`

cd $SRCDIR/tcl$VER/win
env 'CC=gcc -mno-cygwin' ./configure --enable-threads
make libtclstub84.a

cd $SRCDIR/tk$VER/win
env 'CC=gcc -mno-cygwin' ./configure --enable-threads
make libtkstub84.a

cd $SRCDIR/Togl2.0
env 'CC=gcc -mno-cygwin' ./configure --with-tcl=../tcl$VER/win --with-tk=../tk$VER/win

make
</pre></code></blockquote>
    The resulting <code>Togl20.dll</code> and <code>pkgIndex.tcl</code>
    should be installed into your Tcl installation just like any other package.

    <p>
    If you change all of the above <code>make</code>'s
    to <code>make install</code> instead,
    then the Togl package is installed correctly.

    <h4><a name="macosx">Mac OS X usage</a></h4>

    <p>
    These special instructions are for building the Aqua version of Togl.
    Mac OS X needs <code>tkMacOSXInt.h</code>
    and other internal Tk header files.
    Unfortunately, the Tcl and Tk frameworks that Apple distributes
    are missing the internal headers.
    So you need a Tcl/Tk source distribution in addition to the Togl
    distribution (or copy over the various include files).
    You would probably want a newer version of Tcl and Tk anyway
    because each minor revision of 8.4 has many Aqua bug fixes.
    <p>
    Here's one way to build Tcl, Tk, and Togl on Mac OS X
    (assuming they are all in the same directory)
    to install in your home directory:
    <blockquote><code><pre>
VER=8.4.12

mkdir -p ~/bin
make -C tcl$VER/macosx install PREFIX="${HOME}" INSTALL_PATH="${HOME}/Library/Frameworks"
make -C tk$VER/macosx install PREFIX="${HOME}" INSTALL_PATH="${HOME}/Library/Frameworks" APPLICATION_INSTALL_PATH="${HOME}/Applications"

cd Togl2.0
./configure --prefix="${HOME}"
make install
</pre></code></blockquote>

    <br>
    <h2><a name="version">Version History</a></h2>

    <h3>Version 1.0 &mdash; March, 1996</h3>
    <ul>
      <li>Initial version
    </ul>

    <h3>Version 1.1 (never officially released)</h3>
    <ul>
      <li>Added Togl_LoadBitmapFont function
      <li>Fixed a few bugs
    </ul>

    <h3>Version 1.2 &mdash; November, 1996</h3>
    <ul>
      <li>added swapbuffers and makecurrent Tcl commands
      <li>more bug fixes
      <li>upgraded to suport Tcl 7.6 and Tk 4.2
      <li>added stereo and overlay plane support
      <li>added Togl_Get/SetClientData() functions
      <li>added Togl_DestroyFunc()
    </ul>

    <h3>Version 1.3 &mdash; May 2, 1997</h3>
    <ul>
      <li>fixed a bug in Togl_Configure()
      <li>fixed a compilation problem in using Tcl_PkgProvide() with Tcl < 7.4
      <li>new overlay functions: Togl_ExistsOverlay, Togl_GetOverlayTransparentValue,
      Togl_IsMappedOverlay, Togl_AllocColorOverlay, Togl_FreeColorOverlay
      <li>added X11 functions: Togl_Display, Togl_Screen, Togl_ScreenNumber,
      Togl_Colormap
      <li>added Togl_DumpToEpsFile function
      <li>fixed a C++ compilation problem
      <li>more robust overlay code
      <li>added timers (Togl_TimerFunc) from Peter Dern and Elmar Gerwalin
    </ul>

    <h3>Version 1.4 &mdash; September 17, 1997</h3>
    <ul>
      <li>ported to Windows NT (Robert Casto)
      <li>updated for Tcl/Tk 8.0
      <li>added many config flags (-redsize, -depthsize, etc) (Matthias Ott)
      <li>added Togl_Set*Func() functions to reassign callback functions (Matthias Ott)
      <li>added Togl_ResetDefaultCallbacks() and Togl_ClientData() functions (Greg Couch)
    </ul>

    <h3>Version 1.5 &mdash; September 18, 1998</h3>
    <ul>
      <li>fixed a few Unix and Windows compilation bugs
      <li>added Ben Evan's SGI stereo functions
      <li>multiple expose events now reduced to one redraw
      <li>destroying Togl widgets caused problems, patched by Adrian J. Chung
      <li>added Togl_TkWin() function
      <li>updated for Tcl/Tk 8.0p2
      <li>added gears demo from Philip Quaife
      <li>added <code>-sharelist</code> and <code>-sharecontext</code> config flags
      <li>fixed a few overlay update bugs
      <li>added <code>-indirect</code> config flag
    </ul>

    <h3>Version 1.6 &mdash; May 7, 2003</h3>
    <ul>
      <li>added Togl_SetTimerFunc function
      <li>updated for Tcl/Tk 8.0.5 and 8.1
      <li>context sharing added for Windows
      <li>Macintosh support (by Paul Thiessen)
      <li>Tcl/Tk stubs support &mdash; see README.tcl (by Jonas Beskow)
    </ul>

    <h3>Version 1.7 &mdash; Jan 2006</h3>
    <ul>
      <li>added Mac OS X support
      <li>enabled asking for quad-buffered stereo pixel formats on all platforms
      (use -oldstereo on SGIs for splitscreen stereo &mdash; C API changed too)
      <li>configuring the cursor is no longer slow
      <li>added <code>-pixelformat</code> config flag
      <li>added setgrid support (unfortunately many window managers can't cope with 1x1 pixel grid)
      <li>only free context when last reference is gone
      <li>switched to TEA-based configure (instead of editting make files)
    </ul>

    <h3>Version 2.0 &mdash; Apr 2008</h3>
    <ul>
      <li>stubified C API
      <li>replaced EPS support with TK photo image support
      <li>simplified C API by requiring callback command options
      <li>Added command arguments for create, destroy, etc. callbacks,
      so there is a -createcommand option to the togl command (etc.).
      (and removed Togl_*Func from the C API)
      <li>added togl instance commands that call C API &mdash;
      see <a href="tclapi.html">documentation</a>
      <li>use Tcl objects internally
      <li>use Tcl object interface for callbacks
      <li>vertical sync control
      <li>fix thread safety in anticipation that OpenGL drivers may someday be thread safe
      <li>added simple stereo rendering interface
      <li>revised font C API
      <li>updated font support for Tk 8.4 on all platforms
      <li>updated documentation
      <li>prebuilt binaries
    </ul>

    <br>
    <h3>Future plans</h3>
    Patches for the following are especially welcome:
    <ul>
      <li>multisampling support (can be worked-around by passing in a pixelformat)
      <li>pbuffers
      <li>Tk 8.5 fonts
      <li>EGL support
      <li>RGB overlays
      <li>Tcl access to colormap manipulation
      <li>more Aqua support
    </ul>

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 3639
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Togl Frequently Asked Questions</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Togl Frequently Asked Questions</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#badmatch">Bad Match X errors on Sun systems</a>
      <li><a href="#stereo">Is stereo rendering supported?</a>
      <li><a href="#fullscreen stereo">Is fullscreen stereo rendering supported?</a>
      <li><a href="#dc">How do I get the Microsoft Windows device context?</a>
      <li><a href="#python">How do I use Togl from Python?</a>
      <li><a href="#tile">Is Togl compatible with Tile and Tk 8.5?</a>
    </ul>
    <h2>Frequently Asked Questions (and Problems)</h2>

    <hr>

    <p>
    If you have something to add to this section please let us know.

    <dl>
      <dt>
      <a name="badmatch"><b>Bad Match X errors on Sun systems</b></a>
      <dd>
      There is(was?) a bug in Sun's XmuLookupStandardColormap
      X library function.
      If you compile togl.c with the SOLARIS_BUG symbol defined (-DSOLARIS_BUG)
      this function call will be omitted.

      <p>
      <dt>
      <a name="stereo"><b>Is stereo rendering supported?</b></a>
      <dd>
      Several different <a href="stereo.html">stereo modes</a> are supported.

      <p>
      <dt>
      <a name="fullscreen stereo"><b>Is fullscreen stereo rendering supported?</b></a>
      <dd>
      Before Tk 8.5,
      Tk does not support true fullscreen windows.
      Consequenly the full-screen stereo,
      that gaming graphics cards support (ATI Radeon, NVidia GeForce),
      won't be added until sometime after Tk 8.5 is available.
      Fullscreen stereo on workstation graphics cards
      (ATI FireGL, NVidia Quadro, Matrix Parhelia, 3Dlabs Wildcat)
      does work.
      <p>
      <dt>
      <a name="dc"><b>How do I get the Microsoft Windows device context?</b></a>
      <dd>
      First call <code>Togl_MakeCurrent</code> to make sure you have the
      right OpenGL context and device context set,
      then call <code>wglGetCurrentDC</code>.

      <p>
      <dt>
      <a name="python"><b>How do I use Togl from Python?</b></a>
      <dd>
      The Togl source distribution comes with a <code>Togl.py</code> file
      that provides a Tkinter-style Togl widget.
      And for Togl callbacks that are C functions,
      there is a <code>toglpy.h</code> file that provides a function
      that converts a Python object into its corresponding Togl widget:
      <blockquote>
	<code>Togl *getToglFromWidget(PyObject *widget)</code>
      </blockquote>

      <p>
      <dt>
      <a name="tile"><b>Is Togl compatible with Tile and Tk 8.5?</b></a>
      <dd>
      Yes, Togl works as is (except for the bitmap font support for X11 and Aqua).
      From <a href="http://wiki.tcl.tk/1218">Joe English</a>:
      <blockquote>
	Complex &quot;owner-draw&quot; widgets like tkZinc,
	or the text and canvas widgets,
	really don't benefit much from themability,
	so there's no reason to rewrite them.
	(<a href="http://wiki.tcl.tk/13373">http://wiki.tcl.tk/13373</a>)
      </blockquote>
    </dl>

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 746
function displayHeader(pageTitle)
{
	document.write("<center><h1>" + pageTitle + "</h1></center>");
}

function NavigationBar()
{
	document.write("<table rules='cols' cellpadding='4'>");
	document.write(" <tr>");
	document.write(" <td><a href='index.html'>Index</a></td>");
	document.write(" <td><a href='index.html#intro'>Intro</a></td>");
	document.write(" <td><a href='download.html'>Download/Install</a></td>");
	document.write(" <td><a href='using.html'>Using Togl</a></td>");
	document.write(" <td><a href='tclapi.html'>Tcl API</a></td>");
	document.write(" <td><a href='capi.html'>C API</a></td>");
	document.write(" <td><a href='faq.html'>FAQ</a></td>");
	document.write(" </tr>");
	document.write("</table>");
	document.write("<hr>");
}

blob
data 4998
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Togl, a Tk OpenGL widget</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>

    <h1 align="center">Togl &mdash; a Tk OpenGL widget</h1>
    <h3 align="center">Copyright &copy; 1996-2008 Brian Paul, Ben Bederson, and Greg Couch</h3>

    <h2>Index</h2>

    <ul>
      <li><a href="#intro">Introduction</a>
      <li><a href="download.html">Download/Installation</a>
      <li><a href="using.html">Using the togl widget</a>
      <ul>
	<li><a href="tclapi.html">Tcl API</a>
	<li><a href="capi.html">C API</a>
	<li><a href="upgrading.html">Upgrading to version 2</a>
      </ul>
      <li><a href="faq.html">Frequently Asked Questions (FAQ)</a>
      <li><a href="#mailing">Mailing List</a>
      <li><a href="#bugs">Reporting Bugs</a>
      <li><a href="#contrib">Contributors</a>
    </ul>

    <hr>

    <h2><a name="intro">Introduction</a></h2>

    Togl is a <a href="http://www.tcl.tk/">Tk</a> widget for
    <a href="http://www.opengl.org/">OpenGL</a> rendering.
    Togl was originally based on OGLTK, written by Benjamin Bederson at
    the University of New Mexico.

    Togl's main features are:

    <ul>
      <li>unifies Microsoft Windows, X11 (Linux/IRIX/...), and Mac OS X Aqua support
      <li>support for requesting stencil, accumulation, alpha buffers, <i>etc</i>.
      <li>multiple OpenGL drawing windows
      <li>simple stereo rendering support
      <li>simple, portable font support
      <li>color-index mode support including color allocation functions
      <li>overlay plane support
      <li>OpenGL extension testing from Tcl
      <li>Tcl Extension Architecture (TEA) 3 compliant
    </ul>

    <p>
    Togl does almost no OpenGL drawing itself,
    instead it manages OpenGL drawing by calling various Tcl commands
    (<i>a.k.a.</i>, callback functions).
    Those commands can be C functions that call OpenGL (in)directly
    or another Tcl package
    (<i>e.g.</i>, <a href="http://www.tcl3d.org/">Tcl3D</a>).

    <p>
    Togl is copyrighted by
    <a href="http://www.mesa3d.org/brianp/home.html">Brian Paul</a>
    (brian_e_paulATyahooDOTcom),
    <a href="http://www.cs.umd.edu/~bederson/">Benjamin Bederson</a>
    (bedersonATcsDOTumdDOTedu), and
    <a href="http://www.cgl.ucsf.edu/chimera/">Greg Couch</a>
    (gregcouchATusersDOTsourceforgeDOTnet).
    See the LICENSE file for details.

    <p>
    The <a href="http://www.sourceforge.net/projects/togl/">
      Togl project</a> and
    <a href="http://togl.sourceforge.net">home page</a> are
    hosted by <a href="http://www.sourceforge.net">SourceForge</a>.

    <br>
    <h2><a name="mailing">Mailing list</a></h2>

    <p>
    See the <a href="http://www.sourceforge.net/projects/togl/">
      Togl project at SourceForge</a> for mailing list information.

    <br>
    <h2><a name="bugs">Reporting Bugs</a></h2>

    <p>
    There is a bug database on the
    <a href="http://sourceforge.net/projects/togl/">Togl Project Page</a>.
    You may also discuss bugs on the mailing list.
    <p>
    It may be worth upgrading your graphics driver and retesting
    before reporting a bug,
    as, historically,
    many Togl &quot;bugs&quot; have been fixed by a graphics driver upgrade,
    especially on Microsoft Windows.
    <p>
    When reporting bugs please provide as much information as possible.
    Such as the version of Togl, which operating system
    (<i>e,g.</i>, Windows XP, Red Hat Linux, Mac OS X, <i>etc.</i>),
    the version of the operating system,
    and the version of the graphics driver.
    Also, it's very helpful to us if you can provide an example program
    which demonstrates the problem.

    <br>
    <h2><a name="contrib">Contributors</a></h2>

    <p>
    Several people have contributed new features to Togl.  Among them are:

    <ul>
      <li>Ramon Ramsan &mdash; overlay plane support
      <li>Miguel A. De Riera Pasenau &mdash; more overlay functions, X11 functions
      and EPS output
      <li>Peter Dern and Elmar Gerwalin &mdash; Togl_TimerFunc and related code
      <li>Robert Casto &mdash; Windows NT port
      <li>Geza Groma &mdash; Windows 95/NT patches
      <li>Ben Evans &mdash; SGI stereo support
      <li>Paul Thiessen &mdash; Macintosh support
      <li>Jonas Beskow &mdash; Tcl/Tk stubs support
      <li>Paul Kienzle &mdash; TEA debugging and patches
      <li>Greg Couch &mdash; version 1.7, 2.0
    </ul>

    Many others have contributed bug fixes.  Thanks for your contributions!

    <br>
    <hr>
    Last edited on 16 April 2008 by Greg Couch.

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 5788
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Togl Stereo Modes</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Togl Stereo Modes</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#none">none</a>
      <li><a href="#native">native</a>
      <li><a href="#anaglyph">anaglyph</a>
      <li><a href="#cross">cross-eye</a>
      <li><a href="#wall">wall-eye</a>
      <li><a href="#dti">dti</a>
      <li><a href="#left">left eye</a>
      <li><a href="#right">right eye</a>
      <li><a href="#sgioldstyle">sgioldstyle</a>
      <!--
      <li><a href="#nvidia">nvidia consumer stereo</a>
      -->
    </ul>

    <hr>

    <p>
    There are lots of stereo modes in Togl because there are many ways to
    draw stereo with different tradeoffs.
    All of the stereo modes are choosen with the
    <a href="tclapi.html#pixelformat">
      <code>-stereo</code> configuration option</a>.
    All of the non-native stereo techniques
    are software-only and can be changed at anytime.
    <p>
    When using a non-native stereo mode, the OpenGL
    <code>glDrawBuffer</code>, <code>glClear</code>,
    <code>glFrustum</code>, and <code>glOrtho</code> calls
    should be replaced with the Togl
    <a href="tclapi.html#stereo cmds">Tcl</a> or
    <a href="capi.html#stereo">C</a> versions
    for seemless stereo rendering.
    <p>
    The various stereo modes are:
    <dl>
      <dt>
      <a name="none"></a><code>none</code> <i>or</i> &quot;&quot;
      <dd>
      Turn off stereo.
      <dt><code>native</code>
      <dd>
      Use native OpenGL hardware accelerated stereo
      (single- or double-buffered for both the left and the right eyes).
      Each eye is drawn at full window resolution
      which gives the best stereo image.
      This mode requires support from the graphics driver and is
      typically only supported on workstation-class graphics cards, <i>e.g.</i>,
      <a href="http://www.nvidia.com/page/workstation.html">NVidia Quadro</a>,
      <a href="http://ati.amd.com/products/workstation.html">ATI FireGL</a>,
      <a href="http://www.matrox.com/graphics/">Matrix Parhelia</a>,
      <a href="http://www.3dlabs.com/content/wildcat.asp">3DLabs Wildcat</a>
      graphics cards
      and <a href="http://www.sgi.com/">SGI</a> workstations.
      The video refresh rate is changed automatically by the windowing system
      except on SGI workstations.
      Developers for SGI workstations can either switch the video manually with
      <code>/usr/gfx/setmon</code> or <code>/usr/bin/X11/xsetmon</code>, or use the
      <a href="http://www.cgl.ucsf.edu/Overview/software.html#autostereo">
	autostereo</a> package.
      <p>
      Currently, there is a limitation that a togl widget can not be
      reconfigured in or out of the native stereo mode.
      And if/when it is supported,
      some graphics drivers might not allow it.
      <dt>
      <a name="anaglyph"></a><code>anaglyph</code>
      <dd>
      Draw the left eye in the red part of the color buffer
      and the right eye in the blue and green parts.
      Designed to be viewed with inexpensive red-blue or red-cyan glasses.
      Works best with gray scale and non-saturated color images.
      <dt>
      <a name="cross"></a><code>cross-eye</code>
      <dd>
      Draw right eye image on the left half of screen,
      and draw left eye image on the right half of screen.
      So each eye is drawn at less than half of the window resolution.
      <dt>
      <a name="wall"></a><code>wall-eye</code>
      <dd>
      Draw left eye image on the left half of the screen,
      and draw right eye image on the right half of the screen.
      So each eye is drawn at less than half of the window resolution.
      <dt>
      <a name="dti"></a><code>dti</code>
      <dd>
      Designed for <a href="http://www.dti3d.com/">DTI</a> displays.
      If you look at the window unassisted,
      you'll see horizonally squished images
      with the left eye image on the left,
      and right eye image on the right.
      So each eye is drawn at half of the window resolution.
      <dt>
      <a name="left"></a><code>left eye</code>
      <dd>
      Only draw left eye view at full resolution.
      <dt>
      <a name="right"></a><code>right eye</code>
      <dd>
      Only draw right eye view at full resolution.
      <dt>
      <a name="sgioldstyle"></a><code>sgioldstyle</code>
      <dd>
      Support older-style SGI stereo where you lose half of the vertical resolution.
      This uses the SGIStereo X extension,
      that is only available on SGI workstations,
      to tell the X server to duplicate non-stereo windows into both eyes.
      This option only works when the monitor has been changed to the one
      of the <code>str_top</code>, <code>str_bot</code>, or <code>str_rect</code> video output modes.
      <!--
      <dt>
      <a name="nvidia"></a><code>nvidia consumer stereo</code>
      <dd>
      Use the
      <a href="http://www.nvidia.com/drivers">NVidia Consumer 3D Stereo</a> driver.
      This only works with NVidia consumer graphics cards on Microsoft Windows
      and when the Togl window covers the full screen.
      NVidia Quadro users should use the <code>native</code> stereo mode.
      -->
    </dl>

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 20024
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Togl Tcl API</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Togl Tcl API</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#tclfuncs">Togl Tcl command</a>
      <li><a href="#toglfuncs">Togl widget commands</a>
      <ul>
	<li><a href="#configuration">Configuration Commands</a>
	<li><a href="#extensions">Extensions Command</a>
	<li><a href="#rendering">Rendering Commands</a>
	<li><a href="#image">Image Commands</a>
	<li><a href="#font">Font Commands</a>
	<li><a href="#overlay">Overlay Commands</a>
	<li><a href="#stereo cmds">OpenGL (Stereo) Commands</a>
      </ul>
      <li><a href="#options">Togl configuration options</a>
      <ul>
	<li><a href="#drawing">Drawing callbacks</a>
	<li><a href="#geometry">Geometry Options</a>
	<li><a href="#timer">Timer Options</a>
	<li><a href="#stereo options">Stereo Options</a>
	<li><a href="#miscellaneous">Miscellaneous Options</a>
	<li><a href="#pixelformat">Pixel Format Options</a>
      </ul>
    </ul>

    <hr>

    <h2><a name="tclfuncs">Togl Tcl command</a></h2>

    <p>
    The togl command creates a new Tk widget, a Tcl command,
    whose name is <var>pathName</var>.
    This command may be used to invoke various operations on the widget.
    <blockquote>
      <code>togl <var>pathName</var> [<a href="#options">options</a>]</code>
    </blockquote>
    If no options are given, a 400 by 400 pixel RGB window is created.
    This command may be used to invoke various operations on the widget.

    <h2><a name="toglfuncs">Togl widget commands</a></h2>

    The following commands are possible for an existing togl widget:

    <h3><a name="configuration">Configuration commands</a></h3>

    <dl>
      <dt><code><var>pathName</var> cget <var>-option</var></code>
      <dd>
      Return current value of given configuration option.
    </dl>

    <dl>
      <dt>
      <code><var>pathName</var> configure</code><br>
      <code><var>pathName</var> configure <var>-option</var></code>
      <dd>
      If no <var>option</var> is given,
      then return information about
      all configuration <a href="#options">options</a>.
      Otherwise,
      return configuration information for given <var>option</var>.
      All configuration information consists of five values:
      the configuration option name,
      the option database name,
      the option database class,
      the default value,
      and the current value.
    </dl>

    <dl>
      <dt><code><var>pathName</var> configure <var>-option</var> <var>value</var></code>
      <dd>
      Reconfigure a Togl widget.
      <var>option</var> may be any one of the options listed below.
    </dl>

    <dl>
      <dt><code><var>pathName</var> contexttag</code>
      <dd>
      Returns an integer that represents the context tag.
      All Togl widgets with the same context tag share display lists.
    </dl>

    <h3><a name="extensions">Extensions command</a></h3>

    <dl>
      <dt><code><var>pathName</var> extensions</code>
      <dd>
      Returns a list of OpenGL extensions available.  For example:
      <blockquote><code><pre>
if {[lsearch [<i>pathName</i> extensions] GL_EXT_bgra] != -1]} {
    ....
}
</pre></code></blockquote>
      would check if the GL_EXT_bgra extension were supported.
    </dl>

    <h3><a name="rendering">Rendering commands</a></h3>

    <dl>
      <dt><code><var>pathName</var> postredisplay</code>
      <dd>
      Cause the displaycommand callback to be called
      the next time the event loop is idle.
    </dl>

    <dl>
      <dt><code><var>pathName</var> render</code>
      <dd>
      Causes the displaycommand callback to be called for <var>pathName</var>.
    </dl>

    <dl>
      <dt><code><var>pathName</var> swapbuffers</code>
      <dd>
      Causes front/back buffers to be swapped if in double buffer mode.
      And flushs the OpenGL command buffer if in single buffer mode.
      (So this is appropriate to call after every frame is drawn.)
    </dl>

    <dl>
      <dt><code><var>pathName</var> makecurrent</code>
      <dd>
      Make the widget specified by <var>pathName</var> and its OpenGL context
      the current ones.
      This is implicitly called before any callback command is invoked.
    </dl>

    <h3><a name="image">Image commands</a></h3>

    <dl>
      <dt><code><var>pathName</var> takephoto <var>imagename</var></code>
      <dd>
      Copy the contents of the togl window into the given Tk photo image.
      Transparency values are copied and should be fully opaque for windows
      without alpha bitplanes.
    </dl>

    <h3><a name="font">Font commands</a></h3>

    <p>
    These functions provide an interface to the simple bitmap font capabilities
    that every OpenGL implementation provides.
    Better font support is found in other packages, <i>e.g.</i>,
    <a href="http://www.tcl3d.org/">Tcl3D</a>
    or with different <a href="capi.html#font">C APIs</a>.

    <dl>
      <dt><code><var>pathName</var> loadbitmapfont <var>font</var></code>
      <dd>
      <var>font</var> can be any of font descriptions listed in the Tk
      <a href="http://www.tcl.tk/man/tcl8.4/TkCmd/font.htm#M13">font</a> command.
      It returns a togl font object.
    </dl>

    <dl>
      <dt><code><var>pathName</var> unloadbitmapfont <var>toglfont</var></code>
      <dd>
      Releases the OpenGL resources needed by the <var>toglfont</var>.
    </dl>

    <dl>
      <dt><code><var>pathName</var> write <var>toglfont</var> [-pos <var>xyzw</var>] [-color <var>rgba</var>] <var>string</var></code>
      <dd>
      Write the given <var>string</var> in the given <var>toglfont</var>,
      optionally at a particular position, <var>xyzw</var>
      and color, <var>rgba</var>.
      <var>xyzw</var> is either a 2, 3, or 4 element list of numbers.
      <var>rgba</var> is either a 3 or 4 element list of numbers.
    </dl>

    <h3><a name="overlay">Overlay Commands</a></h3>

    <dl>
      <dt><code><var>pathName</var> uselayer <var>layer</var></code>
      <dd>
      This is a variation on the <code>makecurrent</code> command
      that makes the overlay OpenGL context current
      if <var>layer</var> is 2
      and makes the normal OpenGL context current
      if <var>layer</var> is 1.
    </dl>

    <dl>
      <dt><code><var>pathName</var> showoverlay</code>
      <dd>
      Turn on drawing in the overlay planes.
    </dl>

    <dl>
      <dt><code><var>pathName</var> hideoverlay</code>
      <dd>
      Turn off drawing in the overlay planes.
    </dl>

    <dl>
      <dt><code><var>pathName</var> postredisplayoverlay</code>
      <dd>
      Cause the overlay OpenGL context to be redrawn the next time
      the Tcl event loop is idle.
    </dl>

    <dl>
      <dt><code><var>pathName</var> renderoverlay</code>
      <dd>
      Causes the overlaydisplaycommand callback to be called for <var>pathName</var>.
    </dl>

    <dl>
      <dt><code><var>pathName</var> existsoverlay</code>
      <dd>
      Return true if togl widget has overlay planes.
    </dl>

    <dl>
      <dt><code><var>pathName</var> ismappedoverlay</code>
      <dd>
      Return true if overlay planes are shown.
    </dl>

    <dl>
      <dt><code><var>pathName</var> getoverlaytransparentvalue</code>
      <dd>
      Return overlay plane's transparent pixel value.
    </dl>

    <h3><a name="stereo cmds">OpenGL (Stereo) Commands</a></h3>
    These commands exist to support stereo rendering.
    Just replace select OpenGL calls with the Togl versions
    and stereo rendering will magically work.  And don't forget
    to update the <a href="#stereo options">stereo options</a>.

    <dl>
      <dt><code><var>pathName</var> drawbuffer <var>mode</var></code>
      <dd>
      Replaces calls to glDrawBuffer.
      The mode is an integer.
    </dl>

    <dl>
      <dt><code><var>pathName</var> clear <var>mask</var></code>
      <dd>
      Replaces calls to glClear.
      The mask is an integer.
    </dl>

    <dl>
      <dt><code><var>pathName</var> frustum <var>left right bottom top near far</var></code>
      <dd>
      Replaces calls to glFrustum.
    </dl>

    <dl>
      <dt><code><var>pathName</var> ortho <var>left right bottom top near far</var></code>
      <dd>
      Replaces calls to glOrtho.
    </dl>

    <dl>
      <dt><code><var>pathName</var> numeyes</code>
      <dd>
      Returns numbers of eyes &mdash; basically,
      2 for stereo views and 1 for all others,
      except some stereo views only need one eye from OpenGL.
    </dl>

    <h2><a name="options">Togl configuration options</a></h2>

    Togl's configuration options can be separated into several categories:
    geometry, pixel format, and other.
    The pixel format related options can only be set at widget creation time.
    The other options can be changed dynamically
    by the <code><var>pathName</var> configure</code> command (see above).

    <h3><a name="drawing">Drawing callbacks</a></h3>

    <table border="0">
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-createcommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-create</code>.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-displaycommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-display</code>.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-reshapecommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-reshape</code>.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-destroycommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-destroy</code>.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-overlaydisplaycommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-overlaydisplay</code>.
	  </td>
	</tr>
      </tbody>
    </table>

    <h3><a name="geometry">Geometry Options</a></h3>

    <table border="0">
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-width</code></td>
	  <td align="center">400</td>
	  <td>
	    Set width of widget in pixels.
	    It may have any of the forms accepted by <b>Tk_GetPixels</b>.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-height</code></td>
	  <td align="center">400</td>
	  <td>
	    Set height of widget in pixels.
	    It may have any of the forms accepted by <b>Tk_GetPixels</b>(3).
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-setgrid</code></td>
	  <td align="center">0</td>
	  <td>
	    Turn on gridded geometry management for togl widget's toplevel
	    window and specify the geometry of the grid.
	    See the manual pages for Tk's <b>wm</b>(n) and <b>Tk_SetGrid</b>(3)
	    for more information.
	    Unlike the <b>text</b> widget,
	    the same value is used for both width and height increments.
	  </td>
	</tr>
      </tbody>
    </table>

    <h3><a name="timer">Timer Options</a></h3>

    <table>
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-time</code></td>
	  <td align="center">1</td>
	  <td>
	    Specifies the interval, in milliseconds, for
	    calling the timer callback function which
	    was registered with -timercommand.</td>
	</tr>
	<tr valign="top">
	  <td><code>-timercommand</code></td>
	  <td align="center">{}</td>
	  <td>
	    Can be abbreviated <code>-timer</code>.
	  </td>
	</tr>
      </tbody>
    </table>

    <h3><a name="stereo options">Stereo Options</a></h3>

    <table>
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-eyeseparation</code></td>
	  <td align="center">2.0</td>
	  <td>
	    Set the distance between the eyes in viewing coordinates.
	  </td>
	</tr>

	<tr valign="top">
	  <td><code>-convergence</code></td>
	  <td align="center">30.0</td>
	  <td>
	    Set the distance to the screen from the eye in viewing coordinates
	    (the distance at which the eyes converge).
	  </td>
	</tr>
      </tbody>
    </table>

    <blockquote>
      You'd think these values would be given in physical units,
      but there's no single right way to convert to viewing coordinates
      from physical units.
      So if you're willing to use Tk's idea of the horizontal size of a
      window in millimeters (not always correct),
      you could convert the average eye separation of 63 mm
      to your viewing coordinates, and use that value as the eye separation.
    </blockquote>

    <h3><a name="miscellaneous">Miscellaneous Options</a></h3>

    <table>
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-cursor</code></td>
	  <td align="center">""</td>
	  <td>
	    Set the cursor in the widget window.
	  </td>
	</tr>

	<tr valign="top">
	  <td><code>-swapinterval</code></td>
	  <td align="center">1</td>
	  <td>
	    Set the minimum swap interval measure in video frame periods.
	    The default is 1 for for non-tearing artifacts
	    when swapping buffers.
	    Use a value of 0 when benchmarking frame rates.
	  </td>
	</tr>

	<tr valign="top">
	  <td><code>-ident</code></td>
	  <td align="center">""</td>
	  <td>
	    A user identification string.  This is used match widgets
	    for the <code>-sharecontext</code>
	    and the <code>-sharelist</code> options (see below).
	    This is also useful in your callback functions
	    to determine which Togl widget is the caller.
	  </td>
	</tr>
      </tbody>
    </table>

    <h3><a name="pixelformat">Pixel Format Options</a></h3>

    The following options can only be given when the togl widget is created
    &mdash; that is, unlike other options,
    the togl widget can not be reconfigured with different values
    for the following options after it is created.

    <table border="0">
      <thead>
	<tr valign="top">
	  <th>Option</th>
	  <th>Default</th>
	  <th>Comments</th>
	</tr>
      </thead>
      <tbody>
	<tr valign="top">
	  <td><code>-rgba</code></td>
	  <td align="center">true</td>
	  <td>If true, use RGB(A) mode, otherwise use Color Index mode.</td>
	</tr>
	<tr valign="top">
	  <td><code>-redsize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in red component.</td>
	</tr>
	<tr valign="top">
	  <td nowrap="1"><code>-greensize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in green component.</td>
	</tr>
	<tr valign="top">
	  <td><code>-bluesize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in blue component.</td>
	</tr>
	<tr valign="top">
	  <td><code>-alpha</code></td>
	  <td align="center">1</td>
	  <td>
	    If true and <code>-rgba</code> is true, request an alpha channel.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-alphasize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in alpha component.</td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-double</code></td>
	  <td align="center">false</td>
	  <td>
	    If true, request a double-buffered window, otherwise
	    request a single-buffered window.
	  </td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-depth</code></td>
	  <td align="center">false</td>
	  <td>If true, request a depth buffer.</td>
	</tr>
	<tr valign="top">
	  <td><code>-depthsize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in depth buffer.</td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-accum</code></td>
	  <td align="center">false</td>
	  <td>If true, request an accumulation buffer.</td>
	</tr>
	<tr valign="top">
	  <td><code>-accumredsize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in accumulation buffer red component.</td>
	</tr>
	<tr valign="top">
	  <td nowrap="1"><code>-accumgreensize</code></td>
	  <td align="center">1</td>
	  <td>
	    Minimum number of bits in accumulation buffer green component.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-accumbluesize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in accumulation buffer blue component.</td>
	</tr>
	<tr valign="top">
	  <td><code>-accumalphasize</code></td>
	  <td align="center">1</td>
	  <td>
	    Minimum number of bits in accumulation buffer alpha component.
	  </td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-stencil</code></td>
	  <td align="center">false</td>
	  <td>If true, request a stencil buffer.</td>
	</tr>
	<tr valign="top">
	  <td><code>-stencilsize</code></td>
	  <td align="center">1</td>
	  <td>Minimum number of bits in stencil component.</td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-auxbuffers</code></td>
	  <td align="center">0</td>
	  <td>Desired number of auxiliary buffers.</td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-privatecmap</code></td>
	  <td align="center">false</td>
	  <td>
	    Only applicable in color index mode.
	    If false, use a shared read-only colormap.
	    If true, use a private read/write colormap.
	  </td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-overlay</code></td>
	  <td align="center">false</td>
	  <td>If true, request overlay planes.</td>
	</tr>

	<tr><td colspan="3">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-stereo</code></td>
	  <td align="center">mode</td>
	  <td>
	    See the <a href="stereo.html">stereo</a> information
	    for details about the various modes.
	    Stereo parameters are changed with the
	    <a href="#stereo options">stereo options</a>.
	    <p>
	    When using a non-native stereo mode, the OpenGL
	    <code>glDrawBuffer</code>, <code>glClear</code>,
	    <code>glFrustum</code>, and <code>glOrtho</code> calls
	    must be replaced with the Togl
	    <a href="#stereo cmds">Tcl</a> or
	    <a href="capi.html#stereo">C</a> versions.
	  </td>
	</tr>

	<tr><td colspan="3" height="0">&nbsp;</td></tr>
	<tr valign="top">
	  <td><code>-indirect</code></td>
	  <td align="center">false</td>
	  <td>
	    If present, request an indirect rendering context.
	    A direct rendering context is normally requested.
	    <em>Only significant on Unix/X11.</em>
	  </td>
	</tr>

	<tr valign="top">
	  <td><code>-sharelist</code></td>
	  <td align="center">""</td>
	  <td>
	    Name of an existing Togl widget with which to share display lists.
	    If it is not possible to share contexts between the two togl
	    widgets (depends on the graphics driver
	    and the particular formats), it fails.
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-sharecontext</code></td>
	  <td align="center">""</td>
	  <td>
	    Name of an existing Togl widget with which to
	    share the OpenGL context.
	    <i>Note:  all other pixel format options are ignored.</i>
	  </td>
	</tr>
	<tr valign="top">
	  <td><code>-pixelformat</code></td>
	  <td align="center">0</td>
	  <td>
	    Set the pixel format to the (platform-dependent) given value.
	    This is a backdoor into choosing a particular pixel format
	    that was determined by other means.
	  </td>
	</tr>
      </tbody>
    </table>

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 3863
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Upgrading to Version 2</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Upgrading to Version 2</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#callbacks">Widget callback changes</a>
      <li><a href="#subcommands">Widget subcommand changes</a>
      <li><a href="#stereo">Stereo changes</a>
      <li><a href="#fonts">Font API changes</a>
    </ul>

    <hr>

    <p>
    Internally, Togl version 2 isn't very different from version 1,
    and much of the C interface is the same.
    The main difference is that the focus of the Togl API has changed
    from being a C API to being a Tcl API.
    Which means that the full power of Togl is accessible from Tcl
    (the few exceptions are considered bugs).

    <h2><a name="callbacks">Widget callback changes</a></h2>

    The biggest change is how the various callback are initialized.
    In version 1,
    the C API Togl_Set*Func functions had to be used
    to setup the callback functions before creating the Togl widget.
    And once the callbacks were set for a particular Togl widget,
    they could not be changed.
    If more than once Togl widget was needed,
    the callback functions would need to be reset before each widget creation.
    In version 2,
    the callbacks are configuration arguments to the widget
    and can be updated like any other standard widget configuration option.
    See the <a href="tclapi.html">Tcl API</a> for details.

    <h2><a name="subcommands">Widget subcommand changes</a></h2>

    Version 1 also allowed new subcommands to be added
    to the togl widget command via the C API.
    This was dropped for a variety of reasons:
    there is no exact Tcl equivalent,
    there is no standard object-oriented technique
    currently in the Tcl core (8.4.13),
    it is unclear how to make the API thread safe,
    and the internal Tcl C API doesn't support
    dynamicly changing sets of subcommands.
    That said, this functionality might come back, especially when
    <a href="http://www.tcl.tk/cgi-bin/tct/tip/">TIP #257</a> is implemented.
    Instead, in version 2,
    create a Tcl function that takes the Togl widget as an argument.
    Functions written in C can get the underlying Togl structure handle
    with either the <code>Togl_GetToglFromObj</code>
    or the <code>Togl_GetToglFromName</code> function,
    as appropriate.
    This means that there are no special Togl commands, only Tcl commands.
    See the <a href="tclapi.html">C API</a> for details.

    <h2><a name="stereo">Stereo changes</a></h2>

    The stereo support has been totally revamped.
    Some <a href="stereo.html">form of stereo</a> is available all of the time.

    <h2><a name="fonts">Font changes</a></h2>

    Tcl support for writing strings has been added.
    <p>

    The <a href="capi.html#font">font C API</a> has been revised
    so that Togl_LoadBitmapFont returns a font object instead an integer
    (likewise for Togl_UnloadBitmapFont).
    So instead of calling glListBase and glCallLists directly,
    use Togl_WriteObj or Togl_WriteChars.
    <p>
    The TOGL_BITMAP_* constants remain for limited backwards
    source compatibility and are deprecated.
    The acceptable font names are now the same as Tk_GetFont
    and the Tk font command on all platforms.

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 4883
<html>
  <!-- vi:set sw=2: -->
  <!--
  Copyright (C) 1996-2002  Brian Paul and Ben Bederson
  Copyright (C) 2005-2008  Greg Couch
  See the LICENSE file for copyright details.
  -->

  <head>
    <title>Using the Togl Widget</title>
  </head>

  <body>
    <script language="javascript" src="header.js"></script>
    <script language="javascript">
      NavigationBar();
    </script>

    <h1 align="center">Using the Togl Widget</h1>

    <h2>Contents</h2>
    <ul>
      <li><a href="#using">Using Togl With Your Application</a>
      <li><a href="#examples">Examples</a>
      <li><a href="tclapi.html">Tcl API</a>
      <li><a href="capi.html">C API</a>
    </ul>

    <hr>

    <h2><a name="using">Using Togl With Your Application</a></h2>

    <p>
    First, double check that you have all of the
    <a href="download.html#prereq">prerequisites</a>
    and that you have
    <a href="download.html#building">compiled and installed</a> Togl.
    <p>
    Then, Togl acts like any other extension package &mdash;
    to load it, you use the Tcl <code>package</code> command:
    <blockquote>
      <code>package require Togl 2.0</code>
    </blockquote>
    After that, you can create a Togl widget just like any other Tk widget.

    <h2><a name="examples">Examples</a></h2>

    <p>
    There are six working examples:

    <blockquote>
      <table border="0">
	<tr>
	  <td>double.tcl</td>
	  <td>&mdash; compares single vs double buffering with two Togl widgets</td>
	</tr>
	<tr>
	  <td>texture.tcl</td>
	  <td>&mdash; lets you play with texture mapping options</td>
	</tr>
	<tr>
	  <td>index.tcl</td>
	  <td>&mdash; example of using color index mode</td>
	</tr>
	<tr>
	  <td>overlay.tcl</td>
	  <td>&mdash; example of using overlay planes (requires overlay hardware)</td>
	</tr>
	<tr>
	  <td>stereo.tcl</td>
	  <td>&mdash; stereo example</td>
	</tr>
	<tr>
	  <td>gears.tcl</td>
	  <td>&mdash; spinning gears example</td>
	</tr>
      </table>
    </blockquote>

    <p>
    Each example consists of two files: a Tcl script for the user interface,
    and a Tcl C package that does the OpenGL drawing.
    To compile the examples, type <code>make examples</code>
    in the Togl source directory.
    The C packages are compiled into shared libraries
    that are loaded into the Tcl interpreter as Tcl/Tk-extensions.
    The examples are started by running the corrsponding Tcl script:
    just type <code>./double.tcl</code>
    (or <code>./texture.tcl</code> <i>etc.</i>)
    or run under one of the Tcl interpreters, <i>i.e.</i>,
    <code>tclsh</code> or <code>wish</code>.
    For example:
    <blockquote>
      <code>tclsh84 double.tcl</code>.
    </blockquote>

    <p>
    Other examples that use Tcl for OpenGL drawing can be found in the
    <a href="http://tcl3d.org/html/demos.html">Tcl3D demos</a>.

    <h3><a name="callbacks">Togl callbacks</a></h3>
    <p>
    All of the examples have similar structure.
    First they create the user interface with one or more Togl widgets.
    Each Togl widget is configured with the desired pixel format
    and several callback commands (not all are needed):
    <table>
      <tr>
	<td><code>-createcommand</code></td>
	<td>
	  Called when Togl widget is mapped &mdash;
	  when it is safe to initialize the OpenGL context.
	</td>
      </tr>
      <tr>
	<td><code>-reshapecommand</code></td>
	<td>
	  Called when the Togl widget is resized &mdash;
	  when the OpenGL context's viewport needs to be changed.
	</td>
      </tr>
      <tr>
	<td><code>-displaycommand</code></td>
	<td>
	  Called when the contents of the Togl widget needs to be redrawn.
	  Redraws are normally delayed to be when the Tcl event loop is idle
	  (see the togl widget's <code>postredisplay</code> command),
	  or as the result of an explict call to the togl's widgets
	  <code>render</code> command.
	</td>
      </tr>
      <tr>
	<td><code>-destroycommand</code></td>
	<td>
	  Called when the Togl widget is destroyed.
	  While OpenGL frees display lists and other resources,
	  sometimes there's some associated state that is no longer needed.
	</td>
      </tr>
      <tr>
	<td><code>-timercommand</code></td>
	<td>
	  Called every <i>n</i> milliseconds
	  as given by the <code>-time</code> option.
	</td>
      </tr>
      <tr>
	<td><code>-overlaydisplaycommand</code></td>
	<td>
	  Called when the overlay planes needs to be redrawn.
	  The overlay planes are created and reshaped
	  at the same time as the main OpenGL context.
	</td>
      </tr>
    </table>

    Typically, only <code>-createcommand</code>, <code>-reshapecommand</code>
    and <code>-displaycommand</code> are used.

    <hr>
    Hosted by <a href="http://sourceforge.net/">
      <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=519&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" align="middle"/>
    </a>
  </body>
</html>

blob
data 7729
/* $Id$ */

/* 
 * Togl - a Tk OpenGL widget
 * Copyright (C) 1996-1997  Brian Paul and Ben Bederson
 * Copyright (C) 2006-2007  Greg Couch
 * See the LICENSE file for copyright details.
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <stdlib.h>
#include <string.h>

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT

static Tcl_Obj *toglFont;
static double xAngle = 0, yAngle = 0, zAngle = 0;
static GLdouble CornerX, CornerY, CornerZ;      /* where to print strings */


/* 
 * Togl widget create callback.  This is called by Tcl/Tk when the widget has
 * been realized.  Here's where one may do some one-time context setup or
 * initializations.
 */
static int
create_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    toglFont = Togl_LoadBitmapFont(togl, "Helvetica");
    if (!toglFont) {
        Tcl_AppendResult(interp, "create_cb: ", "Couldn't load font!\n", NULL);
        return TCL_ERROR;
    }
    return TCL_OK;
}


/* 
 * Togl widget reshape callback.  This is called by Tcl/Tk when the widget
 * has been resized.  Typically, we call glViewport and perhaps setup the
 * projection matrix.
 */
static int
reshape_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    int     width;
    int     height;
    double  aspect;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);
    aspect = (double) width / (double) height;

    glViewport(0, 0, width, height);

    /* Set up projection transform */
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glFrustum(-aspect, aspect, -1, 1, 1, 10);

    CornerX = -aspect;
    CornerY = -1;
    CornerZ = -1.1;

    /* Change back to model view transform for rendering */
    glMatrixMode(GL_MODELVIEW);

    return TCL_OK;
}



static void
print_string(Togl *togl, const char *s)
{
    Togl_WriteChars(togl, toglFont, s, 0);
}


/* 
 * Togl widget display callback.  This is called by Tcl/Tk when the widget's
 * contents have to be redrawn.  Typically, we clear the color and depth
 * buffers, render our objects, then swap the front/back color buffers.
 */
static int
display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static GLuint cubeList = 0;
    const char *ident;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK)
        return TCL_ERROR;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glLoadIdentity();           /* Reset modelview matrix to the identity
                                 * matrix */
    glTranslatef(0, 0, -3);     /* Move the camera back three units */
    glRotated(xAngle, 1, 0, 0); /* Rotate by X, Y, and Z angles */
    glRotated(yAngle, 0, 1, 0);
    glRotated(zAngle, 0, 0, 1);

    glEnable(GL_DEPTH_TEST);

    if (!cubeList) {
        cubeList = glGenLists(1);
        glNewList(cubeList, GL_COMPILE);

        /* Front face */
        glBegin(GL_QUADS);
        glColor3f(0, 0.7f, 0.1f);       /* Green */
        glVertex3f(-1, 1, 1);
        glVertex3f(1, 1, 1);
        glVertex3f(1, -1, 1);
        glVertex3f(-1, -1, 1);
        /* Back face */
        glColor3f(0.9f, 1, 0);  /* Yellow */
        glVertex3f(-1, 1, -1);
        glVertex3f(1, 1, -1);
        glVertex3f(1, -1, -1);
        glVertex3f(-1, -1, -1);
        /* Top side face */
        glColor3f(0.2f, 0.2f, 1);       /* Blue */
        glVertex3f(-1, 1, 1);
        glVertex3f(1, 1, 1);
        glVertex3f(1, 1, -1);
        glVertex3f(-1, 1, -1);
        /* Bottom side face */
        glColor3f(0.7f, 0, 0.1f);       /* Red */
        glVertex3f(-1, -1, 1);
        glVertex3f(1, -1, 1);
        glVertex3f(1, -1, -1);
        glVertex3f(-1, -1, -1);
        glEnd();

        glEndList();

    }
    glCallList(cubeList);

    glDisable(GL_DEPTH_TEST);
    glLoadIdentity();
    glColor3f(1, 1, 1);
    glRasterPos3d(CornerX, CornerY, CornerZ);
    ident = Togl_Ident(togl);
    if (strcmp(ident, "Single") == 0) {
        print_string(togl, "Single buffered");
    } else {
        print_string(togl, "Double buffered");
    }
    Togl_SwapBuffers(togl);
    return TCL_OK;
}




static int
setXrot_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &xAngle) != TCL_OK) {
        return TCL_ERROR;
    }

    /* printf( "before %f ", xAngle ); */

    if (xAngle < 0) {
        xAngle += 360;
    } else if (xAngle > 360) {
        xAngle -= 360;
    }

    /* printf( "after %f \n", xAngle ); */

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


static int
setYrot_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &yAngle) != TCL_OK) {
        return TCL_ERROR;
    }

    if (yAngle < 0) {
        yAngle += 360;
    } else if (yAngle > 360) {
        yAngle -= 360;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}

static int
getXrot_cb(ClientData clientData, Tcl_Interp *interp, int argc,
        CONST84 char *argv[])
{
    Tcl_SetObjResult(interp, Tcl_NewDoubleObj(xAngle));
    return TCL_OK;
}

static int
getYrot_cb(ClientData clientData, Tcl_Interp *interp, int argc,
        CONST84 char *argv[])
{
    Tcl_SetObjResult(interp, Tcl_NewDoubleObj(yAngle));
    return TCL_OK;
}

/* 
 * Called by Tcl to let me initialize the modules (Togl) I will need.
 */
EXTERN int
Double_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "create_cb", create_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "display_cb", display_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "reshape_cb", reshape_cb, NULL, NULL);

    /* 
     * Make a new Togl widget command so the Tcl code can set a C variable.
     */

    Tcl_CreateObjCommand(interp, "setXrot", setXrot_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "setYrot", setYrot_cb, NULL, NULL);

    /* 
     * Call Tcl_CreateCommand for application-specific commands, if
     * they weren't already created by the init procedures called above.
     */

    Tcl_CreateCommand(interp, "getXrot", getXrot_cb, NULL, NULL);
    Tcl_CreateCommand(interp, "getYrot", getYrot_cb, NULL, NULL);
    return TCL_OK;
}

blob
data 2726
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# $Id$

# Togl - a Tk OpenGL widget
# Copyright (C) 1996  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.


# An Tk/OpenGL widget demo with two windows, one single buffered and the
# other double buffered.

package provide double 1.0

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/double[info sharedlibextension]

# create ::double namespace
namespace eval ::double {
}

proc double::setup {} {
    wm title . "Single vs Double Buffering"

    frame .f1

    # create first Togl widget
    togl .f1.o1 -width 200 -height 200 -rgba true -double false -depth true -ident Single -create create_cb -display display_cb -reshape reshape_cb

    # create second Togl widget, share display lists with first widget
    togl .f1.o2 -width 200 -height 200 -rgba true -double true -depth true -ident Double -sharelist Single -create create_cb -display display_cb -reshape reshape_cb

    scale .sx -label {X Axis} -from 0 -to 360 -command {::double::setAngle x} -orient horizontal
    scale .sy -label {Y Axis} -from 0 -to 360 -command {::double::setAngle y} -orient horizontal
    button .btn -text Quit -command exit

    bind .f1.o1 <B1-Motion> {
	::double::motion_event [lindex [%W config -width] 4] \
		     [lindex [%W config -height] 4] \
		     %x %y
    }

    bind .f1.o2 <B1-Motion> {
	::double::motion_event [lindex [%W config -width] 4] \
		     [lindex [%W config -height] 4] \
		     %x %y
    }

    pack .f1.o1 .f1.o2 -side left -padx 3 -pady 3 -fill both -expand t
    pack .f1 -fill both -expand t
    pack .sx -fill x
    pack .sy -fill x
    pack .btn -fill x
}



# This is called when mouse button 1 is pressed and moved in either of
# the OpenGL windows.
proc double::motion_event { width height x y } {
    setXrot .f1.o1 [expr 360.0 * $y / $height]
    setXrot .f1.o2 [expr 360.0 * $y / $height]
    setYrot .f1.o1 [expr 360.0 * ($width - $x) / $width]
    setYrot .f1.o2 [expr 360.0 * ($width - $x) / $width]

#    .sx set [expr 360.0 * $y / $height]
#    .sy set [expr 360.0 * ($width - $x) / $width]

    .sx set [getXrot]
    .sy set [getYrot]
}

# This is called when a slider is changed.
proc double::setAngle {axis value} {
    global xAngle yAngle zAngle

    switch -exact $axis {
	x {setXrot .f1.o1 $value
	   setXrot .f1.o2 $value}
	y {setYrot .f1.o1 $value
	   setYrot .f1.o2 $value}
    }
}

# Execution starts here!
if { [info script] == $argv0 } {
	::double::setup
}

blob
data 12922
/* gears.c */

/* 
 * 3-D gear wheels.  This program is in the public domain.
 *
 * Brian Paul
 *
 *
 * Modified to work under Togl as a widget for TK 1997
 *
 * Philip Quaife
 *
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <math.h>
#include <stdlib.h>
#include <string.h>

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT

#ifndef M_PI
#  define M_PI 3.14159265
#endif
#define FM_PI ((float) M_PI)

#ifdef _MSC_VER
__inline float
sinf(double a)
{
    return (float) sin(a);
}
__inline float
cosf(double a)
{
    return (float) cos(a);
}
__inline float
sqrtf(double a)
{
    return (float) sqrt(a);
}

#  define sin sinf
#  define cos cosf
#  define sqrt sqrtf
#endif

struct WHIRLYGIZMO
{
    int     Gear1, Gear2, Gear3;
    double  Rotx, Roty, Rotz;
    double  Angle;
    int     Height, Width;
};

typedef struct WHIRLYGIZMO WHIRLYGIZMO;

/* 
 * Draw a gear wheel.  You'll probably want to call this function when
 * building a display list since we do a lot of trig here.
 *
 * Input:  inner_radius - radius of hole at center
 *         outer_radius - radius at center of teeth
 *         width - width of gear
 *         teeth - number of teeth
 *         tooth_depth - depth of tooth
 */
static void
gear(GLfloat inner_radius, GLfloat outer_radius, GLfloat width,
        GLint teeth, GLfloat tooth_depth)
{
    GLint   i;
    GLfloat r0, r1, r2;
    GLfloat angle, da;
    GLfloat u, v, len;

    r0 = inner_radius;
    r1 = outer_radius - tooth_depth / 2;
    r2 = outer_radius + tooth_depth / 2;

    da = 2 * FM_PI / teeth / 4;

    glShadeModel(GL_FLAT);

    glNormal3f(0, 0, 1);

    /* draw front face */
    glBegin(GL_QUAD_STRIP);
    for (i = 0; i <= teeth; i++) {
        angle = i * 2 * FM_PI / teeth;
        glVertex3f(r0 * cos(angle), r0 * sin(angle), width * 0.5f);
        glVertex3f(r1 * cos(angle), r1 * sin(angle), width * 0.5f);
        glVertex3f(r0 * cos(angle), r0 * sin(angle), width * 0.5f);
        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                width * 0.5f);
    }
    glEnd();

    /* draw front sides of teeth */
    glBegin(GL_QUADS);
    da = 2 * FM_PI / teeth / 4;
    for (i = 0; i < teeth; i++) {
        angle = i * 2 * FM_PI / teeth;

        glVertex3f(r1 * cos(angle), r1 * sin(angle), width * 0.5f);
        glVertex3f(r2 * cos(angle + da), r2 * sin(angle + da), width * 0.5f);
        glVertex3f(r2 * cos(angle + 2 * da), r2 * sin(angle + 2 * da),
                width * 0.5f);
        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                width * 0.5f);
    }
    glEnd();


    glNormal3f(0, 0, -1);

    /* draw back face */
    glBegin(GL_QUAD_STRIP);
    for (i = 0; i <= teeth; i++) {
        angle = i * 2 * FM_PI / teeth;
        glVertex3f(r1 * cos(angle), r1 * sin(angle), -width * 0.5f);
        glVertex3f(r0 * cos(angle), r0 * sin(angle), -width * 0.5f);
        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                -width * 0.5f);
        glVertex3f(r0 * cos(angle), r0 * sin(angle), -width * 0.5f);
    }
    glEnd();

    /* draw back sides of teeth */
    glBegin(GL_QUADS);
    da = 2 * FM_PI / teeth / 4;
    for (i = 0; i < teeth; i++) {
        angle = i * 2 * FM_PI / teeth;

        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                -width * 0.5f);
        glVertex3f(r2 * cos(angle + 2 * da), r2 * sin(angle + 2 * da),
                -width * 0.5f);
        glVertex3f(r2 * cos(angle + da), r2 * sin(angle + da), -width * 0.5f);
        glVertex3f(r1 * cos(angle), r1 * sin(angle), -width * 0.5f);
    }
    glEnd();


    /* draw outward faces of teeth */
    glBegin(GL_QUAD_STRIP);
    for (i = 0; i < teeth; i++) {
        angle = i * 2 * FM_PI / teeth;

        glVertex3f(r1 * cos(angle), r1 * sin(angle), width * 0.5f);
        glVertex3f(r1 * cos(angle), r1 * sin(angle), -width * 0.5f);
        u = r2 * cos(angle + da) - r1 * cos(angle);
        v = r2 * sin(angle + da) - r1 * sin(angle);
        len = sqrt(u * u + v * v);
        u /= len;
        v /= len;
        glNormal3f(v, -u, 0);
        glVertex3f(r2 * cos(angle + da), r2 * sin(angle + da), width * 0.5f);
        glVertex3f(r2 * cos(angle + da), r2 * sin(angle + da), -width * 0.5f);
        glNormal3f(cos(angle), sin(angle), 0);
        glVertex3f(r2 * cos(angle + 2 * da), r2 * sin(angle + 2 * da),
                width * 0.5f);
        glVertex3f(r2 * cos(angle + 2 * da), r2 * sin(angle + 2 * da),
                -width * 0.5f);
        u = r1 * cos(angle + 3 * da) - r2 * cos(angle + 2 * da);
        v = r1 * sin(angle + 3 * da) - r2 * sin(angle + 2 * da);
        glNormal3f(v, -u, 0);
        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                width * 0.5f);
        glVertex3f(r1 * cos(angle + 3 * da), r1 * sin(angle + 3 * da),
                -width * 0.5f);
        glNormal3f(cos(angle), sin(angle), 0);
    }

    glVertex3f(r1 /* * cos(0) */, /* r1 * sin(0) */ 0, width * 0.5f);
    glVertex3f(r1 /* * cos(0) */, /* r1 * sin(0) */ 0, -width * 0.5f);

    glEnd();


    glShadeModel(GL_SMOOTH);

    /* draw inside radius cylinder */
    glBegin(GL_QUAD_STRIP);
    for (i = 0; i <= teeth; i++) {
        angle = i * 2 * FM_PI / teeth;
        glNormal3f(-cos(angle), -sin(angle), 0);
        glVertex3f(r0 * cos(angle), r0 * sin(angle), -width * 0.5f);
        glVertex3f(r0 * cos(angle), r0 * sin(angle), width * 0.5f);
    }
    glEnd();

}

/* 
 * static GLfloat view_rotx=20, view_roty=30, view_rotz=0; static GLint
 * gear1, gear2, gear3; static GLfloat angle = 0; */
static GLuint limit;
static GLuint count = 1;

static GLubyte polycolor[4] = { 255, 255, 255, 255 };

static int
draw(ClientData clientData, Tcl_Interp *interp, int objc, Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    Wg = (WHIRLYGIZMO *) Togl_GetClientData(togl);
    glDisable(GL_TEXTURE_2D);
    glPushMatrix();
    glRotatef((float) Wg->Rotx, 1, 0, 0);
    glRotatef((float) Wg->Roty, 0, 1, 0);
    glRotatef((float) Wg->Rotz, 0, 0, 1);

    glPushMatrix();
    glTranslatef(-3, -2, 0);
    glRotatef((float) Wg->Angle, 0, 0, 1);
    glEnable(GL_DEPTH_TEST);
    glCallList(Wg->Gear1);
    glEnable(GL_DEPTH_TEST);
    glPopMatrix();

    glPushMatrix();
    glTranslatef(3.1f, -2, 0);
    glRotatef(-2 * (float) Wg->Angle - 9, 0, 0, 1);
    glCallList(Wg->Gear2);
    glPopMatrix();

    glPushMatrix();
    glTranslatef(-3.1f, 4.2f, 0);
    glRotatef(-2 * (float) Wg->Angle - 25, 0, 0, 1);
    glCallList(Wg->Gear3);
    glPopMatrix();

    glPopMatrix();

    Togl_SwapBuffers(togl);

    return TCL_OK;
}


static int
zap(ClientData clientData, Tcl_Interp *interp, int objc, Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    Wg = (WHIRLYGIZMO *) Togl_GetClientData(togl);
    free(Wg);

    return TCL_OK;
}


static int
idle(ClientData clientData, Tcl_Interp *interp, int objc, Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    Wg = (WHIRLYGIZMO *) Togl_GetClientData(togl);
    Wg->Angle += 2;
    Togl_PostRedisplay(togl);

    return TCL_OK;
}


/* change view angle, exit upon ESC */
/* 
 * static GLenum key(int k, GLenum mask) { switch (k) { case TK_UP: view_rotx
 * += 5; return GL_TRUE; case TK_DOWN: view_rotx -= 5; return GL_TRUE; case 
 * TK_LEFT: view_roty += 5; return GL_TRUE; case TK_RIGHT: view_roty -= 5;
 * return GL_TRUE; case TK_z: view_rotz += 5; return GL_TRUE; case TK_Z:
 * view_rotz -= 5; return GL_TRUE; } return GL_FALSE; } */

/* new window size or exposure */
static int
reshape(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    int     width, height;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);
    glViewport(0, 0, (GLint) width, (GLint) height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    if (width > height) {
        GLfloat w = (GLfloat) width / (GLfloat) height;

        glFrustum(-w, w, -1, 1, 5, 60);
    } else {
        GLfloat h = (GLfloat) height / (GLfloat) width;

        glFrustum(-1, 1, -h, h, 5, 60);
    }

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glTranslatef(0, 0, -40);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    return TCL_OK;
}


static int
init(ClientData clientData, Tcl_Interp *interp, int objc, Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    static GLfloat red[4] = { 0.8f, 0.1f, 0, 1 };
    static GLfloat green[4] = { 0, 0.8f, 0.2f, 1 };
    static GLfloat blue[4] = { 0.2f, 0.2f, 1, 1 };
    static GLfloat pos[4] = { 5, 5, 10, 0 };
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    glLightfv(GL_LIGHT0, GL_POSITION, pos);
    glEnable(GL_CULL_FACE);
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    glEnable(GL_DEPTH_TEST);
    /* make the gears */
    Wg = (WHIRLYGIZMO *) malloc(sizeof (WHIRLYGIZMO));
    if (!Wg) {
        Tcl_SetResult(Togl_Interp(togl),
                "\"Cannot allocate client data for widget\"", TCL_STATIC);
    }
    Wg->Gear1 = glGenLists(1);
    glNewList(Wg->Gear1, GL_COMPILE);
    glMaterialfv(GL_FRONT, GL_AMBIENT_AND_DIFFUSE, red);
    gear(1, 4, 1, 20, 0.7f);
    glEndList();

    Wg->Gear2 = glGenLists(1);
    glNewList(Wg->Gear2, GL_COMPILE);
    glMaterialfv(GL_FRONT, GL_AMBIENT_AND_DIFFUSE, green);
    gear(0.5f, 2, 2, 10, 0.7f);
    glEndList();

    Wg->Gear3 = glGenLists(1);
    glNewList(Wg->Gear3, GL_COMPILE);
    glMaterialfv(GL_FRONT, GL_AMBIENT_AND_DIFFUSE, blue);
    gear(1.3f, 2, 0.5f, 10, 0.7f);
    glEndList();

    glEnable(GL_NORMALIZE);
    Wg->Height = Togl_Height(togl);
    Wg->Width = Togl_Width(togl);
    Wg->Angle = 0;
    Wg->Rotx = 0;
    Wg->Roty = 0;
    Wg->Rotz = 0;
    Togl_SetClientData(togl, (ClientData) Wg);

    return TCL_OK;
}

static int
position(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    char    Result[100];
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    Wg = (WHIRLYGIZMO *) Togl_GetClientData(togl);

    /* Let result string equal value */
    sprintf(Result, "%g %g", Wg->Roty, Wg->Rotx);

    Tcl_SetResult(interp, Result, TCL_VOLATILE);
    return TCL_OK;
}

static int
rotate(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    WHIRLYGIZMO *Wg;
    Togl   *togl;

    if (objc != 4) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName yrot xrot");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    Wg = (WHIRLYGIZMO *) Togl_GetClientData(togl);

    if (Tcl_GetDoubleFromObj(interp, objv[2], &Wg->Roty) != TCL_OK) {
        return TCL_ERROR;
    }
    if (Tcl_GetDoubleFromObj(interp, objv[3], &Wg->Rotx) != TCL_OK) {
        return TCL_ERROR;
    }
    Togl_PostRedisplay(togl);

    return TCL_OK;
}

EXTERN int
Gears_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "init", init, NULL, NULL);
    Tcl_CreateObjCommand(interp, "zap", zap, NULL, NULL);
    Tcl_CreateObjCommand(interp, "draw", draw, NULL, NULL);
    Tcl_CreateObjCommand(interp, "reshape", reshape, NULL, NULL);
    Tcl_CreateObjCommand(interp, "idle", idle, NULL, NULL);
    Tcl_CreateObjCommand(interp, "rotate", rotate, NULL, NULL);
    Tcl_CreateObjCommand(interp, "position", position, NULL, NULL);
    return TCL_OK;
}

blob
data 2420
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# Togl - a Tk OpenGL widget
# Copyright (C) 1996-1997  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.


#
# Test Togl using GL Gears Demo
#
# Copyright (C) 1997 Philip Quaife
#

package provide gears 1.0

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/gears[info sharedlibextension]

# create ::gears namespace
namespace eval ::gears {
}

proc ::gears::setup {} {
    global startx starty xangle0 yangle0 xangle yangle RotCnt
    global vTime
    set RotCnt 1
    set xangle 0.0
    set yangle 0.0
    set vTime 100
    wm title . "Rotating Gear Widget Test"

    label .t -text "Click and drag to rotate image"
    pack .t -side top -padx 2 -pady 10
    frame .f
    pack .f -side top
    button .f.n1 -text "  Add " -command ::gears::AutoRot
    button .f.r1 -text "Remove" -command ::gears::DelRot
    button .f.b1 -text " Quit " -command exit 
    entry .f.t -width 4 -textvariable vTime
    pack .f.n1 .f.t .f.r1 .f.b1 -side left -anchor w -padx 5
    newRot .w0 10

}
proc ::gears::AutoRot {} {
    global RotCnt vTime
    newRot .w$RotCnt $vTime
    set RotCnt [expr $RotCnt + 1]
}

proc ::gears::DelRot {} {
    global RotCnt vTime
    if { $RotCnt != 0 } {
      set RotCnt [expr $RotCnt - 1]
      destroy .w$RotCnt
    }
}

proc ::gears::newRot {win {tick 100} } {
    togl $win -width 200 -height 200 -rgba true -double true -depth true -privatecmap false -time $tick -create init -destroy zap -display draw -reshape reshape -timer idle
    bind $win <ButtonPress-1> {::gears::RotStart %x %y %W}
    bind $win <B1-Motion> {::gears::RotMove %x %y %W}
    pack $win -expand true -fill both
}

proc ::gears::RotStart {x y W} {
    global startx starty xangle0 yangle0 xangle yangle
    set startx $x
    set starty $y
    set vPos [position $W]
    set xangle0 [lindex $vPos 0]
    set yangle0 [lindex $vPos 1]
}

proc ::gears::RotMove {x y W} {
    global startx starty xangle0 yangle0 xangle yangle
    set xangle [expr $xangle0 + ($x - $startx)]
    set yangle [expr $yangle0 + ($y - $starty)]
    rotate $W $xangle $yangle
}

if { [info script] == $argv0 } {
	::gears::setup
}

blob
data 6276
/* 
 * SGI rgb file reader borrowed from gltk library
 */

#include "togl.h"               /* added by GG to include windows.h */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "image.h"

#ifndef SEEK_SET
#  define SEEK_SET 0
#endif


static void
tkQuit(void)
{
    exit(0);
}


/******************************************************************************/

typedef struct _rawImageRec
{
    unsigned short imagic;
    unsigned short type;
    unsigned short dim;
    unsigned short sizeX, sizeY, sizeZ;
    unsigned long min, max;
    unsigned long wasteBytes;
    char    name[80];
    unsigned long colorMap;
    FILE   *file;
    unsigned char *tmp, *tmpR, *tmpG, *tmpB, *tmpA;
    unsigned long rleEnd;
    GLuint *rowStart;
    GLint  *rowSize;
} rawImageRec;


/******************************************************************************/

static void
ConvertShort(unsigned short *array, long length)
{
    unsigned long b1, b2;
    unsigned char *ptr;

    ptr = (unsigned char *) array;
    while (length--) {
        b1 = *ptr++;
        b2 = *ptr++;
        *array++ = (unsigned short) ((b1 << 8) | b2);
    }
}

static void
ConvertLong(GLuint *array, long length)
{
    unsigned long b1, b2, b3, b4;
    unsigned char *ptr;

    ptr = (unsigned char *) array;
    while (length--) {
        b1 = *ptr++;
        b2 = *ptr++;
        b3 = *ptr++;
        b4 = *ptr++;
        *array++ = (b1 << 24) | (b2 << 16) | (b3 << 8) | (b4);
    }
}

static rawImageRec *
RawImageOpen(const char *fileName)
{
    union
    {
        int     testWord;
        char    testByte[4];
    } endianTest;
    rawImageRec *raw;
    GLenum  swapFlag;
    int     x;

    endianTest.testWord = 1;
    if (endianTest.testByte[0] == 1) {
        swapFlag = GL_TRUE;
    } else {
        swapFlag = GL_FALSE;
    }

    raw = (rawImageRec *) malloc(sizeof (rawImageRec));
    if (raw == NULL) {
        fprintf(stderr, "Out of memory!\n");
        tkQuit();
    }
    if ((raw->file = fopen(fileName, "rb")) == NULL) {
        perror(fileName);
        tkQuit();
    }

    fread(raw, 1, 12, raw->file);

    if (swapFlag) {
        ConvertShort(&raw->imagic, 6);
    }

    raw->tmp = (unsigned char *) malloc(raw->sizeX * 256);
    raw->tmpR = (unsigned char *) malloc(raw->sizeX * 256);
    raw->tmpG = (unsigned char *) malloc(raw->sizeX * 256);
    raw->tmpB = (unsigned char *) malloc(raw->sizeX * 256);
    raw->tmpA = (unsigned char *) malloc(raw->sizeX * 256);
    if (raw->tmp == NULL || raw->tmpR == NULL || raw->tmpG == NULL ||
            raw->tmpB == NULL || raw->tmpA == NULL) {
        fprintf(stderr, "Out of memory!\n");
        tkQuit();
    }

    if ((raw->type & 0xFF00) == 0x0100) {
        x = raw->sizeY * raw->sizeZ * sizeof (GLuint);
        raw->rowStart = (GLuint *) malloc(x);
        raw->rowSize = (GLint *) malloc(x);
        if (raw->rowStart == NULL || raw->rowSize == NULL) {
            fprintf(stderr, "Out of memory!\n");
            tkQuit();
        }
        raw->rleEnd = 512 + (2 * x);
        fseek(raw->file, 512, SEEK_SET);
        fread(raw->rowStart, 1, x, raw->file);
        fread(raw->rowSize, 1, x, raw->file);
        if (swapFlag) {
            ConvertLong(raw->rowStart, x / sizeof (GLuint));
            ConvertLong((GLuint *) raw->rowSize, x / sizeof (GLint));
        }
    }
    return raw;
}

static void
RawImageClose(rawImageRec * raw)
{

    fclose(raw->file);
    free(raw->tmp);
    free(raw->tmpR);
    free(raw->tmpG);
    free(raw->tmpB);
    free(raw->tmpA);
    free(raw);
}

static void
RawImageGetRow(rawImageRec * raw, unsigned char *buf, int y, int z)
{
    unsigned char *iPtr, *oPtr, pixel;
    int     count;

    if ((raw->type & 0xFF00) == 0x0100) {
        fseek(raw->file, raw->rowStart[y + z * raw->sizeY], SEEK_SET);
        fread(raw->tmp, 1, (unsigned int) raw->rowSize[y + z * raw->sizeY],
                raw->file);

        iPtr = raw->tmp;
        oPtr = buf;
        while (1) {
            pixel = *iPtr++;
            count = (int) (pixel & 0x7F);
            if (!count) {
                return;
            }
            if (pixel & 0x80) {
                while (count--) {
                    *oPtr++ = *iPtr++;
                }
            } else {
                pixel = *iPtr++;
                while (count--) {
                    *oPtr++ = pixel;
                }
            }
        }
    } else {
        fseek(raw->file, 512 + (y * raw->sizeX) + (z * raw->sizeX * raw->sizeY),
                SEEK_SET);
        fread(buf, 1, raw->sizeX, raw->file);
    }
}

static void
RawImageGetData(rawImageRec * raw, TK_RGBImageRec * final)
{
    unsigned char *ptr;
    int     i, j;

    final->data =
            (unsigned char *) malloc((raw->sizeX + 1) * (raw->sizeY + 1) * 4);
    if (final->data == NULL) {
        fprintf(stderr, "Out of memory!\n");
        tkQuit();
    }

    ptr = final->data;
    for (i = 0; i < (int) (raw->sizeY); i++) {
        RawImageGetRow(raw, raw->tmpR, i, 0);
        RawImageGetRow(raw, raw->tmpG, i, 1);
        RawImageGetRow(raw, raw->tmpB, i, 2);
        if (raw->sizeZ == 4) {
            /* 4 components */
            RawImageGetRow(raw, raw->tmpA, i, 3);
            for (j = 0; j < (int) (raw->sizeX); j++) {
                *ptr++ = *(raw->tmpR + j);
                *ptr++ = *(raw->tmpG + j);
                *ptr++ = *(raw->tmpB + j);
                *ptr++ = *(raw->tmpA + j);
            }
        } else {
            /* 3 components */
            for (j = 0; j < (int) (raw->sizeX); j++) {
                *ptr++ = *(raw->tmpR + j);
                *ptr++ = *(raw->tmpG + j);
                *ptr++ = *(raw->tmpB + j);
            }
        }
    }
}

TK_RGBImageRec *
tkRGBImageLoad(const char *fileName)
{
    rawImageRec *raw;
    TK_RGBImageRec *final;

    raw = RawImageOpen(fileName);
    final = (TK_RGBImageRec *) malloc(sizeof (TK_RGBImageRec));
    if (final == NULL) {
        fprintf(stderr, "Out of memory!\n");
        tkQuit();
    }
    final->sizeX = raw->sizeX;
    final->sizeY = raw->sizeY;
    final->sizeZ = raw->sizeZ;
    RawImageGetData(raw, final);
    RawImageClose(raw);
    return final;
}

/******************************************************************************/

blob
data 229
/* image.h */

#ifndef IMAGE_H
#  define IMAGE_H

typedef struct _TK_RGBImageRec
{
    int     sizeX, sizeY, sizeZ;
    unsigned char *data;
} TK_RGBImageRec;

extern TK_RGBImageRec *tkRGBImageLoad(const char *fileName);

#endif

blob
data 5410
/* $Id$ */

/* 
 * Togl - a Tk OpenGL widget
 * Copyright (C) 1996-1997  Brian Paul and Ben Bederson
 * Copyright (C) 2006-2007  Greg Couch
 * See the LICENSE file for copyright details.
 */


/* 
 * An example Togl program using color-index mode.
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <stdlib.h>
#include <string.h>

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT


/* Our color indexes: */
static unsigned long black, red, green, blue;

/* Rotation angle */
static float Angle = 0;


/* 
 * Togl widget create callback.  This is called by Tcl/Tk when the widget has
 * been realized.  Here's where one may do some one-time context setup or
 * initializations.
 */
static int
create_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    /* allocate color indexes */
    black = Togl_AllocColor(togl, 0, 0, 0);
    red = Togl_AllocColor(togl, 1, 0, 0);
    green = Togl_AllocColor(togl, 0, 1, 0);
    blue = Togl_AllocColor(togl, 0, 0, 1);

    /* If we were using a private read/write colormap we'd setup our color
     * table with something like this: */
    /* 
     * black = 1; Togl_SetColor( togl, black, 0, 0, 0 ); red = 2;
     * Togl_SetColor( togl, red, 1, 0, 0 ); green = 3; Togl_SetColor(
     * togl, green, 0, 1, 0 ); blue = 4; Togl_SetColor( togl, blue, 0,
     * 0, 1 ); */

    glShadeModel(GL_FLAT);
    glDisable(GL_DITHER);

    return TCL_OK;
}


/* 
 * Togl widget reshape callback.  This is called by Tcl/Tk when the widget
 * has been resized.  Typically, we call glViewport and perhaps setup the
 * projection matrix.
 */
static int
reshape_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    int     width;
    int     height;
    float   aspect;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);
    aspect = (float) width / (float) height;
    glViewport(0, 0, width, height);

    /* Set up projection transform */
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(-aspect, aspect, -1, 1, -1, 1);

    /* Change back to model view transform for rendering */
    glMatrixMode(GL_MODELVIEW);

    return TCL_OK;
}


/* 
 * Togl widget display callback.  This is called by Tcl/Tk when the widget's
 * contents have to be redrawn.  Typically, we clear the color and depth
 * buffers, render our objects, then swap the front/back color buffers.
 */
static int
display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    glClearIndex((float) black);
    glClear(GL_COLOR_BUFFER_BIT);

    glPushMatrix();
    glTranslatef(0.3f, -0.3f, 0);
    glRotatef(Angle, 0, 0, 1);
    glIndexi(red);
    glBegin(GL_TRIANGLES);
    glVertex2f(-0.5f, -0.3f);
    glVertex2f(0.5f, -0.3f);
    glVertex2f(0, 0.6f);
    glEnd();
    glPopMatrix();

    glPushMatrix();
    glRotatef(Angle, 0, 0, 1);
    glIndexi(green);
    glBegin(GL_TRIANGLES);
    glVertex2f(-0.5f, -0.3f);
    glVertex2f(0.5f, -0.3f);
    glVertex2f(0, 0.6f);
    glEnd();
    glPopMatrix();

    glPushMatrix();
    glTranslatef(-0.3f, 0.3f, 0);
    glRotatef(Angle, 0, 0, 1);
    glIndexi(blue);
    glBegin(GL_TRIANGLES);
    glVertex2f(-0.5f, -0.3f);
    glVertex2f(0.5f, -0.3f);
    glVertex2f(0, 0.6f);
    glEnd();
    glPopMatrix();

    glFlush();
    Togl_SwapBuffers(togl);

    return TCL_OK;
}


static int
timer_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    Angle += 5.0;
    Togl_PostRedisplay(togl);

    return TCL_OK;
}


EXTERN int
Index_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "::index::create_cb", create_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "::index::display_cb", display_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "::index::reshape_cb", reshape_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "::index::timer_cb", timer_cb, NULL, NULL);

    /* 
     * Make a new Togl widget command so the Tcl code can set a C variable.
     */
    /* NONE */

    /* 
     * Call Tcl_CreateCommand for application-specific commands, if
     * they weren't already created by the init procedures called above.
     */
    return TCL_OK;
}

blob
data 1323
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# $Id$

# Togl - a Tk OpenGL widget
# Copyright (C) 1996  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.


# A Tk/OpenGL widget demo using color-index mode.

package provide index 1.0

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/index[info sharedlibextension]

# create ::index namespace
namespace eval ::index {
}

proc ::index::setup {} {
    wm title . "Color index demo"

    togl .win -width 200 -height 200 -rgba false -double true -privatecmap false -time 10 -timer ::index::timer_cb -create ::index::create_cb -reshape ::index::reshape_cb -display ::index::display_cb
    button .photo -text "Take Photo" -command ::index::take_photo
    button .btn -text Quit -command exit

    pack .win -expand true -fill both
    pack .photo -expand true -fill both
    pack .btn -expand true -fill both
}

proc ::index::take_photo {} {
	image create photo img
	.win takephoto img
	img write image.ppm -format ppm
}


# Execution starts here!
if { [info script] == $argv0 } {
	::index::setup
}

blob
data 5229
/* $Id$ */

/* 
 * Togl - a Tk OpenGL widget
 * Copyright (C) 1996-1997  Brian Paul and Ben Bederson
 * Copyright (C) 2006-2007  Greg Couch
 * See the LICENSE file for copyright details.
 */


/* 
 * An example Togl program using an overlay.
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <stdlib.h>
#include <string.h>

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT


/* Overlay color indexes: */
static unsigned long Red, Green;


/* 
 * Togl widget create callback.  This is called by Tcl/Tk when the widget has
 * been realized.  Here's where one may do some one-time context setup or
 * initializations.
 */
static int
create_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    /* allocate overlay color indexes */
    Red = Togl_AllocColorOverlay(togl, 1, 0, 0);
    Green = Togl_AllocColorOverlay(togl, 0, 1, 0);

    /* in this demo we always show the overlay */
    if (Togl_ExistsOverlay(togl)) {
        Togl_ShowOverlay(togl);
        printf("Red and green lines are in the overlay\n");
    } else {
        printf("Sorry, this display doesn't support overlays\n");
    }
    return TCL_OK;
}


/* 
 * Togl widget reshape callback.  This is called by Tcl/Tk when the widget
 * has been resized.  Typically, we call glViewport and perhaps setup the
 * projection matrix.
 */
static int
reshape_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    int     width;
    int     height;
    float   aspect;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);
    aspect = (float) width / (float) height;

    /* Set up viewing for normal plane's context */
    glViewport(0, 0, width, height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(-aspect, aspect, -1, 1, -1, 1);
    glMatrixMode(GL_MODELVIEW);

    /* Set up viewing for overlay plane's context */
    if (Togl_ExistsOverlay(togl)) {
        Togl_UseLayer(togl, TOGL_OVERLAY);
        glViewport(0, 0, width, height);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glOrtho(-1, 1, -1, 1, -1, 1);
        glMatrixMode(GL_MODELVIEW);
        Togl_UseLayer(togl, TOGL_NORMAL);
    }
    return TCL_OK;
}


/* 
 * Togl widget overlay display callback.  This is called by Tcl/Tk when the
 * overlay has to be redrawn.
 */
static int
overlay_display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    glClear(GL_COLOR_BUFFER_BIT);

    glIndexi(Red);
    glBegin(GL_LINES);
    glVertex2f(-1, -1);
    glVertex2f(1, 1);
    glVertex2f(-1, 1);
    glVertex2f(1, -1);
    glEnd();

    glIndexi(Green);
    glBegin(GL_LINE_LOOP);
    glVertex2f(-0.5f, -0.5f);
    glVertex2f(0.5f, -0.5f);
    glVertex2f(0.5f, 0.5f);
    glVertex2f(-0.5f, 0.5f);
    glEnd();
    glFlush();
    return TCL_OK;
}


/* 
 * Togl widget display callback.  This is called by Tcl/Tk when the widget's
 * contents have to be redrawn.  Typically, we clear the color and depth
 * buffers, render our objects, then swap the front/back color buffers.
 */
static int
display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    glClear(GL_COLOR_BUFFER_BIT);

    glLoadIdentity();

    glBegin(GL_TRIANGLES);

    glColor3f(1, 0, 1);
    glVertex2f(-0.5f, -0.3f);
    glVertex2f(0.5f, -0.3f);
    glVertex2f(0, 0.6f);

    glColor3f(1, 1, 0);
    glVertex2f(-0.5f + 0.2f, -0.3f - 0.2f);
    glVertex2f(0.5f + 0.2f, -0.3f - 0.2f);
    glVertex2f(0 + 0.2f, 0.6f - 0.2f);

    glColor3f(0, 1, 1);
    glVertex2f(-0.5f + 0.4f, -0.3f - 0.4f);
    glVertex2f(0.5f + 0.4f, -0.3f - 0.4f);
    glVertex2f(0 + 0.4f, 0.6f - 0.4f);

    glEnd();

    glFlush();
    return TCL_OK;
}


/* 
 * Called by Tcl to let me initialize the modules (Togl) I will need.
 */
EXTERN int
Overlay_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "create_cb", create_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "display_cb", display_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "reshape_cb", reshape_cb, NULL, NULL);

    Tcl_CreateObjCommand(interp, "overlay_display_cb", overlay_display_cb, NULL,
            NULL);

    /* 
     * Make a new Togl widget command so the Tcl code can set a C variable.
     */
    /* NONE */

    /* 
     * Call Tcl_CreateCommand for application-specific commands, if
     * they weren't already created by the init procedures called above.
     */
    return TCL_OK;
}

blob
data 993
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# $Id$

# Togl - a Tk OpenGL widget
# Copyright (C) 1996  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.


# A Tk/OpenGL widget demo using an overlay.

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/overlay[info sharedlibextension]

proc setup {} {
    wm title . "Overlay demo"

    togl .win -width 200 -height 200 -rgba true -double false -overlay true -create create_cb -reshape reshape_cb -display display_cb -overlaydisplay overlay_display_cb
    button .btn -text Quit -command exit

    pack .win -expand true -fill both
    pack .btn -expand true -fill both
}


# Execution starts here!
# Execution starts here!
if { [info script] == $argv0 } {
	setup
}

blob
data 129
#
# Tcl package index file
#
package ifneeded @PACKAGE_NAME@ @PACKAGE_VERSION@ \
    [list load [file join $dir @PKG_LIB_FILE@]]

blob
data 8416
/* $Id$ */

/* 
 * Togl - a Tk OpenGL widget
 * Copyright (C) 1996-1997  Brian Paul and Ben Bederson
 * Copyright (C) 2006-2007  Greg Couch
 * See the LICENSE file for copyright details.
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <stdlib.h>
#include <string.h>

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT


static Tcl_Obj *toglFont;
static double xAngle = 0, yAngle = 0, zAngle = 0;
static GLfloat CornerX, CornerY, CornerZ;       /* where to print strings */
static double coord_scale = 1;



/* 
 * Togl widget create callback.  This is called by Tcl/Tk when the widget has
 * been realized.  Here's where one may do some one-time context setup or
 * initializations.
 */
static int
create_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    toglFont = Togl_LoadBitmapFont(togl, "Helvetica");
    if (!toglFont) {
        printf("Couldn't load font!\n");
        exit(1);
    }
    return TCL_OK;
}


/* 
 * Togl widget reshape callback.  This is called by Tcl/Tk when the widget
 * has been resized.  Typically, we call glViewport and perhaps setup the
 * projection matrix.
 */
static int
reshape_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    int     width;
    int     height;
    float   aspect;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);
    aspect = (float) width / (float) height;

    glViewport(0, 0, width, height);

    /* Set up projection transform */
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glFrustum(-aspect, aspect, -1, 1, 1, 10);

    CornerX = -aspect;
    CornerY = -1;
    CornerZ = -1.1f;

    /* Change back to model view transform for rendering */
    glMatrixMode(GL_MODELVIEW);
    return TCL_OK;
}


static void
print_string(Togl *togl, const char *s)
{
    Togl_WriteChars(togl, toglFont, s, 0);
}

static void
draw_eye(Togl *togl)
{
    Togl_Clear(togl, GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    Togl_Frustum(togl, -1, 1, -1, 1, 1, 10);
    glMatrixMode(GL_MODELVIEW);

    /* Front face */
    glBegin(GL_QUADS);
    glColor3f(0.4f, 0.8f, 0.4f);        /* Green-ish */
    glVertex3f(-1, 1, 1);
    glVertex3f(1, 1, 1);
    glVertex3f(1, -1, 1);
    glVertex3f(-1, -1, 1);
    /* Back face */
    glColor3f(0.8f, 0.8f, 0.4f);        /* Yellow-ish */
    glVertex3f(-1, 1, -1);
    glVertex3f(1, 1, -1);
    glVertex3f(1, -1, -1);
    glVertex3f(-1, -1, -1);
    /* Top side face */
    glColor3f(0.4f, 0.4f, 0.8f);        /* Blue-ish */
    glVertex3f(-1, 1, 1);
    glVertex3f(1, 1, 1);
    glVertex3f(1, 1, -1);
    glVertex3f(-1, 1, -1);
    /* Bottom side face */
    glColor3f(0.8f, 0.4f, 0.4f);        /* Red-ish */
    glVertex3f(-1, -1, 1);
    glVertex3f(1, -1, 1);
    glVertex3f(1, -1, -1);
    glVertex3f(-1, -1, -1);
    glEnd();
}

/* 
 * Togl widget display callback.  This is called by Tcl/Tk when the widget's
 * contents have to be redrawn.  Typically, we clear the color and depth
 * buffers, render our objects, then swap the front/back color buffers.
 */
static int
display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    /* setup modelview matrix */
    glLoadIdentity();           /* Reset modelview matrix to the identity
                                 * matrix */
    glTranslatef(0, 0, -3.0);   /* Move the camera back three units */
    glScaled(coord_scale, coord_scale, coord_scale);    /* Zoom in and out */
    glRotated(xAngle, 1, 0, 0); /* Rotate by X, Y, and Z angles */
    glRotated(yAngle, 0, 1, 0);
    glRotated(zAngle, 0, 0, 1);

    glEnable(GL_DEPTH_TEST);

    if (Togl_NumEyes(togl) == 1) {
        /* single eye */
        Togl_DrawBuffer(togl, GL_BACK);
        draw_eye(togl);
    } else {
        /* stereo left eye */
        Togl_DrawBuffer(togl, GL_BACK_LEFT);
        draw_eye(togl);

        /* stereo right eye */
        Togl_DrawBuffer(togl, GL_BACK_RIGHT);
        draw_eye(togl);
    }

    glDisable(GL_DEPTH_TEST);
    glLoadIdentity();
    glColor3f(1, 1, 1);
    glRasterPos3f(CornerX, CornerY, CornerZ);
    print_string(togl, Togl_Ident(togl));
    Togl_SwapBuffers(togl);
    return TCL_OK;
}


static int
setXrot_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &xAngle) != TCL_OK) {
        return TCL_ERROR;
    }

    /* printf( "before %f ", xAngle ); */

    if (xAngle < 0) {
        xAngle += 360;
    } else if (xAngle > 360) {
        xAngle -= 360;
    }

    /* printf( "after %f \n", xAngle ); */

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


static int
setYrot_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &yAngle) != TCL_OK) {
        return TCL_ERROR;
    }

    if (yAngle < 0) {
        yAngle += 360;
    } else if (yAngle > 360) {
        yAngle -= 360;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


int
getXrot_cb(ClientData clientData, Tcl_Interp *interp,
        int argc, CONST84 char *argv[])
{
    Tcl_SetObjResult(interp, Tcl_NewDoubleObj(xAngle));
    return TCL_OK;
}


int
getYrot_cb(ClientData clientData, Tcl_Interp *interp,
        int argc, CONST84 char *argv[])
{
    Tcl_SetObjResult(interp, Tcl_NewDoubleObj(yAngle));
    return TCL_OK;
}


static int
coord_scale_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName value");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &coord_scale) != TCL_OK) {
        return TCL_ERROR;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


EXTERN int
Stereo_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "create_cb", create_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "display_cb", display_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "reshape_cb", reshape_cb, NULL, NULL);

    Tcl_CreateObjCommand(interp, "setXrot", setXrot_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "setYrot", setYrot_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "coord_scale", coord_scale_cb, NULL, NULL);

    /* 
     * Call Tcl_CreateCommand for application-specific commands, if
     * they weren't already created by the init procedures called above.
     */

    Tcl_CreateCommand(interp, "getXrot", getXrot_cb, NULL, NULL);
    Tcl_CreateCommand(interp, "getYrot", getYrot_cb, NULL, NULL);

    return TCL_OK;
}

blob
data 3573
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# $Id$

# Togl - a Tk OpenGL widget
# Copyright (C) 1996  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/stereo[info sharedlibextension]

# create ::stereo namespace
namespace eval ::stereo {
}

proc stereo::setup {} {
	grid rowconfigure . 0 -weight 1 -minsize 200p
	grid columnconfigure . 1 -weight 1 -minsize 200p
	labelframe .c -text "Stereo mode:"
	grid .c -sticky nw -padx 2 -pady 2 -ipadx 2 -ipady 1
	# add "nvidia" to list below when it works
	foreach {b} {none native sgioldstyle anaglyph cross-eye wall-eye DTI "left eye" "right eye" } {
		set name [string map {- _ " " _} $b]
		button .c.b$name -text "$b" -command "::stereo::makeGraphics {$b}"
		pack .c.b$name -fill x -padx 2 -pady 1
	}
	scale .sx -label {X Axis} -from 0 -to 360 -command {::stereo::setAngle x} -orient horizontal
	grid .sx -columnspan 2 -sticky ew
	scale .sy -label {Y Axis} -from 0 -to 360 -command {::stereo::setAngle y} -orient horizontal
	grid .sy -columnspan 2 -sticky ew
	if {[string first IRIX $::tcl_platform(os)] != -1} {
		label .irix -justify left -wraplength 250p -text "Use /usr/gfx/setmon or /usr/bin/X11/xsetmon to change video mode for native stereo (eg., 1024x768_120s) or sgioldstyle stereo (eg., str_bot) and back."
		grid .irix -sticky new -columnspan 2
	}
	button .quit -text Close -command exit
	grid .quit -sticky se -columnspan 2 -padx 2 -pady 2
	frame .f -relief groove -borderwidth 2 -bg black
	grid .f -row 0 -column 1 -sticky news
	label .f.gr -wraplength 100p -bg black -fg white -text "To start, choose a stereo mode from the choices on the left."
	pack .f.gr -anchor center -expand 1
	bind . <Key-Escape> {exit}
}

proc stereo::makeGraphics {mode} {
	destroy .f.gr
	set name ".f.gr"
	set width 200
	set height 200
	if { "$mode" == "nvidia" } {
		set mode "nvidia consumer stereo"
		set name ".gr"
		foreach s [grid slaves .] {
			grid forget $s
		}
		wm attributes . -fullscreen 1
		set width [winfo screenwidth .]
		set height [winfo screenheight .]
	}
	if { [catch { togl $name -width $width -height $height -rgba true -stereo "$mode" -double true -depth true -ident "$mode" -create create_cb -display display_cb -reshape reshape_cb -eyeseparation 0.05 -convergence 2.0 } error] } {
		label $name -wraplength 100p -bg black -fg white -text "$error\n\nMake another choice from the stereo modes on the left."
	}
	pack $name -expand 1 -fill both
	bind $name <B1-Motion> {
		::stereo::motion_event %W [lindex [%W config -width] 4] \
		     [lindex [%W config -height] 4] %x %y
	}
}

# This is called when mouse button 1 is pressed and moved
proc stereo::motion_event { widget width height x y } {
    setXrot $widget [expr 360.0 * $y / $height]
    setYrot $widget [expr 360.0 * ($width - $x) / $width]

#    .sx set [expr 360.0 * $y / $height]
#    .sy set [expr 360.0 * ($width - $x) / $width]

    .sx set [getXrot]
    .sy set [getYrot]
}

# This is called when a slider is changed.
proc stereo::setAngle {axis value} {
    global xAngle yAngle zAngle

    # catch because .f.gr might be a label instead of a Togl widget
    catch {
	    switch -exact $axis {
		x {setXrot .f.gr $value}
		y {setYrot .f.gr $value}
	    }
    }
}

if { [info script] == $argv0 } {
	::stereo::setup
}

blob
data 2186
#!/bin/sh

#
# install - install a program, script, or datafile
# This comes from X11R5; it is not part of GNU.
#
# $XConsortium: install.sh,v 1.2 89/12/18 14:47:22 jim Exp $
#
# This script is compatible with the BSD install script, but was written
# from scratch.
#


# set DOITPROG to echo to test this script

# Don't use :- since 4.3BSD and earlier shells don't like it.
doit="${DOITPROG-}"


# put in absolute paths if you don't have them in your path; or use env. vars.

mvprog="${MVPROG-mv}"
cpprog="${CPPROG-cp}"
chmodprog="${CHMODPROG-chmod}"
chownprog="${CHOWNPROG-chown}"
chgrpprog="${CHGRPPROG-chgrp}"
stripprog="${STRIPPROG-strip}"
rmprog="${RMPROG-rm}"

instcmd="$mvprog"
chmodcmd=""
chowncmd=""
chgrpcmd=""
stripcmd=""
rmcmd="$rmprog -f"
mvcmd="$mvprog"
src=""
dst=""

while [ x"$1" != x ]; do
    case $1 in
	-c) instcmd="$cpprog"
	    shift
	    continue;;

	-m) chmodcmd="$chmodprog $2"
	    shift
	    shift
	    continue;;

	-o) chowncmd="$chownprog $2"
	    shift
	    shift
	    continue;;

	-g) chgrpcmd="$chgrpprog $2"
	    shift
	    shift
	    continue;;

	-s) stripcmd="$stripprog"
	    shift
	    continue;;

	*)  if [ x"$src" = x ]
	    then
		src=$1
	    else
		dst=$1
	    fi
	    shift
	    continue;;
    esac
done

if [ x"$src" = x ]
then
	echo "install:  no input file specified"
	exit 1
fi

if [ x"$dst" = x ]
then
	echo "install:  no destination specified"
	exit 1
fi


# If destination is a directory, append the input filename; if your system
# does not like double slashes in filenames, you may need to add some logic

if [ -d $dst ]
then
	dst="$dst"/`basename $src`
fi

# Make a temp file name in the proper directory.

dstdir=`dirname $dst`
dsttmp=$dstdir/#inst.$$#

# Move or copy the file name to the temp name

$doit $instcmd $src $dsttmp

# and set any options; do chmod last to preserve setuid bits

if [ x"$chowncmd" != x ]; then $doit $chowncmd $dsttmp; fi
if [ x"$chgrpcmd" != x ]; then $doit $chgrpcmd $dsttmp; fi
if [ x"$stripcmd" != x ]; then $doit $stripcmd $dsttmp; fi
if [ x"$chmodcmd" != x ]; then $doit $chmodcmd $dsttmp; fi

# Now rename the file to the real destination.

$doit $rmcmd $dst
$doit $mvcmd $dsttmp $dst


exit 0

blob
data 129726
# tcl.m4 --
#
#	This file provides a set of autoconf macros to help TEA-enable
#	a Tcl extension.
#
# Copyright (c) 1999-2000 Ajuba Solutions.
# Copyright (c) 2002-2005 ActiveState Corporation.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# RCS: @(#) $Id$

AC_PREREQ(2.57)

dnl TEA extensions pass us the version of TEA they think they
dnl are compatible with (must be set in TEA_INIT below)
dnl TEA_VERSION="3.6"

# Possible values for key variables defined:
#
# TEA_WINDOWINGSYSTEM - win32 aqua x11 (mirrors 'tk windowingsystem')
# TEA_PLATFORM        - windows unix
#

#------------------------------------------------------------------------
# TEA_PATH_TCLCONFIG --
#
#	Locate the tclConfig.sh file and perform a sanity check on
#	the Tcl compile flags
#
# Arguments:
#	none
#
# Results:
#
#	Adds the following arguments to configure:
#		--with-tcl=...
#
#	Defines the following vars:
#		TCL_BIN_DIR	Full path to the directory containing
#				the tclConfig.sh file
#------------------------------------------------------------------------

AC_DEFUN([TEA_PATH_TCLCONFIG], [
    dnl TEA specific: Make sure we are initialized
    AC_REQUIRE([TEA_INIT])
    #
    # Ok, lets find the tcl configuration
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-tcl
    #

    if test x"${no_tcl}" = x ; then
	# we reset no_tcl in case something fails here
	no_tcl=true
	AC_ARG_WITH(tcl,
	    AC_HELP_STRING([--with-tcl],
		[directory containing tcl configuration (tclConfig.sh)]),
	    with_tclconfig=${withval})
	AC_MSG_CHECKING([for Tcl configuration])
	AC_CACHE_VAL(ac_cv_c_tclconfig,[

	    # First check to see if --with-tcl was specified.
	    if test x"${with_tclconfig}" != x ; then
		case ${with_tclconfig} in
		    */tclConfig.sh )
			if test -f ${with_tclconfig}; then
			    AC_MSG_WARN([--with-tcl argument should refer to directory containing tclConfig.sh, not to tclConfig.sh itself])
			    with_tclconfig=`echo ${with_tclconfig} | sed 's!/tclConfig\.sh$!!'`
			fi ;;
		esac
		if test -f "${with_tclconfig}/tclConfig.sh" ; then
		    ac_cv_c_tclconfig=`(cd ${with_tclconfig}; pwd)`
		else
		    AC_MSG_ERROR([${with_tclconfig} directory doesn't contain tclConfig.sh])
		fi
	    fi

	    # then check for a private Tcl installation
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in \
			../tcl \
			`ls -dr ../tcl[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../tcl[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../tcl[[8-9]].[[0-9]]* 2>/dev/null` \
			../../tcl \
			`ls -dr ../../tcl[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../../tcl[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../tcl[[8-9]].[[0-9]]* 2>/dev/null` \
			../../../tcl \
			`ls -dr ../../../tcl[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../../../tcl[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../../tcl[[8-9]].[[0-9]]* 2>/dev/null` ; do
		    if test -f "$i/unix/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

	    # on Darwin, check in Framework installation locations
	    if test "`uname -s`" = "Darwin" -a x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d ~/Library/Frameworks 2>/dev/null` \
			`ls -d /Library/Frameworks 2>/dev/null` \
			`ls -d /Network/Library/Frameworks 2>/dev/null` \
			`ls -d /System/Library/Frameworks 2>/dev/null` \
			; do
		    if test -f "$i/Tcl.framework/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i/Tcl.framework; pwd)`
			break
		    fi
		done
	    fi

	    # TEA specific: on Windows, check in common installation locations
	    if test "${TEA_PLATFORM}" = "windows" \
		-a x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d C:/Tcl/lib 2>/dev/null` \
			`ls -d C:/Progra~1/Tcl/lib 2>/dev/null` \
			; do
		    if test -f "$i/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few common install locations
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in `ls -d ${libdir} 2>/dev/null` \
			`ls -d ${exec_prefix}/lib 2>/dev/null` \
			`ls -d ${prefix}/lib 2>/dev/null` \
			`ls -d /usr/local/lib 2>/dev/null` \
			`ls -d /usr/contrib/lib 2>/dev/null` \
			`ls -d /usr/lib 2>/dev/null` \
			; do
		    if test -f "$i/tclConfig.sh" ; then
			ac_cv_c_tclconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few other private locations
	    if test x"${ac_cv_c_tclconfig}" = x ; then
		for i in \
			${srcdir}/../tcl \
			`ls -dr ${srcdir}/../tcl[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ${srcdir}/../tcl[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ${srcdir}/../tcl[[8-9]].[[0-9]]* 2>/dev/null` ; do
		    if test -f "$i/unix/tclConfig.sh" ; then
		    ac_cv_c_tclconfig=`(cd $i/unix; pwd)`
		    break
		fi
		done
	    fi
	])

	if test x"${ac_cv_c_tclconfig}" = x ; then
	    TCL_BIN_DIR="# no Tcl configs found"
	    AC_MSG_WARN([Can't find Tcl configuration definitions])
	    exit 0
	else
	    no_tcl=
	    TCL_BIN_DIR=${ac_cv_c_tclconfig}
	    AC_MSG_RESULT([found ${TCL_BIN_DIR}/tclConfig.sh])
	fi
    fi
])

#------------------------------------------------------------------------
# TEA_PATH_TKCONFIG --
#
#	Locate the tkConfig.sh file
#
# Arguments:
#	none
#
# Results:
#
#	Adds the following arguments to configure:
#		--with-tk=...
#
#	Defines the following vars:
#		TK_BIN_DIR	Full path to the directory containing
#				the tkConfig.sh file
#------------------------------------------------------------------------

AC_DEFUN([TEA_PATH_TKCONFIG], [
    #
    # Ok, lets find the tk configuration
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-tk
    #

    if test x"${no_tk}" = x ; then
	# we reset no_tk in case something fails here
	no_tk=true
	AC_ARG_WITH(tk,
	    AC_HELP_STRING([--with-tk],
		[directory containing tk configuration (tkConfig.sh)]),
	    with_tkconfig=${withval})
	AC_MSG_CHECKING([for Tk configuration])
	AC_CACHE_VAL(ac_cv_c_tkconfig,[

	    # First check to see if --with-tkconfig was specified.
	    if test x"${with_tkconfig}" != x ; then
		case ${with_tkconfig} in
		    */tkConfig.sh )
			if test -f ${with_tkconfig}; then
			    AC_MSG_WARN([--with-tk argument should refer to directory containing tkConfig.sh, not to tkConfig.sh itself])
			    with_tkconfig=`echo ${with_tkconfig} | sed 's!/tkConfig\.sh$!!'`
			fi ;;
		esac
		if test -f "${with_tkconfig}/tkConfig.sh" ; then
		    ac_cv_c_tkconfig=`(cd ${with_tkconfig}; pwd)`
		else
		    AC_MSG_ERROR([${with_tkconfig} directory doesn't contain tkConfig.sh])
		fi
	    fi

	    # then check for a private Tk library
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in \
			../tk \
			`ls -dr ../tk[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../tk[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../tk[[8-9]].[[0-9]]* 2>/dev/null` \
			../../tk \
			`ls -dr ../../tk[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../../tk[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../tk[[8-9]].[[0-9]]* 2>/dev/null` \
			../../../tk \
			`ls -dr ../../../tk[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ../../../tk[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../../tk[[8-9]].[[0-9]]* 2>/dev/null` ; do
		    if test -f "$i/unix/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

	    # on Darwin, check in Framework installation locations
	    if test "`uname -s`" = "Darwin" -a x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d ~/Library/Frameworks 2>/dev/null` \
			`ls -d /Library/Frameworks 2>/dev/null` \
			`ls -d /Network/Library/Frameworks 2>/dev/null` \
			`ls -d /System/Library/Frameworks 2>/dev/null` \
			; do
		    if test -f "$i/Tk.framework/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/Tk.framework; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few common install locations
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d ${libdir} 2>/dev/null` \
			`ls -d ${exec_prefix}/lib 2>/dev/null` \
			`ls -d ${prefix}/lib 2>/dev/null` \
			`ls -d /usr/local/lib 2>/dev/null` \
			`ls -d /usr/contrib/lib 2>/dev/null` \
			`ls -d /usr/lib 2>/dev/null` \
			; do
		    if test -f "$i/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # TEA specific: on Windows, check in common installation locations
	    if test "${TEA_PLATFORM}" = "windows" \
		-a x"${ac_cv_c_tkconfig}" = x ; then
		for i in `ls -d C:/Tcl/lib 2>/dev/null` \
			`ls -d C:/Progra~1/Tcl/lib 2>/dev/null` \
			; do
		    if test -f "$i/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few other private locations
	    if test x"${ac_cv_c_tkconfig}" = x ; then
		for i in \
			${srcdir}/../tk \
			`ls -dr ${srcdir}/../tk[[8-9]].[[0-9]].[[0-9]]* 2>/dev/null` \
			`ls -dr ${srcdir}/../tk[[8-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ${srcdir}/../tk[[8-9]].[[0-9]]* 2>/dev/null` ; do
		    if test -f "$i/unix/tkConfig.sh" ; then
			ac_cv_c_tkconfig=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi
	])

	if test x"${ac_cv_c_tkconfig}" = x ; then
	    TK_BIN_DIR="# no Tk configs found"
	    AC_MSG_WARN([Can't find Tk configuration definitions])
	    exit 0
	else
	    no_tk=
	    TK_BIN_DIR=${ac_cv_c_tkconfig}
	    AC_MSG_RESULT([found ${TK_BIN_DIR}/tkConfig.sh])
	fi
    fi
])

#------------------------------------------------------------------------
# TEA_LOAD_TCLCONFIG --
#
#	Load the tclConfig.sh file
#
# Arguments:
#	
#	Requires the following vars to be set:
#		TCL_BIN_DIR
#
# Results:
#
#	Subst the following vars:
#		TCL_BIN_DIR
#		TCL_SRC_DIR
#		TCL_LIB_FILE
#
#------------------------------------------------------------------------

AC_DEFUN([TEA_LOAD_TCLCONFIG], [
    AC_MSG_CHECKING([for existence of ${TCL_BIN_DIR}/tclConfig.sh])

    if test -f "${TCL_BIN_DIR}/tclConfig.sh" ; then
        AC_MSG_RESULT([loading])
	. "${TCL_BIN_DIR}/tclConfig.sh"
    else
        AC_MSG_RESULT([could not find ${TCL_BIN_DIR}/tclConfig.sh])
    fi

    # eval is required to do the TCL_DBGX substitution
    eval "TCL_LIB_FILE=\"${TCL_LIB_FILE}\""
    eval "TCL_STUB_LIB_FILE=\"${TCL_STUB_LIB_FILE}\""

    # If the TCL_BIN_DIR is the build directory (not the install directory),
    # then set the common variable name to the value of the build variables.
    # For example, the variable TCL_LIB_SPEC will be set to the value
    # of TCL_BUILD_LIB_SPEC. An extension should make use of TCL_LIB_SPEC
    # instead of TCL_BUILD_LIB_SPEC since it will work with both an
    # installed and uninstalled version of Tcl.
    if test -f "${TCL_BIN_DIR}/Makefile" ; then
        TCL_LIB_SPEC=${TCL_BUILD_LIB_SPEC}
        TCL_STUB_LIB_SPEC=${TCL_BUILD_STUB_LIB_SPEC}
        TCL_STUB_LIB_PATH=${TCL_BUILD_STUB_LIB_PATH}
    elif test "`uname -s`" = "Darwin"; then
	# If Tcl was built as a framework, attempt to use the libraries
	# from the framework at the given location so that linking works
	# against Tcl.framework installed in an arbitary location.
	case ${TCL_DEFS} in
	    *TCL_FRAMEWORK*)
		if test -f "${TCL_BIN_DIR}/${TCL_LIB_FILE}"; then
		    for i in "`cd ${TCL_BIN_DIR}; pwd`" \
			     "`cd ${TCL_BIN_DIR}/../..; pwd`"; do
			if test "`basename "$i"`" = "${TCL_LIB_FILE}.framework"; then
			    TCL_LIB_SPEC="-F`dirname "$i"` -framework ${TCL_LIB_FILE}"
			    break
			fi
		    done
		fi
		if test -f "${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}"; then
		    TCL_STUB_LIB_SPEC="-L${TCL_BIN_DIR} ${TCL_STUB_LIB_FLAG}"
		    TCL_STUB_LIB_PATH="${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}"
		fi
		;;
	esac
    fi

    # eval is required to do the TCL_DBGX substitution
    eval "TCL_LIB_FLAG=\"${TCL_LIB_FLAG}\""
    eval "TCL_LIB_SPEC=\"${TCL_LIB_SPEC}\""
    eval "TCL_STUB_LIB_FLAG=\"${TCL_STUB_LIB_FLAG}\""
    eval "TCL_STUB_LIB_SPEC=\"${TCL_STUB_LIB_SPEC}\""

    AC_SUBST(TCL_VERSION)
    AC_SUBST(TCL_BIN_DIR)
    AC_SUBST(TCL_SRC_DIR)

    AC_SUBST(TCL_LIB_FILE)
    AC_SUBST(TCL_LIB_FLAG)
    AC_SUBST(TCL_LIB_SPEC)

    AC_SUBST(TCL_STUB_LIB_FILE)
    AC_SUBST(TCL_STUB_LIB_FLAG)
    AC_SUBST(TCL_STUB_LIB_SPEC)

    # TEA specific:
    AC_SUBST(TCL_LIBS)
    AC_SUBST(TCL_DEFS)
    AC_SUBST(TCL_EXTRA_CFLAGS)
    AC_SUBST(TCL_LD_FLAGS)
    AC_SUBST(TCL_SHLIB_LD_LIBS)
])

#------------------------------------------------------------------------
# TEA_LOAD_TKCONFIG --
#
#	Load the tkConfig.sh file
#
# Arguments:
#	
#	Requires the following vars to be set:
#		TK_BIN_DIR
#
# Results:
#
#	Sets the following vars that should be in tkConfig.sh:
#		TK_BIN_DIR
#------------------------------------------------------------------------

AC_DEFUN([TEA_LOAD_TKCONFIG], [
    AC_MSG_CHECKING([for existence of ${TK_BIN_DIR}/tkConfig.sh])

    if test -f "${TK_BIN_DIR}/tkConfig.sh" ; then
        AC_MSG_RESULT([loading])
	. "${TK_BIN_DIR}/tkConfig.sh"
    else
        AC_MSG_RESULT([could not find ${TK_BIN_DIR}/tkConfig.sh])
    fi

    # eval is required to do the TK_DBGX substitution
    eval "TK_LIB_FILE=\"${TK_LIB_FILE}\""
    eval "TK_STUB_LIB_FILE=\"${TK_STUB_LIB_FILE}\""

    # If the TK_BIN_DIR is the build directory (not the install directory),
    # then set the common variable name to the value of the build variables.
    # For example, the variable TK_LIB_SPEC will be set to the value
    # of TK_BUILD_LIB_SPEC. An extension should make use of TK_LIB_SPEC
    # instead of TK_BUILD_LIB_SPEC since it will work with both an
    # installed and uninstalled version of Tcl.
    if test -f "${TK_BIN_DIR}/Makefile" ; then
        TK_LIB_SPEC=${TK_BUILD_LIB_SPEC}
        TK_STUB_LIB_SPEC=${TK_BUILD_STUB_LIB_SPEC}
        TK_STUB_LIB_PATH=${TK_BUILD_STUB_LIB_PATH}
    elif test "`uname -s`" = "Darwin"; then
	# If Tk was built as a framework, attempt to use the libraries
	# from the framework at the given location so that linking works
	# against Tk.framework installed in an arbitary location.
	case ${TK_DEFS} in
	    *TK_FRAMEWORK*)
		if test -f "${TK_BIN_DIR}/${TK_LIB_FILE}"; then
		    for i in "`cd ${TK_BIN_DIR}; pwd`" \
			     "`cd ${TK_BIN_DIR}/../..; pwd`"; do
			if test "`basename "$i"`" = "${TK_LIB_FILE}.framework"; then
			    TK_LIB_SPEC="-F`dirname "$i"` -framework ${TK_LIB_FILE}"
			    break
			fi
		    done
		fi
		if test -f "${TK_BIN_DIR}/${TK_STUB_LIB_FILE}"; then
		    TK_STUB_LIB_SPEC="-L${TK_BIN_DIR} ${TK_STUB_LIB_FLAG}"
		    TK_STUB_LIB_PATH="${TK_BIN_DIR}/${TK_STUB_LIB_FILE}"
		fi
		;;
	esac
    fi

    # eval is required to do the TK_DBGX substitution
    eval "TK_LIB_FLAG=\"${TK_LIB_FLAG}\""
    eval "TK_LIB_SPEC=\"${TK_LIB_SPEC}\""
    eval "TK_STUB_LIB_FLAG=\"${TK_STUB_LIB_FLAG}\""
    eval "TK_STUB_LIB_SPEC=\"${TK_STUB_LIB_SPEC}\""

    # TEA specific: Ensure windowingsystem is defined
    if test "${TEA_PLATFORM}" = "unix" ; then
	case ${TK_DEFS} in
	    *MAC_OSX_TK*)
		AC_DEFINE(MAC_OSX_TK, 1, [Are we building against Mac OS X TkAqua?])
		TEA_WINDOWINGSYSTEM="aqua"
		;;
	    *)
		TEA_WINDOWINGSYSTEM="x11"
		;;
	esac
    elif test "${TEA_PLATFORM}" = "windows" ; then
	TEA_WINDOWINGSYSTEM="win32"
    fi

    AC_SUBST(TK_VERSION)
    AC_SUBST(TK_BIN_DIR)
    AC_SUBST(TK_SRC_DIR)

    AC_SUBST(TK_LIB_FILE)
    AC_SUBST(TK_LIB_FLAG)
    AC_SUBST(TK_LIB_SPEC)

    AC_SUBST(TK_STUB_LIB_FILE)
    AC_SUBST(TK_STUB_LIB_FLAG)
    AC_SUBST(TK_STUB_LIB_SPEC)

    # TEA specific:
    AC_SUBST(TK_LIBS)
    AC_SUBST(TK_XINCLUDES)
])

#------------------------------------------------------------------------
# TEA_PROG_TCLSH
#	Determine the fully qualified path name of the tclsh executable
#	in the Tcl build directory or the tclsh installed in a bin
#	directory. This macro will correctly determine the name
#	of the tclsh executable even if tclsh has not yet been
#	built in the build directory. The tclsh found is always
#	associated with a tclConfig.sh file. This tclsh should be used
#	only for running extension test cases. It should never be
#	or generation of files (like pkgIndex.tcl) at build time.
#
# Arguments
#	none
#
# Results
#	Subst's the following values:
#		TCLSH_PROG
#------------------------------------------------------------------------

AC_DEFUN([TEA_PROG_TCLSH], [
    AC_MSG_CHECKING([for tclsh])
    if test -f "${TCL_BIN_DIR}/Makefile" ; then
        # tclConfig.sh is in Tcl build directory
        if test "${TEA_PLATFORM}" = "windows"; then
            TCLSH_PROG="${TCL_BIN_DIR}/tclsh${TCL_MAJOR_VERSION}${TCL_MINOR_VERSION}${TCL_DBGX}${EXEEXT}"
        else
            TCLSH_PROG="${TCL_BIN_DIR}/tclsh"
        fi
    else
        # tclConfig.sh is in install location
        if test "${TEA_PLATFORM}" = "windows"; then
            TCLSH_PROG="tclsh${TCL_MAJOR_VERSION}${TCL_MINOR_VERSION}${TCL_DBGX}${EXEEXT}"
        else
            TCLSH_PROG="tclsh${TCL_MAJOR_VERSION}.${TCL_MINOR_VERSION}${TCL_DBGX}"
        fi
        list="`ls -d ${TCL_BIN_DIR}/../bin 2>/dev/null` \
              `ls -d ${TCL_BIN_DIR}/..     2>/dev/null` \
              `ls -d ${TCL_PREFIX}/bin     2>/dev/null`"
        for i in $list ; do
            if test -f "$i/${TCLSH_PROG}" ; then
                REAL_TCL_BIN_DIR="`cd "$i"; pwd`/"
                break
            fi
        done
        TCLSH_PROG="${REAL_TCL_BIN_DIR}${TCLSH_PROG}"
    fi
    AC_MSG_RESULT([${TCLSH_PROG}])
    AC_SUBST(TCLSH_PROG)
])

#------------------------------------------------------------------------
# TEA_PROG_WISH
#	Determine the fully qualified path name of the wish executable
#	in the Tk build directory or the wish installed in a bin
#	directory. This macro will correctly determine the name
#	of the wish executable even if wish has not yet been
#	built in the build directory. The wish found is always
#	associated with a tkConfig.sh file. This wish should be used
#	only for running extension test cases. It should never be
#	or generation of files (like pkgIndex.tcl) at build time.
#
# Arguments
#	none
#
# Results
#	Subst's the following values:
#		WISH_PROG
#------------------------------------------------------------------------

AC_DEFUN([TEA_PROG_WISH], [
    AC_MSG_CHECKING([for wish])
    if test -f "${TK_BIN_DIR}/Makefile" ; then
        # tkConfig.sh is in Tk build directory
        if test "${TEA_PLATFORM}" = "windows"; then
            WISH_PROG="${TK_BIN_DIR}/wish${TK_MAJOR_VERSION}${TK_MINOR_VERSION}${TK_DBGX}${EXEEXT}"
        else
            WISH_PROG="${TK_BIN_DIR}/wish"
        fi
    else
        # tkConfig.sh is in install location
        if test "${TEA_PLATFORM}" = "windows"; then
            WISH_PROG="wish${TK_MAJOR_VERSION}${TK_MINOR_VERSION}${TK_DBGX}${EXEEXT}"
        else
            WISH_PROG="wish${TK_MAJOR_VERSION}.${TK_MINOR_VERSION}${TK_DBGX}"
        fi
        list="`ls -d ${TK_BIN_DIR}/../bin 2>/dev/null` \
              `ls -d ${TK_BIN_DIR}/..     2>/dev/null` \
              `ls -d ${TK_PREFIX}/bin     2>/dev/null`"
        for i in $list ; do
            if test -f "$i/${WISH_PROG}" ; then
                REAL_TK_BIN_DIR="`cd "$i"; pwd`/"
                break
            fi
        done
        WISH_PROG="${REAL_TK_BIN_DIR}${WISH_PROG}"
    fi
    AC_MSG_RESULT([${WISH_PROG}])
    AC_SUBST(WISH_PROG)
])

#------------------------------------------------------------------------
# TEA_ENABLE_SHARED --
#
#	Allows the building of shared libraries
#
# Arguments:
#	none
#	
# Results:
#
#	Adds the following arguments to configure:
#		--enable-shared=yes|no
#
#	Defines the following vars:
#		STATIC_BUILD	Used for building import/export libraries
#				on Windows.
#
#	Sets the following vars:
#		SHARED_BUILD	Value of 1 or 0
#------------------------------------------------------------------------

AC_DEFUN([TEA_ENABLE_SHARED], [
    AC_MSG_CHECKING([how to build libraries])
    AC_ARG_ENABLE(shared,
	AC_HELP_STRING([--enable-shared],
	    [build and link with shared libraries (default: on)]),
	[tcl_ok=$enableval], [tcl_ok=yes])

    if test "${enable_shared+set}" = set; then
	enableval="$enable_shared"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" ; then
	AC_MSG_RESULT([shared])
	SHARED_BUILD=1
    else
	AC_MSG_RESULT([static])
	SHARED_BUILD=0
	AC_DEFINE(STATIC_BUILD, 1, [Is this a static build?])
    fi
    AC_SUBST(SHARED_BUILD)
])

#------------------------------------------------------------------------
# TEA_ENABLE_THREADS --
#
#	Specify if thread support should be enabled.  If "yes" is specified
#	as an arg (optional), threads are enabled by default, "no" means
#	threads are disabled.  "yes" is the default.
#
#	TCL_THREADS is checked so that if you are compiling an extension
#	against a threaded core, your extension must be compiled threaded
#	as well.
#
#	Note that it is legal to have a thread enabled extension run in a
#	threaded or non-threaded Tcl core, but a non-threaded extension may
#	only run in a non-threaded Tcl core.
#
# Arguments:
#	none
#	
# Results:
#
#	Adds the following arguments to configure:
#		--enable-threads
#
#	Sets the following vars:
#		THREADS_LIBS	Thread library(s)
#
#	Defines the following vars:
#		TCL_THREADS
#		_REENTRANT
#		_THREAD_SAFE
#
#------------------------------------------------------------------------

AC_DEFUN([TEA_ENABLE_THREADS], [
    AC_ARG_ENABLE(threads,
	AC_HELP_STRING([--enable-threads],
	    [build with threads]),
	[tcl_ok=$enableval], [tcl_ok=yes])

    if test "${enable_threads+set}" = set; then
	enableval="$enable_threads"
	tcl_ok=$enableval
    else
	tcl_ok=yes
    fi

    if test "$tcl_ok" = "yes" -o "${TCL_THREADS}" = 1; then
	TCL_THREADS=1

	if test "${TEA_PLATFORM}" != "windows" ; then
	    # We are always OK on Windows, so check what this platform wants:
    
	    # USE_THREAD_ALLOC tells us to try the special thread-based
	    # allocator that significantly reduces lock contention
	    AC_DEFINE(USE_THREAD_ALLOC, 1,
		[Do we want to use the threaded memory allocator?])
	    AC_DEFINE(_REENTRANT, 1, [Do we want the reentrant OS API?])
	    if test "`uname -s`" = "SunOS" ; then
		AC_DEFINE(_POSIX_PTHREAD_SEMANTICS, 1,
			[Do we really want to follow the standard? Yes we do!])
	    fi
	    AC_DEFINE(_THREAD_SAFE, 1, [Do we want the thread-safe OS API?])
	    AC_CHECK_LIB(pthread,pthread_mutex_init,tcl_ok=yes,tcl_ok=no)
	    if test "$tcl_ok" = "no"; then
		# Check a little harder for __pthread_mutex_init in the same
		# library, as some systems hide it there until pthread.h is
		# defined.  We could alternatively do an AC_TRY_COMPILE with
		# pthread.h, but that will work with libpthread really doesn't
		# exist, like AIX 4.2.  [Bug: 4359]
		AC_CHECK_LIB(pthread, __pthread_mutex_init,
		    tcl_ok=yes, tcl_ok=no)
	    fi

	    if test "$tcl_ok" = "yes"; then
		# The space is needed
		THREADS_LIBS=" -lpthread"
	    else
		AC_CHECK_LIB(pthreads, pthread_mutex_init,
		    tcl_ok=yes, tcl_ok=no)
		if test "$tcl_ok" = "yes"; then
		    # The space is needed
		    THREADS_LIBS=" -lpthreads"
		else
		    AC_CHECK_LIB(c, pthread_mutex_init,
			tcl_ok=yes, tcl_ok=no)
		    if test "$tcl_ok" = "no"; then
			AC_CHECK_LIB(c_r, pthread_mutex_init,
			    tcl_ok=yes, tcl_ok=no)
			if test "$tcl_ok" = "yes"; then
			    # The space is needed
			    THREADS_LIBS=" -pthread"
			else
			    TCL_THREADS=0
			    AC_MSG_WARN([Do not know how to find pthread lib on your system - thread support disabled])
			fi
		    fi
		fi
	    fi
	fi
    else
	TCL_THREADS=0
    fi
    # Do checking message here to not mess up interleaved configure output
    AC_MSG_CHECKING([for building with threads])
    if test "${TCL_THREADS}" = 1; then
	AC_DEFINE(TCL_THREADS, 1, [Are we building with threads enabled?])
	AC_MSG_RESULT([yes (default)])
    else
	AC_MSG_RESULT([no])
    fi
    # TCL_THREADS sanity checking.  See if our request for building with
    # threads is the same as the way Tcl was built.  If not, warn the user.
    case ${TCL_DEFS} in
	*THREADS=1*)
	    if test "${TCL_THREADS}" = "0"; then
		AC_MSG_WARN([
    Building ${PACKAGE_NAME} without threads enabled, but building against Tcl
    that IS thread-enabled.  It is recommended to use --enable-threads.])
	    fi
	    ;;
	*)
	    if test "${TCL_THREADS}" = "1"; then
		AC_MSG_WARN([
    --enable-threads requested, but building against a Tcl that is NOT
    thread-enabled.  This is an OK configuration that will also run in
    a thread-enabled core.])
	    fi
	    ;;
    esac
    AC_SUBST(TCL_THREADS)
])

#------------------------------------------------------------------------
# TEA_ENABLE_SYMBOLS --
#
#	Specify if debugging symbols should be used.
#	Memory (TCL_MEM_DEBUG) debugging can also be enabled.
#
# Arguments:
#	none
#	
#	TEA varies from core Tcl in that C|LDFLAGS_DEFAULT receives
#	the value of C|LDFLAGS_OPTIMIZE|DEBUG already substituted.
#	Requires the following vars to be set in the Makefile:
#		CFLAGS_DEFAULT
#		LDFLAGS_DEFAULT
#	
# Results:
#
#	Adds the following arguments to configure:
#		--enable-symbols
#
#	Defines the following vars:
#		CFLAGS_DEFAULT	Sets to $(CFLAGS_DEBUG) if true
#				Sets to $(CFLAGS_OPTIMIZE) if false
#		LDFLAGS_DEFAULT	Sets to $(LDFLAGS_DEBUG) if true
#				Sets to $(LDFLAGS_OPTIMIZE) if false
#		DBGX		Formerly used as debug library extension;
#				always blank now.
#
#------------------------------------------------------------------------

AC_DEFUN([TEA_ENABLE_SYMBOLS], [
    dnl TEA specific: Make sure we are initialized
    AC_REQUIRE([TEA_CONFIG_CFLAGS])
    AC_MSG_CHECKING([for build with symbols])
    AC_ARG_ENABLE(symbols,
	AC_HELP_STRING([--enable-symbols],
	    [build with debugging symbols (default: off)]),
	[tcl_ok=$enableval], [tcl_ok=no])
    DBGX=""
    if test "$tcl_ok" = "no"; then
	CFLAGS_DEFAULT="${CFLAGS_OPTIMIZE}"
	LDFLAGS_DEFAULT="${LDFLAGS_OPTIMIZE}"
	AC_MSG_RESULT([no])
    else
	CFLAGS_DEFAULT="${CFLAGS_DEBUG}"
	LDFLAGS_DEFAULT="${LDFLAGS_DEBUG}"
	if test "$tcl_ok" = "yes"; then
	    AC_MSG_RESULT([yes (standard debugging)])
	fi
    fi
    # TEA specific:
    if test "${TEA_PLATFORM}" != "windows" ; then
	LDFLAGS_DEFAULT="${LDFLAGS}"
    fi
    AC_SUBST(CFLAGS_DEFAULT)
    AC_SUBST(LDFLAGS_DEFAULT)
    AC_SUBST(TCL_DBGX)

    if test "$tcl_ok" = "mem" -o "$tcl_ok" = "all"; then
	AC_DEFINE(TCL_MEM_DEBUG, 1, [Is memory debugging enabled?])
    fi

    if test "$tcl_ok" != "yes" -a "$tcl_ok" != "no"; then
	if test "$tcl_ok" = "all"; then
	    AC_MSG_RESULT([enabled symbols mem debugging])
	else
	    AC_MSG_RESULT([enabled $tcl_ok debugging])
	fi
    fi
])

#------------------------------------------------------------------------
# TEA_ENABLE_LANGINFO --
#
#	Allows use of modern nl_langinfo check for better l10n.
#	This is only relevant for Unix.
#
# Arguments:
#	none
#	
# Results:
#
#	Adds the following arguments to configure:
#		--enable-langinfo=yes|no (default is yes)
#
#	Defines the following vars:
#		HAVE_LANGINFO	Triggers use of nl_langinfo if defined.
#
#------------------------------------------------------------------------

AC_DEFUN([TEA_ENABLE_LANGINFO], [
    AC_ARG_ENABLE(langinfo,
	AC_HELP_STRING([--enable-langinfo],
	    [use nl_langinfo if possible to determine encoding at startup, otherwise use old heuristic (default: on)]),
	[langinfo_ok=$enableval], [langinfo_ok=yes])

    HAVE_LANGINFO=0
    if test "$langinfo_ok" = "yes"; then
	AC_CHECK_HEADER(langinfo.h,[langinfo_ok=yes],[langinfo_ok=no])
    fi
    AC_MSG_CHECKING([whether to use nl_langinfo])
    if test "$langinfo_ok" = "yes"; then
	AC_CACHE_VAL(tcl_cv_langinfo_h, [
	    AC_TRY_COMPILE([#include <langinfo.h>], [nl_langinfo(CODESET);],
		    [tcl_cv_langinfo_h=yes],[tcl_cv_langinfo_h=no])])
	AC_MSG_RESULT([$tcl_cv_langinfo_h])
	if test $tcl_cv_langinfo_h = yes; then
	    AC_DEFINE(HAVE_LANGINFO, 1, [Do we have nl_langinfo()?])
	fi
    else 
	AC_MSG_RESULT([$langinfo_ok])
    fi
])

#--------------------------------------------------------------------
# TEA_CONFIG_SYSTEM
#
#	Determine what the system is (some things cannot be easily checked
#	on a feature-driven basis, alas). This can usually be done via the
#	"uname" command, but there are a few systems, like Next, where
#	this doesn't work.
#
# Arguments:
#	none
#
# Results:
#	Defines the following var:
#
#	system -	System/platform/version identification code.
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_CONFIG_SYSTEM], [
    AC_CACHE_CHECK([system version], tcl_cv_sys_version, [
	# TEA specific:
	if test "${TEA_PLATFORM}" = "windows" ; then
	    tcl_cv_sys_version=windows
	elif test -f /usr/lib/NextStep/software_version; then
	    tcl_cv_sys_version=NEXTSTEP-`awk '/3/,/3/' /usr/lib/NextStep/software_version`
	else
	    tcl_cv_sys_version=`uname -s`-`uname -r`
	    if test "$?" -ne 0 ; then
		AC_MSG_WARN([can't find uname command])
		tcl_cv_sys_version=unknown
	    else
		# Special check for weird MP-RAS system (uname returns weird
		# results, and the version is kept in special file).

		if test -r /etc/.relid -a "X`uname -n`" = "X`uname -s`" ; then
		    tcl_cv_sys_version=MP-RAS-`awk '{print $[3]}' /etc/.relid`
		fi
		if test "`uname -s`" = "AIX" ; then
		    tcl_cv_sys_version=AIX-`uname -v`.`uname -r`
		fi
	    fi
	fi
    ])
    system=$tcl_cv_sys_version
])

#--------------------------------------------------------------------
# TEA_CONFIG_CFLAGS
#
#	Try to determine the proper flags to pass to the compiler
#	for building shared libraries and other such nonsense.
#
# Arguments:
#	none
#
# Results:
#
#	Defines and substitutes the following vars:
#
#       DL_OBJS -       Name of the object file that implements dynamic
#                       loading for Tcl on this system.
#       DL_LIBS -       Library file(s) to include in tclsh and other base
#                       applications in order for the "load" command to work.
#       LDFLAGS -      Flags to pass to the compiler when linking object
#                       files into an executable application binary such
#                       as tclsh.
#       LD_SEARCH_FLAGS-Flags to pass to ld, such as "-R /usr/local/tcl/lib",
#                       that tell the run-time dynamic linker where to look
#                       for shared libraries such as libtcl.so.  Depends on
#                       the variable LIB_RUNTIME_DIR in the Makefile. Could
#                       be the same as CC_SEARCH_FLAGS if ${CC} is used to link.
#       CC_SEARCH_FLAGS-Flags to pass to ${CC}, such as "-Wl,-rpath,/usr/local/tcl/lib",
#                       that tell the run-time dynamic linker where to look
#                       for shared libraries such as libtcl.so.  Depends on
#                       the variable LIB_RUNTIME_DIR in the Makefile.
#       SHLIB_CFLAGS -  Flags to pass to cc when compiling the components
#                       of a shared library (may request position-independent
#                       code, among other things).
#       SHLIB_LD -      Base command to use for combining object files
#                       into a shared library.
#       SHLIB_LD_LIBS - Dependent libraries for the linker to scan when
#                       creating shared libraries.  This symbol typically
#                       goes at the end of the "ld" commands that build
#                       shared libraries. The value of the symbol is
#                       "${LIBS}" if all of the dependent libraries should
#                       be specified when creating a shared library.  If
#                       dependent libraries should not be specified (as on
#                       SunOS 4.x, where they cause the link to fail, or in
#                       general if Tcl and Tk aren't themselves shared
#                       libraries), then this symbol has an empty string
#                       as its value.
#       SHLIB_SUFFIX -  Suffix to use for the names of dynamically loadable
#                       extensions.  An empty string means we don't know how
#                       to use shared libraries on this platform.
#       LIB_SUFFIX -    Specifies everything that comes after the "libfoo"
#                       in a static or shared library name, using the $VERSION variable
#                       to put the version in the right place.  This is used
#                       by platforms that need non-standard library names.
#                       Examples:  ${VERSION}.so.1.1 on NetBSD, since it needs
#                       to have a version after the .so, and ${VERSION}.a
#                       on AIX, since a shared library needs to have
#                       a .a extension whereas shared objects for loadable
#                       extensions have a .so extension.  Defaults to
#                       ${VERSION}${SHLIB_SUFFIX}.
#       TCL_NEEDS_EXP_FILE -
#                       1 means that an export file is needed to link to a
#                       shared library.
#       TCL_EXP_FILE -  The name of the installed export / import file which
#                       should be used to link to the Tcl shared library.
#                       Empty if Tcl is unshared.
#       TCL_BUILD_EXP_FILE -
#                       The name of the built export / import file which
#                       should be used to link to the Tcl shared library.
#                       Empty if Tcl is unshared.
#	CFLAGS_DEBUG -
#			Flags used when running the compiler in debug mode
#	CFLAGS_OPTIMIZE -
#			Flags used when running the compiler in optimize mode
#	CFLAGS -	Additional CFLAGS added as necessary (usually 64-bit)
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_CONFIG_CFLAGS], [
    dnl TEA specific: Make sure we are initialized
    AC_REQUIRE([TEA_INIT])

    # Step 0.a: Enable 64 bit support?

    AC_MSG_CHECKING([if 64bit support is requested])
    AC_ARG_ENABLE(64bit,
	AC_HELP_STRING([--enable-64bit],
	    [enable 64bit support (default: off)]),
	[do64bit=$enableval], [do64bit=no])
    AC_MSG_RESULT([$do64bit])

    # Step 0.b: Enable Solaris 64 bit VIS support?

    AC_MSG_CHECKING([if 64bit Sparc VIS support is requested])
    AC_ARG_ENABLE(64bit-vis,
	AC_HELP_STRING([--enable-64bit-vis],
	    [enable 64bit Sparc VIS support (default: off)]),
	[do64bitVIS=$enableval], [do64bitVIS=no])
    AC_MSG_RESULT([$do64bitVIS])
    # Force 64bit on with VIS
    AS_IF([test "$do64bitVIS" = "yes"], [do64bit=yes])

    # Step 0.c: Check if visibility support is available. Do this here so
    # that platform specific alternatives can be used below if this fails.

    AC_CACHE_CHECK([if compiler supports visibility "hidden"],
	tcl_cv_cc_visibility_hidden, [
	hold_cflags=$CFLAGS; CFLAGS="$CFLAGS -Werror"
	AC_TRY_LINK([
	    extern __attribute__((__visibility__("hidden"))) void f(void);
	    void f(void) {}], [f();], tcl_cv_cc_visibility_hidden=yes,
	    tcl_cv_cc_visibility_hidden=no)
	CFLAGS=$hold_cflags])
    AS_IF([test $tcl_cv_cc_visibility_hidden = yes], [
	AC_DEFINE(MODULE_SCOPE,
	    [extern __attribute__((__visibility__("hidden")))],
	    [Compiler support for module scope symbols])
    ])

    # Step 0.d: Disable -rpath support?

    AC_MSG_CHECKING([if rpath support is requested])
    AC_ARG_ENABLE(rpath,
	AC_HELP_STRING([--disable-rpath],
	    [disable rpath support (default: on)]),
	[doRpath=$enableval], [doRpath=yes])
    AC_MSG_RESULT([$doRpath])

    # TEA specific: Cross-compiling options for Windows/CE builds?

    AS_IF([test "${TEA_PLATFORM}" = windows], [
	AC_MSG_CHECKING([if Windows/CE build is requested])
	AC_ARG_ENABLE(wince,
	    AC_HELP_STRING([--enable-wince],
		[enable Win/CE support (where applicable)]),
	    [doWince=$enableval], [doWince=no])
	AC_MSG_RESULT([$doWince])
    ])

    # Step 1: set the variable "system" to hold the name and version number
    # for the system.

    TEA_CONFIG_SYSTEM

    # Step 2: check for existence of -ldl library.  This is needed because
    # Linux can use either -ldl or -ldld for dynamic loading.

    AC_CHECK_LIB(dl, dlopen, have_dl=yes, have_dl=no)

    # Require ranlib early so we can override it in special cases below.

    AC_REQUIRE([AC_PROG_RANLIB])

    # Step 3: set configuration options based on system name and version.
    # This is similar to Tcl's unix/tcl.m4 except that we've added a
    # "windows" case.

    do64bit_ok=no
    LDFLAGS_ORIG="$LDFLAGS"
    # When ld needs options to work in 64-bit mode, put them in
    # LDFLAGS_ARCH so they eventually end up in LDFLAGS even if [load]
    # is disabled by the user. [Bug 1016796]
    LDFLAGS_ARCH=""
    TCL_EXPORT_FILE_SUFFIX=""
    UNSHARED_LIB_SUFFIX=""
    # TEA specific: use PACKAGE_VERSION instead of VERSION
    TCL_TRIM_DOTS='`echo ${PACKAGE_VERSION} | tr -d .`'
    ECHO_VERSION='`echo ${PACKAGE_VERSION}`'
    TCL_LIB_VERSIONS_OK=ok
    CFLAGS_DEBUG=-g
    CFLAGS_OPTIMIZE=-O
    AS_IF([test "$GCC" = yes], [
	# TEA specific:
	CFLAGS_OPTIMIZE=-O2
	CFLAGS_WARNING="-Wall -Wno-implicit-int"
    ], [CFLAGS_WARNING=""])
    TCL_NEEDS_EXP_FILE=0
    TCL_BUILD_EXP_FILE=""
    TCL_EXP_FILE=""
dnl FIXME: Replace AC_CHECK_PROG with AC_CHECK_TOOL once cross compiling is fixed.
dnl AC_CHECK_TOOL(AR, ar)
    AC_CHECK_PROG(AR, ar, ar)
    STLIB_LD='${AR} cr'
    LD_LIBRARY_PATH_VAR="LD_LIBRARY_PATH"
    case $system in
	# TEA specific:
	windows)
	    # This is a 2-stage check to make sure we have the 64-bit SDK
	    # We have to know where the SDK is installed.
	    # This magic is based on MS Platform SDK for Win2003 SP1 - hobbs
	    # MACHINE is IX86 for LINK, but this is used by the manifest,
	    # which requires x86|amd64|ia64.
	    MACHINE="X86"
	    if test "$do64bit" != "no" ; then
		if test "x${MSSDK}x" = "xx" ; then
		    MSSDK="C:/Progra~1/Microsoft Platform SDK"
		fi
		MSSDK=`echo "$MSSDK" | sed -e  's!\\\!/!g'`
		PATH64=""
		case "$do64bit" in
		    amd64|x64|yes)
			MACHINE="AMD64" ; # default to AMD64 64-bit build
			PATH64="${MSSDK}/Bin/Win64/x86/AMD64"
			;;
		    ia64)
			MACHINE="IA64"
			PATH64="${MSSDK}/Bin/Win64"
			;;
		esac
		if test ! -d "${PATH64}" ; then
		    AC_MSG_WARN([Could not find 64-bit $MACHINE SDK to enable 64bit mode])
		    AC_MSG_WARN([Ensure latest Platform SDK is installed])
		    do64bit="no"
		else
		    AC_MSG_RESULT([   Using 64-bit $MACHINE mode])
		    do64bit_ok="yes"
		fi
	    fi

	    if test "$doWince" != "no" ; then
		if test "$do64bit" != "no" ; then
		    AC_MSG_ERROR([Windows/CE and 64-bit builds incompatible])
		fi
		if test "$GCC" = "yes" ; then
		    AC_MSG_ERROR([Windows/CE and GCC builds incompatible])
		fi
		TEA_PATH_CELIB
		# Set defaults for common evc4/PPC2003 setup
		# Currently Tcl requires 300+, possibly 420+ for sockets
		CEVERSION=420; 		# could be 211 300 301 400 420 ...
		TARGETCPU=ARMV4;	# could be ARMV4 ARM MIPS SH3 X86 ...
		ARCH=ARM;		# could be ARM MIPS X86EM ...
		PLATFORM="Pocket PC 2003"; # or "Pocket PC 2002"
		if test "$doWince" != "yes"; then
		    # If !yes then the user specified something
		    # Reset ARCH to allow user to skip specifying it
		    ARCH=
		    eval `echo $doWince | awk -F, '{ \
	    if (length([$]1)) { printf "CEVERSION=\"%s\"\n", [$]1; \
	    if ([$]1 < 400)   { printf "PLATFORM=\"Pocket PC 2002\"\n" } }; \
	    if (length([$]2)) { printf "TARGETCPU=\"%s\"\n", toupper([$]2) }; \
	    if (length([$]3)) { printf "ARCH=\"%s\"\n", toupper([$]3) }; \
	    if (length([$]4)) { printf "PLATFORM=\"%s\"\n", [$]4 }; \
		    }'`
		    if test "x${ARCH}" = "x" ; then
			ARCH=$TARGETCPU;
		    fi
		fi
		OSVERSION=WCE$CEVERSION;
	    	if test "x${WCEROOT}" = "x" ; then
			WCEROOT="C:/Program Files/Microsoft eMbedded C++ 4.0"
		    if test ! -d "${WCEROOT}" ; then
			WCEROOT="C:/Program Files/Microsoft eMbedded Tools"
		    fi
		fi
		if test "x${SDKROOT}" = "x" ; then
		    SDKROOT="C:/Program Files/Windows CE Tools"
		    if test ! -d "${SDKROOT}" ; then
			SDKROOT="C:/Windows CE Tools"
		    fi
		fi
		WCEROOT=`echo "$WCEROOT" | sed -e 's!\\\!/!g'`
		SDKROOT=`echo "$SDKROOT" | sed -e 's!\\\!/!g'`
		if test ! -d "${SDKROOT}/${OSVERSION}/${PLATFORM}/Lib/${TARGETCPU}" \
		    -o ! -d "${WCEROOT}/EVC/${OSVERSION}/bin"; then
		    AC_MSG_ERROR([could not find PocketPC SDK or target compiler to enable WinCE mode [$CEVERSION,$TARGETCPU,$ARCH,$PLATFORM]])
		    doWince="no"
		else
		    # We could PATH_NOSPACE these, but that's not important,
		    # as long as we quote them when used.
		    CEINCLUDE="${SDKROOT}/${OSVERSION}/${PLATFORM}/include"
		    if test -d "${CEINCLUDE}/${TARGETCPU}" ; then
			CEINCLUDE="${CEINCLUDE}/${TARGETCPU}"
		    fi
		    CELIBPATH="${SDKROOT}/${OSVERSION}/${PLATFORM}/Lib/${TARGETCPU}"
    		fi
	    fi

	    if test "$GCC" != "yes" ; then
	        if test "${SHARED_BUILD}" = "0" ; then
		    runtime=-MT
	        else
		    runtime=-MD
	        fi

                if test "$do64bit" != "no" ; then
		    # All this magic is necessary for the Win64 SDK RC1 - hobbs
		    CC="\"${PATH64}/cl.exe\""
		    CFLAGS="${CFLAGS} -I\"${MSSDK}/Include\" -I\"${MSSDK}/Include/crt\" -I\"${MSSDK}/Include/crt/sys\""
		    RC="\"${MSSDK}/bin/rc.exe\""
		    lflags="-nologo -MACHINE:${MACHINE} -LIBPATH:\"${MSSDK}/Lib/${MACHINE}\""
		    LINKBIN="\"${PATH64}/link.exe\""
		    CFLAGS_DEBUG="-nologo -Zi -Od -W3 ${runtime}d"
		    CFLAGS_OPTIMIZE="-nologo -O2 -W2 ${runtime}"
		    # Avoid 'unresolved external symbol __security_cookie'
		    # errors, c.f. http://support.microsoft.com/?id=894573
		    TEA_ADD_LIBS([bufferoverflowU.lib])
		elif test "$doWince" != "no" ; then
		    CEBINROOT="${WCEROOT}/EVC/${OSVERSION}/bin"
		    if test "${TARGETCPU}" = "X86"; then
			CC="\"${CEBINROOT}/cl.exe\""
		    else
			CC="\"${CEBINROOT}/cl${ARCH}.exe\""
		    fi
		    CFLAGS="$CFLAGS -I\"${CELIB_DIR}/inc\" -I\"${CEINCLUDE}\""
		    RC="\"${WCEROOT}/Common/EVC/bin/rc.exe\""
		    arch=`echo ${ARCH} | awk '{print tolower([$]0)}'`
		    defs="${ARCH} _${ARCH}_ ${arch} PALM_SIZE _MT _WINDOWS"
		    if test "${SHARED_BUILD}" = "1" ; then
			# Static CE builds require static celib as well
		    	defs="${defs} _DLL"
		    fi
		    for i in $defs ; do
			AC_DEFINE_UNQUOTED($i, 1, [WinCE def ]$i)
		    done
		    AC_DEFINE_UNQUOTED(_WIN32_WCE, $CEVERSION, [_WIN32_WCE version])
		    AC_DEFINE_UNQUOTED(UNDER_CE, $CEVERSION, [UNDER_CE version])
		    CFLAGS_DEBUG="-nologo -Zi -Od"
		    CFLAGS_OPTIMIZE="-nologo -Ox"
		    lversion=`echo ${CEVERSION} | sed -e 's/\(.\)\(..\)/\1\.\2/'`
		    lflags="-MACHINE:${ARCH} -LIBPATH:\"${CELIBPATH}\" -subsystem:windowsce,${lversion} -nologo"
		    LINKBIN="\"${CEBINROOT}/link.exe\""
		    AC_SUBST(CELIB_DIR)
		else
		    RC="rc"
		    lflags="-nologo"
    		    LINKBIN="link"
		    CFLAGS_DEBUG="-nologo -Z7 -Od -W3 -WX ${runtime}d"
		    CFLAGS_OPTIMIZE="-nologo -O2 -W2 ${runtime}"
		fi
	    fi

	    if test "$GCC" = "yes"; then
		# mingw gcc mode
		RC="windres"
		CFLAGS_DEBUG="-g"
		CFLAGS_OPTIMIZE="-O2 -fomit-frame-pointer"
		SHLIB_LD="$CC -shared"
		UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
		LDFLAGS_CONSOLE="-wl,--subsystem,console ${lflags}"
		LDFLAGS_WINDOW="-wl,--subsystem,windows ${lflags}"
	    else
		SHLIB_LD="${LINKBIN} -dll ${lflags}"
		# link -lib only works when -lib is the first arg
		STLIB_LD="${LINKBIN} -lib ${lflags}"
		UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.lib'
		PATHTYPE=-w
		# For information on what debugtype is most useful, see:
		# http://msdn.microsoft.com/library/en-us/dnvc60/html/gendepdebug.asp
		# This essentially turns it all on.
		LDFLAGS_DEBUG="-debug:full -debugtype:both -warn:2"
		LDFLAGS_OPTIMIZE="-release"
		if test "$doWince" != "no" ; then
		    LDFLAGS_CONSOLE="-link ${lflags}"
		    LDFLAGS_WINDOW=${LDFLAGS_CONSOLE}
		else
		    LDFLAGS_CONSOLE="-link -subsystem:console ${lflags}"
		    LDFLAGS_WINDOW="-link -subsystem:windows ${lflags}"
		fi
	    fi

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".dll"
	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.dll'

	    TCL_LIB_VERSIONS_OK=nodots
	    # Bogus to avoid getting this turned off
	    DL_OBJS="tclLoadNone.obj"
    	    ;;
	AIX-*)
	    AS_IF([test "${TCL_THREADS}" = "1" -a "$GCC" != "yes"], [
		# AIX requires the _r compiler when gcc isn't being used
		case "${CC}" in
		    *_r)
			# ok ...
			;;
		    *)
			CC=${CC}_r
			;;
		esac
		AC_MSG_RESULT([Using $CC for compiling with threads])
	    ])
	    LIBS="$LIBS -lc"
	    SHLIB_CFLAGS=""
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    DL_OBJS="tclLoadDl.o"
	    LD_LIBRARY_PATH_VAR="LIBPATH"

	    # Check to enable 64-bit flags for compiler/linker on AIX 4+
	    AS_IF([test "$do64bit" = yes -a "`uname -v`" -gt 3], [
		AS_IF([test "$GCC" = yes], [
		    AC_MSG_WARN([64bit mode not supported with GCC on $system])
		], [
		    do64bit_ok=yes
		    CFLAGS="$CFLAGS -q64"
		    LDFLAGS_ARCH="-q64"
		    RANLIB="${RANLIB} -X64"
		    AR="${AR} -X64"
		    SHLIB_LD_FLAGS="-b64"
		])
	    ])

	    AS_IF([test "`uname -m`" = ia64], [
		# AIX-5 uses ELF style dynamic libraries on IA-64, but not PPC
		SHLIB_LD="/usr/ccs/bin/ld -G -z text"
		# AIX-5 has dl* in libc.so
		DL_LIBS=""
		AS_IF([test "$GCC" = yes], [
		    CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		], [
		    CC_SEARCH_FLAGS='-R${LIB_RUNTIME_DIR}'
		])
		LD_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'
	    ], [
		AS_IF([test "$GCC" = yes], [SHLIB_LD='${CC} -shared'], [
		    SHLIB_LD="/bin/ld -bhalt:4 -bM:SRE -bE:lib.exp -H512 -T512 -bnoentry"
		])
		SHLIB_LD="${TCL_SRC_DIR}/unix/ldAix ${SHLIB_LD} ${SHLIB_LD_FLAGS}"
		DL_LIBS="-ldl"
		CC_SEARCH_FLAGS='-L${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
		TCL_NEEDS_EXP_FILE=1
		# TEA specific: use PACKAGE_VERSION instead of VERSION
		TCL_EXPORT_FILE_SUFFIX='${PACKAGE_VERSION}.exp'
	    ])

	    # AIX v<=4.1 has some different flags than 4.2+
	    AS_IF([test "$system" = "AIX-4.1" -o "`uname -v`" -lt 4], [
		AC_LIBOBJ([tclLoadAix])
		DL_LIBS="-lld"
	    ])

	    # On AIX <=v4 systems, libbsd.a has to be linked in to support
	    # non-blocking file IO.  This library has to be linked in after
	    # the MATH_LIBS or it breaks the pow() function.  The way to
	    # insure proper sequencing, is to add it to the tail of MATH_LIBS.
	    # This library also supplies gettimeofday.
	    #
	    # AIX does not have a timezone field in struct tm. When the AIX
	    # bsd library is used, the timezone global and the gettimeofday
	    # methods are to be avoided for timezone deduction instead, we
	    # deduce the timezone by comparing the localtime result on a
	    # known GMT value.

	    AC_CHECK_LIB(bsd, gettimeofday, libbsd=yes, libbsd=no)
	    AS_IF([test $libbsd = yes], [
	    	MATH_LIBS="$MATH_LIBS -lbsd"
	    	AC_DEFINE(USE_DELTA_FOR_TZ, 1, [Do we need a special AIX hack for timezones?])
	    ])
	    ;;
	BeOS*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -nostart'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"

	    #-----------------------------------------------------------
	    # Check for inet_ntoa in -lbind, for BeOS (which also needs
	    # -lsocket, even if the network functions are in -lnet which
	    # is always linked to, for compatibility.
	    #-----------------------------------------------------------
	    AC_CHECK_LIB(bind, inet_ntoa, [LIBS="$LIBS -lbind -lsocket"])
	    ;;
	BSD/OS-2.1*|BSD/OS-3*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="shlicc -r"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	BSD/OS-4.*)
	    SHLIB_CFLAGS="-export-dynamic -fPIC"
	    SHLIB_LD='${CC} -shared'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -export-dynamic"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	dgux*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	HP-UX-*.11.*)
	    # Use updated header definitions where possible
	    AC_DEFINE(_XOPEN_SOURCE_EXTENDED, 1, [Do we want to use the XOPEN network library?])
	    # TEA specific: Needed by Tcl, but not most extensions
	    #AC_DEFINE(_XOPEN_SOURCE, 1, [Do we want to use the XOPEN network library?])
	    #LIBS="$LIBS -lxnet"               # Use the XOPEN network library

	    AS_IF([test "`uname -m`" = ia64], [
		SHLIB_SUFFIX=".so"
		# Use newer C++ library for C++ extensions
		#if test "$GCC" != "yes" ; then
		#   CPPFLAGS="-AA"
		#fi
	    ], [
		SHLIB_SUFFIX=".sl"
	    ])
	    AC_CHECK_LIB(dld, shl_load, tcl_ok=yes, tcl_ok=no)
	    AS_IF([test "$tcl_ok" = yes], [
		SHLIB_CFLAGS="+z"
		SHLIB_LD="ld -b"
		SHLIB_LD_LIBS='${LIBS}'
		DL_OBJS="tclLoadShl.o"
		DL_LIBS="-ldld"
		LDFLAGS="$LDFLAGS -Wl,-E"
		CC_SEARCH_FLAGS='-Wl,+s,+b,${LIB_RUNTIME_DIR}:.'
		LD_SEARCH_FLAGS='+s +b ${LIB_RUNTIME_DIR}:.'
		LD_LIBRARY_PATH_VAR="SHLIB_PATH"
	    ])
	    AS_IF([test "$GCC" = yes], [
		SHLIB_LD='${CC} -shared'
		SHLIB_LD_LIBS='${LIBS}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    ])

	    # Users may want PA-RISC 1.1/2.0 portable code - needs HP cc
	    #CFLAGS="$CFLAGS +DAportable"

	    # Check to enable 64-bit flags for compiler/linker
	    AS_IF([test "$do64bit" = "yes"], [
		AS_IF([test "$GCC" = yes], [
		    case `${CC} -dumpmachine` in
			hppa64*)
			    # 64-bit gcc in use.  Fix flags for GNU ld.
			    do64bit_ok=yes
			    SHLIB_LD='${CC} -shared'
			    SHLIB_LD_LIBS='${LIBS}'
			    AS_IF([test $doRpath = yes], [
				CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'])
			    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
			    ;;
			*)
			    AC_MSG_WARN([64bit mode not supported with GCC on $system])
			    ;;
		    esac
		], [
		    do64bit_ok=yes
		    CFLAGS="$CFLAGS +DD64"
		    LDFLAGS_ARCH="+DD64"
		])
	    ]) ;;
	HP-UX-*.08.*|HP-UX-*.09.*|HP-UX-*.10.*)
	    SHLIB_SUFFIX=".sl"
	    AC_CHECK_LIB(dld, shl_load, tcl_ok=yes, tcl_ok=no)
	    AS_IF([test "$tcl_ok" = yes], [
		SHLIB_CFLAGS="+z"
		SHLIB_LD="ld -b"
		SHLIB_LD_LIBS=""
		DL_OBJS="tclLoadShl.o"
		DL_LIBS="-ldld"
		LDFLAGS="$LDFLAGS -Wl,-E"
		CC_SEARCH_FLAGS='-Wl,+s,+b,${LIB_RUNTIME_DIR}:.'
		LD_SEARCH_FLAGS='+s +b ${LIB_RUNTIME_DIR}:.'
		LD_LIBRARY_PATH_VAR="SHLIB_PATH"
	    ]) ;;
	IRIX-5.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'])
	    ;;
	IRIX-6.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -n32 -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'])
	    AS_IF([test "$GCC" = yes], [
		CFLAGS="$CFLAGS -mabi=n32"
		LDFLAGS="$LDFLAGS -mabi=n32"
	    ], [
		case $system in
		    IRIX-6.3)
			# Use to build 6.2 compatible binaries on 6.3.
			CFLAGS="$CFLAGS -n32 -D_OLD_TERMIOS"
			;;
		    *)
			CFLAGS="$CFLAGS -n32"
			;;
		esac
		LDFLAGS="$LDFLAGS -n32"
	    ])
	    ;;
	IRIX64-6.*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD="ld -n32 -shared -rdata_shared"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'])

	    # Check to enable 64-bit flags for compiler/linker

	    AS_IF([test "$do64bit" = yes], [
	        AS_IF([test "$GCC" = yes], [
	            AC_MSG_WARN([64bit mode not supported by gcc])
	        ], [
	            do64bit_ok=yes
	            SHLIB_LD="ld -64 -shared -rdata_shared"
	            CFLAGS="$CFLAGS -64"
	            LDFLAGS_ARCH="-64"
	        ])
	    ])
	    ;;
	Linux*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    # TEA specific:
	    CFLAGS_OPTIMIZE="-O2 -fomit-frame-pointer"
	    # egcs-2.91.66 on Redhat Linux 6.0 generates lots of warnings 
	    # when you inline the string and math operations.  Turn this off to
	    # get rid of the warnings.
	    #CFLAGS_OPTIMIZE="${CFLAGS_OPTIMIZE} -D__NO_STRING_INLINES -D__NO_MATH_INLINES"

	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
	    SHLIB_LD='${CC} -shared ${CFLAGS} ${LDFLAGS_DEFAULT}'
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'])
	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    AS_IF([test "`uname -m`" = "alpha"], [CFLAGS="$CFLAGS -mieee"])
	    AS_IF([test $do64bit = yes], [
		AC_CACHE_CHECK([if compiler accepts -m64 flag], tcl_cv_cc_m64, [
		    hold_cflags=$CFLAGS
		    CFLAGS="$CFLAGS -m64"
		    AC_TRY_LINK(,, tcl_cv_cc_m64=yes, tcl_cv_cc_m64=no)
		    CFLAGS=$hold_cflags])
		AS_IF([test $tcl_cv_cc_m64 = yes], [
		    CFLAGS="$CFLAGS -m64"
		    do64bit_ok=yes
		])
	   ])

	    # The combo of gcc + glibc has a bug related to inlining of
	    # functions like strtod(). The -fno-builtin flag should address
	    # this problem but it does not work. The -fno-inline flag is kind
	    # of overkill but it works. Disable inlining only when one of the
	    # files in compat/*.c is being linked in.

	    AS_IF([test x"${USE_COMPAT}" != x],[CFLAGS="$CFLAGS -fno-inline"])

	    ;;
	GNU*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"

	    SHLIB_LD='${CC} -shared'
	    DL_OBJS=""
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,--export-dynamic"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    AS_IF([test "`uname -m`" = "alpha"], [CFLAGS="$CFLAGS -mieee"])
	    ;;
	Lynx*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    CFLAGS_OPTIMIZE=-02
	    SHLIB_LD='${CC} -shared'
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-mshared -ldl"
	    LD_FLAGS="-Wl,--export-dynamic"
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'])
	    ;;
	MP-RAS-02*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	MP-RAS-*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    LDFLAGS="$LDFLAGS -Wl,-Bexport"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	NetBSD-1.*|FreeBSD-[[1-2]].*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD="ld -Bshareable -x"
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'])
	    AC_CACHE_CHECK([for ELF], tcl_cv_ld_elf, [
		AC_EGREP_CPP(yes, [
#ifdef __ELF__
	yes
#endif
		], tcl_cv_ld_elf=yes, tcl_cv_ld_elf=no)])
	    AS_IF([test $tcl_cv_ld_elf = yes], [
		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so'
	    ], [
		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'
	    ])

	    # Ancient FreeBSD doesn't handle version numbers with dots.

	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	OpenBSD-*)
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -shared ${SHLIB_CFLAGS}'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'])
	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'
	    AC_CACHE_CHECK([for ELF], tcl_cv_ld_elf, [
		AC_EGREP_CPP(yes, [
#ifdef __ELF__
	yes
#endif
		], tcl_cv_ld_elf=yes, tcl_cv_ld_elf=no)])
	    AS_IF([test $tcl_cv_ld_elf = yes], [
		LDFLAGS=-Wl,-export-dynamic
	    ], [LDFLAGS=""])

	    # OpenBSD doesn't do version numbers with dots.
	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	NetBSD-*|FreeBSD-*)
	    # FreeBSD 3.* and greater have ELF.
	    # NetBSD 2.* has ELF and can use 'cc -shared' to build shared libs
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD='${CC} -shared ${SHLIB_CFLAGS}'
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    LDFLAGS="$LDFLAGS -export-dynamic"
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'])
	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    AS_IF([test "${TCL_THREADS}" = "1"], [
		# The -pthread needs to go in the CFLAGS, not LIBS
		LIBS=`echo $LIBS | sed s/-pthread//`
		CFLAGS="$CFLAGS -pthread"
	    	LDFLAGS="$LDFLAGS -pthread"
	    ])
	    case $system in
	    FreeBSD-3.*)
	    	# FreeBSD-3 doesn't handle version numbers with dots.
	    	UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    	SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so'
	    	TCL_LIB_VERSIONS_OK=nodots
		;;
	    esac
	    ;;
	Darwin-*)
	    CFLAGS_OPTIMIZE="-Os"
	    SHLIB_CFLAGS="-fno-common"
	    # To avoid discrepancies between what headers configure sees during
	    # preprocessing tests and compiling tests, move any -isysroot and
	    # -mmacosx-version-min flags from CFLAGS to CPPFLAGS:
	    CPPFLAGS="${CPPFLAGS} `echo " ${CFLAGS}" | \
		awk 'BEGIN {FS=" +-";ORS=" "}; {for (i=2;i<=NF;i++) \
		if ([$]i~/^(isysroot|mmacosx-version-min)/) print "-"[$]i}'`"
	    CFLAGS="`echo " ${CFLAGS}" | \
		awk 'BEGIN {FS=" +-";ORS=" "}; {for (i=2;i<=NF;i++) \
		if (!([$]i~/^(isysroot|mmacosx-version-min)/)) print "-"[$]i}'`"
	    AS_IF([test $do64bit = yes], [
		case `arch` in
		    ppc)
			AC_CACHE_CHECK([if compiler accepts -arch ppc64 flag],
				tcl_cv_cc_arch_ppc64, [
			    hold_cflags=$CFLAGS
			    CFLAGS="$CFLAGS -arch ppc64 -mpowerpc64 -mcpu=G5"
			    AC_TRY_LINK(,, tcl_cv_cc_arch_ppc64=yes,
				    tcl_cv_cc_arch_ppc64=no)
			    CFLAGS=$hold_cflags])
			AS_IF([test $tcl_cv_cc_arch_ppc64 = yes], [
			    CFLAGS="$CFLAGS -arch ppc64 -mpowerpc64 -mcpu=G5"
			    do64bit_ok=yes
			]);;
		    i386)
			AC_CACHE_CHECK([if compiler accepts -arch x86_64 flag],
				tcl_cv_cc_arch_x86_64, [
			    hold_cflags=$CFLAGS
			    CFLAGS="$CFLAGS -arch x86_64"
			    AC_TRY_LINK(,, tcl_cv_cc_arch_x86_64=yes,
				    tcl_cv_cc_arch_x86_64=no)
			    CFLAGS=$hold_cflags])
			AS_IF([test $tcl_cv_cc_arch_x86_64 = yes], [
			    CFLAGS="$CFLAGS -arch x86_64"
			    do64bit_ok=yes
			]);;
		    *)
			AC_MSG_WARN([Don't know how enable 64-bit on architecture `arch`]);;
		esac
	    ], [
		# Check for combined 32-bit and 64-bit fat build
		AS_IF([echo "$CFLAGS " |grep -E -q -- '-arch (ppc64|x86_64) ' \
		    && echo "$CFLAGS " |grep -E -q -- '-arch (ppc|i386) '], [
		    fat_32_64=yes])
	    ])
	    # TEA specific: use LDFLAGS_DEFAULT instead of LDFLAGS
	    SHLIB_LD='${CC} -dynamiclib ${CFLAGS} ${LDFLAGS_DEFAULT}'
	    AC_CACHE_CHECK([if ld accepts -single_module flag], tcl_cv_ld_single_module, [
		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -dynamiclib -Wl,-single_module"
		AC_TRY_LINK(, [int i;], tcl_cv_ld_single_module=yes, tcl_cv_ld_single_module=no)
		LDFLAGS=$hold_ldflags])
	    AS_IF([test $tcl_cv_ld_single_module = yes], [
		SHLIB_LD="${SHLIB_LD} -Wl,-single_module"
	    ])
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".dylib"
	    DL_OBJS="tclLoadDyld.o"
	    DL_LIBS=""
	    # Don't use -prebind when building for Mac OS X 10.4 or later only:
	    AS_IF([test "`echo "${MACOSX_DEPLOYMENT_TARGET}" | awk -F '10\\.' '{print int([$]2)}'`" -lt 4 -a \
		"`echo "${CPPFLAGS}" | awk -F '-mmacosx-version-min=10\\.' '{print int([$]2)}'`" -lt 4], [
		LDFLAGS="$LDFLAGS -prebind"])
	    LDFLAGS="$LDFLAGS -headerpad_max_install_names"
	    AC_CACHE_CHECK([if ld accepts -search_paths_first flag],
		    tcl_cv_ld_search_paths_first, [
		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -Wl,-search_paths_first"
		AC_TRY_LINK(, [int i;], tcl_cv_ld_search_paths_first=yes,
			tcl_cv_ld_search_paths_first=no)
		LDFLAGS=$hold_ldflags])
	    AS_IF([test $tcl_cv_ld_search_paths_first = yes], [
		LDFLAGS="$LDFLAGS -Wl,-search_paths_first"
	    ])
	    AS_IF([test "$tcl_cv_cc_visibility_hidden" != yes], [
		AC_DEFINE(MODULE_SCOPE, [__private_extern__],
		    [Compiler support for module scope symbols])
	    ])
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    LD_LIBRARY_PATH_VAR="DYLD_LIBRARY_PATH"
	    # TEA specific: for combined 32 & 64 bit fat builds of Tk
	    # extensions, verify that 64-bit build is possible.
	    AS_IF([test "$fat_32_64" = yes && test -n "${TK_BIN_DIR}"], [
		AS_IF([test "${TEA_WINDOWINGSYSTEM}" = x11], [
		    AC_CACHE_CHECK([for 64-bit X11], tcl_cv_lib_x11_64, [
			for v in CFLAGS CPPFLAGS LDFLAGS; do
			    eval 'hold_'$v'="$'$v'";'$v'="`echo "$'$v' "|sed -e "s/-arch ppc / /g" -e "s/-arch i386 / /g"`"'
			done
			CPPFLAGS="$CPPFLAGS -I/usr/X11R6/include"
			LDFLAGS="$LDFLAGS -L/usr/X11R6/lib -lX11"
			AC_TRY_LINK([#include <X11/Xlib.h>], [XrmInitialize();],
			    tcl_cv_lib_x11_64=yes, tcl_cv_lib_x11_64=no)
			for v in CFLAGS CPPFLAGS LDFLAGS; do
			    eval $v'="$hold_'$v'"'
			done])
		])
		# remove 64-bit arch flags from CFLAGS et al. if configuration
		# does not support 64-bit.
		AS_IF([test "${TEA_WINDOWINGSYSTEM}" = aqua -o "$tcl_cv_lib_x11_64" = no], [
		    AC_MSG_NOTICE([Removing 64-bit architectures from compiler & linker flags])
		    for v in CFLAGS CPPFLAGS LDFLAGS; do
			eval $v'="`echo "$'$v' "|sed -e "s/-arch ppc64 / /g" -e "s/-arch x86_64 / /g"`"'
		    done])
	    ])
	    ;;
	NEXTSTEP-*)
	    SHLIB_CFLAGS=""
	    SHLIB_LD='${CC} -nostdlib -r'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadNext.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OS/390-*)
	    CFLAGS_OPTIMIZE=""		# Optimizer is buggy
	    AC_DEFINE(_OE_SOCKETS, 1,	# needed in sys/socket.h
		[Should OS/390 do the right thing with sockets?])
	    ;;      
	OSF1-1.0|OSF1-1.1|OSF1-1.2)
	    # OSF/1 1.[012] from OSF, and derivatives, including Paragon OSF/1
	    SHLIB_CFLAGS=""
	    # Hack: make package name same as library name
	    SHLIB_LD='ld -R -export $@:'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadOSF.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OSF1-1.*)
	    # OSF/1 1.3 from OSF using ELF, and derivatives, including AD2
	    SHLIB_CFLAGS="-fPIC"
	    AS_IF([test "$SHARED_BUILD" = 1], [SHLIB_LD="ld -shared"], [
	        SHLIB_LD="ld -non_shared"
	    ])
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	OSF1-V*)
	    # Digital OSF/1
	    SHLIB_CFLAGS=""
	    AS_IF([test "$SHARED_BUILD" = 1], [
	        SHLIB_LD="${CC} -shared"
	    ], [
	        SHLIB_LD="${CC} -non_shared"
	    ])
	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    AS_IF([test $doRpath = yes], [
		CC_SEARCH_FLAGS='-Wl,-rpath,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-rpath ${LIB_RUNTIME_DIR}'])
	    AS_IF([test "$GCC" = yes], [CFLAGS="$CFLAGS -mieee"], [
		CFLAGS="$CFLAGS -DHAVE_TZSET -std1 -ieee"])
	    # see pthread_intro(3) for pthread support on osf1, k.furukawa
	    AS_IF([test "${TCL_THREADS}" = 1], [
		CFLAGS="$CFLAGS -DHAVE_PTHREAD_ATTR_SETSTACKSIZE"
		CFLAGS="$CFLAGS -DTCL_THREAD_STACK_MIN=PTHREAD_STACK_MIN*64"
		LIBS=`echo $LIBS | sed s/-lpthreads//`
		AS_IF([test "$GCC" = yes], [
		    LIBS="$LIBS -lpthread -lmach -lexc"
		], [
		    CFLAGS="$CFLAGS -pthread"
		    LDFLAGS="$LDFLAGS -pthread"
		])
	    ])
	    ;;
	QNX-6*)
	    # QNX RTP
	    # This may work for all QNX, but it was only reported for v6.
	    SHLIB_CFLAGS="-fPIC"
	    SHLIB_LD="ld -Bshareable -x"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    # dlopen is in -lc on QNX
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SCO_SV-3.2*)
	    # Note, dlopen is available only on SCO 3.2.5 and greater. However,
	    # this test works, since "uname -s" was non-standard in 3.2.4 and
	    # below.
	    AS_IF([test "$GCC" = yes], [
	    	SHLIB_CFLAGS="-fPIC -melf"
	    	LDFLAGS="$LDFLAGS -melf -Wl,-Bexport"
	    ], [
	    	SHLIB_CFLAGS="-Kpic -belf"
	    	LDFLAGS="$LDFLAGS -belf -Wl,-Bexport"
	    ])
	    SHLIB_LD="ld -G"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS=""
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SINIX*5.4*)
	    SHLIB_CFLAGS="-K PIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
	SunOS-4*)
	    SHLIB_CFLAGS="-PIC"
	    SHLIB_LD="ld"
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    CC_SEARCH_FLAGS='-L${LIB_RUNTIME_DIR}'
	    LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}

	    # SunOS can't handle version numbers with dots in them in library
	    # specs, like -ltcl7.5, so use -ltcl75 instead.  Also, it
	    # requires an extra version number at the end of .so file names.
	    # So, the library has to have a name like libtcl75.so.1.0

	    SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.so.1.0'
	    UNSHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}.a'
	    TCL_LIB_VERSIONS_OK=nodots
	    ;;
	SunOS-5.[[0-6]])
	    # Careful to not let 5.10+ fall into this case

	    # Note: If _REENTRANT isn't defined, then Solaris
	    # won't define thread-safe library routines.

	    AC_DEFINE(_REENTRANT, 1, [Do we want the reentrant OS API?])
	    AC_DEFINE(_POSIX_PTHREAD_SEMANTICS, 1,
		[Do we really want to follow the standard? Yes we do!])

	    SHLIB_CFLAGS="-KPIC"

	    # Note: need the LIBS below, otherwise Tk won't find Tcl's
	    # symbols when dynamically loaded into tclsh.

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    AS_IF([test "$GCC" = yes], [
		SHLIB_LD='${CC} -shared'
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    ], [
		SHLIB_LD="/usr/ccs/bin/ld -G -z text"
		CC_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
	    ])
	    ;;
	SunOS-5*)
	    # Note: If _REENTRANT isn't defined, then Solaris
	    # won't define thread-safe library routines.

	    AC_DEFINE(_REENTRANT, 1, [Do we want the reentrant OS API?])
	    AC_DEFINE(_POSIX_PTHREAD_SEMANTICS, 1,
		[Do we really want to follow the standard? Yes we do!])

	    SHLIB_CFLAGS="-KPIC"

	    # Check to enable 64-bit flags for compiler/linker
	    AS_IF([test "$do64bit" = yes], [
		arch=`isainfo`
		AS_IF([test "$arch" = "sparcv9 sparc"], [
		    AS_IF([test "$GCC" = yes], [
			AS_IF([test "`${CC} -dumpversion | awk -F. '{print [$]1}'`" -lt 3], [
			    AC_MSG_WARN([64bit mode not supported with GCC < 3.2 on $system])
			], [
			    do64bit_ok=yes
			    CFLAGS="$CFLAGS -m64 -mcpu=v9"
			    LDFLAGS="$LDFLAGS -m64 -mcpu=v9"
			    SHLIB_CFLAGS="-fPIC"
			])
		    ], [
			do64bit_ok=yes
			AS_IF([test "$do64bitVIS" = yes], [
			    CFLAGS="$CFLAGS -xarch=v9a"
			    LDFLAGS_ARCH="-xarch=v9a"
			], [
			    CFLAGS="$CFLAGS -xarch=v9"
			    LDFLAGS_ARCH="-xarch=v9"
			])
			# Solaris 64 uses this as well
			#LD_LIBRARY_PATH_VAR="LD_LIBRARY_PATH_64"
		    ])
		], [AS_IF([test "$arch" = "amd64 i386"], [
		    AS_IF([test "$GCC" = yes], [
			AC_MSG_WARN([64bit mode not supported with GCC on $system])
		    ], [
			do64bit_ok=yes
			CFLAGS="$CFLAGS -xarch=amd64"
			LDFLAGS="$LDFLAGS -xarch=amd64"
		    ])
		], [AC_MSG_WARN([64bit mode not supported for $arch])])])
	    ])
	    
	    # Note: need the LIBS below, otherwise Tk won't find Tcl's
	    # symbols when dynamically loaded into tclsh.

	    SHLIB_LD_LIBS='${LIBS}'
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    AS_IF([test "$GCC" = yes], [
		SHLIB_LD='${CC} -shared'
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS=${CC_SEARCH_FLAGS}
		AS_IF([test "$do64bit_ok" = yes], [
		    # We need to specify -static-libgcc or we need to
		    # add the path to the sparv9 libgcc.
		    # JH: static-libgcc is necessary for core Tcl, but may
		    # not be necessary for extensions.
		    SHLIB_LD="$SHLIB_LD -m64 -mcpu=v9 -static-libgcc"
		    # for finding sparcv9 libgcc, get the regular libgcc
		    # path, remove so name and append 'sparcv9'
		    #v9gcclibdir="`gcc -print-file-name=libgcc_s.so` | ..."
		    #CC_SEARCH_FLAGS="${CC_SEARCH_FLAGS},-R,$v9gcclibdir"
		])
	    ], [
		case $system in
		    SunOS-5.[[1-9]][[0-9]]*)
			SHLIB_LD='${CC} -G -z text ${LDFLAGS}';;
		    *)
			SHLIB_LD='/usr/ccs/bin/ld -G -z text';;
		esac
		CC_SEARCH_FLAGS='-Wl,-R,${LIB_RUNTIME_DIR}'
		LD_SEARCH_FLAGS='-R ${LIB_RUNTIME_DIR}'
	    ])
	    ;;
	UNIX_SV* | UnixWare-5*)
	    SHLIB_CFLAGS="-KPIC"
	    SHLIB_LD='${CC} -G'
	    SHLIB_LD_LIBS=""
	    SHLIB_SUFFIX=".so"
	    DL_OBJS="tclLoadDl.o"
	    DL_LIBS="-ldl"
	    # Some UNIX_SV* systems (unixware 1.1.2 for example) have linkers
	    # that don't grok the -Bexport option.  Test that it does.
	    AC_CACHE_CHECK([for ld accepts -Bexport flag], tcl_cv_ld_Bexport, [
		hold_ldflags=$LDFLAGS
		LDFLAGS="$LDFLAGS -Wl,-Bexport"
		AC_TRY_LINK(, [int i;], tcl_cv_ld_Bexport=yes, tcl_cv_ld_Bexport=no)
	        LDFLAGS=$hold_ldflags])
	    AS_IF([test $tcl_cv_ld_Bexport = yes], [
		LDFLAGS="$LDFLAGS -Wl,-Bexport"
	    ])
	    CC_SEARCH_FLAGS=""
	    LD_SEARCH_FLAGS=""
	    ;;
    esac

    AS_IF([test "$do64bit" = yes -a "$do64bit_ok" = no], [
	AC_MSG_WARN([64bit support being disabled -- don't know magic for this platform])
    ])

dnl # Add any CPPFLAGS set in the environment to our CFLAGS, but delay doing so
dnl # until the end of configure, as configure's compile and link tests use
dnl # both CPPFLAGS and CFLAGS (unlike our compile and link) but configure's
dnl # preprocessing tests use only CPPFLAGS.
    AC_CONFIG_COMMANDS_PRE([CFLAGS="${CFLAGS} ${CPPFLAGS}"; CPPFLAGS=""])

    # Step 4: disable dynamic loading if requested via a command-line switch.

    AC_ARG_ENABLE(load,
	AC_HELP_STRING([--enable-load],
	    [allow dynamic loading and "load" command (default: on)]),
	[tcl_ok=$enableval], [tcl_ok=yes])
    AS_IF([test "$tcl_ok" = no], [DL_OBJS=""])

    AS_IF([test "x$DL_OBJS" != x], [BUILD_DLTEST="\$(DLTEST_TARGETS)"], [
	AC_MSG_WARN([Can't figure out how to do dynamic loading or shared libraries on this system.])
	SHLIB_CFLAGS=""
	SHLIB_LD=""
	SHLIB_SUFFIX=""
	DL_OBJS="tclLoadNone.o"
	DL_LIBS=""
	LDFLAGS="$LDFLAGS_ORIG"
	CC_SEARCH_FLAGS=""
	LD_SEARCH_FLAGS=""
	BUILD_DLTEST=""
    ])
    LDFLAGS="$LDFLAGS $LDFLAGS_ARCH"

    # If we're running gcc, then change the C flags for compiling shared
    # libraries to the right flags for gcc, instead of those for the
    # standard manufacturer compiler.

    AS_IF([test "$DL_OBJS" != "tclLoadNone.o" -a "$GCC" = yes], [
	case $system in
	    AIX-*) ;;
	    BSD/OS*) ;;
	    IRIX*) ;;
	    NetBSD-*|FreeBSD-*) ;;
	    Darwin-*) ;;
	    SCO_SV-3.2*) ;;
	    *) SHLIB_CFLAGS="-fPIC" ;;
	esac])

    AS_IF([test "$SHARED_LIB_SUFFIX" = ""], [
	# TEA specific: use PACKAGE_VERSION instead of VERSION
	SHARED_LIB_SUFFIX='${PACKAGE_VERSION}${SHLIB_SUFFIX}'])
    AS_IF([test "$UNSHARED_LIB_SUFFIX" = ""], [
	# TEA specific: use PACKAGE_VERSION instead of VERSION
	UNSHARED_LIB_SUFFIX='${PACKAGE_VERSION}.a'])

    AC_SUBST(DL_LIBS)

    AC_SUBST(CFLAGS_DEBUG)
    AC_SUBST(CFLAGS_OPTIMIZE)
    AC_SUBST(CFLAGS_WARNING)

    AC_SUBST(STLIB_LD)
    AC_SUBST(SHLIB_LD)

    AC_SUBST(SHLIB_LD_LIBS)
    AC_SUBST(SHLIB_CFLAGS)

    AC_SUBST(LD_LIBRARY_PATH_VAR)

    # These must be called after we do the basic CFLAGS checks and
    # verify any possible 64-bit or similar switches are necessary
    TEA_TCL_EARLY_FLAGS
    TEA_TCL_64BIT_FLAGS
])

#--------------------------------------------------------------------
# TEA_SERIAL_PORT
#
#	Determine which interface to use to talk to the serial port.
#	Note that #include lines must begin in leftmost column for
#	some compilers to recognize them as preprocessor directives,
#	and some build environments have stdin not pointing at a
#	pseudo-terminal (usually /dev/null instead.)
#
# Arguments:
#	none
#	
# Results:
#
#	Defines only one of the following vars:
#		HAVE_SYS_MODEM_H
#		USE_TERMIOS
#		USE_TERMIO
#		USE_SGTTY
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_SERIAL_PORT], [
    AC_CHECK_HEADERS(sys/modem.h)
    AC_CACHE_CHECK([termios vs. termio vs. sgtty], tcl_cv_api_serial, [
    AC_TRY_RUN([
#include <termios.h>

int main() {
    struct termios t;
    if (tcgetattr(0, &t) == 0) {
	cfsetospeed(&t, 0);
	t.c_cflag |= PARENB | PARODD | CSIZE | CSTOPB;
	return 0;
    }
    return 1;
}], tcl_cv_api_serial=termios, tcl_cv_api_serial=no, tcl_cv_api_serial=no)
    if test $tcl_cv_api_serial = no ; then
	AC_TRY_RUN([
#include <termio.h>

int main() {
    struct termio t;
    if (ioctl(0, TCGETA, &t) == 0) {
	t.c_cflag |= CBAUD | PARENB | PARODD | CSIZE | CSTOPB;
	return 0;
    }
    return 1;
}], tcl_cv_api_serial=termio, tcl_cv_api_serial=no, tcl_cv_api_serial=no)
    fi
    if test $tcl_cv_api_serial = no ; then
	AC_TRY_RUN([
#include <sgtty.h>

int main() {
    struct sgttyb t;
    if (ioctl(0, TIOCGETP, &t) == 0) {
	t.sg_ospeed = 0;
	t.sg_flags |= ODDP | EVENP | RAW;
	return 0;
    }
    return 1;
}], tcl_cv_api_serial=sgtty, tcl_cv_api_serial=no, tcl_cv_api_serial=no)
    fi
    if test $tcl_cv_api_serial = no ; then
	AC_TRY_RUN([
#include <termios.h>
#include <errno.h>

int main() {
    struct termios t;
    if (tcgetattr(0, &t) == 0
	|| errno == ENOTTY || errno == ENXIO || errno == EINVAL) {
	cfsetospeed(&t, 0);
	t.c_cflag |= PARENB | PARODD | CSIZE | CSTOPB;
	return 0;
    }
    return 1;
}], tcl_cv_api_serial=termios, tcl_cv_api_serial=no, tcl_cv_api_serial=no)
    fi
    if test $tcl_cv_api_serial = no; then
	AC_TRY_RUN([
#include <termio.h>
#include <errno.h>

int main() {
    struct termio t;
    if (ioctl(0, TCGETA, &t) == 0
	|| errno == ENOTTY || errno == ENXIO || errno == EINVAL) {
	t.c_cflag |= CBAUD | PARENB | PARODD | CSIZE | CSTOPB;
	return 0;
    }
    return 1;
    }], tcl_cv_api_serial=termio, tcl_cv_api_serial=no, tcl_cv_api_serial=no)
    fi
    if test $tcl_cv_api_serial = no; then
	AC_TRY_RUN([
#include <sgtty.h>
#include <errno.h>

int main() {
    struct sgttyb t;
    if (ioctl(0, TIOCGETP, &t) == 0
	|| errno == ENOTTY || errno == ENXIO || errno == EINVAL) {
	t.sg_ospeed = 0;
	t.sg_flags |= ODDP | EVENP | RAW;
	return 0;
    }
    return 1;
}], tcl_cv_api_serial=sgtty, tcl_cv_api_serial=none, tcl_cv_api_serial=none)
    fi])
    case $tcl_cv_api_serial in
	termios) AC_DEFINE(USE_TERMIOS, 1, [Use the termios API for serial lines]);;
	termio)  AC_DEFINE(USE_TERMIO, 1, [Use the termio API for serial lines]);;
	sgtty)   AC_DEFINE(USE_SGTTY, 1, [Use the sgtty API for serial lines]);;
    esac
])

#--------------------------------------------------------------------
# TEA_MISSING_POSIX_HEADERS
#
#	Supply substitutes for missing POSIX header files.  Special
#	notes:
#	    - stdlib.h doesn't define strtol, strtoul, or
#	      strtod insome versions of SunOS
#	    - some versions of string.h don't declare procedures such
#	      as strstr
#
# Arguments:
#	none
#	
# Results:
#
#	Defines some of the following vars:
#		NO_DIRENT_H
#		NO_ERRNO_H
#		NO_VALUES_H
#		HAVE_LIMITS_H or NO_LIMITS_H
#		NO_STDLIB_H
#		NO_STRING_H
#		NO_SYS_WAIT_H
#		NO_DLFCN_H
#		HAVE_SYS_PARAM_H
#
#		HAVE_STRING_H ?
#
# tkUnixPort.h checks for HAVE_LIMITS_H, so do both HAVE and
# CHECK on limits.h
#--------------------------------------------------------------------

AC_DEFUN([TEA_MISSING_POSIX_HEADERS], [
    AC_CACHE_CHECK([dirent.h], tcl_cv_dirent_h, [
    AC_TRY_LINK([#include <sys/types.h>
#include <dirent.h>], [
#ifndef _POSIX_SOURCE
#   ifdef __Lynx__
	/*
	 * Generate compilation error to make the test fail:  Lynx headers
	 * are only valid if really in the POSIX environment.
	 */

	missing_procedure();
#   endif
#endif
DIR *d;
struct dirent *entryPtr;
char *p;
d = opendir("foobar");
entryPtr = readdir(d);
p = entryPtr->d_name;
closedir(d);
], tcl_cv_dirent_h=yes, tcl_cv_dirent_h=no)])

    if test $tcl_cv_dirent_h = no; then
	AC_DEFINE(NO_DIRENT_H, 1, [Do we have <dirent.h>?])
    fi

    # TEA specific:
    AC_CHECK_HEADER(errno.h, , [AC_DEFINE(NO_ERRNO_H, 1, [Do we have <errno.h>?])])
    AC_CHECK_HEADER(float.h, , [AC_DEFINE(NO_FLOAT_H, 1, [Do we have <float.h>?])])
    AC_CHECK_HEADER(values.h, , [AC_DEFINE(NO_VALUES_H, 1, [Do we have <values.h>?])])
    AC_CHECK_HEADER(limits.h,
	[AC_DEFINE(HAVE_LIMITS_H, 1, [Do we have <limits.h>?])],
	[AC_DEFINE(NO_LIMITS_H, 1, [Do we have <limits.h>?])])
    AC_CHECK_HEADER(stdlib.h, tcl_ok=1, tcl_ok=0)
    AC_EGREP_HEADER(strtol, stdlib.h, , tcl_ok=0)
    AC_EGREP_HEADER(strtoul, stdlib.h, , tcl_ok=0)
    AC_EGREP_HEADER(strtod, stdlib.h, , tcl_ok=0)
    if test $tcl_ok = 0; then
	AC_DEFINE(NO_STDLIB_H, 1, [Do we have <stdlib.h>?])
    fi
    AC_CHECK_HEADER(string.h, tcl_ok=1, tcl_ok=0)
    AC_EGREP_HEADER(strstr, string.h, , tcl_ok=0)
    AC_EGREP_HEADER(strerror, string.h, , tcl_ok=0)

    # See also memmove check below for a place where NO_STRING_H can be
    # set and why.

    if test $tcl_ok = 0; then
	AC_DEFINE(NO_STRING_H, 1, [Do we have <string.h>?])
    fi

    AC_CHECK_HEADER(sys/wait.h, , [AC_DEFINE(NO_SYS_WAIT_H, 1, [Do we have <sys/wait.h>?])])
    AC_CHECK_HEADER(dlfcn.h, , [AC_DEFINE(NO_DLFCN_H, 1, [Do we have <dlfcn.h>?])])

    # OS/390 lacks sys/param.h (and doesn't need it, by chance).
    AC_HAVE_HEADERS(sys/param.h)
])

#--------------------------------------------------------------------
# TEA_PATH_X
#
#	Locate the X11 header files and the X11 library archive.  Try
#	the ac_path_x macro first, but if it doesn't find the X stuff
#	(e.g. because there's no xmkmf program) then check through
#	a list of possible directories.  Under some conditions the
#	autoconf macro will return an include directory that contains
#	no include files, so double-check its result just to be safe.
#
#	This should be called after TEA_CONFIG_CFLAGS as setting the
#	LIBS line can confuse some configure macro magic.
#
# Arguments:
#	none
#	
# Results:
#
#	Sets the following vars:
#		XINCLUDES
#		XLIBSW
#		PKG_LIBS (appends to)
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_PATH_X], [
    if test "${TEA_WINDOWINGSYSTEM}" = "x11" ; then
	TEA_PATH_UNIX_X
    fi
])

AC_DEFUN([TEA_PATH_UNIX_X], [
    AC_PATH_X
    not_really_there=""
    if test "$no_x" = ""; then
	if test "$x_includes" = ""; then
	    AC_TRY_CPP([#include <X11/XIntrinsic.h>], , not_really_there="yes")
	else
	    if test ! -r $x_includes/X11/Intrinsic.h; then
		not_really_there="yes"
	    fi
	fi
    fi
    if test "$no_x" = "yes" -o "$not_really_there" = "yes"; then
	AC_MSG_CHECKING([for X11 header files])
	found_xincludes="no"
	AC_TRY_CPP([#include <X11/Intrinsic.h>], found_xincludes="yes", found_xincludes="no")
	if test "$found_xincludes" = "no"; then
	    dirs="/usr/unsupported/include /usr/local/include /usr/X386/include /usr/X11R6/include /usr/X11R5/include /usr/include/X11R5 /usr/include/X11R4 /usr/openwin/include /usr/X11/include /usr/sww/include"
	    for i in $dirs ; do
		if test -r $i/X11/Intrinsic.h; then
		    AC_MSG_RESULT([$i])
		    XINCLUDES=" -I$i"
		    found_xincludes="yes"
		    break
		fi
	    done
	fi
    else
	if test "$x_includes" != ""; then
	    XINCLUDES="-I$x_includes"
	    found_xincludes="yes"
	fi
    fi
    if test found_xincludes = "no"; then
	AC_MSG_RESULT([couldn't find any!])
    fi

    if test "$no_x" = yes; then
	AC_MSG_CHECKING([for X11 libraries])
	XLIBSW=nope
	dirs="/usr/unsupported/lib /usr/local/lib /usr/X386/lib /usr/X11R6/lib /usr/X11R5/lib /usr/lib/X11R5 /usr/lib/X11R4 /usr/openwin/lib /usr/X11/lib /usr/sww/X11/lib"
	for i in $dirs ; do
	    if test -r $i/libX11.a -o -r $i/libX11.so -o -r $i/libX11.sl; then
		AC_MSG_RESULT([$i])
		XLIBSW="-L$i -lX11"
		x_libraries="$i"
		break
	    fi
	done
    else
	if test "$x_libraries" = ""; then
	    XLIBSW=-lX11
	else
	    XLIBSW="-L$x_libraries -lX11"
	fi
    fi
    if test "$XLIBSW" = nope ; then
	AC_CHECK_LIB(Xwindow, XCreateWindow, XLIBSW=-lXwindow)
    fi
    if test "$XLIBSW" = nope ; then
	AC_MSG_RESULT([could not find any!  Using -lX11.])
	XLIBSW=-lX11
    fi
    # TEA specific:
    if test x"${XLIBSW}" != x ; then
	PKG_LIBS="${PKG_LIBS} ${XLIBSW}"
    fi
])

#--------------------------------------------------------------------
# TEA_BLOCKING_STYLE
#
#	The statements below check for systems where POSIX-style
#	non-blocking I/O (O_NONBLOCK) doesn't work or is unimplemented. 
#	On these systems (mostly older ones), use the old BSD-style
#	FIONBIO approach instead.
#
# Arguments:
#	none
#	
# Results:
#
#	Defines some of the following vars:
#		HAVE_SYS_IOCTL_H
#		HAVE_SYS_FILIO_H
#		USE_FIONBIO
#		O_NONBLOCK
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_BLOCKING_STYLE], [
    AC_CHECK_HEADERS(sys/ioctl.h)
    AC_CHECK_HEADERS(sys/filio.h)
    TEA_CONFIG_SYSTEM
    AC_MSG_CHECKING([FIONBIO vs. O_NONBLOCK for nonblocking I/O])
    case $system in
	# There used to be code here to use FIONBIO under AIX.  However, it
	# was reported that FIONBIO doesn't work under AIX 3.2.5.  Since
	# using O_NONBLOCK seems fine under AIX 4.*, I removed the FIONBIO
	# code (JO, 5/31/97).

	OSF*)
	    AC_DEFINE(USE_FIONBIO, 1, [Should we use FIONBIO?])
	    AC_MSG_RESULT([FIONBIO])
	    ;;
	SunOS-4*)
	    AC_DEFINE(USE_FIONBIO, 1, [Should we use FIONBIO?])
	    AC_MSG_RESULT([FIONBIO])
	    ;;
	*)
	    AC_MSG_RESULT([O_NONBLOCK])
	    ;;
    esac
])

#--------------------------------------------------------------------
# TEA_TIME_HANLDER
#
#	Checks how the system deals with time.h, what time structures
#	are used on the system, and what fields the structures have.
#
# Arguments:
#	none
#	
# Results:
#
#	Defines some of the following vars:
#		USE_DELTA_FOR_TZ
#		HAVE_TM_GMTOFF
#		HAVE_TM_TZADJ
#		HAVE_TIMEZONE_VAR
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_TIME_HANDLER], [
    AC_CHECK_HEADERS(sys/time.h)
    AC_HEADER_TIME
    AC_STRUCT_TIMEZONE

    AC_CHECK_FUNCS(gmtime_r localtime_r)

    AC_CACHE_CHECK([tm_tzadj in struct tm], tcl_cv_member_tm_tzadj, [
	AC_TRY_COMPILE([#include <time.h>], [struct tm tm; tm.tm_tzadj;],
	    tcl_cv_member_tm_tzadj=yes, tcl_cv_member_tm_tzadj=no)])
    if test $tcl_cv_member_tm_tzadj = yes ; then
	AC_DEFINE(HAVE_TM_TZADJ, 1, [Should we use the tm_tzadj field of struct tm?])
    fi

    AC_CACHE_CHECK([tm_gmtoff in struct tm], tcl_cv_member_tm_gmtoff, [
	AC_TRY_COMPILE([#include <time.h>], [struct tm tm; tm.tm_gmtoff;],
	    tcl_cv_member_tm_gmtoff=yes, tcl_cv_member_tm_gmtoff=no)])
    if test $tcl_cv_member_tm_gmtoff = yes ; then
	AC_DEFINE(HAVE_TM_GMTOFF, 1, [Should we use the tm_gmtoff field of struct tm?])
    fi

    #
    # Its important to include time.h in this check, as some systems
    # (like convex) have timezone functions, etc.
    #
    AC_CACHE_CHECK([long timezone variable], tcl_cv_timezone_long, [
	AC_TRY_COMPILE([#include <time.h>],
	    [extern long timezone;
	    timezone += 1;
	    exit (0);],
	    tcl_cv_timezone_long=yes, tcl_cv_timezone_long=no)])
    if test $tcl_cv_timezone_long = yes ; then
	AC_DEFINE(HAVE_TIMEZONE_VAR, 1, [Should we use the global timezone variable?])
    else
	#
	# On some systems (eg IRIX 6.2), timezone is a time_t and not a long.
	#
	AC_CACHE_CHECK([time_t timezone variable], tcl_cv_timezone_time, [
	    AC_TRY_COMPILE([#include <time.h>],
		[extern time_t timezone;
		timezone += 1;
		exit (0);],
		tcl_cv_timezone_time=yes, tcl_cv_timezone_time=no)])
	if test $tcl_cv_timezone_time = yes ; then
	    AC_DEFINE(HAVE_TIMEZONE_VAR, 1, [Should we use the global timezone variable?])
	fi
    fi
])

#--------------------------------------------------------------------
# TEA_BUGGY_STRTOD
#
#	Under Solaris 2.4, strtod returns the wrong value for the
#	terminating character under some conditions.  Check for this
#	and if the problem exists use a substitute procedure
#	"fixstrtod" (provided by Tcl) that corrects the error.
#	Also, on Compaq's Tru64 Unix 5.0,
#	strtod(" ") returns 0.0 instead of a failure to convert.
#
# Arguments:
#	none
#	
# Results:
#
#	Might defines some of the following vars:
#		strtod (=fixstrtod)
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_BUGGY_STRTOD], [
    AC_CHECK_FUNC(strtod, tcl_strtod=1, tcl_strtod=0)
    if test "$tcl_strtod" = 1; then
	AC_CACHE_CHECK([for Solaris2.4/Tru64 strtod bugs], tcl_cv_strtod_buggy,[
	    AC_TRY_RUN([
		extern double strtod();
		int main() {
		    char *infString="Inf", *nanString="NaN", *spaceString=" ";
		    char *term;
		    double value;
		    value = strtod(infString, &term);
		    if ((term != infString) && (term[-1] == 0)) {
			exit(1);
		    }
		    value = strtod(nanString, &term);
		    if ((term != nanString) && (term[-1] == 0)) {
			exit(1);
		    }
		    value = strtod(spaceString, &term);
		    if (term == (spaceString+1)) {
			exit(1);
		    }
		    exit(0);
		}], tcl_cv_strtod_buggy=ok, tcl_cv_strtod_buggy=buggy,
		    tcl_cv_strtod_buggy=buggy)])
	if test "$tcl_cv_strtod_buggy" = buggy; then
	    AC_LIBOBJ([fixstrtod])
	    USE_COMPAT=1
	    AC_DEFINE(strtod, fixstrtod, [Do we want to use the strtod() in compat?])
	fi
    fi
])

#--------------------------------------------------------------------
# TEA_TCL_LINK_LIBS
#
#	Search for the libraries needed to link the Tcl shell.
#	Things like the math library (-lm) and socket stuff (-lsocket vs.
#	-lnsl) are dealt with here.
#
# Arguments:
#	Requires the following vars to be set in the Makefile:
#		DL_LIBS
#		LIBS
#		MATH_LIBS
#	
# Results:
#
#	Subst's the following var:
#		TCL_LIBS
#		MATH_LIBS
#
#	Might append to the following vars:
#		LIBS
#
#	Might define the following vars:
#		HAVE_NET_ERRNO_H
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_TCL_LINK_LIBS], [
    #--------------------------------------------------------------------
    # On a few very rare systems, all of the libm.a stuff is
    # already in libc.a.  Set compiler flags accordingly.
    # Also, Linux requires the "ieee" library for math to work
    # right (and it must appear before "-lm").
    #--------------------------------------------------------------------

    AC_CHECK_FUNC(sin, MATH_LIBS="", MATH_LIBS="-lm")
    AC_CHECK_LIB(ieee, main, [MATH_LIBS="-lieee $MATH_LIBS"])

    #--------------------------------------------------------------------
    # Interactive UNIX requires -linet instead of -lsocket, plus it
    # needs net/errno.h to define the socket-related error codes.
    #--------------------------------------------------------------------

    AC_CHECK_LIB(inet, main, [LIBS="$LIBS -linet"])
    AC_CHECK_HEADER(net/errno.h, [
	AC_DEFINE(HAVE_NET_ERRNO_H, 1, [Do we have <net/errno.h>?])])

    #--------------------------------------------------------------------
    #	Check for the existence of the -lsocket and -lnsl libraries.
    #	The order here is important, so that they end up in the right
    #	order in the command line generated by make.  Here are some
    #	special considerations:
    #	1. Use "connect" and "accept" to check for -lsocket, and
    #	   "gethostbyname" to check for -lnsl.
    #	2. Use each function name only once:  can't redo a check because
    #	   autoconf caches the results of the last check and won't redo it.
    #	3. Use -lnsl and -lsocket only if they supply procedures that
    #	   aren't already present in the normal libraries.  This is because
    #	   IRIX 5.2 has libraries, but they aren't needed and they're
    #	   bogus:  they goof up name resolution if used.
    #	4. On some SVR4 systems, can't use -lsocket without -lnsl too.
    #	   To get around this problem, check for both libraries together
    #	   if -lsocket doesn't work by itself.
    #--------------------------------------------------------------------

    tcl_checkBoth=0
    AC_CHECK_FUNC(connect, tcl_checkSocket=0, tcl_checkSocket=1)
    if test "$tcl_checkSocket" = 1; then
	AC_CHECK_FUNC(setsockopt, , [AC_CHECK_LIB(socket, setsockopt,
	    LIBS="$LIBS -lsocket", tcl_checkBoth=1)])
    fi
    if test "$tcl_checkBoth" = 1; then
	tk_oldLibs=$LIBS
	LIBS="$LIBS -lsocket -lnsl"
	AC_CHECK_FUNC(accept, tcl_checkNsl=0, [LIBS=$tk_oldLibs])
    fi
    AC_CHECK_FUNC(gethostbyname, , [AC_CHECK_LIB(nsl, gethostbyname,
	    [LIBS="$LIBS -lnsl"])])
    
    # TEA specific: Don't perform the eval of the libraries here because
    # DL_LIBS won't be set until we call TEA_CONFIG_CFLAGS

    TCL_LIBS='${DL_LIBS} ${LIBS} ${MATH_LIBS}'
    AC_SUBST(TCL_LIBS)
    AC_SUBST(MATH_LIBS)
])

#--------------------------------------------------------------------
# TEA_TCL_EARLY_FLAGS
#
#	Check for what flags are needed to be passed so the correct OS
#	features are available.
#
# Arguments:
#	None
#	
# Results:
#
#	Might define the following vars:
#		_ISOC99_SOURCE
#		_LARGEFILE64_SOURCE
#		_LARGEFILE_SOURCE64
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_TCL_EARLY_FLAG],[
    AC_CACHE_VAL([tcl_cv_flag_]translit($1,[A-Z],[a-z]),
	AC_TRY_COMPILE([$2], $3, [tcl_cv_flag_]translit($1,[A-Z],[a-z])=no,
	    AC_TRY_COMPILE([[#define ]$1[ 1
]$2], $3,
		[tcl_cv_flag_]translit($1,[A-Z],[a-z])=yes,
		[tcl_cv_flag_]translit($1,[A-Z],[a-z])=no)))
    if test ["x${tcl_cv_flag_]translit($1,[A-Z],[a-z])[}" = "xyes"] ; then
	AC_DEFINE($1, 1, [Add the ]$1[ flag when building])
	tcl_flags="$tcl_flags $1"
    fi
])

AC_DEFUN([TEA_TCL_EARLY_FLAGS],[
    AC_MSG_CHECKING([for required early compiler flags])
    tcl_flags=""
    TEA_TCL_EARLY_FLAG(_ISOC99_SOURCE,[#include <stdlib.h>],
	[char *p = (char *)strtoll; char *q = (char *)strtoull;])
    TEA_TCL_EARLY_FLAG(_LARGEFILE64_SOURCE,[#include <sys/stat.h>],
	[struct stat64 buf; int i = stat64("/", &buf);])
    TEA_TCL_EARLY_FLAG(_LARGEFILE_SOURCE64,[#include <sys/stat.h>],
	[char *p = (char *)open64;])
    if test "x${tcl_flags}" = "x" ; then
	AC_MSG_RESULT([none])
    else
	AC_MSG_RESULT([${tcl_flags}])
    fi
])

#--------------------------------------------------------------------
# TEA_TCL_64BIT_FLAGS
#
#	Check for what is defined in the way of 64-bit features.
#
# Arguments:
#	None
#	
# Results:
#
#	Might define the following vars:
#		TCL_WIDE_INT_IS_LONG
#		TCL_WIDE_INT_TYPE
#		HAVE_STRUCT_DIRENT64
#		HAVE_STRUCT_STAT64
#		HAVE_TYPE_OFF64_T
#
#--------------------------------------------------------------------

AC_DEFUN([TEA_TCL_64BIT_FLAGS], [
    AC_MSG_CHECKING([for 64-bit integer type])
    AC_CACHE_VAL(tcl_cv_type_64bit,[
	tcl_cv_type_64bit=none
	# See if the compiler knows natively about __int64
	AC_TRY_COMPILE(,[__int64 value = (__int64) 0;],
	    tcl_type_64bit=__int64, tcl_type_64bit="long long")
	# See if we should use long anyway  Note that we substitute in the
	# type that is our current guess for a 64-bit type inside this check
	# program, so it should be modified only carefully...
        AC_TRY_COMPILE(,[switch (0) { 
            case 1: case (sizeof(]${tcl_type_64bit}[)==sizeof(long)): ; 
        }],tcl_cv_type_64bit=${tcl_type_64bit})])
    if test "${tcl_cv_type_64bit}" = none ; then
	AC_DEFINE(TCL_WIDE_INT_IS_LONG, 1, [Are wide integers to be implemented with C 'long's?])
	AC_MSG_RESULT([using long])
    elif test "${tcl_cv_type_64bit}" = "__int64" \
		-a "${TEA_PLATFORM}" = "windows" ; then
	# TEA specific: We actually want to use the default tcl.h checks in
	# this case to handle both TCL_WIDE_INT_TYPE and TCL_LL_MODIFIER*
	AC_MSG_RESULT([using Tcl header defaults])
    else
	AC_DEFINE_UNQUOTED(TCL_WIDE_INT_TYPE,${tcl_cv_type_64bit},
	    [What type should be used to define wide integers?])
	AC_MSG_RESULT([${tcl_cv_type_64bit}])

	# Now check for auxiliary declarations
	AC_CACHE_CHECK([for struct dirent64], tcl_cv_struct_dirent64,[
	    AC_TRY_COMPILE([#include <sys/types.h>
#include <sys/dirent.h>],[struct dirent64 p;],
		tcl_cv_struct_dirent64=yes,tcl_cv_struct_dirent64=no)])
	if test "x${tcl_cv_struct_dirent64}" = "xyes" ; then
	    AC_DEFINE(HAVE_STRUCT_DIRENT64, 1, [Is 'struct dirent64' in <sys/types.h>?])
	fi

	AC_CACHE_CHECK([for struct stat64], tcl_cv_struct_stat64,[
	    AC_TRY_COMPILE([#include <sys/stat.h>],[struct stat64 p;
],
		tcl_cv_struct_stat64=yes,tcl_cv_struct_stat64=no)])
	if test "x${tcl_cv_struct_stat64}" = "xyes" ; then
	    AC_DEFINE(HAVE_STRUCT_STAT64, 1, [Is 'struct stat64' in <sys/stat.h>?])
	fi

	AC_CHECK_FUNCS(open64 lseek64)
	AC_MSG_CHECKING([for off64_t])
	AC_CACHE_VAL(tcl_cv_type_off64_t,[
	    AC_TRY_COMPILE([#include <sys/types.h>],[off64_t offset;
],
		tcl_cv_type_off64_t=yes,tcl_cv_type_off64_t=no)])
	dnl Define HAVE_TYPE_OFF64_T only when the off64_t type and the
	dnl functions lseek64 and open64 are defined.
	if test "x${tcl_cv_type_off64_t}" = "xyes" && \
	        test "x${ac_cv_func_lseek64}" = "xyes" && \
	        test "x${ac_cv_func_open64}" = "xyes" ; then
	    AC_DEFINE(HAVE_TYPE_OFF64_T, 1, [Is off64_t in <sys/types.h>?])
	    AC_MSG_RESULT([yes])
	else
	    AC_MSG_RESULT([no])
	fi
    fi
])

##
## Here ends the standard Tcl configuration bits and starts the
## TEA specific functions
##

#------------------------------------------------------------------------
# TEA_INIT --
#
#	Init various Tcl Extension Architecture (TEA) variables.
#	This should be the first called TEA_* macro.
#
# Arguments:
#	none
#
# Results:
#
#	Defines and substs the following vars:
#		CYGPATH
#		EXEEXT
#	Defines only:
#		TEA_VERSION
#		TEA_INITED
#		TEA_PLATFORM (windows or unix)
#
# "cygpath" is used on windows to generate native path names for include
# files. These variables should only be used with the compiler and linker
# since they generate native path names.
#
# EXEEXT
#	Select the executable extension based on the host type.  This
#	is a lightweight replacement for AC_EXEEXT that doesn't require
#	a compiler.
#------------------------------------------------------------------------

AC_DEFUN([TEA_INIT], [
    # TEA extensions pass this us the version of TEA they think they
    # are compatible with.
    TEA_VERSION="3.6"

    AC_MSG_CHECKING([for correct TEA configuration])
    if test x"${PACKAGE_NAME}" = x ; then
	AC_MSG_ERROR([
The PACKAGE_NAME variable must be defined by your TEA configure.in])
    fi
    if test x"$1" = x ; then
	AC_MSG_ERROR([
TEA version not specified.])
    elif test "$1" != "${TEA_VERSION}" ; then
	AC_MSG_RESULT([warning: requested TEA version "$1", have "${TEA_VERSION}"])
    else
	AC_MSG_RESULT([ok (TEA ${TEA_VERSION})])
    fi
    case "`uname -s`" in
	*win32*|*WIN32*|*CYGWIN_NT*|*CYGWIN_9*|*CYGWIN_ME*|*MINGW32_*)
	    AC_CHECK_PROG(CYGPATH, cygpath, cygpath -w, echo)
	    EXEEXT=".exe"
	    TEA_PLATFORM="windows"
	    ;;
	*)
	    CYGPATH=echo
	    EXEEXT=""
	    TEA_PLATFORM="unix"
	    ;;
    esac

    # Check if exec_prefix is set. If not use fall back to prefix.
    # Note when adjusted, so that TEA_PREFIX can correct for this.
    # This is needed for recursive configures, since autoconf propagates
    # $prefix, but not $exec_prefix (doh!).
    if test x$exec_prefix = xNONE ; then
	exec_prefix_default=yes
	exec_prefix=$prefix
    fi

    AC_SUBST(EXEEXT)
    AC_SUBST(CYGPATH)

    # This package name must be replaced statically for AC_SUBST to work
    AC_SUBST(PKG_LIB_FILE)
    # Substitute STUB_LIB_FILE in case package creates a stub library too.
    AC_SUBST(PKG_STUB_LIB_FILE)

    # We AC_SUBST these here to ensure they are subst'ed,
    # in case the user doesn't call TEA_ADD_...
    AC_SUBST(PKG_STUB_SOURCES)
    AC_SUBST(PKG_STUB_OBJECTS)
    AC_SUBST(PKG_TCL_SOURCES)
    AC_SUBST(PKG_HEADERS)
    AC_SUBST(PKG_INCLUDES)
    AC_SUBST(PKG_LIBS)
    AC_SUBST(PKG_CFLAGS)
])

#------------------------------------------------------------------------
# TEA_ADD_SOURCES --
#
#	Specify one or more source files.  Users should check for
#	the right platform before adding to their list.
#	It is not important to specify the directory, as long as it is
#	in the generic, win or unix subdirectory of $(srcdir).
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_SOURCES
#		PKG_OBJECTS
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_SOURCES], [
    vars="$@"
    for i in $vars; do
	case $i in
	    [\$]*)
		# allow $-var names
		PKG_SOURCES="$PKG_SOURCES $i"
		PKG_OBJECTS="$PKG_OBJECTS $i"
		;;
	    *)
		# check for existence - allows for generic/win/unix VPATH
		# To add more dirs here (like 'src'), you have to update VPATH
		# in Makefile.in as well
		if test ! -f "${srcdir}/$i" -a ! -f "${srcdir}/generic/$i" \
		    -a ! -f "${srcdir}/win/$i" -a ! -f "${srcdir}/unix/$i" \
		    ; then
		    AC_MSG_ERROR([could not find source file '$i'])
		fi
		PKG_SOURCES="$PKG_SOURCES $i"
		# this assumes it is in a VPATH dir
		i=`basename $i`
		# handle user calling this before or after TEA_SETUP_COMPILER
		if test x"${OBJEXT}" != x ; then
		    j="`echo $i | sed -e 's/\.[[^.]]*$//'`.${OBJEXT}"
		else
		    j="`echo $i | sed -e 's/\.[[^.]]*$//'`.\${OBJEXT}"
		fi
		PKG_OBJECTS="$PKG_OBJECTS $j"
		;;
	esac
    done
    AC_SUBST(PKG_SOURCES)
    AC_SUBST(PKG_OBJECTS)
])

#------------------------------------------------------------------------
# TEA_ADD_STUB_SOURCES --
#
#	Specify one or more source files.  Users should check for
#	the right platform before adding to their list.
#	It is not important to specify the directory, as long as it is
#	in the generic, win or unix subdirectory of $(srcdir).
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_STUB_SOURCES
#		PKG_STUB_OBJECTS
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_STUB_SOURCES], [
    vars="$@"
    for i in $vars; do
	# check for existence - allows for generic/win/unix VPATH
	if test ! -f "${srcdir}/$i" -a ! -f "${srcdir}/generic/$i" \
	    -a ! -f "${srcdir}/win/$i" -a ! -f "${srcdir}/unix/$i" \
	    ; then
	    AC_MSG_ERROR([could not find stub source file '$i'])
	fi
	PKG_STUB_SOURCES="$PKG_STUB_SOURCES $i"
	# this assumes it is in a VPATH dir
	i=`basename $i`
	# handle user calling this before or after TEA_SETUP_COMPILER
	if test x"${OBJEXT}" != x ; then
	    j="`echo $i | sed -e 's/\.[[^.]]*$//'`.${OBJEXT}"
	else
	    j="`echo $i | sed -e 's/\.[[^.]]*$//'`.\${OBJEXT}"
	fi
	PKG_STUB_OBJECTS="$PKG_STUB_OBJECTS $j"
    done
    AC_SUBST(PKG_STUB_SOURCES)
    AC_SUBST(PKG_STUB_OBJECTS)
])

#------------------------------------------------------------------------
# TEA_ADD_TCL_SOURCES --
#
#	Specify one or more Tcl source files.  These should be platform
#	independent runtime files.
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_TCL_SOURCES
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_TCL_SOURCES], [
    vars="$@"
    for i in $vars; do
	# check for existence, be strict because it is installed
	if test ! -f "${srcdir}/$i" ; then
	    AC_MSG_ERROR([could not find tcl source file '${srcdir}/$i'])
	fi
	PKG_TCL_SOURCES="$PKG_TCL_SOURCES $i"
    done
    AC_SUBST(PKG_TCL_SOURCES)
])

#------------------------------------------------------------------------
# TEA_ADD_HEADERS --
#
#	Specify one or more source headers.  Users should check for
#	the right platform before adding to their list.
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_HEADERS
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_HEADERS], [
    vars="$@"
    for i in $vars; do
	# check for existence, be strict because it is installed
	if test ! -f "${srcdir}/$i" ; then
	    AC_MSG_ERROR([could not find header file '${srcdir}/$i'])
	fi
	PKG_HEADERS="$PKG_HEADERS $i"
    done
    AC_SUBST(PKG_HEADERS)
])

#------------------------------------------------------------------------
# TEA_ADD_INCLUDES --
#
#	Specify one or more include dirs.  Users should check for
#	the right platform before adding to their list.
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_INCLUDES
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_INCLUDES], [
    vars="$@"
    for i in $vars; do
	PKG_INCLUDES="$PKG_INCLUDES $i"
    done
    AC_SUBST(PKG_INCLUDES)
])

#------------------------------------------------------------------------
# TEA_ADD_LIBS --
#
#	Specify one or more libraries.  Users should check for
#	the right platform before adding to their list.  For Windows,
#	libraries provided in "foo.lib" format will be converted to
#	"-lfoo" when using GCC (mingw).
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_LIBS
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_LIBS], [
    vars="$@"
    for i in $vars; do
	if test "${TEA_PLATFORM}" = "windows" -a "$GCC" = "yes" ; then
	    # Convert foo.lib to -lfoo for GCC.  No-op if not *.lib
	    i=`echo "$i" | sed -e 's/^\([[^-]].*\)\.lib[$]/-l\1/i'`
	fi
	PKG_LIBS="$PKG_LIBS $i"
    done
    AC_SUBST(PKG_LIBS)
])

#------------------------------------------------------------------------
# TEA_ADD_CFLAGS --
#
#	Specify one or more CFLAGS.  Users should check for
#	the right platform before adding to their list.
#
# Arguments:
#	one or more file names
#
# Results:
#
#	Defines and substs the following vars:
#		PKG_CFLAGS
#------------------------------------------------------------------------
AC_DEFUN([TEA_ADD_CFLAGS], [
    PKG_CFLAGS="$PKG_CFLAGS $@"
    AC_SUBST(PKG_CFLAGS)
])

#------------------------------------------------------------------------
# TEA_PREFIX --
#
#	Handle the --prefix=... option by defaulting to what Tcl gave
#
# Arguments:
#	none
#
# Results:
#
#	If --prefix or --exec-prefix was not specified, $prefix and
#	$exec_prefix will be set to the values given to Tcl when it was
#	configured.
#------------------------------------------------------------------------
AC_DEFUN([TEA_PREFIX], [
    if test "${prefix}" = "NONE"; then
	prefix_default=yes
	if test x"${TCL_PREFIX}" != x; then
	    AC_MSG_NOTICE([--prefix defaulting to TCL_PREFIX ${TCL_PREFIX}])
	    prefix=${TCL_PREFIX}
	else
	    AC_MSG_NOTICE([--prefix defaulting to /usr/local])
	    prefix=/usr/local
	fi
    fi
    if test "${exec_prefix}" = "NONE" -a x"${prefix_default}" = x"yes" \
	-o x"${exec_prefix_default}" = x"yes" ; then
	if test x"${TCL_EXEC_PREFIX}" != x; then
	    AC_MSG_NOTICE([--exec-prefix defaulting to TCL_EXEC_PREFIX ${TCL_EXEC_PREFIX}])
	    exec_prefix=${TCL_EXEC_PREFIX}
	else
	    AC_MSG_NOTICE([--exec-prefix defaulting to ${prefix}])
	    exec_prefix=$prefix
	fi
    fi
])

#------------------------------------------------------------------------
# TEA_SETUP_COMPILER_CC --
#
#	Do compiler checks the way we want.  This is just a replacement
#	for AC_PROG_CC in TEA configure.in files to make them cleaner.
#
# Arguments:
#	none
#
# Results:
#
#	Sets up CC var and other standard bits we need to make executables.
#------------------------------------------------------------------------
AC_DEFUN([TEA_SETUP_COMPILER_CC], [
    # Don't put any macros that use the compiler (e.g. AC_TRY_COMPILE)
    # in this macro, they need to go into TEA_SETUP_COMPILER instead.

    # If the user did not set CFLAGS, set it now to keep
    # the AC_PROG_CC macro from adding "-g -O2".
    if test "${CFLAGS+set}" != "set" ; then
	CFLAGS=""
    fi

    AC_PROG_CC
    AC_PROG_CPP

    AC_PROG_INSTALL

    #--------------------------------------------------------------------
    # Checks to see if the make program sets the $MAKE variable.
    #--------------------------------------------------------------------

    AC_PROG_MAKE_SET

    #--------------------------------------------------------------------
    # Find ranlib
    #--------------------------------------------------------------------

    AC_PROG_RANLIB

    #--------------------------------------------------------------------
    # Determines the correct binary file extension (.o, .obj, .exe etc.)
    #--------------------------------------------------------------------

    AC_OBJEXT
    AC_EXEEXT
])

#------------------------------------------------------------------------
# TEA_SETUP_COMPILER --
#
#	Do compiler checks that use the compiler.  This must go after
#	TEA_SETUP_COMPILER_CC, which does the actual compiler check.
#
# Arguments:
#	none
#
# Results:
#
#	Sets up CC var and other standard bits we need to make executables.
#------------------------------------------------------------------------
AC_DEFUN([TEA_SETUP_COMPILER], [
    # Any macros that use the compiler (e.g. AC_TRY_COMPILE) have to go here.
    AC_REQUIRE([TEA_SETUP_COMPILER_CC])

    #------------------------------------------------------------------------
    # If we're using GCC, see if the compiler understands -pipe. If so, use it.
    # It makes compiling go faster.  (This is only a performance feature.)
    #------------------------------------------------------------------------

    if test -z "$no_pipe" -a -n "$GCC"; then
	AC_CACHE_CHECK([if the compiler understands -pipe],
	    tcl_cv_cc_pipe, [
	    hold_cflags=$CFLAGS; CFLAGS="$CFLAGS -pipe"
	    AC_TRY_COMPILE(,, tcl_cv_cc_pipe=yes, tcl_cv_cc_pipe=no)
	    CFLAGS=$hold_cflags])
	if test $tcl_cv_cc_pipe = yes; then
	    CFLAGS="$CFLAGS -pipe"
	fi
    fi

    #--------------------------------------------------------------------
    # Common compiler flag setup
    #--------------------------------------------------------------------

    AC_C_BIGENDIAN
    if test "${TEA_PLATFORM}" = "unix" ; then
	TEA_TCL_LINK_LIBS
	TEA_MISSING_POSIX_HEADERS
	# Let the user call this, because if it triggers, they will
	# need a compat/strtod.c that is correct.  Users can also
	# use Tcl_GetDouble(FromObj) instead.
	#TEA_BUGGY_STRTOD
    fi
])

#------------------------------------------------------------------------
# TEA_MAKE_LIB --
#
#	Generate a line that can be used to build a shared/unshared library
#	in a platform independent manner.
#
# Arguments:
#	none
#
#	Requires:
#
# Results:
#
#	Defines the following vars:
#	CFLAGS -	Done late here to note disturb other AC macros
#       MAKE_LIB -      Command to execute to build the Tcl library;
#                       differs depending on whether or not Tcl is being
#                       compiled as a shared library.
#	MAKE_SHARED_LIB	Makefile rule for building a shared library
#	MAKE_STATIC_LIB	Makefile rule for building a static library
#	MAKE_STUB_LIB	Makefile rule for building a stub library
#------------------------------------------------------------------------

AC_DEFUN([TEA_MAKE_LIB], [
    if test "${TEA_PLATFORM}" = "windows" -a "$GCC" != "yes"; then
	MAKE_STATIC_LIB="\${STLIB_LD} -out:\[$]@ \$(PKG_OBJECTS)"
	MAKE_SHARED_LIB="\${SHLIB_LD} \${SHLIB_LD_LIBS} \${LDFLAGS_DEFAULT} -out:\[$]@ \$(PKG_OBJECTS)"
	MAKE_STUB_LIB="\${STLIB_LD} -out:\[$]@ \$(PKG_STUB_OBJECTS)"
    else
	MAKE_STATIC_LIB="\${STLIB_LD} \[$]@ \$(PKG_OBJECTS)"
	MAKE_SHARED_LIB="\${SHLIB_LD} -o \[$]@ \$(PKG_OBJECTS) \${SHLIB_LD_LIBS}"
	MAKE_STUB_LIB="\${STLIB_LD} \[$]@ \$(PKG_STUB_OBJECTS)"
    fi

    if test "${SHARED_BUILD}" = "1" ; then
	MAKE_LIB="${MAKE_SHARED_LIB} "
    else
	MAKE_LIB="${MAKE_STATIC_LIB} "
    fi

    #--------------------------------------------------------------------
    # Shared libraries and static libraries have different names.
    # Use the double eval to make sure any variables in the suffix is
    # substituted. (@@@ Might not be necessary anymore)
    #--------------------------------------------------------------------

    if test "${TEA_PLATFORM}" = "windows" ; then
	if test "${SHARED_BUILD}" = "1" ; then
	    # We force the unresolved linking of symbols that are really in
	    # the private libraries of Tcl and Tk.
	    SHLIB_LD_LIBS="${SHLIB_LD_LIBS} \"`${CYGPATH} ${TCL_BIN_DIR}/${TCL_STUB_LIB_FILE}`\""
	    if test x"${TK_BIN_DIR}" != x ; then
		SHLIB_LD_LIBS="${SHLIB_LD_LIBS} \"`${CYGPATH} ${TK_BIN_DIR}/${TK_STUB_LIB_FILE}`\""
	    fi
	    eval eval "PKG_LIB_FILE=${PACKAGE_NAME}${SHARED_LIB_SUFFIX}"
	else
	    eval eval "PKG_LIB_FILE=${PACKAGE_NAME}${UNSHARED_LIB_SUFFIX}"
	fi
	# Some packages build their own stubs libraries
	eval eval "PKG_STUB_LIB_FILE=${PACKAGE_NAME}stub${UNSHARED_LIB_SUFFIX}"
	if test "$GCC" = "yes"; then
	    PKG_STUB_LIB_FILE=lib${PKG_STUB_LIB_FILE}
	fi
	# These aren't needed on Windows (either MSVC or gcc)
	RANLIB=:
	RANLIB_STUB=:
    else
	RANLIB_STUB="${RANLIB}"
	if test "${SHARED_BUILD}" = "1" ; then
	    SHLIB_LD_LIBS="${SHLIB_LD_LIBS} ${TCL_STUB_LIB_SPEC}"
	    if test x"${TK_BIN_DIR}" != x ; then
		SHLIB_LD_LIBS="${SHLIB_LD_LIBS} ${TK_STUB_LIB_SPEC}"
	    fi
	    eval eval "PKG_LIB_FILE=lib${PACKAGE_NAME}${SHARED_LIB_SUFFIX}"
	    RANLIB=:
	else
	    eval eval "PKG_LIB_FILE=lib${PACKAGE_NAME}${UNSHARED_LIB_SUFFIX}"
	fi
	# Some packages build their own stubs libraries
	eval eval "PKG_STUB_LIB_FILE=lib${PACKAGE_NAME}stub${UNSHARED_LIB_SUFFIX}"
    fi

    # These are escaped so that only CFLAGS is picked up at configure time.
    # The other values will be substituted at make time.
    CFLAGS="${CFLAGS} \${CFLAGS_DEFAULT} \${CFLAGS_WARNING}"
    if test "${SHARED_BUILD}" = "1" ; then
	CFLAGS="${CFLAGS} \${SHLIB_CFLAGS}"
    fi

    AC_SUBST(MAKE_LIB)
    AC_SUBST(MAKE_SHARED_LIB)
    AC_SUBST(MAKE_STATIC_LIB)
    AC_SUBST(MAKE_STUB_LIB)
    AC_SUBST(RANLIB_STUB)
])

#------------------------------------------------------------------------
# TEA_LIB_SPEC --
#
#	Compute the name of an existing object library located in libdir
#	from the given base name and produce the appropriate linker flags.
#
# Arguments:
#	basename	The base name of the library without version
#			numbers, extensions, or "lib" prefixes.
#	extra_dir	Extra directory in which to search for the
#			library.  This location is used first, then
#			$prefix/$exec-prefix, then some defaults.
#
# Requires:
#	TEA_INIT and TEA_PREFIX must be called first.
#
# Results:
#
#	Defines the following vars:
#		${basename}_LIB_NAME	The computed library name.
#		${basename}_LIB_SPEC	The computed linker flags.
#------------------------------------------------------------------------

AC_DEFUN([TEA_LIB_SPEC], [
    AC_MSG_CHECKING([for $1 library])

    # Look in exec-prefix for the library (defined by TEA_PREFIX).

    tea_lib_name_dir="${exec_prefix}/lib"

    # Or in a user-specified location.

    if test x"$2" != x ; then
	tea_extra_lib_dir=$2
    else
	tea_extra_lib_dir=NONE
    fi

    for i in \
	    `ls -dr ${tea_extra_lib_dir}/$1[[0-9]]*.lib 2>/dev/null ` \
	    `ls -dr ${tea_extra_lib_dir}/lib$1[[0-9]]* 2>/dev/null ` \
	    `ls -dr ${tea_lib_name_dir}/$1[[0-9]]*.lib 2>/dev/null ` \
	    `ls -dr ${tea_lib_name_dir}/lib$1[[0-9]]* 2>/dev/null ` \
	    `ls -dr /usr/lib/$1[[0-9]]*.lib 2>/dev/null ` \
	    `ls -dr /usr/lib/lib$1[[0-9]]* 2>/dev/null ` \
	    `ls -dr /usr/local/lib/$1[[0-9]]*.lib 2>/dev/null ` \
	    `ls -dr /usr/local/lib/lib$1[[0-9]]* 2>/dev/null ` ; do
	if test -f "$i" ; then
	    tea_lib_name_dir=`dirname $i`
	    $1_LIB_NAME=`basename $i`
	    $1_LIB_PATH_NAME=$i
	    break
	fi
    done

    if test "${TEA_PLATFORM}" = "windows"; then
	$1_LIB_SPEC=\"`${CYGPATH} ${$1_LIB_PATH_NAME} 2>/dev/null`\"
    else
	# Strip off the leading "lib" and trailing ".a" or ".so"

	tea_lib_name_lib=`echo ${$1_LIB_NAME}|sed -e 's/^lib//' -e 's/\.[[^.]]*$//' -e 's/\.so.*//'`
	$1_LIB_SPEC="-L${tea_lib_name_dir} -l${tea_lib_name_lib}"
    fi

    if test "x${$1_LIB_NAME}" = x ; then
	AC_MSG_ERROR([not found])
    else
	AC_MSG_RESULT([${$1_LIB_SPEC}])
    fi
])

#------------------------------------------------------------------------
# TEA_PRIVATE_TCL_HEADERS --
#
#	Locate the private Tcl include files
#
# Arguments:
#
#	Requires:
#		TCL_SRC_DIR	Assumes that TEA_LOAD_TCLCONFIG has
#				 already been called.
#
# Results:
#
#	Substs the following vars:
#		TCL_TOP_DIR_NATIVE
#		TCL_GENERIC_DIR_NATIVE
#		TCL_UNIX_DIR_NATIVE
#		TCL_WIN_DIR_NATIVE
#		TCL_BMAP_DIR_NATIVE
#		TCL_TOOL_DIR_NATIVE
#		TCL_PLATFORM_DIR_NATIVE
#		TCL_BIN_DIR_NATIVE
#		TCL_INCLUDES
#------------------------------------------------------------------------

AC_DEFUN([TEA_PRIVATE_TCL_HEADERS], [
    AC_MSG_CHECKING([for Tcl private include files])

    TCL_SRC_DIR_NATIVE=`${CYGPATH} ${TCL_SRC_DIR}`
    TCL_TOP_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}\"
    TCL_GENERIC_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/generic\"
    TCL_UNIX_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/unix\"
    TCL_WIN_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/win\"
    TCL_BMAP_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/bitmaps\"
    TCL_TOOL_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/tools\"
    TCL_COMPAT_DIR_NATIVE=\"${TCL_SRC_DIR_NATIVE}/compat\"

    if test "${TEA_PLATFORM}" = "windows"; then
	TCL_PLATFORM_DIR_NATIVE=${TCL_WIN_DIR_NATIVE}
    else
	TCL_PLATFORM_DIR_NATIVE=${TCL_UNIX_DIR_NATIVE}
    fi
    # We want to ensure these are substituted so as not to require
    # any *_NATIVE vars be defined in the Makefile
    TCL_INCLUDES="-I${TCL_GENERIC_DIR_NATIVE} -I${TCL_PLATFORM_DIR_NATIVE}"
    if test "`uname -s`" = "Darwin"; then
        # If Tcl was built as a framework, attempt to use
        # the framework's Headers and PrivateHeaders directories
        case ${TCL_DEFS} in
	    *TCL_FRAMEWORK*)
	        if test -d "${TCL_BIN_DIR}/Headers" -a -d "${TCL_BIN_DIR}/PrivateHeaders"; then
	        TCL_INCLUDES="-I\"${TCL_BIN_DIR}/Headers\" -I\"${TCL_BIN_DIR}/PrivateHeaders\" ${TCL_INCLUDES}"; else
	        TCL_INCLUDES="${TCL_INCLUDES} ${TCL_INCLUDE_SPEC} `echo "${TCL_INCLUDE_SPEC}" | sed -e 's/Headers/PrivateHeaders/'`"; fi
	        ;;
	esac
    else
	if test ! -f "${TCL_SRC_DIR}/generic/tclInt.h" ; then
	    AC_MSG_ERROR([Cannot find private header tclInt.h in ${TCL_SRC_DIR}])
	fi
    fi


    AC_SUBST(TCL_TOP_DIR_NATIVE)
    AC_SUBST(TCL_GENERIC_DIR_NATIVE)
    AC_SUBST(TCL_UNIX_DIR_NATIVE)
    AC_SUBST(TCL_WIN_DIR_NATIVE)
    AC_SUBST(TCL_BMAP_DIR_NATIVE)
    AC_SUBST(TCL_TOOL_DIR_NATIVE)
    AC_SUBST(TCL_PLATFORM_DIR_NATIVE)

    AC_SUBST(TCL_INCLUDES)
    AC_MSG_RESULT([Using srcdir found in tclConfig.sh: ${TCL_SRC_DIR}])
])

#------------------------------------------------------------------------
# TEA_PUBLIC_TCL_HEADERS --
#
#	Locate the installed public Tcl header files
#
# Arguments:
#	None.
#
# Requires:
#	CYGPATH must be set
#
# Results:
#
#	Adds a --with-tclinclude switch to configure.
#	Result is cached.
#
#	Substs the following vars:
#		TCL_INCLUDES
#------------------------------------------------------------------------

AC_DEFUN([TEA_PUBLIC_TCL_HEADERS], [
    AC_MSG_CHECKING([for Tcl public headers])

    AC_ARG_WITH(tclinclude, [  --with-tclinclude       directory containing the public Tcl header files], with_tclinclude=${withval})

    AC_CACHE_VAL(ac_cv_c_tclh, [
	# Use the value from --with-tclinclude, if it was given

	if test x"${with_tclinclude}" != x ; then
	    if test -f "${with_tclinclude}/tcl.h" ; then
		ac_cv_c_tclh=${with_tclinclude}
	    else
		AC_MSG_ERROR([${with_tclinclude} directory does not contain tcl.h])
	    fi
	else
	    if test "`uname -s`" = "Darwin"; then
		# If Tcl was built as a framework, attempt to use
		# the framework's Headers directory
		case ${TCL_DEFS} in
		    *TCL_FRAMEWORK*)
			list="`ls -d ${TCL_BIN_DIR}/Headers 2>/dev/null`"
			;;
		esac
	    fi

	    # Look in the source dir only if Tcl is not installed,
	    # and in that situation, look there before installed locations.
	    if test -f "${TCL_BIN_DIR}/Makefile" ; then
		list="$list `ls -d ${TCL_SRC_DIR}/generic 2>/dev/null`"
	    fi

	    # Check order: pkg --prefix location, Tcl's --prefix location,
	    # relative to directory of tclConfig.sh.

	    eval "temp_includedir=${includedir}"
	    list="$list \
		`ls -d ${temp_includedir}        2>/dev/null` \
		`ls -d ${TCL_PREFIX}/include     2>/dev/null` \
		`ls -d ${TCL_BIN_DIR}/../include 2>/dev/null`"
	    if test "${TEA_PLATFORM}" != "windows" -o "$GCC" = "yes"; then
		list="$list /usr/local/include /usr/include"
		if test x"${TCL_INCLUDE_SPEC}" != x ; then
		    d=`echo "${TCL_INCLUDE_SPEC}" | sed -e 's/^-I//'`
		    list="$list `ls -d ${d} 2>/dev/null`"
		fi
	    fi
	    for i in $list ; do
		if test -f "$i/tcl.h" ; then
		    ac_cv_c_tclh=$i
		    break
		fi
	    done
	fi
    ])

    # Print a message based on how we determined the include path

    if test x"${ac_cv_c_tclh}" = x ; then
	AC_MSG_ERROR([tcl.h not found.  Please specify its location with --with-tclinclude])
    else
	AC_MSG_RESULT([${ac_cv_c_tclh}])
    fi

    # Convert to a native path and substitute into the output files.

    INCLUDE_DIR_NATIVE=`${CYGPATH} ${ac_cv_c_tclh}`

    TCL_INCLUDES=-I\"${INCLUDE_DIR_NATIVE}\"

    AC_SUBST(TCL_INCLUDES)
])

#------------------------------------------------------------------------
# TEA_PRIVATE_TK_HEADERS --
#
#	Locate the private Tk include files
#
# Arguments:
#
#	Requires:
#		TK_SRC_DIR	Assumes that TEA_LOAD_TKCONFIG has
#				 already been called.
#
# Results:
#
#	Substs the following vars:
#		TK_INCLUDES
#------------------------------------------------------------------------

AC_DEFUN([TEA_PRIVATE_TK_HEADERS], [
    AC_MSG_CHECKING([for Tk private include files])

    TK_SRC_DIR_NATIVE=`${CYGPATH} ${TK_SRC_DIR}`
    TK_TOP_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}\"
    TK_UNIX_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/unix\"
    TK_WIN_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/win\"
    TK_GENERIC_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/generic\"
    TK_XLIB_DIR_NATIVE=\"${TK_SRC_DIR_NATIVE}/xlib\"
    if test "${TEA_PLATFORM}" = "windows"; then
	TK_PLATFORM_DIR_NATIVE=${TK_WIN_DIR_NATIVE}
    else
	TK_PLATFORM_DIR_NATIVE=${TK_UNIX_DIR_NATIVE}
    fi
    # We want to ensure these are substituted so as not to require
    # any *_NATIVE vars be defined in the Makefile
    TK_INCLUDES="-I${TK_GENERIC_DIR_NATIVE} -I${TK_PLATFORM_DIR_NATIVE}"
    # Detect and add ttk subdir
    if test -d ${TK_SRC_DIR_NATIVE}/generic/ttk; then
	TK_INCLUDES="${TK_INCLUDES} -I\"${TK_SRC_DIR_NATIVE}/generic/ttk\""
    fi
    if test "${TEA_WINDOWINGSYSTEM}" = "win32" \
	-o "${TEA_WINDOWINGSYSTEM}" = "aqua"; then
	TK_INCLUDES="${TK_INCLUDES} -I${TK_XLIB_DIR_NATIVE}"
    fi
    if test "${TEA_WINDOWINGSYSTEM}" = "aqua"; then
	TK_INCLUDES="${TK_INCLUDES} -I${TK_SRC_DIR_NATIVE}/macosx"
    fi
    if test "`uname -s`" = "Darwin"; then
        # If Tk was built as a framework, attempt to use
        # the framework's Headers and PrivateHeaders directories
        case ${TK_DEFS} in
	    *TK_FRAMEWORK*)
	        if test -d "${TK_BIN_DIR}/Headers" -a -d "${TK_BIN_DIR}/PrivateHeaders"; then
	        TK_INCLUDES="-I\"${TK_BIN_DIR}/Headers\" -I\"${TK_BIN_DIR}/PrivateHeaders\" ${TK_INCLUDES}"; fi
	        ;;
	esac
    else
	if test ! -f "${TK_SRC_DIR}/generic/tkInt.h" ; then
	    AC_MSG_ERROR([Cannot find private header tkInt.h in ${TK_SRC_DIR}])
	fi
    fi

    AC_SUBST(TK_TOP_DIR_NATIVE)
    AC_SUBST(TK_UNIX_DIR_NATIVE)
    AC_SUBST(TK_WIN_DIR_NATIVE)
    AC_SUBST(TK_GENERIC_DIR_NATIVE)
    AC_SUBST(TK_XLIB_DIR_NATIVE)
    AC_SUBST(TK_PLATFORM_DIR_NATIVE)

    AC_SUBST(TK_INCLUDES)
    AC_MSG_RESULT([Using srcdir found in tkConfig.sh: ${TK_SRC_DIR}])
])

#------------------------------------------------------------------------
# TEA_PUBLIC_TK_HEADERS --
#
#	Locate the installed public Tk header files
#
# Arguments:
#	None.
#
# Requires:
#	CYGPATH must be set
#
# Results:
#
#	Adds a --with-tkinclude switch to configure.
#	Result is cached.
#
#	Substs the following vars:
#		TK_INCLUDES
#------------------------------------------------------------------------

AC_DEFUN([TEA_PUBLIC_TK_HEADERS], [
    AC_MSG_CHECKING([for Tk public headers])

    AC_ARG_WITH(tkinclude, [  --with-tkinclude        directory containing the public Tk header files], with_tkinclude=${withval})

    AC_CACHE_VAL(ac_cv_c_tkh, [
	# Use the value from --with-tkinclude, if it was given

	if test x"${with_tkinclude}" != x ; then
	    if test -f "${with_tkinclude}/tk.h" ; then
		ac_cv_c_tkh=${with_tkinclude}
	    else
		AC_MSG_ERROR([${with_tkinclude} directory does not contain tk.h])
	    fi
	else
	    if test "`uname -s`" = "Darwin"; then
		# If Tk was built as a framework, attempt to use
		# the framework's Headers directory.
		case ${TK_DEFS} in
		    *TK_FRAMEWORK*)
			list="`ls -d ${TK_BIN_DIR}/Headers 2>/dev/null`"
			;;
		esac
	    fi

	    # Look in the source dir only if Tk is not installed,
	    # and in that situation, look there before installed locations.
	    if test -f "${TK_BIN_DIR}/Makefile" ; then
		list="$list `ls -d ${TK_SRC_DIR}/generic 2>/dev/null`"
	    fi

	    # Check order: pkg --prefix location, Tk's --prefix location,
	    # relative to directory of tkConfig.sh, Tcl's --prefix location, 
	    # relative to directory of tclConfig.sh.

	    eval "temp_includedir=${includedir}"
	    list="$list \
		`ls -d ${temp_includedir}        2>/dev/null` \
		`ls -d ${TK_PREFIX}/include      2>/dev/null` \
		`ls -d ${TK_BIN_DIR}/../include  2>/dev/null` \
		`ls -d ${TCL_PREFIX}/include     2>/dev/null` \
		`ls -d ${TCL_BIN_DIR}/../include 2>/dev/null`"
	    if test "${TEA_PLATFORM}" != "windows" -o "$GCC" = "yes"; then
		list="$list /usr/local/include /usr/include"
	    fi
	    for i in $list ; do
		if test -f "$i/tk.h" ; then
		    ac_cv_c_tkh=$i
		    break
		fi
	    done
	fi
    ])

    # Print a message based on how we determined the include path

    if test x"${ac_cv_c_tkh}" = x ; then
	AC_MSG_ERROR([tk.h not found.  Please specify its location with --with-tkinclude])
    else
	AC_MSG_RESULT([${ac_cv_c_tkh}])
    fi

    # Convert to a native path and substitute into the output files.

    INCLUDE_DIR_NATIVE=`${CYGPATH} ${ac_cv_c_tkh}`

    TK_INCLUDES=-I\"${INCLUDE_DIR_NATIVE}\"

    AC_SUBST(TK_INCLUDES)

    if test "${TEA_WINDOWINGSYSTEM}" = "win32" \
	-o "${TEA_WINDOWINGSYSTEM}" = "aqua"; then
	# On Windows and Aqua, we need the X compat headers
	AC_MSG_CHECKING([for X11 header files])
	if test ! -r "${INCLUDE_DIR_NATIVE}/X11/Xlib.h"; then
	    INCLUDE_DIR_NATIVE="`${CYGPATH} ${TK_SRC_DIR}/xlib`"
	    TK_XINCLUDES=-I\"${INCLUDE_DIR_NATIVE}\"
	    AC_SUBST(TK_XINCLUDES)
	fi
	AC_MSG_RESULT([${INCLUDE_DIR_NATIVE}])
    fi
])

#------------------------------------------------------------------------
# TEA_PATH_CONFIG --
#
#	Locate the ${1}Config.sh file and perform a sanity check on
#	the ${1} compile flags.  These are used by packages like
#	[incr Tk] that load *Config.sh files from more than Tcl and Tk.
#
# Arguments:
#	none
#
# Results:
#
#	Adds the following arguments to configure:
#		--with-$1=...
#
#	Defines the following vars:
#		$1_BIN_DIR	Full path to the directory containing
#				the $1Config.sh file
#------------------------------------------------------------------------

AC_DEFUN([TEA_PATH_CONFIG], [
    #
    # Ok, lets find the $1 configuration
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-$1
    #

    if test x"${no_$1}" = x ; then
	# we reset no_$1 in case something fails here
	no_$1=true
	AC_ARG_WITH($1, [  --with-$1              directory containing $1 configuration ($1Config.sh)], with_$1config=${withval})
	AC_MSG_CHECKING([for $1 configuration])
	AC_CACHE_VAL(ac_cv_c_$1config,[

	    # First check to see if --with-$1 was specified.
	    if test x"${with_$1config}" != x ; then
		case ${with_$1config} in
		    */$1Config.sh )
			if test -f ${with_$1config}; then
			    AC_MSG_WARN([--with-$1 argument should refer to directory containing $1Config.sh, not to $1Config.sh itself])
			    with_$1config=`echo ${with_$1config} | sed 's!/$1Config\.sh$!!'`
			fi;;
		esac
		if test -f "${with_$1config}/$1Config.sh" ; then
		    ac_cv_c_$1config=`(cd ${with_$1config}; pwd)`
		else
		    AC_MSG_ERROR([${with_$1config} directory doesn't contain $1Config.sh])
		fi
	    fi

	    # then check for a private $1 installation
	    if test x"${ac_cv_c_$1config}" = x ; then
		for i in \
			../$1 \
			`ls -dr ../$1*[[0-9]].[[0-9]]*.[[0-9]]* 2>/dev/null` \
			`ls -dr ../$1*[[0-9]].[[0-9]][[0-9]] 2>/dev/null` \
			`ls -dr ../$1*[[0-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../$1*[[0-9]].[[0-9]]* 2>/dev/null` \
			../../$1 \
			`ls -dr ../../$1*[[0-9]].[[0-9]]*.[[0-9]]* 2>/dev/null` \
			`ls -dr ../../$1*[[0-9]].[[0-9]][[0-9]] 2>/dev/null` \
			`ls -dr ../../$1*[[0-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../$1*[[0-9]].[[0-9]]* 2>/dev/null` \
			../../../$1 \
			`ls -dr ../../../$1*[[0-9]].[[0-9]]*.[[0-9]]* 2>/dev/null` \
			`ls -dr ../../../$1*[[0-9]].[[0-9]][[0-9]] 2>/dev/null` \
			`ls -dr ../../../$1*[[0-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ../../../$1*[[0-9]].[[0-9]]* 2>/dev/null` \
			${srcdir}/../$1 \
			`ls -dr ${srcdir}/../$1*[[0-9]].[[0-9]]*.[[0-9]]* 2>/dev/null` \
			`ls -dr ${srcdir}/../$1*[[0-9]].[[0-9]][[0-9]] 2>/dev/null` \
			`ls -dr ${srcdir}/../$1*[[0-9]].[[0-9]] 2>/dev/null` \
			`ls -dr ${srcdir}/../$1*[[0-9]].[[0-9]]* 2>/dev/null` \
			; do
		    if test -f "$i/$1Config.sh" ; then
			ac_cv_c_$1config=`(cd $i; pwd)`
			break
		    fi
		    if test -f "$i/unix/$1Config.sh" ; then
			ac_cv_c_$1config=`(cd $i/unix; pwd)`
			break
		    fi
		done
	    fi

	    # check in a few common install locations
	    if test x"${ac_cv_c_$1config}" = x ; then
		for i in `ls -d ${libdir} 2>/dev/null` \
			`ls -d ${exec_prefix}/lib 2>/dev/null` \
			`ls -d ${prefix}/lib 2>/dev/null` \
			`ls -d /usr/local/lib 2>/dev/null` \
			`ls -d /usr/contrib/lib 2>/dev/null` \
			`ls -d /usr/lib 2>/dev/null` \
			; do
		    if test -f "$i/$1Config.sh" ; then
			ac_cv_c_$1config=`(cd $i; pwd)`
			break
		    fi
		done
	    fi
	])

	if test x"${ac_cv_c_$1config}" = x ; then
	    $1_BIN_DIR="# no $1 configs found"
	    AC_MSG_WARN([Cannot find $1 configuration definitions])
	    exit 0
	else
	    no_$1=
	    $1_BIN_DIR=${ac_cv_c_$1config}
	    AC_MSG_RESULT([found $$1_BIN_DIR/$1Config.sh])
	fi
    fi
])

#------------------------------------------------------------------------
# TEA_LOAD_CONFIG --
#
#	Load the $1Config.sh file
#
# Arguments:
#	
#	Requires the following vars to be set:
#		$1_BIN_DIR
#
# Results:
#
#	Subst the following vars:
#		$1_SRC_DIR
#		$1_LIB_FILE
#		$1_LIB_SPEC
#
#------------------------------------------------------------------------

AC_DEFUN([TEA_LOAD_CONFIG], [
    AC_MSG_CHECKING([for existence of ${$1_BIN_DIR}/$1Config.sh])

    if test -f "${$1_BIN_DIR}/$1Config.sh" ; then
        AC_MSG_RESULT([loading])
	. "${$1_BIN_DIR}/$1Config.sh"
    else
        AC_MSG_RESULT([file not found])
    fi

    #
    # If the $1_BIN_DIR is the build directory (not the install directory),
    # then set the common variable name to the value of the build variables.
    # For example, the variable $1_LIB_SPEC will be set to the value
    # of $1_BUILD_LIB_SPEC. An extension should make use of $1_LIB_SPEC
    # instead of $1_BUILD_LIB_SPEC since it will work with both an
    # installed and uninstalled version of Tcl.
    #

    if test -f "${$1_BIN_DIR}/Makefile" ; then
	AC_MSG_WARN([Found Makefile - using build library specs for $1])
        $1_LIB_SPEC=${$1_BUILD_LIB_SPEC}
        $1_STUB_LIB_SPEC=${$1_BUILD_STUB_LIB_SPEC}
        $1_STUB_LIB_PATH=${$1_BUILD_STUB_LIB_PATH}
    fi

    AC_SUBST($1_VERSION)
    AC_SUBST($1_BIN_DIR)
    AC_SUBST($1_SRC_DIR)

    AC_SUBST($1_LIB_FILE)
    AC_SUBST($1_LIB_SPEC)

    AC_SUBST($1_STUB_LIB_FILE)
    AC_SUBST($1_STUB_LIB_SPEC)
    AC_SUBST($1_STUB_LIB_PATH)
])

#------------------------------------------------------------------------
# TEA_PATH_CELIB --
#
#	Locate Keuchel's celib emulation layer for targeting Win/CE
#
# Arguments:
#	none
#
# Results:
#
#	Adds the following arguments to configure:
#		--with-celib=...
#
#	Defines the following vars:
#		CELIB_DIR	Full path to the directory containing
#				the include and platform lib files
#------------------------------------------------------------------------

AC_DEFUN([TEA_PATH_CELIB], [
    # First, look for one uninstalled.
    # the alternative search directory is invoked by --with-celib

    if test x"${no_celib}" = x ; then
	# we reset no_celib in case something fails here
	no_celib=true
	AC_ARG_WITH(celib,[  --with-celib=DIR        use Windows/CE support library from DIR], with_celibconfig=${withval})
	AC_MSG_CHECKING([for Windows/CE celib directory])
	AC_CACHE_VAL(ac_cv_c_celibconfig,[
	    # First check to see if --with-celibconfig was specified.
	    if test x"${with_celibconfig}" != x ; then
		if test -d "${with_celibconfig}/inc" ; then
		    ac_cv_c_celibconfig=`(cd ${with_celibconfig}; pwd)`
		else
		    AC_MSG_ERROR([${with_celibconfig} directory doesn't contain inc directory])
		fi
	    fi

	    # then check for a celib library
	    if test x"${ac_cv_c_celibconfig}" = x ; then
		for i in \
			../celib-palm-3.0 \
			../celib \
			../../celib-palm-3.0 \
			../../celib \
			`ls -dr ../celib-*3.[[0-9]]* 2>/dev/null` \
			${srcdir}/../celib-palm-3.0 \
			${srcdir}/../celib \
			`ls -dr ${srcdir}/../celib-*3.[[0-9]]* 2>/dev/null` \
			; do
		    if test -d "$i/inc" ; then
			ac_cv_c_celibconfig=`(cd $i; pwd)`
			break
		    fi
		done
	    fi
	])
	if test x"${ac_cv_c_celibconfig}" = x ; then
	    AC_MSG_ERROR([Cannot find celib support library directory])
	else
	    no_celib=
	    CELIB_DIR=${ac_cv_c_celibconfig}
	    CELIB_DIR=`echo "$CELIB_DIR" | sed -e 's!\\\!/!g'`
	    AC_MSG_RESULT([found $CELIB_DIR])
	fi
    fi
])


# Local Variables:
# mode: autoconf
# End:

blob
data 16838
/* $Id$ */

/* 
 * Togl - a Tk OpenGL widget
 * Copyright (C) 1996-1997  Brian Paul and Ben Bederson
 * Copyright (C) 2006-2007  Greg Couch
 * See the LICENSE file for copyright details.
 */


/* 
 * An example Togl program demonstrating texture mapping
 */

#define USE_TOGL_STUBS

#include "togl.h"
#include <stdlib.h>
#include <string.h>
#if defined(TOGL_AGL)
#  include <OpenGL/glu.h>
#else
#  include <GL/glu.h>
#endif
#include "image.h"

#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT

#define CHECKER 0
#define FACE 1
#define TREE 2


static GLenum minfilter = GL_NEAREST_MIPMAP_LINEAR;
static GLenum magfilter = GL_LINEAR;
static GLenum swrap = GL_REPEAT;
static GLenum twrap = GL_REPEAT;
static GLenum envmode = GL_MODULATE;
static GLubyte polycolor[4] = { 255, 255, 255, 255 };
static int teximage = CHECKER;
static double coord_scale = 1;
static double xrot = 0;
static double yrot = 0;
static double texscale = 1;

static GLint width, height;

static GLboolean blend = GL_FALSE;


/* 
 * Load a texture image.  n is one of CHECKER, FACE or TREE.
 */
static void
texture_image(int n)
{
    if (n == CHECKER) {
#define WIDTH 64
#define HEIGHT 64
        GLubyte teximage[WIDTH * HEIGHT][4];
        int     i, j;

        for (i = 0; i < HEIGHT; i++) {
            for (j = 0; j < WIDTH; j++) {
                GLubyte value;

                value = ((i / 4 + j / 4) % 2) ? 0xff : 0x00;
                teximage[i * WIDTH + j][0] = value;
                teximage[i * WIDTH + j][1] = value;
                teximage[i * WIDTH + j][2] = value;
                teximage[i * WIDTH + j][3] = value;
            }
        }

        glEnable(GL_TEXTURE_2D);
        gluBuild2DMipmaps(GL_TEXTURE_2D, 4, WIDTH, HEIGHT,
                GL_RGBA, GL_UNSIGNED_BYTE, teximage);
        blend = GL_FALSE;

#undef WIDTH
#undef HEIGHT
    } else if (n == FACE) {
        TK_RGBImageRec *img = tkRGBImageLoad("ben.rgb");

        if (img) {
            glEnable(GL_TEXTURE_2D);
            glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
            gluBuild2DMipmaps(GL_TEXTURE_2D, img->sizeZ, img->sizeX, img->sizeY,
                    img->sizeZ == 3 ? GL_RGB : GL_RGBA,
                    GL_UNSIGNED_BYTE, img->data);

            blend = GL_TRUE;
        }
    } else if (n == TREE) {
        TK_RGBImageRec *img = tkRGBImageLoad("tree2.rgba");

        if (img) {
            glEnable(GL_TEXTURE_2D);
            glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
            gluBuild2DMipmaps(GL_TEXTURE_2D, img->sizeZ, img->sizeX, img->sizeY,
                    img->sizeZ == 3 ? GL_RGB : GL_RGBA,
                    GL_UNSIGNED_BYTE, img->data);

            blend = GL_TRUE;
        }
    } else {
        abort();
    }
}


/* 
 * Togl widget create callback.  This is called by Tcl/Tk when the widget has
 * been realized.  Here's where one may do some one-time context setup or
 * initializations.
 */
static int
create_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    glEnable(GL_DEPTH_TEST);    /* Enable depth buffering */

    texture_image(CHECKER);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, magfilter);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, minfilter);

    return TCL_OK;
}


/* 
 * Togl widget reshape callback.  This is called by Tcl/Tk when the widget
 * has been resized.  Typically, we call glViewport and perhaps setup the
 * projection matrix.
 */
static int
reshape_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    width = Togl_Width(togl);
    height = Togl_Height(togl);

    glViewport(0, 0, width, height);

    return TCL_OK;
}


static void
check_error(char *where)
{
    GLenum  error;

    while (1) {
        error = glGetError();
        if (error == GL_NO_ERROR) {
            break;
        }
        printf("OpenGL error near %s: %s\n", where, gluErrorString(error));
    }
}



/* 
 * Togl widget display callback.  This is called by Tcl/Tk when the widget's
 * contents have to be redrawn.  Typically, we clear the color and depth
 * buffers, render our objects, then swap the front/back color buffers.
 */
static int
display_cb(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    float   aspect = (float) width / (float) height;
    Togl   *togl;

    if (objc != 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    check_error("begin display\n");

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    /* Draw background image */
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glDisable(GL_TEXTURE_2D);
    glDisable(GL_DEPTH_TEST);
    glBegin(GL_POLYGON);
    glColor3f(0, 0, 0.3f);
    glVertex2f(-1, -1);
    glColor3f(0, 0, 0.3f);
    glVertex2f(1, -1);
    glColor3f(0, 0, 0.9f);
    glVertex2f(1, 1);
    glColor3f(0, 0, 0.9f);
    glVertex2f(-1, 1);
    glEnd();

    /* draw textured object */
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glFrustum(-aspect, aspect, -1, 1, 2, 10);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glTranslatef(0, 0, -5);
    glScaled(texscale, texscale, texscale);
    glRotated(yrot, 0, 1, 0);
    glRotated(xrot, 1, 0, 0);

    glEnable(GL_DEPTH_TEST);
    glEnable(GL_TEXTURE_2D);
    glColor4ubv(polycolor);

    if (blend) {
        glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
        glEnable(GL_BLEND);
    }

    glBegin(GL_POLYGON);
    glTexCoord2f(0, 0);
    glVertex2f(-1, -1);
    glTexCoord2d(coord_scale, 0);
    glVertex2f(1, -1);
    glTexCoord2d(coord_scale, coord_scale);
    glVertex2f(1, 1);
    glTexCoord2d(0, coord_scale);
    glVertex2f(-1, 1);
    glEnd();

    glDisable(GL_BLEND);

    Togl_SwapBuffers(togl);

    return TCL_OK;
}


/* 
 * Called when a magnification filter radio button is pressed.
 */
static int
magfilter_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = { "GL_NEAREST", "GL_LINEAR", NULL };
    static const GLenum magfilters[] = { GL_NEAREST, GL_LINEAR };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName magnification-filter-type");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "magnification filter type", 0, &index);
    if (result == TCL_OK) {
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER,
                magfilters[index]);
        Togl_PostRedisplay(togl);
    }
    return result;
}


/* 
 * Called when a minification filter radio button is pressed.
 */
static int
minfilter_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = {
        "GL_NEAREST", "GL_LINEAR",
        "GL_NEAREST_MIPMAP_NEAREST", "GL_LINEAR_MIPMAP_NEAREST",
        "GL_NEAREST_MIPMAP_LINEAR", "GL_LINEAR_MIPMAP_LINEAR", NULL
    };
    static const GLenum minfilters[] = {
        GL_NEAREST, GL_LINEAR,
        GL_NEAREST_MIPMAP_NEAREST, GL_LINEAR_MIPMAP_NEAREST,
        GL_NEAREST_MIPMAP_LINEAR, GL_LINEAR_MIPMAP_LINEAR
    };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName minification-filter-type");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "minification filter type", 0, &index);
    if (result == TCL_OK) {
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER,
                minfilters[index]);
        Togl_PostRedisplay(togl);
    }
    return result;
}


static int
xrot_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &xrot) != TCL_OK) {
        return TCL_ERROR;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


static int
yrot_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName angle");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &yrot) != TCL_OK) {
        return TCL_ERROR;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


static int
texscale_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName value");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &texscale) != TCL_OK) {
        return TCL_ERROR;
    }

    Togl_PostRedisplay(togl);

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


/* 
 * Called when S texture coordinate wrapping is changed.
 */
static int
swrap_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = { "GL_CLAMP", "GL_REPEAT", NULL };
    static const GLenum swraps[] = { GL_CLAMP, GL_REPEAT };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName wrap-mode");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "wrap mode", 0, &index);
    if (result == TCL_OK) {
        swrap = swraps[index];
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, swrap);
        Togl_PostRedisplay(togl);
        /* Let result string equal value */
        Tcl_SetObjResult(interp, objv[2]);
    }
    return result;
}


/* 
 * Called when T texture coordinate wrapping is changed.
 */
static int
twrap_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = { "GL_CLAMP", "GL_REPEAT", NULL };
    static const GLenum twraps[] = { GL_CLAMP, GL_REPEAT };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName wrap-mode");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "wrap mode", 0, &index);
    if (result == TCL_OK) {
        twrap = twraps[index];
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, twrap);
        Togl_PostRedisplay(togl);
        /* Let result string equal value */
        Tcl_SetObjResult(interp, objv[2]);
    }
    return result;
}


/* 
 * Called when the texture environment mode is changed.
 */
static int
envmode_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = {
        "GL_MODULATE", "GL_DECAL", "GL_BLEND", NULL
    };
    static const GLenum envmodes[] = { GL_MODULATE, GL_DECAL, GL_BLEND };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName texture-env-mode");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "texture env mode", 0, &index);
    if (result == TCL_OK) {
        envmode = envmodes[index];
        glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, envmode);
        Togl_PostRedisplay(togl);
        /* Let result string equal value */
        Tcl_SetObjResult(interp, objv[2]);
    }
    return result;
}


/* 
 * Called when the polygon color is changed.
 */
static int
polycolor_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl;
    int     r, g, b;

    if (objc != 5) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName r g b");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetIntFromObj(interp, objv[2], &r) != TCL_OK
            || Tcl_GetIntFromObj(interp, objv[3], &g) != TCL_OK
            || Tcl_GetIntFromObj(interp, objv[4], &b) != TCL_OK) {
        return TCL_ERROR;
    }
    polycolor[0] = r;
    polycolor[1] = g;
    polycolor[2] = b;

    Togl_PostRedisplay(togl);

    return TCL_OK;
}


/* 
 * Called when the texture image is to be changed
 */
static int
teximage_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    static const char *names[] = {
        "CHECKER", "FACE", "TREE", NULL
    };
    static const GLenum teximages[] = {
        CHECKER, FACE, TREE
    };
    int     result, index;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName texture-image-name");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    result = Tcl_GetIndexFromObj(interp, objv[2], names,
            "texture image name", 0, &index);
    if (result == TCL_OK) {
        teximage = teximages[index];
        texture_image(teximage);
        Togl_PostRedisplay(togl);
        /* Let result string equal value */
        Tcl_SetObjResult(interp, objv[2]);
    }
    return result;
}


/* 
 * Called when the texture coordinate scale is changed.
 */
static int
coord_scale_cmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    double  s;
    Togl   *togl;

    if (objc != 3) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName scale");
        return TCL_ERROR;
    }

    if (Togl_GetToglFromObj(interp, objv[1], &togl) != TCL_OK) {
        return TCL_ERROR;
    }

    if (Tcl_GetDoubleFromObj(interp, objv[2], &s) != TCL_OK) {
        return TCL_ERROR;
    }
    if (s > 0 && s < 10) {
        coord_scale = s;
        Togl_PostRedisplay(togl);
    }

    /* Let result string equal value */
    Tcl_SetObjResult(interp, objv[2]);
    return TCL_OK;
}


EXTERN int
Texture_Init(Tcl_Interp *interp)
{
    /* 
     * Initialize Tcl and the Togl widget module.
     */
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL
            || Togl_InitStubs(interp, "2.0", 0) == NULL) {
        return TCL_ERROR;
    }

    /* 
     * Specify the C callback functions for widget creation, display,
     * and reshape.
     */
    Tcl_CreateObjCommand(interp, "create_cb", create_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "display_cb", display_cb, NULL, NULL);
    Tcl_CreateObjCommand(interp, "reshape_cb", reshape_cb, NULL, NULL);

    /* 
     * Make a new Togl widget command so the Tcl code can set a C variable.
     */
    Tcl_CreateObjCommand(interp, "min_filter", minfilter_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "mag_filter", magfilter_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "xrot", xrot_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "yrot", yrot_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "texscale", texscale_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "swrap", swrap_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "twrap", twrap_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "envmode", envmode_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "polycolor", polycolor_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "teximage", teximage_cmd, NULL, NULL);
    Tcl_CreateObjCommand(interp, "coord_scale", coord_scale_cmd, NULL, NULL);

    /* 
     * Call Tcl_CreateCommand for application-specific commands, if
     * they weren't already created by the init procedures called above.
     */

    return TCL_OK;
}

blob
data 9844
#!/bin/sh
# the next line restarts using tclsh \
exec tclsh "$0" "$@"

# $Id$

# Togl - a Tk OpenGL widget
# Copyright (C) 1996  Brian Paul and Ben Bederson
# Copyright (C) 2006-2007  Greg Couch
# See the LICENSE file for copyright details.


# Togl texture map demo

package provide texture 1.0

# add parent directory to path to find Togl's pkgIndex in current directory
if { [file exists pkgIndex.tcl] } {
    set auto_path [linsert $auto_path 0 ..]
}
# following load also loads Tk and Togl packages
load [file dirname [info script]]/texture[info sharedlibextension]

# create ::texture namespace
namespace eval ::texture {
}

# Called magnification filter changes
proc ::texture::new_magfilter {} {
    global magfilter
    mag_filter .f1.view $magfilter
}


# Called minification filter changes
proc ::texture::new_minfilter {} {
    global minfilter
    min_filter .f1.view $minfilter
}


# Called when texture image radio button changes
proc ::texture::new_image {} {
    global image
    teximage .f1.view $image
}


# Called when texture S wrap button changes
proc ::texture::new_swrap {} {
    global swrap
    swrap .f1.view $swrap
}


# Called when texture T wrap button changes
proc ::texture::new_twrap {} {
    global twrap
    twrap .f1.view $twrap
}


# Called when texture environment radio button selected
proc ::texture::new_env {} {
    global envmode
    envmode .f1.view $envmode
}


# Called when polygon color sliders change
proc ::texture::new_color { foo } {
    global poly_red poly_green poly_blue
    polycolor .f1.view $poly_red $poly_green $poly_blue
}


proc ::texture::new_coord_scale { name element op } {
    global coord_scale
    coord_scale .f1.view $coord_scale
}

proc ::texture::take_photo {} {
	image create photo teximg
	.f1.view takephoto teximg
	teximg write image.ppm -format ppm
}

# Make the widgets
proc ::texture::setup {} {
    global magfilter
    global minfilter
    global image
    global swrap
    global twrap
    global envmode
    global poly_red
    global poly_green
    global poly_blue
    global coord_scale
    global startx starty         # location of mouse when button pressed
    global xangle yangle
    global xangle0 yangle0
    global texscale texscale0

    wm title . "Texture Map Options"

    ### Two frames:  top half and bottom half
    frame .f1
    frame .f2

    ### The OpenGL window
    togl .f1.view -width 250 -height 250 -rgba true -double true -depth true -create create_cb -reshape reshape_cb -display display_cb


    ### Filter radio buttons
    frame .f1.filter -relief ridge -borderwidth 3

    frame .f1.filter.mag -relief ridge -borderwidth 2

    label .f1.filter.mag.label -text "Magnification Filter" -anchor w
    radiobutton .f1.filter.mag.nearest -text GL_NEAREST -anchor w -variable magfilter -value GL_NEAREST -command ::texture::new_magfilter
    radiobutton .f1.filter.mag.linear -text GL_LINEAR -anchor w -variable magfilter -value GL_LINEAR -command ::texture::new_magfilter

    frame .f1.filter.min -relief ridge -borderwidth 2

    label .f1.filter.min.label -text "Minification Filter" -anchor w
    radiobutton .f1.filter.min.nearest -text GL_NEAREST -anchor w -variable minfilter -value GL_NEAREST -command ::texture::new_minfilter
    radiobutton .f1.filter.min.linear -text GL_LINEAR -anchor w -variable minfilter -value GL_LINEAR -command ::texture::new_minfilter
    radiobutton .f1.filter.min.nearest_mipmap_nearest -text GL_NEAREST_MIPMAP_NEAREST -anchor w -variable minfilter -value GL_NEAREST_MIPMAP_NEAREST -command ::texture::new_minfilter
    radiobutton .f1.filter.min.linear_mipmap_nearest -text GL_LINEAR_MIPMAP_NEAREST -anchor w -variable minfilter -value GL_LINEAR_MIPMAP_NEAREST -command ::texture::new_minfilter
    radiobutton .f1.filter.min.nearest_mipmap_linear -text GL_NEAREST_MIPMAP_LINEAR -anchor w -variable minfilter -value GL_NEAREST_MIPMAP_LINEAR -command ::texture::new_minfilter
    radiobutton .f1.filter.min.linear_mipmap_linear -text GL_LINEAR_MIPMAP_LINEAR -anchor w -variable minfilter -value GL_LINEAR_MIPMAP_LINEAR -command ::texture::new_minfilter

    pack .f1.filter.mag -fill x
    pack .f1.filter.mag.label -fill x
    pack .f1.filter.mag.nearest -side top -fill x
    pack .f1.filter.mag.linear -side top -fill x

    pack .f1.filter.min -fill both -expand true
    pack .f1.filter.min.label -side top -fill x
    pack .f1.filter.min.nearest -side top -fill x
    pack .f1.filter.min.linear -side top -fill x 
    pack .f1.filter.min.nearest_mipmap_nearest -side top -fill x
    pack .f1.filter.min.linear_mipmap_nearest -side top -fill x
    pack .f1.filter.min.nearest_mipmap_linear -side top -fill x
    pack .f1.filter.min.linear_mipmap_linear -side top -fill x


    ### Texture coordinate scale and wrapping
    frame .f2.coord -relief ridge -borderwidth 3
    frame .f2.coord.scale -relief ridge -borderwidth 2
    label .f2.coord.scale.label -text "Max Texture Coord" -anchor w
    entry .f2.coord.scale.entry -textvariable coord_scale
    trace variable coord_scale w ::texture::new_coord_scale

    frame .f2.coord.s -relief ridge -borderwidth 2
    label .f2.coord.s.label -text "GL_TEXTURE_WRAP_S" -anchor w
    radiobutton .f2.coord.s.repeat -text "GL_REPEAT" -anchor w -variable swrap -value GL_REPEAT -command ::texture::new_swrap
    radiobutton .f2.coord.s.clamp -text "GL_CLAMP" -anchor w -variable swrap -value GL_CLAMP -command ::texture::new_swrap

    frame .f2.coord.t -relief ridge -borderwidth 2
    label .f2.coord.t.label -text "GL_TEXTURE_WRAP_T" -anchor w
    radiobutton .f2.coord.t.repeat -text "GL_REPEAT" -anchor w -variable twrap -value GL_REPEAT -command ::texture::new_twrap
    radiobutton .f2.coord.t.clamp -text "GL_CLAMP" -anchor w -variable twrap -value GL_CLAMP -command ::texture::new_twrap

    pack .f2.coord.scale -fill both -expand true
    pack .f2.coord.scale.label -side top -fill x
    pack .f2.coord.scale.entry -side top -fill x

    pack .f2.coord.s -fill x
    pack .f2.coord.s.label -side top -fill x
    pack .f2.coord.s.repeat -side top -fill x
    pack .f2.coord.s.clamp -side top -fill x

    pack .f2.coord.t -fill x
    pack .f2.coord.t.label -side top -fill x
    pack .f2.coord.t.repeat -side top -fill x
    pack .f2.coord.t.clamp -side top -fill x


    ### Texture image radio buttons (just happens to fit into the coord frame)
    frame .f2.env -relief ridge -borderwidth 3
    frame .f2.env.image -relief ridge -borderwidth 2
    label .f2.env.image.label -text "Texture Image" -anchor w
    radiobutton .f2.env.image.checker -text "Checker" -anchor w -variable image -value CHECKER -command ::texture::new_image
    radiobutton .f2.env.image.tree -text "Tree" -anchor w -variable image -value TREE -command ::texture::new_image
    radiobutton .f2.env.image.face -text "Face" -anchor w -variable image -value FACE -command ::texture::new_image
    pack .f2.env.image -fill x
    pack .f2.env.image.label -side top -fill x
    pack .f2.env.image.checker -side top -fill x
    pack .f2.env.image.tree -side top -fill x
    pack .f2.env.image.face -side top -fill x


    ### Texture Environment
    label .f2.env.label -text "GL_TEXTURE_ENV_MODE" -anchor w
    radiobutton .f2.env.modulate -text "GL_MODULATE" -anchor w -variable envmode -value GL_MODULATE -command ::texture::new_env
    radiobutton .f2.env.decal -text "GL_DECAL" -anchor w -variable envmode -value GL_DECAL -command ::texture::new_env
    radiobutton .f2.env.blend -text "GL_BLEND" -anchor w -variable envmode -value GL_BLEND -command ::texture::new_env
    pack .f2.env.label -fill x
    pack .f2.env.modulate -side top -fill x
    pack .f2.env.decal -side top -fill x
    pack .f2.env.blend -side top -fill x

    ### Polygon color
    frame .f2.color -relief ridge -borderwidth 3
    label .f2.color.label -text "Polygon color" -anchor w
    scale .f2.color.red -label Red -from 0 -to 255 -orient horizontal -variable poly_red -command ::texture::new_color
    scale .f2.color.green -label Green -from 0 -to 255 -orient horizontal -variable poly_green -command ::texture::new_color
    scale .f2.color.blue -label Blue -from 0 -to 255 -orient horizontal -variable poly_blue -command ::texture::new_color
    pack .f2.color.label -fill x
    pack .f2.color.red -side top -fill x
    pack .f2.color.green -side top -fill x
    pack .f2.color.blue -side top -fill x


    ### Main widgets
    pack .f1.view -side left -fill both -expand true
    pack .f1.filter -side left -fill y
    pack .f1 -side top -fill both -expand true

    pack .f2.coord .f2.env -side left -fill both
    pack .f2.color -fill x
    pack .f2 -side top -fill x

    button .photo -text "Take Photo" -command ::texture::take_photo
    pack .photo -expand true -fill both
    button .quit -text Quit -command exit
    pack .quit -expand true -fill both

    bind .f1.view <ButtonPress-1> {
	set startx %x
	set starty %y
	set xangle0 $xangle
	set yangle0 $yangle
    }

    bind .f1.view <B1-Motion> {
        set xangle [expr $xangle0 + (%x - $startx) / 3.0 ]
        set yangle [expr $yangle0 + (%y - $starty) / 3.0 ]
        yrot .f1.view $xangle
        xrot .f1.view $yangle
    }

    bind .f1.view <ButtonPress-2> {
	set startx %x
	set starty %y
	set texscale0 $texscale
    }

    bind .f1.view <B2-Motion> {
        set q [ expr ($starty - %y) / 400.0 ]
	set texscale [expr $texscale0 * exp($q)]
        texscale .f1.view $texscale
    }

    # set default values:
    set minfilter GL_NEAREST_MIPMAP_LINEAR
    set magfilter GL_LINEAR
    set swrap GL_REPEAT
    set twrap GL_REPEAT
    set envmode GL_MODULATE
    set image CHECKER
    set poly_red 255
    set poly_green 255
    set poly_blue 255
    set coord_scale 1.0

    set xangle 0.0
    set yangle 0.0
    set texscale 1.0
}


# Execution starts here!
if { [info script] == $argv0 } {
	::texture::setup
}

blob
data 142607
/* $Id$ */

/* vi:set sw=4: */

/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2008  Greg Couch
 * See the LICENSE file for copyright details.
 */

/* 
 * Currently we support X11, Win32 and Mac OS X only
 */

#define USE_TOGL_STUB_PROCS
#include "togl.h"
#include <tclInt.h>
#include <tkInt.h>
#include <limits.h>

#ifndef TOGL_USE_FONTS
#  define TOGL_USE_FONTS 1
#endif
#ifndef TOGL_USE_OVERLAY
#  if defined(TOGL_X11) || defined(TOGL_WGL)
#    define TOGL_USE_OVERLAY 1
#  endif
#endif

/* Use TCL_STUPID to cast (const char *) to (char *) where the Tcl function
 * prototype argument should really be const */
#define TCL_STUPID (char *)

/* Use WIDGREC to cast widgRec or recordPtr arguments */
#define WIDGREC	(char *)

/*** Windows headers ***/
#if defined(TOGL_WGL)
#  define WIN32_LEAN_AND_MEAN
#  include <windows.h>
#  undef WIN32_LEAN_AND_MEAN
#  include <winnt.h>
#  ifndef PFD_SUPPORT_COMPOSITION
// for Vista -- not strictly needed because we don't use PFD_SUPPORT_GDI/BITMAP
#    define PFD_SUPPORT_COMPOSITION 0x00008000
#  endif
#  include <objbase.h>
#  ifdef _MSC_VER
#    include <strsafe.h>
#    include "StereoI/StereoI.h"        /* NVidia Consumer 3D stereo */
#  else
#    ifdef UNICODE
#      define StringCchPrintf snwprintf
#    else
#      define StringCchPrintf snprintf
#    endif
#  endif

/*** X Window System headers ***/
#elif defined(TOGL_X11)
#  include <X11/Xlib.h>
#  include <X11/Xutil.h>
#  include <X11/Xatom.h>        /* for XA_RGB_DEFAULT_MAP atom */
#  if defined(__vms)
#    include <X11/StdCmap.h>    /* for XmuLookupStandardColormap */
#  else
#    include <X11/Xmu/StdCmap.h>        /* for XmuLookupStandardColormap */
#  endif
#  include <GL/glx.h>
#  ifdef __sgi
#    include <X11/extensions/SGIStereo.h>
#  endif
#  ifdef HAVE_AUTOSTEREO
#    include <autostereo.h>
#  endif

/*** Mac headers ***/
#elif defined(TOGL_AGL)
#  define Cursor QDCursor
#  include <AGL/agl.h>
#  undef Cursor
#  include <tkMacOSXInt.h>      /* usa MacDrawable */
#  include <ApplicationServices/ApplicationServices.h>

#else /* make sure only one platform defined */
#  error Unsupported platform, or confused platform defines...
#endif

#define NC3D "NVidia Consumer 3D Stereo"

#ifndef STEREO_BUFFER_NONE
/* From <X11/extensions/SGIStereo.h>, but we use this constants elsewhere */
#  define STEREO_BUFFER_NONE 0
#  define STEREO_BUFFER_LEFT 1
#  define STEREO_BUFFER_RIGHT 2
#endif

/*** Standard C headers ***/
#include <assert.h>
#include <stdlib.h>
#include <string.h>

#ifdef TOGL_WGL
#  include <tkPlatDecls.h>
#endif

#if TK_MAJOR_VERSION < 8
#  error Sorry Togl requires Tcl/Tk ver 8.0 or higher.
#endif

#ifdef USE_TCL_STUBS
#  if TK_MAJOR_VERSION < 8 || (TK_MAJOR_VERSION == 8 && TK_MINOR_VERSION < 1)
#    error Sorry stub support requires Tcl/Tk ver 8.1 or higher.
#  endif
#endif

#if defined(TOGL_AGL)
#  if TK_MAJOR_VERSION < 8 || (TK_MAJOR_VERSION == 8 && TK_MINOR_VERSION < 4)
#    error Sorry Mac Aqua version requires Tcl/Tk ver 8.4.0 or higher.
#  endif
#endif /* TOGL_AGL */

/* workaround for bug #123153 in tcl ver8.4a2 (tcl.h) */
#if defined(Tcl_InitHashTable) && defined(USE_TCL_STUBS)
#  undef Tcl_InitHashTable
#  define Tcl_InitHashTable (tclStubsPtr->tcl_InitHashTable)
#endif
#if TK_MAJOR_VERSION > 8 || (TK_MAJOR_VERSION == 8 && TK_MINOR_VERSION >= 4)
#  define HAVE_TK_SETCLASSPROCS
/* pointer to Tk_SetClassProcs function in the stub table */

static void (*SetClassProcsPtr)
        _ANSI_ARGS_((Tk_Window, Tk_ClassProcs *, ClientData));
#endif

/* 
 * Copy of TkClassProcs declarations from tkInt.h
 * (this is needed for Tcl ver =< 8.4a3)
 */

typedef Window (TkClassCreateProc) _ANSI_ARGS_((Tk_Window tkwin,
                Window parent, ClientData instanceData));
typedef void (TkClassGeometryProc) _ANSI_ARGS_((ClientData instanceData));
typedef void (TkClassModalProc) _ANSI_ARGS_((Tk_Window tkwin,
                XEvent *eventPtr));
typedef struct TkClassProcs
{
    TkClassCreateProc *createProc;
    TkClassGeometryProc *geometryProc;
    TkClassModalProc *modalProc;
} TkClassProcs;


/* Defaults */
#define DEFAULT_WIDTH		"400"
#define DEFAULT_HEIGHT		"400"
#define DEFAULT_IDENT		""
#define DEFAULT_FONTNAME	"Courier"
#define DEFAULT_TIME		"1"


#ifdef TOGL_WGL
/* Maximum size of a logical palette corresponding to a colormap in color index 
 * mode. */
#  define MAX_CI_COLORMAP_SIZE 4096
#  define MAX_CI_COLORMAP_BITS 12

#  if TOGL_USE_FONTS != 1
/* 
 * copy of TkWinColormap from tkWinInt.h
 */

typedef struct
{
    HPALETTE palette;           /* Palette handle used when drawing. */
    UINT    size;               /* Number of entries in the palette. */
    int     stale;              /* 1 if palette needs to be realized, otherwise 
                                 * 0.  If the palette is stale, then an idle
                                 * handler is scheduled to realize the palette. 
                                 */
    Tcl_HashTable refCounts;    /* Hash table of palette entry reference counts
                                 * indexed by pixel value. */
} TkWinColormap;
#  else
#    include <tkWinInt.h>
#  endif

static  LRESULT(CALLBACK *tkWinChildProc) (HWND hwnd, UINT message,
        WPARAM wParam, LPARAM lParam) = NULL;

#  define TK_WIN_CHILD_CLASS_NAME "TkChild"

#endif /* TOGL_WGL */


#define MAX(a,b)	(((a)>(b))?(a):(b))

#define TCL_ERR(interp, string)			\
   do {						\
      Tcl_ResetResult(interp);			\
      Tcl_AppendResult(interp, string, NULL);	\
      return TCL_ERROR;				\
   } while (0)

/* The constant DUMMY_WINDOW is used to signal window creation failure from
 * Togl_CreateWindow() */
#define DUMMY_WINDOW ((Window) -1)

#define ALL_EVENTS_MASK 	\
   (KeyPressMask		\
   |KeyReleaseMask		\
   |ButtonPressMask		\
   |ButtonReleaseMask		\
   |EnterWindowMask		\
   |LeaveWindowMask		\
   |PointerMotionMask		\
   |ExposureMask		\
   |VisibilityChangeMask	\
   |FocusChangeMask		\
   |PropertyChangeMask		\
   |ColormapChangeMask)

/* 
 * The following structure contains pointers to functions used for
 * processing the custom "-stereo" option.  Copied from tkPanedWindow.c.
 */
static int SetStereo(ClientData clientData, Tcl_Interp *interp,
        Tk_Window tkwin, Tcl_Obj **value, char *recordPtr,
        int internalOffset, char *oldInternalPtr, int flags);
static Tcl_Obj *GetStereo(ClientData clientData, Tk_Window tkwin,
        char *recordPtr, int internalOffset);
static void RestoreStereo(ClientData clientData, Tk_Window tkwin,
        char *internalPtr, char *oldInternalPtr);

static Tk_ObjCustomOption stereoOption = {
    "stereo",                   /* name */
    SetStereo,                  /* setProc */
    GetStereo,                  /* getProc */
    RestoreStereo,              /* restoreProc */
    NULL,                       /* freeProc */
    0
};

/* 
 * Stuff we initialize on a per package (Togl_Init) basis.
 * Since Tcl uses one interpreter per thread, any per-thread
 * data goes here.
 */
struct Togl_PackageGlobals
{
    Tk_OptionTable optionTable; /* Used to parse options */
    Togl   *toglHead;           /* Head of linked list of all Togl widgets */
    int     nextContextTag;     /* Used to assign similar context tags */
};
typedef struct Togl_PackageGlobals Togl_PackageGlobals;

extern ToglStubs toglStubs;     /* should be only non-const global */

struct Togl
{
    Togl   *Next;               /* next in linked list */

#if defined(TOGL_WGL)
    HDC     tglGLHdc;           /* Device context of device that OpenGL calls
                                 * will be drawn on */
    HGLRC   tglGLHglrc;         /* OpenGL rendering context to be made current */
    int     CiColormapSize;     /* (Maximum) size of colormap in color index
                                 * mode */
#  ifdef STEREO_I_H
    StereoI *pStereoI;
#  endif
#elif defined(TOGL_X11)
    GLXContext GlCtx;           /* Normal planes GLX context */
#elif defined(TOGL_AGL)
    AGLContext aglCtx;
#endif
    int     contextTag;         /* all contexts with same tag share display
                                 * lists */

    XVisualInfo *VisInfo;       /* Visual info of the current */

    Display *display;           /* X's token for the window's display. */
    Tk_Window TkWin;            /* Tk window structure */
    Tcl_Interp *Interp;         /* Tcl interpreter */
    Tcl_Command widgetCmd;      /* Token for togl's widget command */
    Togl_PackageGlobals *tpg;   /* Used to access globals */
#ifndef NO_TK_CURSOR
    Tk_Cursor Cursor;           /* The widget's cursor */
#endif
    int     Width, Height;      /* Dimensions of window */
    int     SetGrid;            /* positive is grid size for window manager */
    int     TimerInterval;      /* Time interval for timer in milliseconds */
    Tcl_TimerToken timerHandler;        /* Token for togl's timer handler */
    Bool    RgbaFlag;           /* configuration flags (ala GLX parameters) */
    int     RgbaRed;
    int     RgbaGreen;
    int     RgbaBlue;
    Bool    DoubleFlag;
    Bool    DepthFlag;
    int     DepthSize;
    Bool    AccumFlag;
    int     AccumRed;
    int     AccumGreen;
    int     AccumBlue;
    int     AccumAlpha;
    Bool    AlphaFlag;
    int     AlphaSize;
    Bool    StencilFlag;
    int     StencilSize;
    Bool    PrivateCmapFlag;
    Bool    OverlayFlag;
    int     Stereo;
    double  EyeSeparation;
    double  Convergence;
    int     AuxNumber;
    Bool    Indirect;
    int     PixelFormat;
    int     SwapInterval;
    const char *ShareList;      /* name (ident) of Togl to share dlists with */
    const char *ShareContext;   /* name (ident) to share OpenGL context with */

    const char *Ident;          /* User's identification string */
    ClientData Client_Data;     /* Pointer to user data */

    Bool    UpdatePending;      /* Should normal planes be redrawn? */

    Tcl_Obj *CreateProc;        /* Callback when widget is realized */
    Tcl_Obj *DisplayProc;       /* Callback when widget is redrawn */
    Tcl_Obj *ReshapeProc;       /* Callback when window size changes */
    Tcl_Obj *DestroyProc;       /* Callback when widget is destroyed */
    Tcl_Obj *TimerProc;         /* Callback when widget is idle */

    /* Overlay stuff */
#if defined(TOGL_X11)
    GLXContext OverlayCtx;      /* Overlay planes OpenGL context */
#elif defined(TOGL_WGL)
    HGLRC   tglGLOverlayHglrc;
#endif

    Window  OverlayWindow;      /* The overlay window, or 0 */
    Tcl_Obj *OverlayDisplayProc;        /* Overlay redraw proc */
    Bool    OverlayUpdatePending;       /* Should overlay be redrawn? */
    Colormap OverlayCmap;       /* colormap for overlay is created */
    int     OverlayTransparentPixel;    /* transparent pixel */
    Bool    OverlayIsMapped;

    GLfloat *EpsRedMap;         /* Index2RGB Maps for Color index modes */
    GLfloat *EpsGreenMap;
    GLfloat *EpsBlueMap;
    GLint   EpsMapSize;         /* = Number of indices in our Togl */
    int     currentStereoBuffer;
#ifdef HAVE_AUTOSTEREO
    int     as_initialized;     /* for autostereo package */
    ASHandle ash;               /* for autostereo package */
#endif
    int     badWindow;          /* true when Togl_CreateWindow fails */
};


/* 
 * Prototypes for functions local to this file
 */
static int Togl_ObjCmd(ClientData clientData, Tcl_Interp *interp,
        int objc, Tcl_Obj *const *objv);
static void Togl_ObjCmdDelete(ClientData clientData);
static void Togl_EventProc(ClientData clientData, XEvent *eventPtr);
static Window Togl_CreateWindow(Tk_Window, Window, ClientData);
static void Togl_WorldChanged(ClientData);

#ifdef MESA_COLOR_HACK
static int get_free_color_cells(Display *display, int screen,
        Colormap colormap);
static void free_default_color_cells(Display *display, Colormap colormap);
#endif
static void ToglCmdDeletedProc(ClientData);

#if defined(TOGL_AGL)
static void SetMacBufRect(Togl *togl);
#endif


/* 
 * Setup Togl widget configuration options:
 */

#define GEOMETRY_MASK 0x1       /* widget geometry */
#define FORMAT_MASK 0x2         /* pixel format */
#define CURSOR_MASK 0x4
#define TIMER_MASK 0x8
#define OVERLAY_MASK 0x10
#define SWAP_MASK 0x20
#define STEREO_MASK 0x40
#define STEREO_FORMAT_MASK 0x80

static Tk_OptionSpec optionSpecs[] = {
    {TK_OPTION_PIXELS, TCL_STUPID "-height", "height", "Height",
                DEFAULT_HEIGHT, -1, Tk_Offset(Togl, Height), 0, NULL,
            GEOMETRY_MASK},
    {TK_OPTION_PIXELS, TCL_STUPID "-width", "width", "Width",
                DEFAULT_WIDTH, -1, Tk_Offset(Togl, Width), 0, NULL,
            GEOMETRY_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-rgba", "rgba", "Rgba",
            "true", -1, Tk_Offset(Togl, RgbaFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-redsize", "redsize", "RedSize",
            "1", -1, Tk_Offset(Togl, RgbaRed), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-greensize", "greensize", "GreenSize",
            "1", -1, Tk_Offset(Togl, RgbaGreen), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-bluesize", "bluesize", "BlueSize",
            "1", -1, Tk_Offset(Togl, RgbaBlue), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-double", "double", "Double",
            "false", -1, Tk_Offset(Togl, DoubleFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-depth", "depth", "Depth",
            "false", -1, Tk_Offset(Togl, DepthFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-depthsize", "depthsize", "DepthSize",
            "1", -1, Tk_Offset(Togl, DepthSize), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-accum", "accum", "Accum",
            "false", -1, Tk_Offset(Togl, AccumFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-accumredsize", "accumredsize", "AccumRedSize",
            "1", -1, Tk_Offset(Togl, AccumRed), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-accumgreensize", "accumgreensize",
                "AccumGreenSize",
            "1", -1, Tk_Offset(Togl, AccumGreen), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-accumbluesize", "accumbluesize",
                "AccumBlueSize",
            "1", -1, Tk_Offset(Togl, AccumBlue), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-accumalphasize", "accumalphasize",
                "AccumAlphaSize",
            "1", -1, Tk_Offset(Togl, AccumAlpha), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-alpha", "alpha", "Alpha",
            "false", -1, Tk_Offset(Togl, AlphaFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-alphasize", "alphasize", "AlphaSize",
            "1", -1, Tk_Offset(Togl, AlphaSize), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-stencil", "stencil", "Stencil",
            "false", -1, Tk_Offset(Togl, StencilFlag), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-stencilsize", "stencilsize", "StencilSize",
            "1", -1, Tk_Offset(Togl, StencilSize), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-auxbuffers", "auxbuffers", "AuxBuffers",
            "0", -1, Tk_Offset(Togl, AuxNumber), 0, NULL, FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-privatecmap", "privateCmap", "PrivateCmap",
                "false", -1, Tk_Offset(Togl, PrivateCmapFlag), 0, NULL,
            FORMAT_MASK},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-overlay", "overlay", "Overlay",
            "false", -1, Tk_Offset(Togl, OverlayFlag), 0, NULL, OVERLAY_MASK},
    {TK_OPTION_CUSTOM, TCL_STUPID "-stereo", "stereo", "Stereo",
                "", -1, Tk_Offset(Togl, Stereo), 0,
            (ClientData) &stereoOption, STEREO_FORMAT_MASK},
    {TK_OPTION_DOUBLE, TCL_STUPID "-eyeseparation", "eyeseparation",
                "EyeSeparation",
            "2.0", -1, Tk_Offset(Togl, EyeSeparation), 0, NULL, STEREO_MASK},
    {TK_OPTION_DOUBLE, TCL_STUPID "-convergence", "convergence", "Convergence",
            "35.0", -1, Tk_Offset(Togl, Convergence), 0, NULL, STEREO_MASK},
#ifndef NO_TK_CURSOR
    {TK_OPTION_CURSOR, TCL_STUPID "-cursor", "cursor", "Cursor",
                "", -1, Tk_Offset(Togl, Cursor), TK_OPTION_NULL_OK, NULL,
            CURSOR_MASK},
#endif
    {TK_OPTION_INT, TCL_STUPID "-setgrid", "setGrid", "SetGrid",
            "0", -1, Tk_Offset(Togl, SetGrid), 0, NULL, GEOMETRY_MASK},
    {TK_OPTION_INT, TCL_STUPID "-time", "time", "Time",
                DEFAULT_TIME, -1, Tk_Offset(Togl, TimerInterval), 0, NULL,
            TIMER_MASK},
    {TK_OPTION_STRING, TCL_STUPID "-sharelist", "sharelist", "ShareList",
            NULL, -1, Tk_Offset(Togl, ShareList), 0, NULL, FORMAT_MASK},
    {TK_OPTION_STRING, TCL_STUPID "-sharecontext", "sharecontext",
                "ShareContext", NULL,
            -1, Tk_Offset(Togl, ShareContext), 0, NULL, FORMAT_MASK},
    {TK_OPTION_STRING, TCL_STUPID "-ident", "ident", "Ident",
            DEFAULT_IDENT, -1, Tk_Offset(Togl, Ident), 0, NULL, 0},
    {TK_OPTION_BOOLEAN, TCL_STUPID "-indirect", "indirect", "Indirect",
            "false", -1, Tk_Offset(Togl, Indirect), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-pixelformat", "pixelFormat", "PixelFormat",
            "0", -1, Tk_Offset(Togl, PixelFormat), 0, NULL, FORMAT_MASK},
    {TK_OPTION_INT, TCL_STUPID "-swapinterval", "swapInterval", "SwapInterval",
            "1", -1, Tk_Offset(Togl, SwapInterval), 0, NULL, SWAP_MASK},
    {TK_OPTION_STRING, TCL_STUPID "-createcommand", "createCommand",
                "CallbackCommand", NULL,
            Tk_Offset(Togl, CreateProc), -1, TK_OPTION_NULL_OK, NULL, 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-create", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-createcommand", 0},
    {TK_OPTION_STRING, TCL_STUPID "-displaycommand", "displayCommand",
                "CallbackCommand", NULL,
            Tk_Offset(Togl, DisplayProc), -1, TK_OPTION_NULL_OK, NULL, 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-display", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-displaycommand", 0},
    {TK_OPTION_STRING, TCL_STUPID "-reshapecommand", "reshapeCommand",
                "CallbackCommand", NULL,
            Tk_Offset(Togl, ReshapeProc), -1, TK_OPTION_NULL_OK, NULL, 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-reshape", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-reshapecommand", 0},
    {TK_OPTION_STRING, TCL_STUPID "-destroycommand", "destroyCommand",
                "CallbackCommand", NULL,
            Tk_Offset(Togl, DestroyProc), -1, TK_OPTION_NULL_OK, NULL, 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-destroy", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-destroycommand", 0},
    {TK_OPTION_STRING, TCL_STUPID "-timercommand", "timerCommand",
                "CallabckCommand", NULL,
            Tk_Offset(Togl, TimerProc), -1, TK_OPTION_NULL_OK, NULL, 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-timer", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-timercommand", 0},
    {TK_OPTION_STRING, TCL_STUPID "-overlaydisplaycommand",
                "overlaydisplayCommand", "CallbackCommand", NULL,
                Tk_Offset(Togl, OverlayDisplayProc), -1,
            TK_OPTION_NULL_OK, NULL, OVERLAY_MASK},
    {TK_OPTION_SYNONYM, TCL_STUPID "-overlaydisplay", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-overlaydisplaycommand", 0},
    /* Tcl3D backwards compatibility */
    {TK_OPTION_SYNONYM, TCL_STUPID "-createproc", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-createcommand", 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-displayproc", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-displaycommand", 0},
    {TK_OPTION_SYNONYM, TCL_STUPID "-reshapeproc", NULL, NULL,
            NULL, -1, -1, 0, (ClientData) "-reshapecommand", 0},
    /* end Tcl3D compatibility */
    {TK_OPTION_END, NULL, NULL, NULL, NULL, -1, -1, 0, NULL, 0}
};

/* 
 * Add given togl widget to linked list.
 */
static void
AddToList(Togl *t)
{
    t->Next = t->tpg->toglHead;
    t->tpg->toglHead = t;
}

/* 
 * Remove given togl widget from linked list.
 */
static void
RemoveFromList(Togl *t)
{
    Togl   *prev;
    Togl   *cur;

    for (cur = t->tpg->toglHead, prev = NULL; cur; prev = cur, cur = cur->Next) {
        if (t != cur)
            continue;
        if (prev) {
            prev->Next = cur->Next;
        } else {
            t->tpg->toglHead = cur->Next;
        }
        break;
    }
    if (cur)
        cur->Next = NULL;
}

/* 
 * Return pointer to togl widget given a user identifier string.
 */
static Togl *
FindTogl(Togl *togl, const char *ident)
{
    Togl   *t;

    for (t = togl->tpg->toglHead; t; t = t->Next) {
        if (strcmp(t->Ident, ident) == 0)
            break;
    }
    return t;
}


/* 
 * Return pointer to another togl widget with same OpenGL context.
 */
static Togl *
FindToglWithSameContext(Togl *togl)
{
    Togl   *t;

    for (t = togl->tpg->toglHead; t != NULL; t = t->Next) {
        if (t == togl)
            continue;
#if defined(TOGL_WGL)
        if (t->tglGLHglrc == togl->tglGLHglrc)
#elif defined(TOGL_X11)
        if (t->GlCtx == togl->GlCtx)
#elif defined(TOGL_AGL)
        if (t->aglCtx == togl->aglCtx)
#endif
        {
            return t;
        }
    }
    return NULL;
}

#if TOGL_USE_OVERLAY
/* 
 * Return pointer to another togl widget with same OpenGL overlay context.
 */
static Togl *
FindToglWithSameOverlayContext(Togl *togl)
{
    Togl   *t;

    for (t = togl->tpg->toglHead; t != NULL; t = t->Next) {
        if (t == togl)
            continue;
#  if defined(TOGL_X11)
        if (t->OverlayCtx == togl->OverlayCtx)
#  elif defined(TOGL_WGL)
        if (t->tglGLOverlayHglrc == togl->tglGLOverlayHglrc)
#  endif
        {
            return t;
        }
    }
    return NULL;
}
#endif

#if defined(TOGL_X11)
/* 
 * Return an X colormap to use for OpenGL RGB-mode rendering.
 * Input:  dpy - the X display
 *         scrnum - the X screen number
 *         visinfo - the XVisualInfo as returned by glXChooseVisual()
 * Return:  an X Colormap or 0 if there's a _serious_ error.
 */
static Colormap
get_rgb_colormap(Display *dpy,
        int scrnum, const XVisualInfo *visinfo, Tk_Window tkwin)
{
    Atom    hp_cr_maps;
    Status  status;
    int     numCmaps;
    int     i;
    XStandardColormap *standardCmaps;
    Window  root = XRootWindow(dpy, scrnum);
    Bool    using_mesa;

    /* 
     * First check if visinfo's visual matches the default/root visual.
     */
    if (visinfo->visual == Tk_Visual(tkwin)) {
        /* use the default/root colormap */
        Colormap cmap;

        cmap = Tk_Colormap(tkwin);
#  ifdef MESA_COLOR_HACK
        (void) get_free_color_cells(dpy, scrnum, cmap);
#  endif
        return cmap;
    }

    /* 
     * Check if we're using Mesa.
     */
    if (strstr(glXQueryServerString(dpy, scrnum, GLX_VERSION), "Mesa")) {
        using_mesa = True;
    } else {
        using_mesa = False;
    }

    /* 
     * Next, if we're using Mesa and displaying on an HP with the "Color
     * Recovery" feature and the visual is 8-bit TrueColor, search for a
     * special colormap initialized for dithering.  Mesa will know how to
     * dither using this colormap.
     */
    if (using_mesa) {
        hp_cr_maps = XInternAtom(dpy, "_HP_RGB_SMOOTH_MAP_LIST", True);
        if (hp_cr_maps
#  ifdef __cplusplus
                && visinfo->visual->c_class == TrueColor
#  else
                && visinfo->visual->class == TrueColor
#  endif
                && visinfo->depth == 8) {
            status = XGetRGBColormaps(dpy, root, &standardCmaps,
                    &numCmaps, hp_cr_maps);
            if (status) {
                for (i = 0; i < numCmaps; i++) {
                    if (standardCmaps[i].visualid == visinfo->visual->visualid) {
                        Colormap cmap = standardCmaps[i].colormap;

                        (void) XFree(standardCmaps);
                        return cmap;
                    }
                }
                (void) XFree(standardCmaps);
            }
        }
    }

    /* 
     * Next, try to find a standard X colormap.
     */
#  if !HP && !SUN
#    ifndef SOLARIS_BUG
    status = XmuLookupStandardColormap(dpy, visinfo->screen,
            visinfo->visualid, visinfo->depth, XA_RGB_DEFAULT_MAP,
            /* replace */ False, /* retain */ True);
    if (status == 1) {
        status = XGetRGBColormaps(dpy, root, &standardCmaps,
                &numCmaps, XA_RGB_DEFAULT_MAP);
        if (status == 1) {
            for (i = 0; i < numCmaps; i++) {
                if (standardCmaps[i].visualid == visinfo->visualid) {
                    Colormap cmap = standardCmaps[i].colormap;

                    (void) XFree(standardCmaps);
                    return cmap;
                }
            }
            (void) XFree(standardCmaps);
        }
    }
#    endif
#  endif

    /* 
     * If we get here, give up and just allocate a new colormap.
     */
    return XCreateColormap(dpy, root, visinfo->visual, AllocNone);
}
#elif defined(TOGL_WGL)

/* Code to create RGB palette is taken from the GENGL sample program of Win32
 * SDK */

static const unsigned char threeto8[8] = {
    0, 0111 >> 1, 0222 >> 1, 0333 >> 1, 0444 >> 1, 0555 >> 1, 0666 >> 1, 0377
};

static const unsigned char twoto8[4] = {
    0, 0x55, 0xaa, 0xff
};

static const unsigned char oneto8[2] = {
    0, 255
};

static const int defaultOverride[13] = {
    0, 3, 24, 27, 64, 67, 88, 173, 181, 236, 247, 164, 91
};

static const PALETTEENTRY defaultPalEntry[20] = {
    {0, 0, 0, 0},
    {0x80, 0, 0, 0},
    {0, 0x80, 0, 0},
    {0x80, 0x80, 0, 0},
    {0, 0, 0x80, 0},
    {0x80, 0, 0x80, 0},
    {0, 0x80, 0x80, 0},
    {0xC0, 0xC0, 0xC0, 0},

    {192, 220, 192, 0},
    {166, 202, 240, 0},
    {255, 251, 240, 0},
    {160, 160, 164, 0},

    {0x80, 0x80, 0x80, 0},
    {0xFF, 0, 0, 0},
    {0, 0xFF, 0, 0},
    {0xFF, 0xFF, 0, 0},
    {0, 0, 0xFF, 0},
    {0xFF, 0, 0xFF, 0},
    {0, 0xFF, 0xFF, 0},
    {0xFF, 0xFF, 0xFF, 0}
};

static unsigned char
ComponentFromIndex(int i, UINT nbits, UINT shift)
{
    unsigned char val;

    val = (unsigned char) (i >> shift);
    switch (nbits) {

      case 1:
          val &= 0x1;
          return oneto8[val];

      case 2:
          val &= 0x3;
          return twoto8[val];

      case 3:
          val &= 0x7;
          return threeto8[val];

      default:
          return 0;
    }
}

static Colormap
Win32CreateRgbColormap(PIXELFORMATDESCRIPTOR pfd)
{
    TkWinColormap *cmap = (TkWinColormap *) ckalloc(sizeof (TkWinColormap));
    LOGPALETTE *pPal;
    int     n, i;

    n = 1 << pfd.cColorBits;
    pPal = (PLOGPALETTE) LocalAlloc(LMEM_FIXED, sizeof (LOGPALETTE)
            + n * sizeof (PALETTEENTRY));
    pPal->palVersion = 0x300;
    pPal->palNumEntries = n;
    for (i = 0; i < n; i++) {
        pPal->palPalEntry[i].peRed =
                ComponentFromIndex(i, pfd.cRedBits, pfd.cRedShift);
        pPal->palPalEntry[i].peGreen =
                ComponentFromIndex(i, pfd.cGreenBits, pfd.cGreenShift);
        pPal->palPalEntry[i].peBlue =
                ComponentFromIndex(i, pfd.cBlueBits, pfd.cBlueShift);
        pPal->palPalEntry[i].peFlags = 0;
    }

    /* fix up the palette to include the default GDI palette */
    if ((pfd.cColorBits == 8)
            && (pfd.cRedBits == 3) && (pfd.cRedShift == 0)
            && (pfd.cGreenBits == 3) && (pfd.cGreenShift == 3)
            && (pfd.cBlueBits == 2) && (pfd.cBlueShift == 6)) {
        for (i = 1; i <= 12; i++)
            pPal->palPalEntry[defaultOverride[i]] = defaultPalEntry[i];
    }

    cmap->palette = CreatePalette(pPal);
    LocalFree(pPal);
    cmap->size = n;
    cmap->stale = 0;

    /* Since this is a private colormap of a fix size, we do not need a valid
     * hash table, but a dummy one */

    Tcl_InitHashTable(&cmap->refCounts, TCL_ONE_WORD_KEYS);
    return (Colormap) cmap;
}

static Colormap
Win32CreateCiColormap(Togl *togl)
{
    /* Create a colormap with size of togl->CiColormapSize and set all entries
     * to black */

    LOGPALETTE logPalette;
    TkWinColormap *cmap = (TkWinColormap *) ckalloc(sizeof (TkWinColormap));

    logPalette.palVersion = 0x300;
    logPalette.palNumEntries = 1;
    logPalette.palPalEntry[0].peRed = 0;
    logPalette.palPalEntry[0].peGreen = 0;
    logPalette.palPalEntry[0].peBlue = 0;
    logPalette.palPalEntry[0].peFlags = 0;

    cmap->palette = CreatePalette(&logPalette);
    cmap->size = togl->CiColormapSize;
    ResizePalette(cmap->palette, cmap->size);   /* sets new entries to black */
    cmap->stale = 0;

    /* Since this is a private colormap of a fix size, we do not need a valid
     * hash table, but a dummy one */

    Tcl_InitHashTable(&cmap->refCounts, TCL_ONE_WORD_KEYS);
    return (Colormap) cmap;
}

/* ErrorExit is from <http://msdn2.microsoft.com/en-us/library/ms680582.aspx> */
static void
ErrorExit(LPTSTR lpszFunction)
{
    /* Retrieve the system error message for the last-error code */
    LPTSTR  lpMsgBuf;
    LPTSTR  lpDisplayBuf;
    DWORD   err = GetLastError();

    if (err == 0) {
        /* The function said it failed, but GetLastError says it didn't, so
         * pretend it didn't. */
        return;
    }

    FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER
            | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
            NULL, err, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
            (LPTSTR) &lpMsgBuf, 0, NULL);

    /* Display the error message and exit the process */

    lpDisplayBuf = (LPTSTR) LocalAlloc(LMEM_ZEROINIT,
            (lstrlen(lpMsgBuf) + lstrlen(lpszFunction) + 40) * sizeof (TCHAR));
    StringCchPrintf(lpDisplayBuf, LocalSize(lpDisplayBuf),
            TEXT("%s failed with error %ld: %s"), lpszFunction, err, lpMsgBuf);
    MessageBox(NULL, lpDisplayBuf, TEXT("Error"), MB_OK);

    LocalFree(lpMsgBuf);
    LocalFree(lpDisplayBuf);
    ExitProcess(err);
}
#endif

/* 
 * Togl_Init
 *
 *   Called upon system startup to create togl command.
 */
int
Togl_Init(Tcl_Interp *interp)
{
    int     major, minor, patchLevel, releaseType;

#ifdef USE_TCL_STUBS
    if (Tcl_InitStubs(interp, "8.1", 0) == NULL) {
        return TCL_ERROR;
    }
#endif
#ifdef USE_TK_STUBS
    if (Tk_InitStubs(interp, TCL_STUPID "8.1", 0) == NULL) {
        return TCL_ERROR;
    }
#endif

    Tcl_GetVersion(&major, &minor, &patchLevel, &releaseType);
#ifdef HAVE_TK_SETCLASSPROCS
    if (major > 8
            || (major == 8
                    && (minor > 4
                            || (minor == 4 && (releaseType > 0
                                            || patchLevel >= 2))))) {
#  ifdef USE_TK_STUBS
        SetClassProcsPtr = tkStubsPtr->tk_SetClassProcs;
#  else
        SetClassProcsPtr = Tk_SetClassProcs;
#  endif
    } else {
        SetClassProcsPtr = NULL;
    }
#else
    if (major > 8
            || (major == 8
                    && (minor > 4
                            || (minor == 4 && (releaseType > 0
                                            || patchLevel >= 2))))) {
        TCL_ERR(interp,
                "Sorry, this instance of Togl was not compiled to work with Tcl/Tk 8.4a2 or higher.");
    }
#endif

    if (Tcl_CreateObjCommand(interp, "togl", Togl_ObjCmd, NULL,
                    Togl_ObjCmdDelete) == NULL) {
        return TCL_ERROR;
    }

    if (Tcl_PkgProvideEx(interp, "Togl", TOGL_VERSION, &toglStubs) != TCL_OK) {
        return TCL_ERROR;
    }

    return TCL_OK;
}


/* 
 * Togl_CallCallback
 *
 * Call command with togl widget as only argument
 */

int
Togl_CallCallback(Togl *togl, Tcl_Obj *cmd)
{
    int     result;
    Tcl_Obj *objv[3];

    if (cmd == NULL || togl->widgetCmd == NULL)
        return TCL_OK;

    objv[0] = cmd;
    Tcl_IncrRefCount(objv[0]);
    objv[1] =
            Tcl_NewStringObj(Tcl_GetCommandName(togl->Interp, togl->widgetCmd),
            -1);
    Tcl_IncrRefCount(objv[1]);
    objv[2] = NULL;
    result = Tcl_EvalObjv(togl->Interp, 2, objv, TCL_EVAL_GLOBAL);
    Tcl_DecrRefCount(objv[1]);
    Tcl_DecrRefCount(objv[0]);
    return result;
}


/* 
 * Togl_Timer
 *
 * Gets called from Tk_CreateTimerHandler.
 */
static void
Togl_Timer(ClientData clientData)
{
    Togl   *togl = (Togl *) clientData;

    if (togl->TimerProc) {
        if (Togl_CallCallback(togl, togl->TimerProc) != TCL_OK) {
            togl->timerHandler = NULL;
            return;
        }
        /* 
         * Re-register this callback since Tcl/Tk timers are "one-shot".
         * That is, after the timer callback is called it not normally
         * called again.  That's not the behavior we want for Togl.
         */
        togl->timerHandler =
                Tcl_CreateTimerHandler(togl->TimerInterval, Togl_Timer,
                (ClientData) togl);
    }
}


/* 
 * Togl_MakeCurrent
 *
 *   Bind the OpenGL rendering context to the specified
 *   Togl widget.  If given a NULL argument, then the
 *   OpenGL context is released without assigning a new one.
 */
void
Togl_MakeCurrent(const Togl *togl)
{
#if defined(TOGL_WGL)
    int     res = TRUE;

    if (togl == NULL) {
        HDC     hdc = wglGetCurrentDC();

        if (hdc != NULL)
            res = wglMakeCurrent(hdc, NULL);
    } else {
        res = wglMakeCurrent(togl->tglGLHdc, togl->tglGLHglrc);
    }
    if (!res) {
        ErrorExit(TEXT("wglMakeCurrent"));
    }
#elif defined(TOGL_X11)
    if (togl == NULL || togl->GlCtx == NULL) {
        Display *display = togl ? togl->display : glXGetCurrentDisplay();

        if (display)
            (void) glXMakeCurrent(display, None, NULL);
    } else {
        GLXDrawable drawable = togl->TkWin ? Tk_WindowId(togl->TkWin) : None;

        (void) glXMakeCurrent(togl->display, drawable, togl->GlCtx);
    }

#elif defined(TOGL_AGL)
    if (togl == NULL || togl->aglCtx == NULL) {
        (void) aglSetCurrentContext(NULL);
    } else {
        (void) aglSetCurrentContext(togl->aglCtx);
    }
#endif
}

/* 
 * Togl_TakePhoto
 *
 *   Take a photo image of the current OpenGL window.  May have problems
 *   if window is partially obscured, either by other windows or by the
 *   edges of the display.
 */
int
Togl_TakePhoto(Togl *togl, Tk_PhotoHandle photo)
{
    GLubyte *buffer;
    Tk_PhotoImageBlock photoBlock;
    int     y, midy;
    unsigned char *cp;
    int     width = Togl_Width(togl), height = Togl_Height(togl);

    /* 
     * TIP #116 altered Tk_PhotoPutBlock API to add interp arg that 8.4
     * doesn't have.
     * We need to remove that for compiling with 8.4.
     */
#if (TK_MAJOR_VERSION == 8) && (TK_MINOR_VERSION < 5)
#  define TK_PHOTOPUTBLOCK(interp, hdl, blk, x, y, w, h, cr) \
   		Tk_PhotoPutBlock(hdl, blk, x, y, w, h, cr)
#else
#  define TK_PHOTOPUTBLOCK	Tk_PhotoPutBlock
#endif
    buffer = (GLubyte *) ckalloc(width * height * 4);
    photoBlock.pixelPtr = buffer;
    photoBlock.width = width;
    photoBlock.height = height;
    photoBlock.pitch = width * 4;
    photoBlock.pixelSize = 4;
    photoBlock.offset[0] = 0;
    photoBlock.offset[1] = 1;
    photoBlock.offset[2] = 2;
    photoBlock.offset[3] = 3;

    glPushAttrib(GL_PIXEL_MODE_BIT);
    if (togl->DoubleFlag) {
        glReadBuffer(GL_FRONT);
    }

    if (!togl->RgbaFlag) {
#if defined(TOGL_WGL)
        /* Due to the lack of a unique inverse mapping from the frame buffer to
         * the logical palette we need a translation map from the complete
         * logical palette. */
        int     n, i;
        TkWinColormap *cmap = (TkWinColormap *) Tk_Colormap(togl->TkWin);
        LPPALETTEENTRY entry =
                (LPPALETTEENTRY) malloc(togl->EpsMapSize *
                sizeof (PALETTEENTRY));

        n = GetPaletteEntries(cmap->palette, 0, togl->EpsMapSize, entry);
        for (i = 0; i < n; i++) {
            togl->EpsRedMap[i] = (GLfloat) (entry[i].peRed / 255.0);
            togl->EpsGreenMap[i] = (GLfloat) (entry[i].peGreen / 255.0);
            togl->EpsBlueMap[i] = (GLfloat) (entry[i].peBlue / 255.0);
        }
        free(entry);
#endif /* TOGL_WGL */

        glPixelMapfv(GL_PIXEL_MAP_I_TO_R, togl->EpsMapSize, togl->EpsRedMap);
        glPixelMapfv(GL_PIXEL_MAP_I_TO_G, togl->EpsMapSize, togl->EpsGreenMap);
        glPixelMapfv(GL_PIXEL_MAP_I_TO_B, togl->EpsMapSize, togl->EpsBlueMap);
    }

    glPushClientAttrib(GL_CLIENT_PIXEL_STORE_BIT);
    glPixelStorei(GL_PACK_ALIGNMENT, 4);        /* guarantee performance */
    glPixelStorei(GL_PACK_SWAP_BYTES, GL_FALSE);
    glPixelStorei(GL_PACK_SKIP_PIXELS, 0);

#if 1
    glPixelStorei(GL_PACK_ROW_LENGTH, 0);
    glPixelStorei(GL_PACK_SKIP_ROWS, 0);
    glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, buffer);
    /* Some OpenGL drivers are buggy and return zero for Alpha instead of one
     * for RGB pixel formats.  If that is happening to you, upgrade your
     * graphics driver. */

    /* OpenGL's origin is bottom-left, Tk Photo image's is top-left, so mirror
     * the rows around the middle row. */
    midy = height / 2;
    cp = buffer;
    for (y = 0; y < midy; ++y) {
        int     m_y = height - 1 - y;   /* mirror y */
        unsigned char *m_cp = buffer + m_y * photoBlock.pitch;
        int     x;

        for (x = 0; x < photoBlock.pitch; ++x) {
            unsigned char c = *cp;

            *cp++ = *m_cp;
            *m_cp++ = c;
        }
    }
#else
    /* OpenGL's origin is bottom-left, Tk Photo image's is top-left, so save
     * rows in reverse order. */
    glPixelStorei(GL_PACK_ROW_LENGTH, width);
    glPixelStorei(GL_PACK_SKIP_ROWS, -1);
    glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE,
            buffer + width * (height - 1) * 4);
#endif

    TK_PHOTOPUTBLOCK(togl->Interp, photo, &photoBlock, 0, 0, width, height,
            TK_PHOTO_COMPOSITE_SET);

    glPopClientAttrib();        /* restore PACK_ALIGNMENT */
    glPopAttrib();              /* restore glReadBuffer */
    ckfree((char *) buffer);
    return TCL_OK;
}

Bool
Togl_SwapInterval(const Togl *togl, int interval)
{
#ifdef TOGL_AGL
    GLint   swapInterval = interval;

    return aglSetInteger(togl->aglCtx, AGL_SWAP_INTERVAL, &swapInterval);
#endif
#ifdef TOGL_WGL
    typedef BOOL (WINAPI *BOOLFuncInt) (int);
    typedef const char *(WINAPI *StrFuncHDC) (HDC);
    static BOOLFuncInt swapInterval = NULL;
    static  initialized = False;

    if (!initialized) {
        const char *extensions;
        StrFuncHDC getExtensionsString;

        getExtensionsString = (StrFuncHDC)
                wglGetProcAddress("wglGetExtensionsStringARB");
        if (getExtensionsString == NULL)
            getExtensionsString = (StrFuncHDC)
                    wglGetProcAddress("wglGetExtensionsStringEXT");
        if (getExtensionsString) {
            extensions = getExtensionsString(togl->tglGLHdc);
            if (strstr(extensions, "WGL_EXT_swap_control") != NULL) {
                swapInterval =
                        (BOOLFuncInt) wglGetProcAddress("wglSwapIntervalEXT");
            }
        }
        initialized = True;
    }
    if (swapInterval)
        return swapInterval(interval);
    return False;
#endif
#ifdef TOGL_X11
    typedef int (*IntFuncInt) (int);
    static IntFuncInt swapInterval = NULL;
    static int initialized = False;

    if (!initialized) {
        const char *extensions = glXQueryExtensionsString(togl->display,
                Tk_ScreenNumber(togl->TkWin));

        if (strstr(extensions, "GLX_SGI_swap_control") != NULL) {
            swapInterval = (IntFuncInt) Togl_GetProcAddr("glXSwapIntervalSGI");
        } else if (strstr(extensions, "GLX_MESA_swap_control") != NULL) {
            swapInterval = (IntFuncInt) Togl_GetProcAddr("glXSwapIntervalMESA");
        }
        initialized = True;
    }
    if (swapInterval)
        return swapInterval(interval) == 0;
    return False;
#endif
}

#if defined(TOGL_AGL)
/* tell OpenGL which part of the Mac window to render to */
static void
SetMacBufRect(Togl *togl)
{
    GLint   wrect[4];

    /* set wrect[0,1] to lower left corner of widget */
    wrect[2] = Tk_Width(togl->TkWin);
    wrect[3] = Tk_Height(togl->TkWin);
    wrect[0] = ((TkWindow *) (togl->TkWin))->privatePtr->xOff;

    Rect    r;

    GetPortBounds(((TkWindow *) (togl->TkWin))->privatePtr->toplevel->grafPtr,
            &r);

    wrect[1] = r.bottom -
            wrect[3] - ((TkWindow *) (togl->TkWin))->privatePtr->yOff;

    aglSetInteger(togl->aglCtx, AGL_BUFFER_RECT, wrect);
    aglEnable(togl->aglCtx, AGL_BUFFER_RECT);
    aglUpdateContext(togl->aglCtx);
}
#endif

/* 
 * Called when the widget's contents must be redrawn.  Basically, we
 * just call the user's render callback function.
 *
 * Note that the parameter type is ClientData so this function can be
 * passed to Tk_DoWhenIdle().
 */
static void
Togl_Render(ClientData clientData)
{
    Togl   *togl = (Togl *) clientData;

    if (togl->DisplayProc) {
        Togl_MakeCurrent(togl);
#ifdef TOGL_AGL
        SetMacBufRect(togl);
#endif
        Togl_CallCallback(togl, togl->DisplayProc);
    }
#if defined(TOGL_AGL)
    else {
        /* Always need to update on resize */
        SetMacBufRect(togl);
    }
#endif
    togl->UpdatePending = False;
}


static void
Togl_RenderOverlay(ClientData clientData)
{
    Togl   *togl = (Togl *) clientData;

    if (togl->OverlayFlag && togl->OverlayDisplayProc) {
#if defined(TOGL_WGL)
        int     res = wglMakeCurrent(togl->tglGLHdc, togl->tglGLOverlayHglrc);

        if (!res) {
            ErrorExit(TEXT("wglMakeCurrent overlay"));
        }
#elif defined(TOGL_X11)
        (void) glXMakeCurrent(Tk_Display(togl->TkWin),
                togl->OverlayWindow, togl->OverlayCtx);
#endif /* TOGL_WGL */

        Togl_CallCallback(togl, togl->OverlayDisplayProc);
    }
    togl->OverlayUpdatePending = False;
}


static void
Togl_LeaveStereo(Togl *togl, int oldStereo)
{
    switch (oldStereo) {
      default:
          break;
#ifdef STEREO_I_H
      case TOGL_STEREO_NVIDIA_CON:
          if (togl->pStereoI) {
              togl->pStereoI->SetStereoState(STEREO_STATE_OFF);
          }
          break;
#endif
#ifdef HAVE_AUTOSTEREO
      case TOGL_STEREO_NATIVE:
          if (togl->ash != -1) {
              ASClosedStereoWindow(togl->ash);
              togl->ash = -1;
          }
          break;
#endif
#ifdef __sgi
      case TOGL_STEREO_SGIOLDSTYLE:
          togl->currentStereoBuffer = STEREO_BUFFER_NONE;
          glXWaitGL();          /* sync with GL command stream before calling X 
                                 */
          XSGISetStereoBuffer(togl->display, Tk_WindowId(togl->TkWin),
                  togl->currentStereoBuffer);
          glXWaitX();           /* sync with X command stream before calling GL 
                                 */
          break;
#endif
    }
}


/* 
 * See domentation about what can't be changed
 */
static int
Togl_ObjConfigure(Tcl_Interp *interp, Togl *togl,
        int objc, Tcl_Obj *const *objv)
{
    Tk_SavedOptions savedOptions;
    int     error, mask;
    int     undoMask = 0;
    Tcl_Obj *errorResult = NULL;
    int     oldStereo = togl->Stereo;

    for (error = 0; error <= 1; ++error, mask = undoMask) {
        if (error == 0) {
            /* 
             * Tk_SetOptions parses the command arguments
             * and looks for defaults in the resource database.
             */
            if (Tk_SetOptions(interp, WIDGREC togl, togl->tpg->optionTable,
                            objc, objv, togl->TkWin, &savedOptions, &mask)
                    != TCL_OK) {
                /* previous values are restored, so nothing to do */
                return TCL_ERROR;
            }
        } else {
            /* 
             * Restore options from saved values
             */
            errorResult = Tcl_GetObjResult(interp);
            Tcl_IncrRefCount(errorResult);
            Tk_RestoreSavedOptions(&savedOptions);
        }

        if (mask & GEOMETRY_MASK) {
            Togl_WorldChanged((ClientData) togl);
            /* this added per Lou Arata <arata@enya.picker.com> */
            Tk_ResizeWindow(togl->TkWin, togl->Width, togl->Height);

            if (togl->ReshapeProc &&
#if defined(TOGL_WGL)
                    togl->tglGLHglrc
#elif defined(TOGL_X11)
                    togl->GlCtx
#elif defined(TOGL_AGL)
                    togl->aglCtx
#endif
                    ) {
                Togl_MakeCurrent(togl);
                Togl_CallCallback(togl, togl->ReshapeProc);
            }
            undoMask |= GEOMETRY_MASK;
        }

        if (mask & OVERLAY_MASK) {
#if !TOGL_USE_OVERLAY
            if (togl->OverlayFlag) {
                Tcl_AppendResult(interp, "Sorry, overlay was disabled", NULL);
                continue;
            }
#else
#  if defined(TOGL_X11)
            if (togl->OverlayCtx)
#  elif defined(TOGL_WGL)
            if (togl->tglGLOverlayHglrc)
#  endif
            {
                /* 
                 * Trying to change existing pixel format/graphics context
                 */
                Tcl_AppendResult(interp,
                        "Unable to change overlay pixel format", NULL);
                continue;
            }
#endif
        }

        if (mask & SWAP_MASK) {
            if (
#if defined(TOGL_WGL)
                    togl->tglGLHglrc
#elif defined(TOGL_X11)
                    togl->GlCtx
#elif defined(TOGL_AGL)
                    togl->aglCtx
#endif
                    ) {
                /* 
                 * Change existing swap interval
                 */
                Togl_MakeCurrent(togl); /* TODO: needed? */
                Togl_SwapInterval(togl, togl->SwapInterval);
                undoMask |= SWAP_MASK;
            }
        }

        if (error == 0 && (mask & STEREO_FORMAT_MASK) != 0) {
            if (oldStereo == TOGL_STEREO_NATIVE
                    || togl->Stereo == TOGL_STEREO_NATIVE) {
                /* only native stereo affects the visual format */
                mask |= FORMAT_MASK;
            }
            if (togl->Stereo == TOGL_STEREO_SGIOLDSTYLE) {
#ifndef __sgi
                Tcl_AppendResult(interp,
                        "sgioldstyle: only available on SGI computers", NULL);
                continue;
#else
                int     event, error;

                /* Make sure Display supports SGIStereo */
                if (XSGIStereoQueryExtension(Tk_Display(togl->TkWin), &event,
                                &error) == False) {
                    Tcl_AppendResult(interp,
                            "sgioldstyle: SGIStereo X extension is missing",
                            NULL);
                    continue;
                }
                /* Make sure Window (Screen) supports SGIStereo */
                if (XSGIQueryStereoMode(Tk_Display(togl->TkWin),
                                Tk_WindowId(Tk_Parent(togl->TkWin))) ==
                        X_STEREO_UNSUPPORTED) {
                    Tcl_AppendResult(interp,
                            "sgioldstyle: unsupported by screen", NULL);
                    continue;
                }
#endif
            }
        }

        if (mask & FORMAT_MASK) {
#if defined(TOGL_WGL)
            if (togl->tglGLHglrc)
#elif defined(TOGL_X11)
            if (togl->GlCtx)
#elif defined(TOGL_AGL)
            if (togl->aglCtx)
#endif
            {
                /* 
                 * Trying to change existing pixel format/graphics context
                 * TODO: (re)create graphics context
                 *
                 * save old graphics context
                 * try to create new one and share display lists
                 * if failure, then restore old one
                 */
                Tcl_AppendResult(interp, "Unable to change pixel format", NULL);
                continue;
            }
            /* Whether or not the format is okay is figured out when togl tries 
             * to create the window. */
#ifdef MESA_COLOR_HACK
            free_default_color_cells(Tk_Display(togl->TkWin),
                    Tk_Colormap(togl->TkWin));
#endif
            undoMask |= FORMAT_MASK;
        }

        if (oldStereo != togl->Stereo) {
            /* leaving stereo */
            Togl_LeaveStereo(togl, oldStereo);
        }
#if !defined(_WIN32) || !defined(STEREO_I_H)
        if (togl->Stereo == TOGL_STEREO_NVIDIA_CON) {
#  ifndef _WIN32
            Tcl_AppendResult(interp, NC3D ": Microsoft Windows option only",
                    NULL);
            continue;
#  elif !defined(STEREO_I_H)
            Tcl_AppendResult(interp,
                    NC3D
                    ": only available when togl is compiled with Microsoft Visual Studio",
                    NULL);
            continue;
#  endif
        }
#endif

        if (mask & TIMER_MASK) {
            if (togl->timerHandler != NULL) {
                Tcl_DeleteTimerHandler(togl->timerHandler);
            }
            if (togl->TimerProc) {
                togl->timerHandler =
                        Tcl_CreateTimerHandler(togl->TimerInterval, Togl_Timer,
                        (ClientData) togl);
            }
            undoMask |= TIMER_MASK;
        }
        break;
    }

    if (error == 0) {
        Tk_FreeSavedOptions(&savedOptions);
        return TCL_OK;
    } else {
        Tcl_SetObjResult(interp, errorResult);
        Tcl_DecrRefCount(errorResult);
        return TCL_ERROR;
    }
}


static int
Togl_ObjWidget(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl   *togl = (Togl *) clientData;
    const char *commands[] = {
        "cget", "configure", "extensions",
        "postredisplay", "render",
        "swapbuffers", "makecurrent", "takephoto",
        "loadbitmapfont", "unloadbitmapfont", "write",
        "uselayer", "showoverlay", "hideoverlay",
        "postredisplayoverlay", "renderoverlay",
        "existsoverlay", "ismappedoverlay",
        "getoverlaytransparentvalue",
        "drawbuffer", "clear", "frustum", "ortho",
        "numeyes", "contexttag",
        NULL
    };
    enum command
    {
        TOGL_CGET, TOGL_CONFIGURE, TOGL_EXTENSIONS,
        TOGL_POSTREDISPLAY, TOGL_RENDER,
        TOGL_SWAPBUFFERS, TOGL_MAKECURRENT, TOGL_TAKEPHOTO,
        TOGL_LOADBITMAPFONT, TOGL_UNLOADBITMAPFONT, TOGL_WRITE,
        TOGL_USELAYER, TOGL_SHOWOVERLAY, TOGL_HIDEOVERLAY,
        TOGL_POSTREDISPLAYOVERLAY, TOGL_RENDEROVERLAY,
        TOGL_EXISTSOVERLAY, TOGL_ISMAPPEDOVERLAY,
        TOGL_GETOVERLAYTRANSPARENTVALUE,
        TOGL_DRAWBUFFER, TOGL_CLEAR, TOGL_FRUSTUM, TOGL_ORTHO,
        TOGL_NUMEYES, TOGL_CONTEXTTAG
    };
    int     result = TCL_OK;
    Tcl_Obj *objPtr;
    int     index;

    if (objc < 2) {
        Tcl_WrongNumArgs(interp, 1, objv, "command ?arg arg ...?");
        return TCL_ERROR;
    }

    Tk_Preserve((ClientData) togl);

    result = Tcl_GetIndexFromObj(interp, objv[1], commands, "option", 0,
            &index);

    switch (index) {
      case TOGL_CGET:
          if (objc != 3) {
              Tcl_WrongNumArgs(interp, 2, objv, "option");
              result = TCL_ERROR;
              break;
          }
          objPtr = Tk_GetOptionValue(interp, WIDGREC togl,
                  togl->tpg->optionTable, (objc == 3) ? objv[2] : NULL,
                  togl->TkWin);
          if (objPtr == NULL) {
              result = TCL_ERROR;
              break;
          }
          Tcl_SetObjResult(interp, objPtr);
          break;

      case TOGL_CONFIGURE:
          if (objc <= 3) {
              /* 
               * Return one item if the option is given,
               * or return all configuration information
               */
              objPtr = Tk_GetOptionInfo(interp, WIDGREC togl,
                      togl->tpg->optionTable, (objc == 3) ? objv[2] : NULL,
                      togl->TkWin);
              if (objPtr == NULL) {
                  result = TCL_ERROR;
              } else {
                  Tcl_SetObjResult(interp, objPtr);
              }
          } else {
              /* Execute a configuration change */
              result = Togl_ObjConfigure(interp, togl, objc - 2, objv + 2);
          }
          break;

      case TOGL_EXTENSIONS:
          /* Return a list of OpenGL extensions available */
          /* TODO: -glu for glu extensions, -platform for glx/wgl extensions */
          if (objc == 2) {
              const char *extensions;
              Tcl_Obj *objPtr;
              int     length = -1;

              extensions = (const char *) glGetString(GL_EXTENSIONS);
              objPtr = Tcl_NewStringObj(extensions, -1);
              /* convert to list by asking for its length */
              (void) Tcl_ListObjLength(interp, objPtr, &length);
              Tcl_SetObjResult(interp, objPtr);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_POSTREDISPLAY:
          /* schedule the widget to be redrawn */
          if (objc == 2) {
              Togl_PostRedisplay(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_RENDER:
          /* force the widget to be redrawn */
          if (objc == 2) {
              Togl_Render((ClientData) togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_SWAPBUFFERS:
          /* force the widget to be redrawn */
          if (objc == 2) {
              Togl_SwapBuffers(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_MAKECURRENT:
          /* force the widget to be redrawn */
          if (objc == 2) {
              Togl_MakeCurrent(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_TAKEPHOTO:
      {
          /* force the widget to be redrawn */
          if (objc != 3) {
              Tcl_WrongNumArgs(interp, 2, objv, "name");
              result = TCL_ERROR;
          } else {
              const char *name;
              Tk_PhotoHandle photo;

              name = Tcl_GetStringFromObj(objv[2], NULL);
              photo = Tk_FindPhoto(interp, name);
              if (photo == NULL) {
                  Tcl_AppendResult(interp, "image \"", name,
                          "\" doesn't exist or is not a photo image", NULL);
                  result = TCL_ERROR;
                  break;
              }
              Togl_TakePhoto(togl, photo);
          }
          break;
      }

      case TOGL_LOADBITMAPFONT:
#if TOGL_USE_FONTS != 1
          Tcl_AppendResult(interp, "unsupported", NULL);
          result = TCL_ERROR;
#else
          if (objc >= 3) {
              Tcl_Obj *font, *list;

              list = Tcl_NewListObj(objc - 2, objv + 2);
              Tcl_IncrRefCount(list);
              font = Togl_LoadBitmapFont(togl, Tcl_GetString(list));
              Tcl_DecrRefCount(list);
              if (font) {
                  Tcl_SetObjResult(interp, font);
                  result = TCL_OK;
              } else {
                  Tcl_AppendResult(interp, "Could not allocate font", NULL);
                  result = TCL_ERROR;
              }
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, "fontname");
              result = TCL_ERROR;
          }
#endif
          break;

      case TOGL_UNLOADBITMAPFONT:
#if TOGL_USE_FONTS != 1
          Tcl_AppendResult(interp, "unsupported", NULL);
          result = TCL_ERROR;
#else
          if (objc == 3) {
              result = Togl_UnloadBitmapFont(togl, objv[2]);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, "toglfont");
              result = TCL_ERROR;
          }
#endif
          break;

      case TOGL_WRITE:{
#if TOGL_USE_FONTS != 1
          Tcl_AppendResult(interp, "unsupported", NULL);
          result = TCL_ERROR;
#else
          /* Tcl_Obj *toglfont = objv[2]; */
          int     wobjc = objc - 3;
          Tcl_Obj *const *wobjv = objv + 3;

          while (wobjc > 1) {
              const char *name = Tcl_GetStringFromObj(wobjv[0], NULL);
              int     oc, i;
              Tcl_Obj **ov;
              double  args[4];

              if (Tcl_ListObjGetElements(NULL, wobjv[1], &oc, &ov) != TCL_OK) {
                  oc = 0;
              } else if (oc <= 4) {
                  for (i = 0; i < oc; ++i) {
                      if (Tcl_GetDoubleFromObj(NULL, ov[i], &args[i]) != TCL_OK) {
                      }
                  }
              }
              if (strcmp(name, "-color") == 0) {
                  if (oc == 4)
                      glColor4f(args[0], args[1], args[2], args[3]);
                  else if (oc == 3)
                      glColor3f(args[0], args[1], args[2]);
                  else
                      goto write_usage;
              } else if (strcmp(name, "-pos") == 0) {
                  if (oc == 4)
                      glRasterPos4f(args[0], args[1], args[2], args[3]);
                  else if (oc == 3)
                      glRasterPos3f(args[0], args[1], args[2]);
                  else if (oc == 2)
                      glRasterPos2f(args[0], args[1]);
                  else
                      goto write_usage;
              } else
                  goto write_usage;
              wobjc -= 2;
              wobjv += 2;
          }
          if (wobjc != 1)
              goto write_usage;
          result = Togl_WriteObj(togl, objv[2], wobjv[0]);
          if (result != -1)
              result = TCL_OK;
          else {
              Tcl_AppendResult(interp, "togl write failed", NULL);
              result = TCL_ERROR;
          }
          break;
        write_usage:
          Tcl_WrongNumArgs(interp, 2, objv, "[-pos {x y [z [w]]}]"
                  " [-color {r g b [a]}" " string");
          result = TCL_ERROR;
#endif
          break;
      }

      case TOGL_USELAYER:
          if (objc == 3) {
              int     layer;

              result = Tcl_GetIntFromObj(interp, objv[2], &layer);
              if (result == TCL_OK) {
                  Togl_UseLayer(togl, layer);
              }
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, "layer");
              result = TCL_ERROR;
          }
          break;

      case TOGL_SHOWOVERLAY:
          if (objc == 2) {
              Togl_ShowOverlay(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_HIDEOVERLAY:
          if (objc == 2) {
              Togl_HideOverlay(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_POSTREDISPLAYOVERLAY:
          if (objc == 2) {
              Togl_PostOverlayRedisplay(togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_RENDEROVERLAY:
          /* force the overlay to be redrawn */
          if (objc == 2) {
              Togl_RenderOverlay((ClientData) togl);
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_EXISTSOVERLAY:
          if (objc == 2) {
              Tcl_SetObjResult(interp, Tcl_NewIntObj(Togl_ExistsOverlay(togl)));
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_ISMAPPEDOVERLAY:
          if (objc == 2) {
              Tcl_SetObjResult(interp,
                      Tcl_NewIntObj(Togl_IsMappedOverlay(togl)));
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_GETOVERLAYTRANSPARENTVALUE:
          if (objc == 2) {
              Tcl_SetObjResult(interp,
                      Tcl_NewIntObj(Togl_GetOverlayTransparentValue(togl)));
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_DRAWBUFFER:
          if (objc != 3) {
              Tcl_WrongNumArgs(interp, 2, objv, "mode");
              result = TCL_ERROR;
          } else {
              int     mask;

              result = Tcl_GetIntFromObj(interp, objv[2], &mask);
              if (result == TCL_ERROR)
                  break;
              Togl_DrawBuffer(togl, (GLenum) mask);
          }
          break;

      case TOGL_CLEAR:
          if (objc != 3) {
              Tcl_WrongNumArgs(interp, 2, objv, "mask");
              result = TCL_ERROR;
          } else {
              int     mask;

              result = Tcl_GetIntFromObj(interp, objv[2], &mask);
              if (result == TCL_ERROR)
                  break;
              Togl_Clear(togl, (GLbitfield) mask);
          }
          break;

      case TOGL_FRUSTUM:
          if (objc != 8) {
              Tcl_WrongNumArgs(interp, 2, objv,
                      "left right bottom top near far");
              result = TCL_ERROR;
          } else {
              double  left, right, bottom, top, zNear, zFar;

              if (Tcl_GetDoubleFromObj(interp, objv[2], &left) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[3],
                              &right) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[4],
                              &bottom) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[5],
                              &top) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[6],
                              &zNear) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[7],
                              &zFar) == TCL_ERROR) {
                  result = TCL_ERROR;
                  break;
              }
              Togl_Frustum(togl, left, right, bottom, top, zNear, zFar);
          }
          break;

      case TOGL_ORTHO:
          if (objc != 8) {
              Tcl_WrongNumArgs(interp, 2, objv,
                      "left right bottom top near far");
              result = TCL_ERROR;
          } else {
              double  left, right, bottom, top, zNear, zFar;

              if (Tcl_GetDoubleFromObj(interp, objv[2], &left) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[3],
                              &right) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[4],
                              &bottom) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[5],
                              &top) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[6],
                              &zNear) == TCL_ERROR
                      || Tcl_GetDoubleFromObj(interp, objv[7],
                              &zFar) == TCL_ERROR) {
                  result = TCL_ERROR;
                  break;
              }
              Togl_Ortho(togl, left, right, bottom, top, zNear, zFar);
          }
          break;

      case TOGL_NUMEYES:
          if (objc == 2) {
              Tcl_SetObjResult(interp, Tcl_NewIntObj(Togl_NumEyes(togl)));
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;

      case TOGL_CONTEXTTAG:
          if (objc == 2) {
              Tcl_SetObjResult(interp, Tcl_NewIntObj(Togl_ContextTag(togl)));
          } else {
              Tcl_WrongNumArgs(interp, 2, objv, NULL);
              result = TCL_ERROR;
          }
          break;
    }

    Tk_Release((ClientData) togl);
    return result;
}

/* 
 * Togl_ObjCmdDelete
 *
 * Called when togl command is removed from interpreter.
 */

static void
Togl_ObjCmdDelete(ClientData clientData)
{
    if (clientData != NULL) {
        Togl_PackageGlobals *tpg = (Togl_PackageGlobals *) clientData;

        Tk_DeleteOptionTable(tpg->optionTable);
        ckfree((char *) clientData);
    }
}


/* 
 * Togl_ObjCmd
 *
 *   Called when Togl is executed - creation of a Togl widget.
 *     * Creates a new window
 *     * Creates an 'Togl' data structure
 *     * Creates an event handler for this window
 *     * Creates a command that handles this object
 *     * Configures this Togl for the given arguments
 */
int
Togl_ObjCmd(ClientData clientData, Tcl_Interp *interp, int objc,
        Tcl_Obj *const *objv)
{
    Togl_PackageGlobals *tpg;
    Togl   *togl;
    Tk_Window tkwin;

    if (objc <= 1) {
        Tcl_WrongNumArgs(interp, 1, objv, "pathName ?options?");
        return TCL_ERROR;
    }
    tpg = (Togl_PackageGlobals *) clientData;
    if (tpg == NULL) {
        Tcl_CmdInfo info;
        const char *name;

        /* 
         * Initialize the Togl_PackageGlobals for this widget the
         * first time a Togl widget is created.  The globals are
         * saved as our client data.
         */

        tpg = (Togl_PackageGlobals *) ckalloc(sizeof (Togl_PackageGlobals));
        if (tpg == NULL) {
            return TCL_ERROR;
        }
        tpg->nextContextTag = 0;
        tpg->optionTable = Tk_CreateOptionTable(interp, optionSpecs);
        tpg->toglHead = NULL;

        name = Tcl_GetString(objv[0]);
        Tcl_GetCommandInfo(interp, name, &info);
        info.objClientData = (ClientData) tpg;
        Tcl_SetCommandInfo(interp, name, &info);
    }

    /* Create the window. */
    tkwin = Tk_CreateWindowFromPath(interp, Tk_MainWindow(interp),
            Tcl_GetString(objv[1]), NULL);
    if (tkwin == NULL) {
        return TCL_ERROR;
    }

    Tk_SetClass(tkwin, "Togl");

    /* Create Togl data structure */
    togl = (Togl *) ckalloc(sizeof (Togl));
    if (togl == NULL) {
        return TCL_ERROR;
    }

    /* initialize Togl data structures values */
    togl->Next = NULL;
#if defined(TOGL_WGL)
    togl->tglGLHdc = NULL;
    togl->tglGLHglrc = NULL;
    togl->tglGLOverlayHglrc = NULL;
#  ifdef STEREO_I_H
    togl->pStereoI = NULL;
#  endif
#elif defined(TOGL_X11)
    togl->GlCtx = NULL;
    togl->OverlayCtx = NULL;
#elif defined(TOGL_AGL)
    togl->aglCtx = NULL;
#endif
    togl->contextTag = 0;
    togl->display = Tk_Display(tkwin);
    togl->TkWin = tkwin;
    togl->Interp = interp;
    togl->VisInfo = NULL;
    togl->OverlayWindow = None;
    togl->OverlayCmap = None;
    togl->OverlayTransparentPixel = 0;
    togl->OverlayIsMapped = False;

    togl->UpdatePending = False;
    togl->OverlayUpdatePending = False;
    togl->tpg = tpg;
    togl->Client_Data = NULL;

    /* for EPS Output */
    togl->EpsRedMap = togl->EpsGreenMap = togl->EpsBlueMap = NULL;
    togl->EpsMapSize = 0;

#ifndef NO_TK_CURSOR
    togl->Cursor = None;
#endif
    togl->Width = 0;
    togl->Height = 0;
    togl->SetGrid = 0;
    togl->TimerInterval = 0;
    togl->RgbaFlag = True;
    togl->RgbaRed = 1;
    togl->RgbaGreen = 1;
    togl->RgbaBlue = 1;
    togl->DoubleFlag = False;
    togl->DepthFlag = False;
    togl->DepthSize = 1;
    togl->AccumFlag = False;
    togl->AccumRed = 1;
    togl->AccumGreen = 1;
    togl->AccumBlue = 1;
    togl->AccumAlpha = 1;
    togl->AlphaFlag = False;
    togl->AlphaSize = 1;
    togl->StencilFlag = False;
    togl->StencilSize = 1;
    togl->OverlayFlag = False;
    togl->Stereo = TOGL_STEREO_NONE;
    togl->AuxNumber = 0;
    togl->Indirect = False;
    togl->PixelFormat = 0;
    togl->SwapInterval = 1;

    togl->CreateProc = NULL;
    togl->DisplayProc = NULL;
    togl->ReshapeProc = NULL;
    togl->DestroyProc = NULL;
    togl->TimerProc = NULL;
    togl->timerHandler = NULL;
    togl->OverlayDisplayProc = NULL;
    togl->ShareList = NULL;
    togl->ShareContext = NULL;
    togl->Ident = NULL;
    togl->PrivateCmapFlag = False;
    togl->currentStereoBuffer = STEREO_BUFFER_NONE;
#ifdef HAVE_AUTOSTEREO
    togl->as_initialized = False;
    togl->ash = -1;
#endif
    togl->badWindow = False;

    /* Create command event handler */
    togl->widgetCmd = Tcl_CreateObjCommand(interp, Tk_PathName(tkwin),
            Togl_ObjWidget, (ClientData) togl, ToglCmdDeletedProc);

    /* 
     * Setup the Tk_ClassProcs callbacks to point at our own window creation
     * function
     *
     * We need to check at runtime if we should use the new Tk_SetClassProcs()
     * API or if we need to modify the window structure directly
     */
#ifdef HAVE_TK_SETCLASSPROCS

    if (SetClassProcsPtr != NULL) {     /* use public API (Tk 8.4+) */
        Tk_ClassProcs *procsPtr;

        procsPtr = (Tk_ClassProcs *) ckalloc(sizeof (Tk_ClassProcs));
        procsPtr->size = sizeof (Tk_ClassProcs);
        procsPtr->createProc = Togl_CreateWindow;
        procsPtr->worldChangedProc = Togl_WorldChanged;
        procsPtr->modalProc = NULL;
        /* Tk_SetClassProcs(togl->TkWin, procsPtr, (ClientData) togl); */
        (SetClassProcsPtr) (togl->TkWin, procsPtr, (ClientData) togl);
    } else
#endif
    {                           /* use private API */
        /* 
         * We need to set these fields in the Tk_FakeWin structure: dummy17 =
         * classProcsPtr dummy18 = instanceData */
        TkClassProcs *procsPtr;
        Tk_FakeWin *winPtr = (Tk_FakeWin *) (togl->TkWin);

        procsPtr = (TkClassProcs *) ckalloc(sizeof (TkClassProcs));
        procsPtr->createProc = Togl_CreateWindow;
        procsPtr->geometryProc = Togl_WorldChanged;
        procsPtr->modalProc = NULL;
        winPtr->dummy17 = (char *) procsPtr;
        winPtr->dummy18 = (ClientData) togl;
    }

    Tk_CreateEventHandler(tkwin, ExposureMask | StructureNotifyMask,
            Togl_EventProc, (ClientData) togl);

    /* Configure Togl widget */
    if (Tk_InitOptions(interp, WIDGREC togl, tpg->optionTable, tkwin) != TCL_OK
            || Togl_ObjConfigure(interp, togl, objc - 2, objv + 2) != TCL_OK) {
        goto error;
    }

    /* 
     * If OpenGL window wasn't already created by Togl_ObjConfigure() we
     * create it now.  We can tell by checking if the OpenGL context has
     * been initialized.
     */
    if (!
#if defined(TOGL_WGL)
            togl->tglGLHdc
#elif defined(TOGL_X11)
            togl->GlCtx
#elif defined(TOGL_AGL)
            togl->aglCtx
#endif
            ) {
        Tk_MakeWindowExist(togl->TkWin);
        if (Tk_WindowId(togl->TkWin) == DUMMY_WINDOW) {
            /* Make sure Tk does not try to delete dummy window by creating a
             * non-OpenGL one (because Tk _really_ doesn't want
             * Tk_MakeWindowExist to fail). */
            togl->badWindow = True;
            Tk_WindowId(togl->TkWin) = None;
            Tk_MakeWindowExist(togl->TkWin);
            goto error;
        }
        Togl_MakeCurrent(togl);
    }
    if (togl->contextTag == 0)
        togl->contextTag = ++tpg->nextContextTag;

    (void) Togl_SwapInterval(togl, togl->SwapInterval);

    /* If defined, call create callback */
    if (togl->CreateProc) {
        if (Togl_CallCallback(togl, togl->CreateProc) != TCL_OK) {
            goto error;
        }
    }

    glViewport(0, 0, togl->Width, togl->Height);
#if defined(TOGL_X11)
    if (togl->OverlayFlag) {
        Togl_UseLayer(togl, TOGL_OVERLAY);
        glViewport(0, 0, togl->Width, togl->Height);
        Togl_UseLayer(togl, TOGL_NORMAL);
    }
#endif
    /* If defined, call reshape proc */
    if (togl->ReshapeProc) {
        if (Togl_CallCallback(togl, togl->ReshapeProc) != TCL_OK) {
            goto error;
        }
    }
#if defined(STEREO_I_H)
    if (togl->Stereo == TOGL_STEREO_NVIDIA_CON) {
        /* check if driver is installed */
        if (!togl->pStereoI && !CreateStereoI(&togl->pStereoI)) {
            Tcl_AppendResult(interp,
                    NC3D " driver is not installed;"
                    " see <http://www.nvidia.com/>", NULL);
            goto error;
        }
        if (togl->pStereoI->GetStereoState() == STEREO_STATE_DISABLED) {
            Tcl_AppendResult(interp,
                    NC3D " is disabled."
                    "  Please enable it in the driver control panel.", NULL);
            goto error;
        }
#  if 0
        /* check if full screen */
        if (togl->Width != WidthOfScreen(Tk_Screen(togl->TkWin))
                || togl->Height != HeightOfScreen(Tk_Screen(togl->TkWin))) {
            fprintf(stderr, " not fullscreen %d x %d should be %d x %d\n",
                    togl->Width, togl->Height,
                    WidthOfScreen(Tk_Screen(togl->TkWin)),
                    HeightOfScreen(Tk_Screen(togl->TkWin)));
            Tcl_AppendResult(interp, NC3D " only works for fullscreen windows.",
                    NULL);
            goto error;
        }
#  endif

        /* Turn on stereo */
        togl->pStereoI->SetStereoState(STEREO_STATE_ON);
    }
#endif

    Tcl_AppendResult(interp, Tk_PathName(tkwin), NULL);

    /* Add to linked list */
    AddToList(togl);

    return TCL_OK;

  error:
    (void) Tcl_DeleteCommandFromToken(interp, togl->widgetCmd);
    Tcl_AppendResult(interp, "\nCouldn't configure togl widget", NULL);
    return TCL_ERROR;
}


#if TOGL_USE_OVERLAY

/* 
 * Do all the setup for overlay planes
 * Return:   TCL_OK or TCL_ERROR
 */
static int
SetupOverlay(Togl *togl)
{
#  if defined(TOGL_X11)

#    ifdef GLX_TRANSPARENT_TYPE_EXT
    static int ovAttributeList[] = {
        GLX_BUFFER_SIZE, 2,
        GLX_LEVEL, 1,
        GLX_TRANSPARENT_TYPE_EXT, GLX_TRANSPARENT_INDEX_EXT,
        None
    };
#    else
    static int ovAttributeList[] = {
        GLX_BUFFER_SIZE, 2,
        GLX_LEVEL, 1,
        None
    };
#    endif

    Display *dpy;
    XVisualInfo *visinfo;
    TkWindow *winPtr = (TkWindow *) togl->TkWin;

    XSetWindowAttributes swa;
    Tcl_HashEntry *hPtr;
    int     new_flag;

    dpy = Tk_Display(togl->TkWin);

    visinfo = glXChooseVisual(dpy, Tk_ScreenNumber(winPtr), ovAttributeList);
    if (!visinfo) {
        Tcl_AppendResult(togl->Interp, Tk_PathName(winPtr),
                ": No suitable overlay index visual available", NULL);
        togl->OverlayCtx = 0;
        togl->OverlayWindow = 0;
        togl->OverlayCmap = 0;
        return TCL_ERROR;
    }
#    ifdef GLX_TRANSPARENT_INDEX_EXT
    {
        int     fail =
                glXGetConfig(dpy, visinfo, GLX_TRANSPARENT_INDEX_VALUE_EXT,
                &togl->OverlayTransparentPixel);

        if (fail)
            togl->OverlayTransparentPixel = 0;  /* maybe, maybe ... */
    }
#    else
    togl->OverlayTransparentPixel = 0;  /* maybe, maybe ... */
#    endif

    /* share display lists with normal layer context */
    togl->OverlayCtx =
            glXCreateContext(dpy, visinfo, togl->GlCtx, !togl->Indirect);

    swa.colormap = XCreateColormap(dpy, XRootWindow(dpy, visinfo->screen),
            visinfo->visual, AllocNone);
    togl->OverlayCmap = swa.colormap;

    swa.border_pixel = 0;
    swa.event_mask = ALL_EVENTS_MASK;
    togl->OverlayWindow = XCreateWindow(dpy, Tk_WindowId(togl->TkWin), 0, 0,
            togl->Width, togl->Height, 0,
            visinfo->depth, InputOutput,
            visinfo->visual, CWBorderPixel | CWColormap | CWEventMask, &swa);

    hPtr = Tcl_CreateHashEntry(&winPtr->dispPtr->winTable,
            (const char *) togl->OverlayWindow, &new_flag);
    Tcl_SetHashValue(hPtr, winPtr);

    /* XMapWindow( dpy, togl->OverlayWindow ); */
    togl->OverlayIsMapped = False;

    /* Make sure window manager installs our colormap */
    XSetWMColormapWindows(dpy, togl->OverlayWindow, &togl->OverlayWindow, 1);

    return TCL_OK;

#  elif defined(TOGL_WGL) || defined(TOGL_AGL)
    /* not yet implemented on these */
    return TCL_ERROR;
#  endif
}

#endif /* TOGL_USE_OVERLAY */



#ifdef TOGL_WGL
#  define TOGL_CLASS_NAME "Togl Class"
static Bool ToglClassInitialized = False;

static LRESULT CALLBACK
Win32WinProc(HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    LONG    result;
    Togl   *togl = (Togl *) GetWindowLongPtr(hwnd, 0);
    WNDCLASS childClass;

    switch (message) {

      case WM_WINDOWPOSCHANGED:
          /* Should be processed by DefWindowProc, otherwise a double buffered
           * context is not properly resized when the corresponding window is
           * resized. */
          break;

      case WM_DESTROY:
          if (togl && togl->TkWin != NULL) {
              if (togl->SetGrid > 0) {
                  Tk_UnsetGrid(togl->TkWin);
              }
              (void) Tcl_DeleteCommandFromToken(togl->Interp, togl->widgetCmd);
          }
          break;

      case WM_ERASEBKGND:
          /* We clear our own window */
          return 1;

      default:
#  if USE_STATIC_LIB
          return TkWinChildProc(hwnd, message, wParam, lParam);
#  else
          /* 
           * OK, since TkWinChildProc is not explicitly exported in the
           * dynamic libraries, we have to retrieve it from the class info
           * registered with windows.
           *
           */
          if (tkWinChildProc == NULL) {
              GetClassInfo(Tk_GetHINSTANCE(), TK_WIN_CHILD_CLASS_NAME,
                      &childClass);
              tkWinChildProc = childClass.lpfnWndProc;
          }
          return tkWinChildProc(hwnd, message, wParam, lParam);
#  endif
    }
    result = DefWindowProc(hwnd, message, wParam, lParam);
    Tcl_ServiceAll();
    return result;
}
#endif /* TOGL_WGL */



/* 
 * Togl_CreateWindow
 *
 *   Window creation function, invoked as a callback from Tk_MakeWindowExist.
 *   Creates an OpenGL window for the Togl widget.
 */
static Window
Togl_CreateWindow(Tk_Window tkwin, Window parent, ClientData instanceData)
{

    Togl   *togl = (Togl *) instanceData;
    XVisualInfo *visinfo = NULL;
    Display *dpy;
    Colormap cmap;
    int     scrnum;
    Window  window;

#if defined(TOGL_X11)
    Bool    directCtx = True;
    int     attrib_list[1000];
    int     attrib_count;
    int     dummy;
    XSetWindowAttributes swa;

#  define MAX_ATTEMPTS 12
    static int ci_depths[MAX_ATTEMPTS] = {
        8, 4, 2, 1, 12, 16, 8, 4, 2, 1, 12, 16
    };
    static int dbl_flags[MAX_ATTEMPTS] = {
        0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1
    };
#elif defined(TOGL_WGL)
    HWND    hwnd, parentWin;
    int     pixelformat;
    HINSTANCE hInstance;
    WNDCLASS ToglClass;
    PIXELFORMATDESCRIPTOR pfd;
#elif defined(TOGL_AGL)
    GLint   attribs[20];
    int     na;
    AGLPixelFormat fmt;
#endif /* TOGL_X11 */


    if (togl->badWindow) {
        TkWindow *winPtr = (TkWindow *) tkwin;

        window = TkpMakeWindow(winPtr, parent);
        return window;
    }

    dpy = Tk_Display(tkwin);

#if defined(TOGL_X11)
    /* Make sure OpenGL's GLX extension supported */
    if (!glXQueryExtension(dpy, &dummy, &dummy)) {
        Tcl_SetResult(togl->Interp,
                TCL_STUPID "X server has no OpenGL GLX extension", TCL_STATIC);
        return DUMMY_WINDOW;
    }

    if (togl->ShareContext && FindTogl(togl, togl->ShareContext)) {
        /* share OpenGL context with existing Togl widget */
        Togl   *shareWith = FindTogl(togl, togl->ShareContext);

        assert(shareWith != NULL);
        assert(shareWith->GlCtx != NULL);
        togl->GlCtx = shareWith->GlCtx;
        togl->contextTag = shareWith->contextTag;
        togl->VisInfo = shareWith->VisInfo;
        visinfo = togl->VisInfo;
    } else {
        if (togl->PixelFormat) {
            XVisualInfo template;
            int     count = 1;
            int     stereo = 0;

            template.visualid = togl->PixelFormat;
            visinfo = XGetVisualInfo(dpy, VisualIDMask, &template, &count);
            if (visinfo == NULL) {
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "couldn't choose pixel format", TCL_STATIC);
                return DUMMY_WINDOW;
            }
            /* fill in flags normally passed in that affect behavior */
            (void) glXGetConfig(dpy, visinfo, GLX_RGBA, &togl->RgbaFlag);
            (void) glXGetConfig(dpy, visinfo, GLX_DOUBLEBUFFER,
                    &togl->DoubleFlag);
            (void) glXGetConfig(dpy, visinfo, GLX_STEREO, &stereo);
            if (stereo)
                togl->Stereo = TOGL_STEREO_NATIVE;
            else
                togl->Stereo = TOGL_STEREO_NONE;
        } else {
            int     attempt;

            /* It may take a few tries to get a visual */
            for (attempt = 0; attempt < MAX_ATTEMPTS; attempt++) {
                attrib_count = 0;
                attrib_list[attrib_count++] = GLX_USE_GL;
                if (togl->RgbaFlag) {
                    /* RGB[A] mode */
                    attrib_list[attrib_count++] = GLX_RGBA;
                    attrib_list[attrib_count++] = GLX_RED_SIZE;
                    attrib_list[attrib_count++] = togl->RgbaRed;
                    attrib_list[attrib_count++] = GLX_GREEN_SIZE;
                    attrib_list[attrib_count++] = togl->RgbaGreen;
                    attrib_list[attrib_count++] = GLX_BLUE_SIZE;
                    attrib_list[attrib_count++] = togl->RgbaBlue;
                    if (togl->AlphaFlag) {
                        attrib_list[attrib_count++] = GLX_ALPHA_SIZE;
                        attrib_list[attrib_count++] = togl->AlphaSize;
                    }

                    /* for EPS Output */
                    if (togl->EpsRedMap)
                        free(togl->EpsRedMap);
                    if (togl->EpsGreenMap)
                        free(togl->EpsGreenMap);
                    if (togl->EpsBlueMap)
                        free(togl->EpsBlueMap);
                    togl->EpsRedMap = togl->EpsGreenMap = togl->EpsBlueMap =
                            NULL;
                    togl->EpsMapSize = 0;
                } else {
                    /* Color index mode */
                    int     depth;

                    attrib_list[attrib_count++] = GLX_BUFFER_SIZE;
                    depth = ci_depths[attempt];
                    attrib_list[attrib_count++] = depth;
                }
                if (togl->DepthFlag) {
                    attrib_list[attrib_count++] = GLX_DEPTH_SIZE;
                    attrib_list[attrib_count++] = togl->DepthSize;
                }
                if (togl->DoubleFlag || dbl_flags[attempt]) {
                    attrib_list[attrib_count++] = GLX_DOUBLEBUFFER;
                }
                if (togl->StencilFlag) {
                    attrib_list[attrib_count++] = GLX_STENCIL_SIZE;
                    attrib_list[attrib_count++] = togl->StencilSize;
                }
                if (togl->AccumFlag) {
                    attrib_list[attrib_count++] = GLX_ACCUM_RED_SIZE;
                    attrib_list[attrib_count++] = togl->AccumRed;
                    attrib_list[attrib_count++] = GLX_ACCUM_GREEN_SIZE;
                    attrib_list[attrib_count++] = togl->AccumGreen;
                    attrib_list[attrib_count++] = GLX_ACCUM_BLUE_SIZE;
                    attrib_list[attrib_count++] = togl->AccumBlue;
                    if (togl->AlphaFlag) {
                        attrib_list[attrib_count++] = GLX_ACCUM_ALPHA_SIZE;
                        attrib_list[attrib_count++] = togl->AccumAlpha;
                    }
                }
                if (togl->AuxNumber != 0) {
                    attrib_list[attrib_count++] = GLX_AUX_BUFFERS;
                    attrib_list[attrib_count++] = togl->AuxNumber;
                }
                if (togl->Indirect) {
                    directCtx = False;
                }

                if (togl->Stereo == TOGL_STEREO_NATIVE) {
                    attrib_list[attrib_count++] = GLX_STEREO;
                }
                attrib_list[attrib_count++] = None;

                visinfo = glXChooseVisual(dpy, Tk_ScreenNumber(tkwin),
                        attrib_list);
                if (visinfo) {
                    /* found a GLX visual! */
                    break;
                }
            }

            togl->VisInfo = visinfo;

            if (visinfo == NULL) {
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "couldn't choose pixel format", TCL_STATIC);
                return DUMMY_WINDOW;
            }
        }

        /* 
         * Create a new OpenGL rendering context.
         */
        if (togl->ShareList) {
            /* share display lists with existing togl widget */
            Togl   *shareWith = FindTogl(togl, togl->ShareList);
            GLXContext shareCtx;

            if (shareWith) {
                shareCtx = shareWith->GlCtx;
                togl->contextTag = shareWith->contextTag;
            } else {
                shareCtx = None;
            }
            togl->GlCtx = glXCreateContext(dpy, visinfo, shareCtx, directCtx);
        } else {
            /* don't share display lists */
            togl->GlCtx = glXCreateContext(dpy, visinfo, None, directCtx);
        }

        if (togl->GlCtx == NULL) {
            Tcl_SetResult(togl->Interp,
                    TCL_STUPID "could not create rendering context",
                    TCL_STATIC);
            return DUMMY_WINDOW;
        }
    }
#endif /* TOGL_X11 */

#ifdef TOGL_WGL
    parentWin = Tk_GetHWND(parent);
    hInstance = Tk_GetHINSTANCE();
    if (!ToglClassInitialized) {
        ToglClassInitialized = True;
        ToglClass.style = CS_HREDRAW | CS_VREDRAW;
        ToglClass.cbClsExtra = 0;
        ToglClass.cbWndExtra = sizeof (LONG_PTR);       /* to save Togl* */
        ToglClass.hInstance = hInstance;
        ToglClass.hbrBackground = NULL;
        ToglClass.lpszMenuName = NULL;
        ToglClass.lpszClassName = TOGL_CLASS_NAME;
        ToglClass.lpfnWndProc = Win32WinProc;
        ToglClass.hIcon = NULL;
        ToglClass.hCursor = NULL;
        if (!RegisterClass(&ToglClass)) {
            Tcl_SetResult(togl->Interp,
                    TCL_STUPID "unable register Togl window class", TCL_STATIC);
            return DUMMY_WINDOW;
        }
    }

    hwnd = CreateWindow(TOGL_CLASS_NAME, NULL,
            WS_CHILD | WS_CLIPCHILDREN | WS_CLIPSIBLINGS, 0, 0,
            togl->Width, togl->Height, parentWin, NULL, hInstance, NULL);
    SetWindowPos(hwnd, HWND_TOP, 0, 0, 0, 0,
            SWP_NOACTIVATE | SWP_NOMOVE | SWP_NOSIZE);

    togl->tglGLHdc = GetDC(hwnd);

    pfd.nSize = sizeof (PIXELFORMATDESCRIPTOR);
    pfd.nVersion = 1;
    pfd.dwFlags =
            PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_SUPPORT_COMPOSITION;
    if (togl->DoubleFlag) {
        pfd.dwFlags |= PFD_DOUBLEBUFFER;
    }
    /* The stereo flag is not supported in the generic OpenGL implementation,
     * but may be supported by specific hardware devices. */
    if (togl->Stereo == TOGL_STEREO_NATIVE) {
        pfd.dwFlags |= PFD_STEREO;
    }

    if (togl->PixelFormat) {
        pixelformat = togl->PixelFormat;
    } else {
        pfd.cColorBits = togl->RgbaRed + togl->RgbaGreen + togl->RgbaBlue;
        pfd.iPixelType = togl->RgbaFlag ? PFD_TYPE_RGBA : PFD_TYPE_COLORINDEX;
        /* Alpha bitplanes are not supported in the current generic OpenGL
         * implementation, but may be supported by specific hardware devices. */
        pfd.cAlphaBits = togl->AlphaFlag ? togl->AlphaSize : 0;
        pfd.cAccumBits = togl->AccumFlag ? (togl->AccumRed + togl->AccumGreen +
                togl->AccumBlue + togl->AccumAlpha) : 0;
        pfd.cDepthBits = togl->DepthFlag ? togl->DepthSize : 0;
        pfd.cStencilBits = togl->StencilFlag ? togl->StencilSize : 0;
        /* Auxiliary buffers are not supported in the current generic OpenGL
         * implementation, but may be supported by specific hardware devices. */
        pfd.cAuxBuffers = togl->AuxNumber;
        pfd.iLayerType = PFD_MAIN_PLANE;

        if ((pixelformat = ChoosePixelFormat(togl->tglGLHdc, &pfd)) == 0) {
            Tcl_SetResult(togl->Interp,
                    TCL_STUPID "couldn't choose pixel format", TCL_STATIC);
            ReleaseDC(hwnd, togl->tglGLHdc);
            togl->tglGLHdc = NULL;
            DestroyWindow(hwnd);
            return DUMMY_WINDOW;
        }
    }
    if (SetPixelFormat(togl->tglGLHdc, pixelformat, &pfd) == FALSE) {
        Tcl_SetResult(togl->Interp,
                TCL_STUPID "couldn't choose pixel format", TCL_STATIC);
        ReleaseDC(hwnd, togl->tglGLHdc);
        togl->tglGLHdc = NULL;
        DestroyWindow(hwnd);
        return DUMMY_WINDOW;
    }

    /* Get the actual pixel format */
    DescribePixelFormat(togl->tglGLHdc, pixelformat, sizeof (pfd), &pfd);
    if (togl->PixelFormat) {
        /* fill in flags normally passed in that affect behavior */
        togl->RgbaFlag = pfd.iPixelType == PFD_TYPE_RGBA;
        togl->DoubleFlag = pfd.cDepthBits > 0;
        if ((pfd.dwFlags & PFD_STEREO) != 0)
            togl->Stereo = TOGL_STEREO_NATIVE;
        else
            togl->Stereo = TOGL_STEREO_NONE;
        /* TODO: set depth flag, and more */
    } else if (togl->Stereo == TOGL_STEREO_NATIVE
            && (pfd.dwFlags & PFD_STEREO) == 0) {
        Tcl_SetResult(togl->Interp,
                TCL_STUPID "couldn't choose stereo pixel format", TCL_STATIC);
        ReleaseDC(hwnd, togl->tglGLHdc);
        togl->tglGLHdc = NULL;
        DestroyWindow(hwnd);
        return DUMMY_WINDOW;
    }

    if (togl->ShareContext && FindTogl(togl, togl->ShareContext)) {
        /* share OpenGL context with existing Togl widget */
        Togl   *shareWith = FindTogl(togl, togl->ShareContext);

        assert(shareWith);
        assert(shareWith->tglGLHglrc);
        togl->tglGLHglrc = shareWith->tglGLHglrc;
        togl->contextTag = shareWith->contextTag;
        togl->VisInfo = shareWith->VisInfo;
        visinfo = togl->VisInfo;
    } else {
        /* 
         * Create a new OpenGL rendering context. And check to share lists.
         */
        togl->tglGLHglrc = wglCreateContext(togl->tglGLHdc);

        if (togl->ShareList) {
            /* share display lists with existing togl widget */
            Togl   *shareWith = FindTogl(togl, togl->ShareList);

            if (shareWith) {
                if (!wglShareLists(shareWith->tglGLHglrc, togl->tglGLHglrc)) {
#  if 0
                    LPVOID  lpMsgBuf;
                    DWORD   err = GetLastError();

                    FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER |
                            FORMAT_MESSAGE_FROM_SYSTEM,
                            NULL, err,
                            MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
                            (LPTSTR) &lpMsgBuf, 0, NULL);
                    fprintf(stderr, "unable to share display lists: %d: %s\n",
                            err, lpMsgBuf);
                    LocalFree(lpMsgBuf);
#  endif
                    Tcl_SetResult(togl->Interp,
                            TCL_STUPID "unable to share display lists",
                            TCL_STATIC);
                    ReleaseDC(hwnd, togl->tglGLHdc);
                    togl->tglGLHdc = NULL;
                    DestroyWindow(hwnd);
                    return DUMMY_WINDOW;
                }
                togl->contextTag = shareWith->contextTag;
            }
        }

        if (!togl->tglGLHglrc) {
            Tcl_SetResult(togl->Interp,
                    TCL_STUPID "could not create rendering context",
                    TCL_STATIC);
            ReleaseDC(hwnd, togl->tglGLHdc);
            togl->tglGLHdc = NULL;
            DestroyWindow(hwnd);
            return DUMMY_WINDOW;
        }

        /* Just for portability, define the simplest visinfo */
        visinfo = (XVisualInfo *) malloc(sizeof (XVisualInfo));
        visinfo->visual = DefaultVisual(dpy, DefaultScreen(dpy));
        visinfo->depth = visinfo->visual->bits_per_rgb;
        togl->VisInfo = visinfo;
    }
    SetWindowLongPtr(hwnd, 0, (LONG_PTR) togl);
#endif /* TOGL_WGL */

    /* for TOGL_AGL, we create the window first, then choose the pixel format */

    /* 
     * find a colormap
     */
    scrnum = Tk_ScreenNumber(tkwin);
    if (togl->RgbaFlag) {
        /* Colormap for RGB mode */
#if defined(TOGL_X11)
        cmap = get_rgb_colormap(dpy, scrnum, visinfo, tkwin);

#elif defined(TOGL_WGL)
        if (pfd.dwFlags & PFD_NEED_PALETTE) {
            cmap = Win32CreateRgbColormap(pfd);
        } else {
            cmap = DefaultColormap(dpy, scrnum);
        }

        /* for EPS Output */
        if (togl->EpsRedMap)
            free(togl->EpsRedMap);
        if (togl->EpsGreenMap)
            free(togl->EpsGreenMap);
        if (togl->EpsBlueMap)
            free(togl->EpsBlueMap);
        togl->EpsRedMap = togl->EpsGreenMap = togl->EpsBlueMap = NULL;
        togl->EpsMapSize = 0;

#elif defined(TOGL_AGL)
        cmap = DefaultColormap(dpy, scrnum);

        /* for EPS Output */
        if (togl->EpsRedMap)
            free(togl->EpsRedMap);
        if (togl->EpsGreenMap)
            free(togl->EpsGreenMap);
        if (togl->EpsBlueMap)
            free(togl->EpsBlueMap);
        togl->EpsRedMap = togl->EpsGreenMap = togl->EpsBlueMap = NULL;
        togl->EpsMapSize = 0;
#endif
    } else {
        /* Colormap for CI mode */
#ifdef TOGL_WGL
        /* this logic is to overcome a combination driver/compiler bug: 1.
         * cColorBits may be unusally large (e.g., 32 instead of 8 or 12) 2. 1
         * << 32 might be 1 instead of zero (gcc for ia32) */
        if (pfd.cColorBits >= MAX_CI_COLORMAP_BITS) {
            togl->CiColormapSize = MAX_CI_COLORMAP_SIZE;
        } else {
            togl->CiColormapSize = 1 << pfd.cColorBits;
            if (togl->CiColormapSize >= MAX_CI_COLORMAP_SIZE)
                togl->CiColormapSize = MAX_CI_COLORMAP_SIZE;
        }

#endif
        if (togl->PrivateCmapFlag) {
            /* need read/write colormap so user can store own color entries */
#if defined(TOGL_X11)
            cmap = XCreateColormap(dpy, XRootWindow(dpy, visinfo->screen),
                    visinfo->visual, AllocAll);
#elif defined(TOGL_WGL)
            cmap = Win32CreateCiColormap(togl);
#elif defined(TOGL_AGL)
            /* need to figure out how to do this correctly on Mac... */
            cmap = DefaultColormap(dpy, scrnum);
#endif
        } else {
            if (visinfo->visual == DefaultVisual(dpy, scrnum)) {
                /* share default/root colormap */
                cmap = Tk_Colormap(tkwin);
            } else {
                /* make a new read-only colormap */
                cmap = XCreateColormap(dpy, XRootWindow(dpy, visinfo->screen),
                        visinfo->visual, AllocNone);
            }
        }
    }

#if !defined(TOGL_AGL)
    /* Make sure Tk knows to switch to the new colormap when the cursor is over
     * this window when running in color index mode. */
    (void) Tk_SetWindowVisual(tkwin, visinfo->visual, visinfo->depth, cmap);
#endif

#ifdef TOGL_WGL
    /* Install the colormap */
    SelectPalette(togl->tglGLHdc, ((TkWinColormap *) cmap)->palette, TRUE);
    RealizePalette(togl->tglGLHdc);
#endif

#if defined(TOGL_X11)
    swa.colormap = cmap;
    swa.border_pixel = 0;
    swa.event_mask = ALL_EVENTS_MASK;
    window = XCreateWindow(dpy, parent,
            0, 0, togl->Width, togl->Height,
            0, visinfo->depth,
            InputOutput, visinfo->visual,
            CWBorderPixel | CWColormap | CWEventMask, &swa);
    /* Make sure window manager installs our colormap */
    (void) XSetWMColormapWindows(dpy, window, &window, 1);

#elif defined(TOGL_WGL)
    window = Tk_AttachHWND(tkwin, hwnd);

#elif defined(TOGL_AGL)
    {
        TkWindow *winPtr = (TkWindow *) tkwin;

        window = TkpMakeWindow(winPtr, parent);
    }
#endif

#if TOGL_USE_OVERLAY
    if (togl->OverlayFlag) {
        if (SetupOverlay(togl) == TCL_ERROR) {
            fprintf(stderr, "Warning: couldn't setup overlay.\n");
            togl->OverlayFlag = False;
        }
    }
#endif

    /* Request the X window to be displayed */
    (void) XMapWindow(dpy, window);

#if defined(TOGL_AGL)
    if (togl->ShareContext && FindTogl(togl, togl->ShareContext)) {
        /* share OpenGL context with existing Togl widget */
        Togl   *shareWith = FindTogl(togl, togl->ShareContext);

        assert(shareWith);
        assert(shareWith->aglCtx);
        togl->aglCtx = shareWith->aglCtx;
        togl->contextTag = shareWith->contextTag;
        togl->VisInfo = shareWith->VisInfo;
        visinfo = togl->VisInfo;

    } else {
        AGLContext shareCtx = NULL;

        if (togl->PixelFormat) {
            /* fill in RgbaFlag, DoubleFlag, and Stereo */
            fmt = (AGLPixelFormat) togl->PixelFormat;
            GLint   has_rgba, has_doublebuf, has_stereo;

            if (aglDescribePixelFormat(fmt, AGL_RGBA, &has_rgba)
                    && aglDescribePixelFormat(fmt, AGL_DOUBLEBUFFER,
                            &has_doublebuf)
                    && aglDescribePixelFormat(fmt, AGL_STEREO, &has_stereo)) {
                togl->RgbaFlag = (has_rgba ? True : False);
                togl->DoubleFlag = (has_doublebuf ? True : False);
                togl->Stereo =
                        (has_stereo ? TOGL_STEREO_NATIVE : TOGL_STEREO_NONE);
            } else {
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "failed querying pixel format attributes",
                        TCL_STATIC);
                return DUMMY_WINDOW;
            }
        } else {

            /* Need to do this after mapping window, so MacDrawable structure
             * is more completely filled in */
            na = 0;
            attribs[na++] = AGL_MINIMUM_POLICY;
            /* ask for hardware-accelerated onscreen */
            attribs[na++] = AGL_ACCELERATED;
            attribs[na++] = AGL_NO_RECOVERY;
            if (togl->RgbaFlag) {
                /* RGB[A] mode */
                attribs[na++] = AGL_RGBA;
                attribs[na++] = AGL_RED_SIZE;
                attribs[na++] = togl->RgbaRed;
                attribs[na++] = AGL_GREEN_SIZE;
                attribs[na++] = togl->RgbaGreen;
                attribs[na++] = AGL_BLUE_SIZE;
                attribs[na++] = togl->RgbaBlue;
                if (togl->AlphaFlag) {
                    attribs[na++] = AGL_ALPHA_SIZE;
                    attribs[na++] = togl->AlphaSize;
                }
            } else {
                /* Color index mode */
                attribs[na++] = AGL_BUFFER_SIZE;
                attribs[na++] = 8;
            }
            if (togl->DepthFlag) {
                attribs[na++] = AGL_DEPTH_SIZE;
                attribs[na++] = togl->DepthSize;
            }
            if (togl->DoubleFlag) {
                attribs[na++] = AGL_DOUBLEBUFFER;
            }
            if (togl->StencilFlag) {
                attribs[na++] = AGL_STENCIL_SIZE;
                attribs[na++] = togl->StencilSize;
            }
            if (togl->AccumFlag) {
                attribs[na++] = AGL_ACCUM_RED_SIZE;
                attribs[na++] = togl->AccumRed;
                attribs[na++] = AGL_ACCUM_GREEN_SIZE;
                attribs[na++] = togl->AccumGreen;
                attribs[na++] = AGL_ACCUM_BLUE_SIZE;
                attribs[na++] = togl->AccumBlue;
                if (togl->AlphaFlag) {
                    attribs[na++] = AGL_ACCUM_ALPHA_SIZE;
                    attribs[na++] = togl->AccumAlpha;
                }
            }
            if (togl->AuxNumber != 0) {
                attribs[na++] = AGL_AUX_BUFFERS;
                attribs[na++] = togl->AuxNumber;
            }
            if (togl->Stereo == TOGL_STEREO_NATIVE) {
                attribs[na++] = AGL_STEREO;
            }
            attribs[na++] = AGL_NONE;

            if ((fmt = aglChoosePixelFormat(NULL, 0, attribs)) == NULL) {
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "couldn't choose pixel format", TCL_STATIC);
                return DUMMY_WINDOW;
            }
        }

        /* 
         * Check whether to share lists.
         */
        if (togl->ShareList) {
            /* share display lists with existing togl widget */
            Togl   *shareWith = FindTogl(togl, togl->ShareList);

            if (shareWith) {
                shareCtx = shareWith->aglCtx;
                togl->contextTag = shareWith->contextTag;
            }
        }
        if ((togl->aglCtx = aglCreateContext(fmt, shareCtx)) == NULL) {
            GLenum  err = aglGetError();

            aglDestroyPixelFormat(fmt);
            if (err == AGL_BAD_MATCH)
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "unable to share display lists"
                        ": shared context doesn't match", TCL_STATIC);
            else if (err == AGL_BAD_CONTEXT)
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "unable to share display lists"
                        ": bad shared context", TCL_STATIC);
            else if (err == AGL_BAD_PIXELFMT)
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "could not create rendering context"
                        ": bad pixel format", TCL_STATIC);
            else
                Tcl_SetResult(togl->Interp,
                        TCL_STUPID "could not create rendering context"
                        ": unknown reason", TCL_STATIC);
            return DUMMY_WINDOW;
        }

        aglDestroyPixelFormat(fmt);
        if (!aglSetDrawable(togl->aglCtx,
                        ((MacDrawable *) (window))->toplevel->grafPtr)) {
            aglDestroyContext(togl->aglCtx);
            Tcl_SetResult(togl->Interp,
                    TCL_STUPID "couldn't set drawable", TCL_STATIC);
            return DUMMY_WINDOW;
        }

        /* Just for portability, define the simplest visinfo */
        visinfo = (XVisualInfo *) malloc(sizeof (XVisualInfo));
        visinfo->visual = DefaultVisual(dpy, DefaultScreen(dpy));
        visinfo->depth = visinfo->visual->bits_per_rgb;

        Tk_SetWindowVisual(tkwin, visinfo->visual, visinfo->depth, cmap);
    }
#endif /* TOGL_AGL */

#if defined(TOGL_X11)
    /* Check for a single/double buffering snafu */
    {
        int     dbl_flag;

        if (glXGetConfig(dpy, visinfo, GLX_DOUBLEBUFFER, &dbl_flag)) {
            if (!togl->DoubleFlag && dbl_flag) {
                /* We requested single buffering but had to accept a */
                /* double buffered visual.  Set the GL draw buffer to */
                /* be the front buffer to simulate single buffering. */
                glDrawBuffer(GL_FRONT);
            }
        }
    }
#endif

    /* for EPS Output */
    if (!togl->RgbaFlag) {
        int     index_size;

#if defined(TOGL_X11) || defined(TOGL_AGL)
        GLint   index_bits;

        glGetIntegerv(GL_INDEX_BITS, &index_bits);
        index_size = 1 << index_bits;
#elif defined(TOGL_WGL)
        index_size = togl->CiColormapSize;
#endif /* TOGL_X11 */
        if (togl->EpsMapSize != index_size) {
            if (togl->EpsRedMap)
                free(togl->EpsRedMap);
            if (togl->EpsGreenMap)
                free(togl->EpsGreenMap);
            if (togl->EpsBlueMap)
                free(togl->EpsBlueMap);
            togl->EpsMapSize = index_size;
            togl->EpsRedMap = (GLfloat *) calloc(index_size, sizeof (GLfloat));
            togl->EpsGreenMap =
                    (GLfloat *) calloc(index_size, sizeof (GLfloat));
            togl->EpsBlueMap = (GLfloat *) calloc(index_size, sizeof (GLfloat));
        }
    }
#ifdef HAVE_AUTOSTEREO
    if (togl->Stereo == TOGL_STEREO_NATIVE) {
        if (!togl->as_initialized) {
            const char *autostereod;

            togl->as_initialized = True;
            if ((autostereod = getenv("AUTOSTEREOD")) == NULL)
                autostereod = AUTOSTEREOD;
            if (autostereod && *autostereod) {
                if (ASInitialize(togl->display, autostereod) == Success) {
                    togl->ash = ASCreatedStereoWindow(dpy);
                }
            }
        } else {
            togl->ash = ASCreatedStereoWindow(dpy);
        }
    }
#endif

    return window;
}

/* 
 * Togl_WorldChanged
 *
 *    Add support for setgrid option.
 */
static void
Togl_WorldChanged(ClientData instanceData)
{
    Togl   *togl = (Togl *) instanceData;

    Tk_GeometryRequest(togl->TkWin, togl->Width, togl->Height);
    Tk_SetInternalBorder(togl->TkWin, 0);
    if (togl->SetGrid > 0) {
        Tk_SetGrid(togl->TkWin, togl->Width / togl->SetGrid,
                togl->Height / togl->SetGrid, togl->SetGrid, togl->SetGrid);
    } else {
        Tk_UnsetGrid(togl->TkWin);
    }
}

/* 
 * ToglFree
 *
 *      Wrap the ckfree macro.
 */
static void
ToglFree(char *clientData)
{
    ckfree(clientData);
}

/* 
 * ToglCmdDeletedProc
 *
 *      This procedure is invoked when a widget command is deleted.  If
 *      the widget isn't already in the process of being destroyed,
 *      this command destroys it.
 *
 * Results:
 *      None.
 *
 * Side effects:
 *      The widget is destroyed.
 *
 *----------------------------------------------------------------------
 */
static void
ToglCmdDeletedProc(ClientData clientData)
{
    Togl   *togl = (Togl *) clientData;
    Tk_Window tkwin = togl->TkWin;

    /* 
     * This procedure could be invoked either because the window was
     * destroyed and the command was then deleted (in which case tkwin
     * is NULL) or because the command was deleted, and then this procedure
     * destroys the widget.
     */

    if (tkwin) {
        Tk_DeleteEventHandler(tkwin, ExposureMask | StructureNotifyMask,
                Togl_EventProc, (ClientData) togl);
    }

    Tk_Preserve((ClientData) togl);
    Tcl_EventuallyFree((ClientData) togl, ToglFree);

    Togl_LeaveStereo(togl, togl->Stereo);

    if (togl->DestroyProc) {
        /* call user's cleanup code */
        Togl_CallCallback(togl, togl->DestroyProc);
    }

    if (togl->TimerProc != NULL) {
        Tcl_DeleteTimerHandler(togl->timerHandler);
        togl->timerHandler = NULL;
    }
    if (togl->UpdatePending) {
        Tcl_CancelIdleCall(Togl_Render, (ClientData) togl);
        togl->UpdatePending = False;
    }
#ifndef NO_TK_CURSOR
    if (togl->Cursor != None) {
        Tk_FreeCursor(togl->display, togl->Cursor);
        togl->Cursor = None;
    }
#endif

    /* remove from linked list */
    RemoveFromList(togl);

    togl->TkWin = NULL;
    if (tkwin != NULL && Tk_WindowId(tkwin) != DUMMY_WINDOW) {

#if defined(TOGL_X11)
        if (togl->GlCtx) {
            if (FindToglWithSameContext(togl) == NULL)
                glXDestroyContext(togl->display, togl->GlCtx);
            togl->GlCtx = NULL;
        }
#  if TOGL_USE_OVERLAY
        if (togl->OverlayCtx) {
            Tcl_HashEntry *entryPtr;
            TkWindow *winPtr = (TkWindow *) tkwin;

            if (winPtr) {
                entryPtr = Tcl_FindHashEntry(&winPtr->dispPtr->winTable,
                        (const char *) togl->OverlayWindow);
                Tcl_DeleteHashEntry(entryPtr);
            }
            if (FindToglWithSameOverlayContext(togl) == NULL)
                glXDestroyContext(togl->display, togl->OverlayCtx);
            togl->OverlayCtx = NULL;
        }
#  endif /* TOGL_USE_OVERLAY */
#endif
#if defined(TOGL_WGL)
        if (togl->tglGLHglrc) {
            if (FindToglWithSameContext(togl) == NULL)
                wglDeleteContext(togl->tglGLHglrc);
            togl->tglGLHglrc = NULL;
        }
        if (tkwin && togl->tglGLHdc) {
            HWND    hwnd = Tk_GetHWND(Tk_WindowId(tkwin));

            ReleaseDC(hwnd, togl->tglGLHdc);
            togl->tglGLHdc = NULL;
        }
#endif
        /* TODO: delete contexts on other platforms */

        if (togl->SetGrid > 0) {
            Tk_UnsetGrid(tkwin);
        }
        Tk_DestroyWindow(tkwin);
    }

    Tk_Release((ClientData) togl);
}


/* 
 * This gets called to handle Togl window configuration events
 */
static void
Togl_EventProc(ClientData clientData, XEvent *eventPtr)
{
    Togl   *togl = (Togl *) clientData;

    switch (eventPtr->type) {
      case Expose:
          if (eventPtr->xexpose.count == 0) {
              if (!togl->UpdatePending
                      && eventPtr->xexpose.window == Tk_WindowId(togl->TkWin)) {
                  Togl_PostRedisplay(togl);
              }
#if defined(TOGL_X11)
              if (!togl->OverlayUpdatePending && togl->OverlayFlag
                      && togl->OverlayIsMapped
                      && eventPtr->xexpose.window == togl->OverlayWindow) {
                  Togl_PostOverlayRedisplay(togl);
              }
#endif
          }
          break;
      case ConfigureNotify:
          if (togl->Width != Tk_Width(togl->TkWin)
                  || togl->Height != Tk_Height(togl->TkWin)) {
              togl->Width = Tk_Width(togl->TkWin);
              togl->Height = Tk_Height(togl->TkWin);
              (void) XResizeWindow(Tk_Display(togl->TkWin),
                      Tk_WindowId(togl->TkWin), togl->Width, togl->Height);
#if defined(TOGL_X11)
              if (togl->OverlayFlag) {
                  (void) XResizeWindow(Tk_Display(togl->TkWin),
                          togl->OverlayWindow, togl->Width, togl->Height);
                  (void) XRaiseWindow(Tk_Display(togl->TkWin),
                          togl->OverlayWindow);
              }
#endif
              Togl_MakeCurrent(togl);
              glViewport(0, 0, togl->Width, togl->Height);
#if defined(TOGL_X11)
              if (togl->OverlayFlag) {
                  Togl_UseLayer(togl, TOGL_OVERLAY);
                  glViewport(0, 0, togl->Width, togl->Height);
                  Togl_UseLayer(togl, TOGL_NORMAL);
              }
#endif
              if (togl->ReshapeProc) {
                  Togl_CallCallback(togl, togl->ReshapeProc);
              }
#ifndef TOGL_WGL                /* causes double redisplay on Win32 platform */
              Togl_PostRedisplay(togl);
#endif
          }
          break;
      case MapNotify:
#if defined(TOGL_AGL)
      {
          /* 
           * See comment for the UnmapNotify case below.
           */
          AGLDrawable d = TkMacOSXGetDrawablePort(Tk_WindowId(togl->TkWin));

          aglSetDrawable(togl->aglCtx, d);
      }
#endif
          break;
      case UnmapNotify:
#if defined(TOGL_AGL)
      {
          /* 
           * For Mac OS X Aqua, Tk subwindows are not implemented as
           * separate Aqua windows.  They are just different regions of
           * a single Aqua window.  To unmap them they are just not drawn.
           * Have to disconnect the AGL context otherwise they will continue
           * to be displayed directly by Aqua.
           */
          aglSetDrawable(togl->aglCtx, NULL);
      }
#endif
          break;
      case DestroyNotify:
          if (togl->TkWin != NULL) {
              if (togl->SetGrid > 0) {
                  Tk_UnsetGrid(togl->TkWin);
              }
              (void) Tcl_DeleteCommandFromToken(togl->Interp, togl->widgetCmd);
          }
          break;
      default:
          /* nothing */
          ;
    }
}


void
Togl_PostRedisplay(Togl *togl)
{
    if (!togl->UpdatePending) {
        togl->UpdatePending = True;
        Tk_DoWhenIdle(Togl_Render, (ClientData) togl);
    }
}


Bool
Togl_UpdatePending(const Togl *togl)
{
    return togl->UpdatePending;
}


void
Togl_SwapBuffers(const Togl *togl)
{
    if (togl->DoubleFlag) {
#if defined(TOGL_WGL)
        int     res = SwapBuffers(togl->tglGLHdc);

        if (!res) {
            ErrorExit(TEXT("SwapBuffers"));
        }
#elif defined(TOGL_X11)
        glXSwapBuffers(Tk_Display(togl->TkWin), Tk_WindowId(togl->TkWin));
#elif defined(TOGL_AGL)
        aglSwapBuffers(togl->aglCtx);
#endif
    } else {
        glFlush();
    }
}



const char *
Togl_Ident(const Togl *togl)
{
    return togl->Ident;
}


int
Togl_Width(const Togl *togl)
{
    return togl->Width;
}


int
Togl_Height(const Togl *togl)
{
    return togl->Height;
}


Tcl_Interp *
Togl_Interp(const Togl *togl)
{
    return togl->Interp;
}


Tk_Window
Togl_TkWin(const Togl *togl)
{
    return togl->TkWin;
}


const char *
Togl_CommandName(const Togl *togl)
{
    return Tcl_GetCommandName(togl->Interp, togl->widgetCmd);
}

int
Togl_ContextTag(const Togl *togl)
{
    return togl->contextTag;
}


#if defined(TOGL_X11)
/* 
 * A replacement for XAllocColor.  This function should never
 * fail to allocate a color.  When XAllocColor fails, we return
 * the nearest matching color.  If we have to allocate many colors
 * this function isn't too efficient; the XQueryColors() could be
 * done just once.
 * Written by Michael Pichler, Brian Paul, Mark Kilgard
 * Input:  dpy - X display
 *         cmap - X colormap
 *         cmapSize - size of colormap
 * In/Out: color - the XColor struct
 * Output:  exact - 1=exact color match, 0=closest match
 */
static void
noFaultXAllocColor(Display *dpy, Colormap cmap, int cmapSize,
        XColor *color, int *exact)
{
    XColor *ctable, subColor;
    int     i, bestmatch;
    double  mindist;            /* 3*2^16^2 exceeds long int precision. */

    /* First try just using XAllocColor. */
    if (XAllocColor(dpy, cmap, color)) {
        *exact = 1;
        return;
    }

    /* Retrieve color table entries. */
    /* XXX alloca candidate. */
    ctable = (XColor *) ckalloc(cmapSize * sizeof (XColor));
    for (i = 0; i < cmapSize; i++) {
        ctable[i].pixel = i;
    }
    (void) XQueryColors(dpy, cmap, ctable, cmapSize);

    /* Find best match. */
    bestmatch = -1;
    mindist = 0;
    for (i = 0; i < cmapSize; i++) {
        double  dr = (double) color->red - (double) ctable[i].red;
        double  dg = (double) color->green - (double) ctable[i].green;
        double  db = (double) color->blue - (double) ctable[i].blue;
        double  dist = dr * dr + dg * dg + db * db;

        if (bestmatch < 0 || dist < mindist) {
            bestmatch = i;
            mindist = dist;
        }
    }

    /* Return result. */
    subColor.red = ctable[bestmatch].red;
    subColor.green = ctable[bestmatch].green;
    subColor.blue = ctable[bestmatch].blue;
    ckfree((char *) ctable);
    /* Try to allocate the closest match color.  This should only fail if the
     * cell is read/write.  Otherwise, we're incrementing the cell's reference
     * count. */
    if (!XAllocColor(dpy, cmap, &subColor)) {
        /* do this to work around a problem reported by Frank Ortega */
        subColor.pixel = (unsigned long) bestmatch;
        subColor.red = ctable[bestmatch].red;
        subColor.green = ctable[bestmatch].green;
        subColor.blue = ctable[bestmatch].blue;
        subColor.flags = DoRed | DoGreen | DoBlue;
    }
    *color = subColor;
}

#elif defined(TOGL_WGL)

static UINT
Win32AllocColor(const Togl *togl, float red, float green, float blue)
{
    /* Modified version of XAllocColor emulation of Tk. - returns index,
     * instead of color itself - allocates logical palette entry even for
     * non-palette devices */

    TkWinColormap *cmap = (TkWinColormap *) Tk_Colormap(togl->TkWin);
    UINT    index;
    COLORREF newColor, closeColor;
    PALETTEENTRY entry, closeEntry;
    int     isNew, refCount;
    Tcl_HashEntry *entryPtr;

    entry.peRed = (unsigned char) (red * 255 + .5);
    entry.peGreen = (unsigned char) (green * 255 + .5);
    entry.peBlue = (unsigned char) (blue * 255 + .5);
    entry.peFlags = 0;

    /* 
     * Find the nearest existing palette entry.
     */

    newColor = RGB(entry.peRed, entry.peGreen, entry.peBlue);
    index = GetNearestPaletteIndex(cmap->palette, newColor);
    GetPaletteEntries(cmap->palette, index, 1, &closeEntry);
    closeColor = RGB(closeEntry.peRed, closeEntry.peGreen, closeEntry.peBlue);

    /* 
     * If this is not a duplicate and colormap is not full, allocate a new entry.
     */

    if (newColor != closeColor) {
        if (cmap->size == (unsigned int) togl->CiColormapSize) {
            entry = closeEntry;
        } else {
            cmap->size++;
            ResizePalette(cmap->palette, cmap->size);
            index = cmap->size - 1;
            SetPaletteEntries(cmap->palette, index, 1, &entry);
            SelectPalette(togl->tglGLHdc, cmap->palette, TRUE);
            RealizePalette(togl->tglGLHdc);
        }
    }
    newColor = PALETTERGB(entry.peRed, entry.peGreen, entry.peBlue);
    entryPtr = Tcl_CreateHashEntry(&cmap->refCounts,
            (CONST char *) newColor, &isNew);
    if (isNew) {
        refCount = 1;
    } else {
        refCount = ((int) Tcl_GetHashValue(entryPtr)) + 1;
    }
    Tcl_SetHashValue(entryPtr, (ClientData) refCount);

    /* for EPS output */
    togl->EpsRedMap[index] = (GLfloat) (entry.peRed / 255.0);
    togl->EpsGreenMap[index] = (GLfloat) (entry.peGreen / 255.0);
    togl->EpsBlueMap[index] = (GLfloat) (entry.peBlue / 255.0);
    return index;
}

static void
Win32FreeColor(const Togl *togl, unsigned long index)
{
    TkWinColormap *cmap = (TkWinColormap *) Tk_Colormap(togl->TkWin);
    COLORREF cref;
    UINT    count, refCount;
    PALETTEENTRY entry, *entries;
    Tcl_HashEntry *entryPtr;

    if (index >= cmap->size) {
        panic("Tried to free a color that isn't allocated.");
    }
    GetPaletteEntries(cmap->palette, index, 1, &entry);

    cref = PALETTERGB(entry.peRed, entry.peGreen, entry.peBlue);
    entryPtr = Tcl_FindHashEntry(&cmap->refCounts, (CONST char *) cref);
    if (!entryPtr) {
        panic("Tried to free a color that isn't allocated.");
    }
    refCount = (int) Tcl_GetHashValue(entryPtr) - 1;
    if (refCount == 0) {
        count = cmap->size - index;
        entries = (PALETTEENTRY *) ckalloc(sizeof (PALETTEENTRY) * count);
        GetPaletteEntries(cmap->palette, index + 1, count, entries);
        SetPaletteEntries(cmap->palette, index, count, entries);
        SelectPalette(togl->tglGLHdc, cmap->palette, TRUE);
        RealizePalette(togl->tglGLHdc);
        ckfree((char *) entries);
        cmap->size--;
        Tcl_DeleteHashEntry(entryPtr);
    } else {
        Tcl_SetHashValue(entryPtr, (ClientData) refCount);
    }
}

static void
Win32SetColor(const Togl *togl,
        unsigned long index, float red, float green, float blue)
{
    TkWinColormap *cmap = (TkWinColormap *) Tk_Colormap(togl->TkWin);
    PALETTEENTRY entry;

    entry.peRed = (unsigned char) (red * 255 + .5);
    entry.peGreen = (unsigned char) (green * 255 + .5);
    entry.peBlue = (unsigned char) (blue * 255 + .5);
    entry.peFlags = 0;
    SetPaletteEntries(cmap->palette, index, 1, &entry);
    SelectPalette(togl->tglGLHdc, cmap->palette, TRUE);
    RealizePalette(togl->tglGLHdc);

    /* for EPS output */
    togl->EpsRedMap[index] = (GLfloat) (entry.peRed / 255.0);
    togl->EpsGreenMap[index] = (GLfloat) (entry.peGreen / 255.0);
    togl->EpsBlueMap[index] = (GLfloat) (entry.peBlue / 255.0);
}
#endif /* TOGL_X11 */


unsigned long
Togl_AllocColor(const Togl *togl, float red, float green, float blue)
{
    if (togl->RgbaFlag) {
        (void) fprintf(stderr,
                "Error: Togl_AllocColor illegal in RGBA mode.\n");
        return 0;
    }
    /* TODO: maybe not... */
    if (togl->PrivateCmapFlag) {
        (void) fprintf(stderr,
                "Error: Togl_AllocColor illegal with private colormap\n");
        return 0;
    }
#if defined(TOGL_X11)
    {
        XColor  xcol;
        int     exact;

        xcol.red = (short) (red * 65535.0);
        xcol.green = (short) (green * 65535.0);
        xcol.blue = (short) (blue * 65535.0);

        noFaultXAllocColor(Tk_Display(togl->TkWin), Tk_Colormap(togl->TkWin),
                Tk_Visual(togl->TkWin)->map_entries, &xcol, &exact);
        /* for EPS output */
        togl->EpsRedMap[xcol.pixel] = (float) xcol.red / 65535.0;
        togl->EpsGreenMap[xcol.pixel] = (float) xcol.green / 65535.0;
        togl->EpsBlueMap[xcol.pixel] = (float) xcol.blue / 65535.0;

        return xcol.pixel;
    }

#elif defined(TOGL_WGL)
    return Win32AllocColor(togl, red, green, blue);

#elif defined(TOGL_AGL)
    /* still need to implement this on Mac... */
    return 0;

#endif
}



void
Togl_FreeColor(const Togl *togl, unsigned long pixel)
{
    if (togl->RgbaFlag) {
        (void) fprintf(stderr, "Error: Togl_FreeColor illegal in RGBA mode.\n");
        return;
    }
    /* TODO: maybe not... */
    if (togl->PrivateCmapFlag) {
        (void) fprintf(stderr,
                "Error: Togl_FreeColor illegal with private colormap\n");
        return;
    }
#if defined(TOGL_X11)
    (void) XFreeColors(Tk_Display(togl->TkWin), Tk_Colormap(togl->TkWin),
            &pixel, 1, 0);
#elif defined(TOGL_WGL)
    Win32FreeColor(togl, pixel);
#endif
}



void
Togl_SetColor(const Togl *togl,
        unsigned long index, float red, float green, float blue)
{

    if (togl->RgbaFlag) {
        (void) fprintf(stderr, "Error: Togl_SetColor illegal in RGBA mode.\n");
        return;
    }
    if (!togl->PrivateCmapFlag) {
        (void) fprintf(stderr,
                "Error: Togl_SetColor requires a private colormap\n");
        return;
    }
#if defined(TOGL_X11)
    {
        XColor  xcol;

        xcol.pixel = index;
        xcol.red = (short) (red * 65535.0);
        xcol.green = (short) (green * 65535.0);
        xcol.blue = (short) (blue * 65535.0);
        xcol.flags = DoRed | DoGreen | DoBlue;

        (void) XStoreColor(Tk_Display(togl->TkWin), Tk_Colormap(togl->TkWin),
                &xcol);

        /* for EPS output */
        togl->EpsRedMap[xcol.pixel] = (float) xcol.red / 65535.0;
        togl->EpsGreenMap[xcol.pixel] = (float) xcol.green / 65535.0;
        togl->EpsBlueMap[xcol.pixel] = (float) xcol.blue / 65535.0;
    }
#elif defined(TOGL_WGL)
    Win32SetColor(togl, index, red, green, blue);
#endif
}


#if TOGL_USE_FONTS == 1
#  include "toglFont.c"
#else

Tcl_Obj *
Togl_LoadBitmapFont(const Togl *togl, const char *fontname)
{
    return NULL;
}

int
Togl_UnloadBitmapFont(const Togl *togl, Tcl_Obj *bitmapfont)
{
    return TCL_OK;
}

int
Togl_WriteObj(const Togl *togl, const Tcl_Obj *toglfont, const Tcl_Obj *obj)
{
    return -1;
}

int
Togl_WriteChars(const Togl *togl, const Tcl_Obj *toglfont, const char *str,
        int len)
{
    return -1;
}
#endif /* TOGL_USE_FONTS */



/* 
 * Overlay functions
 */


void
Togl_UseLayer(Togl *togl, int layer)
{
    if (layer == TOGL_NORMAL) {
#if defined(TOGL_WGL)
        int     res = wglMakeCurrent(togl->tglGLHdc, togl->tglGLHglrc);

        if (!res) {
            ErrorExit(TEXT("wglMakeCurrent"));
        }
#elif defined(TOGL_X11)
        (void) glXMakeCurrent(Tk_Display(togl->TkWin),
                Tk_WindowId(togl->TkWin), togl->GlCtx);
#elif defined(TOGL_AGL)
        (void) aglSetCurrentContext(togl->aglCtx);
#endif /* TOGL_WGL */
    } else if (layer == TOGL_OVERLAY && togl->OverlayWindow) {
#if defined(TOGL_WGL)
        int     res = wglMakeCurrent(togl->tglGLHdc, togl->tglGLOverlayHglrc);

        if (!res) {
            ErrorExit(TEXT("wglMakeCurrent overlay"));
        }
#elif defined(TOGL_X11)
        (void) glXMakeCurrent(Tk_Display(togl->TkWin),
                togl->OverlayWindow, togl->OverlayCtx);
#elif defined(TOGL_AGL)
#endif /* TOGL_WGL */
    } else {
        /* error */
    }
}


void
Togl_ShowOverlay(Togl *togl)
{
#if defined(TOGL_X11)           /* not yet implemented on Windows */
    if (togl->OverlayWindow) {
        (void) XMapWindow(Tk_Display(togl->TkWin), togl->OverlayWindow);
        (void) XInstallColormap(Tk_Display(togl->TkWin), togl->OverlayCmap);
        togl->OverlayIsMapped = True;
    }
#endif
}


void
Togl_HideOverlay(Togl *togl)
{
    if (togl->OverlayWindow && togl->OverlayIsMapped) {
        (void) XUnmapWindow(Tk_Display(togl->TkWin), togl->OverlayWindow);
        togl->OverlayIsMapped = False;
    }
}


void
Togl_PostOverlayRedisplay(Togl *togl)
{
    if (!togl->OverlayUpdatePending
            && togl->OverlayWindow && togl->OverlayDisplayProc) {
        Tk_DoWhenIdle(Togl_RenderOverlay, (ClientData) togl);
        togl->OverlayUpdatePending = True;
    }
}


int
Togl_ExistsOverlay(const Togl *togl)
{
    return togl->OverlayFlag;
}


int
Togl_GetOverlayTransparentValue(const Togl *togl)
{
    return togl->OverlayTransparentPixel;
}


int
Togl_IsMappedOverlay(const Togl *togl)
{
    return togl->OverlayFlag && togl->OverlayIsMapped;
}


unsigned long
Togl_AllocColorOverlay(const Togl *togl, float red, float green, float blue)
{
#if defined(TOGL_X11)           /* not yet implemented on Windows */
    if (togl->OverlayFlag && togl->OverlayCmap) {
        XColor  xcol;

        xcol.red = (short) (red * 65535.0);
        xcol.green = (short) (green * 65535.0);
        xcol.blue = (short) (blue * 65535.0);
        if (!XAllocColor(Tk_Display(togl->TkWin), togl->OverlayCmap, &xcol))
            return (unsigned long) -1;
        return xcol.pixel;
    }
#endif /* TOGL_X11 */
    return (unsigned long) -1;
}


void
Togl_FreeColorOverlay(const Togl *togl, unsigned long pixel)
{
#if defined(TOGL_X11)           /* not yet implemented on Windows */
    if (togl->OverlayFlag && togl->OverlayCmap) {
        (void) XFreeColors(Tk_Display(togl->TkWin), togl->OverlayCmap, &pixel,
                1, 0);
    }
#endif /* TOGL_X11 */
}


/* 
 * User client data
 */

ClientData
Togl_GetClientData(const Togl *togl)
{
    return togl->Client_Data;
}


void
Togl_SetClientData(Togl *togl, ClientData clientData)
{
    togl->Client_Data = clientData;
}


#ifdef MESA_COLOR_HACK
/* 
 * Let's know how many free colors do we have
 */
#  define RLEVELS     5
#  define GLEVELS     9
#  define BLEVELS     5

/* to free dithered_rgb_colormap pixels allocated by Mesa */
static unsigned long *ToglMesaUsedPixelCells = NULL;
static int ToglMesaUsedFreeCells = 0;

static int
get_free_color_cells(Display *display, int screen, Colormap colormap)
{
    if (!ToglMesaUsedPixelCells) {
        XColor  xcol;
        int     i;
        int     colorsfailed, ncolors = XDisplayCells(display, screen);

        long    r, g, b;

        ToglMesaUsedPixelCells =
                (unsigned long *) ckalloc(ncolors * sizeof (unsigned long));

        /* Allocate X colors and initialize color_table[], red_table[], etc */
        /* de Mesa 2.1: xmesa1.c setup_dithered_(...) */
        i = colorsfailed = 0;
        for (r = 0; r < RLEVELS; r++)
            for (g = 0; g < GLEVELS; g++)
                for (b = 0; b < BLEVELS; b++) {
                    int     exact;

                    xcol.red = (r * 65535) / (RLEVELS - 1);
                    xcol.green = (g * 65535) / (GLEVELS - 1);
                    xcol.blue = (b * 65535) / (BLEVELS - 1);
                    noFaultXAllocColor(display, colormap, ncolors,
                            &xcol, &exact);
                    ToglMesaUsedPixelCells[i++] = xcol.pixel;
                    if (!exact) {
                        colorsfailed++;
                    }
                }
        ToglMesaUsedFreeCells = i;

        XFreeColors(display, colormap, ToglMesaUsedPixelCells,
                ToglMesaUsedFreeCells, 0x00000000);
    }
    return ToglMesaUsedFreeCells;
}


static void
free_default_color_cells(Display *display, Colormap colormap)
{
    if (ToglMesaUsedPixelCells) {
        XFreeColors(display, colormap, ToglMesaUsedPixelCells,
                ToglMesaUsedFreeCells, 0x00000000);
        ckfree((char *) ToglMesaUsedPixelCells);
        ToglMesaUsedPixelCells = NULL;
        ToglMesaUsedFreeCells = 0;
    }
}
#endif

/* 
 * Original stereo code contributed by Ben Evans (Ben.Evans@anusf.anu.edu.au)
 * and was based on SGI's /usr/share/src/OpenGL/teach/stereo/glwstereo.c,
 * which is identical to the 1997/12/1 glwstereo.c code in the CrystalEyes
 * Software Development Kit.
 */

int
Togl_NumEyes(const Togl *togl)
{
    if (togl->Stereo > TOGL_STEREO_ONE_EYE_MAX)
        return 2;
    return 1;
}

/* call instead of glDrawBuffer */
void
Togl_DrawBuffer(Togl *togl, GLenum mode)
{
    if (togl->Stereo <= TOGL_STEREO_ONE_EYE_MAX) {
        /* Only drawing a single eye */
        if (togl->currentStereoBuffer != STEREO_BUFFER_NONE) {
            glViewport(0, 0, togl->Width, togl->Height);
            glColorMask(GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE);
            togl->currentStereoBuffer = STEREO_BUFFER_NONE;
        }
        switch (mode) {
          case GL_FRONT:
          case GL_BACK:
          case GL_FRONT_AND_BACK:
              break;
          case GL_LEFT:
          case GL_FRONT_LEFT:
          case GL_RIGHT:
          case GL_FRONT_RIGHT:
              mode = GL_FRONT;
              break;
          case GL_BACK_LEFT:
          case GL_BACK_RIGHT:
              mode = GL_BACK;
              break;
          default:
              break;
        }
        glDrawBuffer(mode);
#ifdef STEREO_I_H
        if (togl->Stereo == TOGL_STEREO_NVIDIA_CON) {
            if (togl->pStereoI) {
                togl->pStereoI->SetSeparation((float) togl->EyeSeparation);
                togl->pStereoI->SetConvergence((float) togl->Convergence);
            }
        }
#endif
        return;
    }
    /* called once for each eye */
    switch (mode) {
      case GL_FRONT:
      case GL_BACK:
      case GL_FRONT_AND_BACK:
          /* 
           ** Simultaneous drawing to both left and right buffers isn't
           ** really possible if we don't have a stereo capable visual.
           ** For now just fall through and use the left buffer.
           */
      case GL_LEFT:
      case GL_FRONT_LEFT:
      case GL_BACK_LEFT:
          togl->currentStereoBuffer = STEREO_BUFFER_LEFT;
          break;
      case GL_RIGHT:
      case GL_FRONT_RIGHT:
      case GL_BACK_RIGHT:
          togl->currentStereoBuffer = STEREO_BUFFER_RIGHT;
          break;
      default:
          break;
    }
    if (togl->Stereo != TOGL_STEREO_NATIVE) {
        switch (mode) {
          default:
              mode = GL_FRONT;
              break;
          case GL_BACK:
          case GL_BACK_LEFT:
          case GL_BACK_RIGHT:
              mode = GL_BACK;
              break;
        }
    }
    switch (togl->Stereo) {
      default:
          break;
#ifdef __sgi
      case TOGL_STEREO_SGIOLDSTYLE:
          glXWaitGL();          /* sync with GL command stream before calling X 
                                 */
          XSGISetStereoBuffer(togl->display, Tk_WindowId(togl->TkWin),
                  togl->currentStereoBuffer);
          glXWaitX();           /* sync with X command stream before calling GL 
                                 */
          break;
#endif
      case TOGL_STEREO_ANAGLYPH:
          if (togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
              glColorMask(GL_TRUE, GL_FALSE, GL_FALSE, GL_TRUE);
          else
              glColorMask(GL_FALSE, GL_TRUE, GL_TRUE, GL_TRUE);
          break;
      case TOGL_STEREO_CROSS_EYE:
          if (togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
              glViewport(togl->Width / 2 + 1, 0, togl->Width / 2, togl->Height);
          else
              glViewport(0, 0, togl->Width / 2, togl->Height);
          break;
      case TOGL_STEREO_WALL_EYE:
          if (togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
              glViewport(0, 0, togl->Width / 2, togl->Height);
          else
              glViewport(togl->Width / 2 + 1, 0, togl->Width / 2, togl->Height);
          break;
      case TOGL_STEREO_DTI:
          if (togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
              glViewport(0, 0, togl->Width / 2, togl->Height);
          else
              glViewport(togl->Width / 2 + 1, 0, togl->Width / 2, togl->Height);
          break;
    }
    glDrawBuffer(mode);
}

/* call instead of glClear */
void
Togl_Clear(const Togl *togl, GLbitfield mask)
{
    switch (togl->Stereo) {
      default:
          break;
      case TOGL_STEREO_CROSS_EYE:
      case TOGL_STEREO_WALL_EYE:
      case TOGL_STEREO_DTI:
          if (togl->currentStereoBuffer != STEREO_BUFFER_LEFT) {
              /* Since glViewport does not affect what is cleared (unlike
               * glScissor), only clear in left eye */
              return;
          }
    }
#if 0
    /* only needed if we wish to support multi-eye clears */
    if (togl->Stereo > TOGL_STEREO_ONE_EYE_MAX) {
        GLenum  drawBuffer = togl->currentDrawBuffer;

        switch (drawBuffer) {
          case GL_FRONT:
              Togl_DrawBuffer(togl, GL_FRONT_RIGHT);
              glClear(mask);
              Togl_DrawBuffer(togl, drawBuffer);
              break;
          case GL_BACK:
              Togl_DrawBuffer(togl, GL_BACK_RIGHT);
              glClear(mask);
              Togl_DrawBuffer(togl, drawBuffer);
              break;
          case GL_FRONT_AND_BACK:
              Togl_DrawBuffer(togl, GL_RIGHT);
              glClear(mask);
              Togl_DrawBuffer(togl, drawBuffer);
              break;
          case GL_LEFT:
          case GL_FRONT_LEFT:
          case GL_BACK_LEFT:
          case GL_RIGHT:
          case GL_FRONT_RIGHT:
          case GL_BACK_RIGHT:
          default:
              break;
        }
    }
#endif
    glClear(mask);
}

void
Togl_Frustum(const Togl *togl, GLdouble left, GLdouble right,
        GLdouble bottom, GLdouble top, GLdouble zNear, GLdouble zFar)
{
    GLdouble eyeOffset = 0, eyeShift = 0;

    if (togl->Stereo == TOGL_STEREO_LEFT_EYE
            || togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
        eyeOffset = -togl->EyeSeparation / 2;   /* for left eye */
    else if (togl->Stereo == TOGL_STEREO_RIGHT_EYE
            || togl->currentStereoBuffer == STEREO_BUFFER_RIGHT)
        eyeOffset = togl->EyeSeparation / 2;    /* for right eye */
    eyeShift = (togl->Convergence - zNear) * (eyeOffset / togl->Convergence);

    /* compenstate for altered viewports */
    switch (togl->Stereo) {
      default:
          break;
      case TOGL_STEREO_SGIOLDSTYLE:
      case TOGL_STEREO_DTI:
          /* squished image is expanded, nothing needed */
          break;
      case TOGL_STEREO_CROSS_EYE:
      case TOGL_STEREO_WALL_EYE:{
          GLdouble delta = (top - bottom) / 2;

          top += delta;
          bottom -= delta;
          break;
      }
    }

    glFrustum(left + eyeShift, right + eyeShift, bottom, top, zNear, zFar);
    glTranslated(-eyeShift, 0, 0);
}

void
Togl_Ortho(const Togl *togl, GLdouble left, GLdouble right,
        GLdouble bottom, GLdouble top, GLdouble zNear, GLdouble zFar)
{
    /* TODO: debug this */
    GLdouble eyeOffset = 0, eyeShift = 0;

    if (togl->currentStereoBuffer == STEREO_BUFFER_LEFT)
        eyeOffset = -togl->EyeSeparation / 2;   /* for left eye */
    else if (togl->currentStereoBuffer == STEREO_BUFFER_RIGHT)
        eyeOffset = togl->EyeSeparation / 2;    /* for right eye */
    eyeShift = (togl->Convergence - zNear) * (eyeOffset / togl->Convergence);

    /* compenstate for altered viewports */
    switch (togl->Stereo) {
      default:
          break;
      case TOGL_STEREO_SGIOLDSTYLE:
      case TOGL_STEREO_DTI:
          /* squished image is expanded, nothing needed */
          break;
      case TOGL_STEREO_CROSS_EYE:
      case TOGL_STEREO_WALL_EYE:{
          GLdouble delta = (top - bottom) / 2;

          top += delta;
          bottom -= delta;
          break;
      }
    }

    glOrtho(left + eyeShift, right + eyeShift, bottom, top, zNear, zFar);
    glTranslated(-eyeShift, 0, 0);
}

int
Togl_GetToglFromObj(Tcl_Interp *interp, Tcl_Obj *obj, Togl **toglPtr)
{
    Tcl_Command toglCmd;
    Tcl_CmdInfo info;

    toglCmd = Tcl_GetCommandFromObj(interp, obj);
    if (Tcl_GetCommandInfoFromToken(toglCmd, &info) == 0
            || info.objProc != Togl_ObjWidget) {
        Tcl_AppendResult(interp, "expected togl command argument", NULL);
        return TCL_ERROR;
    }
    *toglPtr = (Togl *) info.objClientData;
    return TCL_OK;
}

int
Togl_GetToglFromName(Tcl_Interp *interp, const char *cmdName, Togl **toglPtr)
{
    Tcl_CmdInfo info;

    if (Tcl_GetCommandInfo(interp, cmdName, &info) == 0
            || info.objProc != Togl_ObjWidget) {
        Tcl_AppendResult(interp, "expected togl command argument", NULL);
        return TCL_ERROR;
    }
    *toglPtr = (Togl *) info.objClientData;
    return TCL_OK;
}

static int ObjectIsEmpty(Tcl_Obj *objPtr);

/* 
 *----------------------------------------------------------------------
 *
 * GetStereo -
 *
 *      Converts an internal int into a a Tcl string obj.
 *
 * Results:
 *      Tcl_Obj containing the string representation of the stereo value.
 *
 * Side effects:
 *      Creates a new Tcl_Obj.
 *
 *----------------------------------------------------------------------
 */

static Tcl_Obj *
GetStereo(ClientData clientData, Tk_Window tkwin, char *recordPtr,
        int internalOffset)
    /* recordPtr is a pointer to widget record. */
    /* internalOffset is the offset within *recordPtr containing the stereo
     * value. */
{
    int     stereo = *(int *) (recordPtr + internalOffset);
    const char *name = "unknown";

    switch (stereo) {
      case TOGL_STEREO_NONE:
          name = "";
          break;
      case TOGL_STEREO_LEFT_EYE:
          name = "left eye";
          break;
      case TOGL_STEREO_RIGHT_EYE:
          name = "right eye";
          break;
      case TOGL_STEREO_NVIDIA_CON:
          name = "nvidia consumer stereo";
          break;
      case TOGL_STEREO_NATIVE:
          name = "native";
          break;
      case TOGL_STEREO_SGIOLDSTYLE:
          name = "sgioldstyle";
          break;
      case TOGL_STEREO_ANAGLYPH:
          name = "anaglyph";
          break;
      case TOGL_STEREO_CROSS_EYE:
          name = "cross-eye";
          break;
      case TOGL_STEREO_WALL_EYE:
          name = "wall-eye";
          break;
      case TOGL_STEREO_DTI:
          name = "dti";
          break;
    }
    return Tcl_NewStringObj(name, -1);
}

/* 
 *----------------------------------------------------------------------
 *
 * SetStereo --
 *
 *      Converts a Tcl_Obj representing a widgets stereo into an
 *      integer value.
 *
 * Results:
 *      Standard Tcl result.
 *
 * Side effects:
 *      May store the integer value into the internal representation
 *      pointer.  May change the pointer to the Tcl_Obj to NULL to indicate
 *      that the specified string was empty and that is acceptable.
 *
 *----------------------------------------------------------------------
 */

static int
SetStereo(ClientData clientData, Tcl_Interp *interp, Tk_Window tkwin,
        Tcl_Obj **value, char *recordPtr, int internalOffset,
        char *oldInternalPtr, int flags)
    /* interp is the current interp; may be used for errors. */
    /* tkwin is the Window for which option is being set. */
    /* value is a pointer to the pointer to the value object. We use a pointer
     * to the pointer because we may need to return a value (NULL). */
    /* recordPtr is a pointer to storage for the widget record. */
    /* internalOffset is the offset within *recordPtr at which the internal
     * value is to be stored. */
    /* oldInternalPtr is a pointer to storage for the old value. */
    /* flags are the flags for the option, set Tk_SetOptions. */
{
    int     stereo = 0;
    char   *string, *internalPtr;

    internalPtr = (internalOffset > 0) ? recordPtr + internalOffset : NULL;

    if (flags & TK_OPTION_NULL_OK && ObjectIsEmpty(*value)) {
        *value = NULL;
    } else {
        /* 
         * Convert the stereo specifier into an integer value.
         */

        string = Tcl_GetString(*value);

        if (strcmp(string, "") == 0 || strcasecmp(string, "none") == 0
                || strcasecmp(string, "false") == 0) {
            stereo = TOGL_STEREO_NONE;
        } else if (strcasecmp(string, "native") == 0
                || strcasecmp(string, "true") == 0) {
            stereo = TOGL_STEREO_NATIVE;
            /* check if available when creating visual */
        } else if (strcasecmp(string, "left eye") == 0) {
            stereo = TOGL_STEREO_LEFT_EYE;
        } else if (strcasecmp(string, "right eye") == 0) {
            stereo = TOGL_STEREO_RIGHT_EYE;
        } else if (strcasecmp(string, "nvidia consumer stereo") == 0) {
            stereo = TOGL_STEREO_NVIDIA_CON;
        } else if (strcasecmp(string, "sgioldstyle") == 0) {
            stereo = TOGL_STEREO_SGIOLDSTYLE;
        } else if (strcasecmp(string, "anaglyph") == 0) {
            stereo = TOGL_STEREO_ANAGLYPH;
        } else if (strcasecmp(string, "cross-eye") == 0) {
            stereo = TOGL_STEREO_CROSS_EYE;
        } else if (strcasecmp(string, "wall-eye") == 0) {
            stereo = TOGL_STEREO_WALL_EYE;
        } else if (strcasecmp(string, "dti") == 0) {
            stereo = TOGL_STEREO_DTI;
        } else {
            Tcl_ResetResult(interp);
            Tcl_AppendResult(interp, "bad stereo value \"",
                    Tcl_GetString(*value), "\"", NULL);
            return TCL_ERROR;
        }
    }

    if (internalPtr != NULL) {
        *((int *) oldInternalPtr) = *((int *) internalPtr);
        *((int *) internalPtr) = stereo;
    }
    return TCL_OK;
}

/* 
 *----------------------------------------------------------------------
 * RestoreStereo --
 *
 *      Restore a stereo option value from a saved value.
 *
 * Results:
 *      None.
 *
 * Side effects:
 *      Restores the old value.
 *
 *----------------------------------------------------------------------
 */

static void
RestoreStereo(ClientData clientData, Tk_Window tkwin, char *internalPtr,
        char *oldInternalPtr)
{
    *(int *) internalPtr = *(int *) oldInternalPtr;
}

/* 
 *----------------------------------------------------------------------
 *
 * ObjectIsEmpty --
 *
 *      This procedure tests whether the string value of an object is
 *      empty.
 *
 * Results:
 *      The return value is 1 if the string value of objPtr has length
 *      zero, and 0 otherwise.
 *
 * Side effects:
 *      None.
 *
 *----------------------------------------------------------------------
 */

static int
ObjectIsEmpty(Tcl_Obj *objPtr)
/* objPtr = Object to test.  May be NULL. */
{
    int     length;

    if (objPtr == NULL) {
        return 1;
    }
    if (objPtr->bytes != NULL) {
        return (objPtr->length == 0);
    }
    Tcl_GetStringFromObj(objPtr, &length);
    return (length == 0);
}

blob
data 3745
library togl
interface togl

# Declare each of the functions in the public Togl interface.  Note that
# the an index should never be reused for a different function in order
# to preserve backwards compatibility.

# package initialization
declare 0 generic {
	int Togl_Init(Tcl_Interp *interp)
}

# Miscellaneous
declare 1 generic {
	void Togl_MakeCurrent(const Togl *togl)
}
declare 2 generic {
	void Togl_PostRedisplay(Togl *togl)
}
declare 3 generic {
	void Togl_SwapBuffers(const Togl *togl)
}
declare 33 generic {
	Bool Togl_SwapInterval(const Togl *togl, int interval)
}

# Query functions
declare 4 generic {
	const char *Togl_Ident(const Togl *togl)
}
declare 5 generic {
	int Togl_Width(const Togl *togl)
}
declare 6 generic {
	int Togl_Height(const Togl *togl)
}
declare 7 generic {
	Tcl_Interp *Togl_Interp(const Togl *togl)
}
declare 8 generic {
	Tk_Window Togl_TkWin(const Togl *togl)
}
declare 9 generic {
	const char *Togl_CommandName(const Togl *togl)
}
declare 36 generic {
	int Togl_ContextTag(const Togl *togl)
}
declare 37 generic {
	Bool Togl_UpdatePending(const Togl *togl)
}

# Color Index mode
declare 10 generic {
	unsigned long Togl_AllocColor(const Togl *togl, float red,
		float green, float blue)
}
declare 11 generic {
	void Togl_FreeColor(const Togl *togl, unsigned long index)
}
declare 12 generic {
	void Togl_SetColor(const Togl *togl, unsigned long index,
		float red, float green, float blue)
}

# Bitmap fonts
declare 13 generic {
	Tcl_Obj *Togl_LoadBitmapFont(const Togl *togl, const char *fontname)
}
declare 14 generic {
	int Togl_UnloadBitmapFont(const Togl *togl, Tcl_Obj *toglfont)
}

declare 38 generic {
	int Togl_WriteObj(const Togl *togl, const Tcl_Obj *toglfont, Tcl_Obj *obj)
}

declare 39 generic {
	int Togl_WriteChars(const Togl *togl, const Tcl_Obj *toglfont, const char *str, int len)
}

# Overlay functions
declare 15 generic {
	void Togl_UseLayer(Togl *togl, int layer)
}
declare 16 generic {
	void Togl_ShowOverlay(Togl *togl)
}
declare 17 generic {
	void Togl_HideOverlay(Togl *togl)
}
declare 18 generic {
	void Togl_PostOverlayRedisplay(Togl *togl)
}
declare 19 generic {
	int Togl_ExistsOverlay(const Togl *togl)
}
declare 20 generic {
	int Togl_GetOverlayTransparentValue(const Togl *togl)
}
declare 21 generic {
	int Togl_IsMappedOverlay(const Togl *togl)
}
declare 22 generic {
	unsigned long Togl_AllocColorOverlay(const Togl *togl,
		float red, float green, float blue)
}
declare 23 generic {
	void Togl_FreeColorOverlay(const Togl *togl, unsigned long index)
}

# User client data
declare 24 generic {
	ClientData Togl_GetClientData(const Togl *togl)
}
declare 25 generic {
	void Togl_SetClientData(Togl *togl, ClientData clientData)
}

# Stereo support
declare 26 generic {
	void Togl_DrawBuffer(Togl *togl, GLenum mode)
}
declare 27 generic {
	void Togl_Clear(const Togl *togl, GLbitfield mask)
}
declare 28 generic {
	void Togl_Frustum(const Togl *togl, GLdouble left, GLdouble right,
		GLdouble bottom, GLdouble top, GLdouble near, GLdouble far)
}
declare 34 generic {
	void Togl_Ortho(const Togl *togl, GLdouble left, GLdouble right,
		GLdouble bottom, GLdouble top, GLdouble near, GLdouble far)
}
declare 35 generic {
	int Togl_NumEyes(const Togl *togl)
}

# save current contents of OpenGL window into photo image
declare 30 generic {
	int Togl_TakePhoto(Togl *togl, Tk_PhotoHandle photo)
}

# platform-independent lookup of OpenGL functions
declare 31 generic {
	Togl_FuncPtr Togl_GetProcAddr(const char *funcname)
}

# Return the Togl data associated with pathName
declare 29 generic {
	int Togl_GetToglFromObj(Tcl_Interp *interp, Tcl_Obj *obj, Togl **toglPtr)
}
declare 32 generic {
	int Togl_GetToglFromName(Tcl_Interp *interp, const char *cmdName, Togl **toglPtr)
}

blob
data 3134
/* $Id$ */

/* vi:set sw=4: */

/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2008  Greg Couch
 * See the LICENSE file for copyright details.
 */


#ifndef TOGL_H
#  define TOGL_H

#  include "togl_ws.h"

#  ifdef TOGL_WGL
#    define WIN32_LEAN_AND_MEAN
#    include <windows.h>
#    undef WIN32_LEAN_AND_MEAN
#    if defined(_MSC_VER)
#      	define DllEntryPoint DllMain
#    endif
#  endif

#  ifdef TOGL_AGL
#    ifndef MAC_OSX_TCL
#      define MAC_OSX_TCL 1
#    endif
#    ifndef MAC_OSX_TK
#      define MAC_OSX_TK 1
#    endif
#  endif

#  ifdef USE_TOGL_STUBS
#    ifndef USE_TCL_STUBS
#      define USE_TCL_STUBS
#    endif
#    ifndef USE_TK_STUBS
#      define USE_TK_STUBS
#    endif
#  endif

#  include <tcl.h>
#  include <tk.h>
#  if defined(TOGL_AGL)
#    include <OpenGL/gl.h>
#  else
#    include <GL/gl.h>
#  endif

#  ifdef BUILD_togl
#    undef TCL_STORAGE_CLASS
#    define TCL_STORAGE_CLASS DLLEXPORT
#  endif

#  ifndef CONST84
#    define CONST84
#  endif

#  ifndef NULL
#    define NULL 0
#  endif

#  ifndef EXTERN
#    define EXTERN extern
#  endif

#  ifdef __cplusplus
/* *INDENT-OFF* */
extern "C" {
/* *INDENT-ON* */
#  endif

#  define TOGL_VERSION "2.0"
#  define TOGL_MAJOR_VERSION 2
#  define TOGL_MINOR_VERSION 0

/* 
 * "Standard" fonts which can be specified to Togl_LoadBitmapFont()
 * Deprecated.  Use the Tk font name or description instead.
 */
#  define TOGL_BITMAP_8_BY_13		"8x13"
#  define TOGL_BITMAP_9_BY_15		"9x15"
#  define TOGL_BITMAP_TIMES_ROMAN_10 	"Times 10"
#  define TOGL_BITMAP_TIMES_ROMAN_24 	"Times 24"
#  define TOGL_BITMAP_HELVETICA_10 	"Helvetica 10"
#  define TOGL_BITMAP_HELVETICA_12 	"Helvetica 12"
#  define TOGL_BITMAP_HELVETICA_18 	"Helvetica 18"

/* 
 * Normal and overlay plane constants
 */
#  define TOGL_NORMAL	1
#  define TOGL_OVERLAY	2

/* 
 * Stereo techniques:
 *      Only the native method uses OpenGL quad-buffered stereo.
 *      All need the eye offset and eye distance set properly.
 */
/* These versions need one eye drawn */
#  define TOGL_STEREO_NONE		0
#  define TOGL_STEREO_LEFT_EYE		1       /* just the left eye */
#  define TOGL_STEREO_RIGHT_EYE		2       /* just the right eye */
#  define TOGL_STEREO_NVIDIA_CON	3       /* GeForce Consumer 3D stereo */
#  define TOGL_STEREO_ONE_EYE_MAX	127
/* These versions need both eyes drawn */
#  define TOGL_STEREO_NATIVE		128
#  define TOGL_STEREO_SGIOLDSTYLE	129     /* interlaced, SGI API */
#  define TOGL_STEREO_ANAGLYPH		130
#  define TOGL_STEREO_CROSS_EYE		131
#  define TOGL_STEREO_WALL_EYE		132
#  define TOGL_STEREO_DTI		133     /* dti3d.com */

struct Togl;
typedef struct Togl Togl;
typedef void (*Togl_FuncPtr) ();

const char *Togl_InitStubs _ANSI_ARGS_((Tcl_Interp *interp, const char *version,
                int exact));

#  ifndef USE_TOGL_STUBS
#    define Togl_InitStubs(interp, version, exact) \
	Tcl_PkgRequire(interp, "Togl", version, exact)
#  endif

#  ifdef __cplusplus
/* *INDENT-OFF* */
}
/* *INDENT-ON* */
#  endif

/* 
 * Platform independent exported functions
 */

#  include "toglDecls.h"

#endif

blob
data 12021
#ifndef ToglDecls_H
#  define ToglDecls_H

/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2008  Greg Couch
 * See the LICENSE file for copyright details.
 */

/* !BEGIN!: Do not edit below this line. */

/*
 * Exported function declarations:
 */

/* 0 */
EXTERN int		Togl_Init _ANSI_ARGS_((Tcl_Interp * interp));
/* 1 */
EXTERN void		Togl_MakeCurrent _ANSI_ARGS_((const Togl * togl));
/* 2 */
EXTERN void		Togl_PostRedisplay _ANSI_ARGS_((Togl * togl));
/* 3 */
EXTERN void		Togl_SwapBuffers _ANSI_ARGS_((const Togl * togl));
/* 4 */
EXTERN const char *	Togl_Ident _ANSI_ARGS_((const Togl * togl));
/* 5 */
EXTERN int		Togl_Width _ANSI_ARGS_((const Togl * togl));
/* 6 */
EXTERN int		Togl_Height _ANSI_ARGS_((const Togl * togl));
/* 7 */
EXTERN Tcl_Interp *	Togl_Interp _ANSI_ARGS_((const Togl * togl));
/* 8 */
EXTERN Tk_Window	Togl_TkWin _ANSI_ARGS_((const Togl * togl));
/* 9 */
EXTERN const char *	Togl_CommandName _ANSI_ARGS_((const Togl * togl));
/* 10 */
EXTERN unsigned long	Togl_AllocColor _ANSI_ARGS_((const Togl * togl, 
				float red, float green, float blue));
/* 11 */
EXTERN void		Togl_FreeColor _ANSI_ARGS_((const Togl * togl, 
				unsigned long index));
/* 12 */
EXTERN void		Togl_SetColor _ANSI_ARGS_((const Togl * togl, 
				unsigned long index, float red, float green, 
				float blue));
/* 13 */
EXTERN Tcl_Obj *	Togl_LoadBitmapFont _ANSI_ARGS_((const Togl * togl, 
				const char * fontname));
/* 14 */
EXTERN int		Togl_UnloadBitmapFont _ANSI_ARGS_((const Togl * togl, 
				Tcl_Obj * toglfont));
/* 15 */
EXTERN void		Togl_UseLayer _ANSI_ARGS_((Togl * togl, int layer));
/* 16 */
EXTERN void		Togl_ShowOverlay _ANSI_ARGS_((Togl * togl));
/* 17 */
EXTERN void		Togl_HideOverlay _ANSI_ARGS_((Togl * togl));
/* 18 */
EXTERN void		Togl_PostOverlayRedisplay _ANSI_ARGS_((Togl * togl));
/* 19 */
EXTERN int		Togl_ExistsOverlay _ANSI_ARGS_((const Togl * togl));
/* 20 */
EXTERN int		Togl_GetOverlayTransparentValue _ANSI_ARGS_((
				const Togl * togl));
/* 21 */
EXTERN int		Togl_IsMappedOverlay _ANSI_ARGS_((const Togl * togl));
/* 22 */
EXTERN unsigned long	Togl_AllocColorOverlay _ANSI_ARGS_((
				const Togl * togl, float red, float green, 
				float blue));
/* 23 */
EXTERN void		Togl_FreeColorOverlay _ANSI_ARGS_((const Togl * togl, 
				unsigned long index));
/* 24 */
EXTERN ClientData	Togl_GetClientData _ANSI_ARGS_((const Togl * togl));
/* 25 */
EXTERN void		Togl_SetClientData _ANSI_ARGS_((Togl * togl, 
				ClientData clientData));
/* 26 */
EXTERN void		Togl_DrawBuffer _ANSI_ARGS_((Togl * togl, 
				GLenum mode));
/* 27 */
EXTERN void		Togl_Clear _ANSI_ARGS_((const Togl * togl, 
				GLbitfield mask));
/* 28 */
EXTERN void		Togl_Frustum _ANSI_ARGS_((const Togl * togl, 
				GLdouble left, GLdouble right, 
				GLdouble bottom, GLdouble top, GLdouble near, 
				GLdouble far));
/* 29 */
EXTERN int		Togl_GetToglFromObj _ANSI_ARGS_((Tcl_Interp * interp, 
				Tcl_Obj * obj, Togl ** toglPtr));
/* 30 */
EXTERN int		Togl_TakePhoto _ANSI_ARGS_((Togl * togl, 
				Tk_PhotoHandle photo));
/* 31 */
EXTERN Togl_FuncPtr	Togl_GetProcAddr _ANSI_ARGS_((const char * funcname));
/* 32 */
EXTERN int		Togl_GetToglFromName _ANSI_ARGS_((
				Tcl_Interp * interp, const char * cmdName, 
				Togl ** toglPtr));
/* 33 */
EXTERN Bool		Togl_SwapInterval _ANSI_ARGS_((const Togl * togl, 
				int interval));
/* 34 */
EXTERN void		Togl_Ortho _ANSI_ARGS_((const Togl * togl, 
				GLdouble left, GLdouble right, 
				GLdouble bottom, GLdouble top, GLdouble near, 
				GLdouble far));
/* 35 */
EXTERN int		Togl_NumEyes _ANSI_ARGS_((const Togl * togl));
/* 36 */
EXTERN int		Togl_ContextTag _ANSI_ARGS_((const Togl * togl));
/* 37 */
EXTERN Bool		Togl_UpdatePending _ANSI_ARGS_((const Togl * togl));
/* 38 */
EXTERN int		Togl_WriteObj _ANSI_ARGS_((const Togl * togl, 
				const Tcl_Obj * toglfont, Tcl_Obj * obj));
/* 39 */
EXTERN int		Togl_WriteChars _ANSI_ARGS_((const Togl * togl, 
				const Tcl_Obj * toglfont, const char * str, 
				int len));

typedef struct ToglStubs {
    int magic;
    struct ToglStubHooks *hooks;

    int (*togl_Init) _ANSI_ARGS_((Tcl_Interp * interp)); /* 0 */
    void (*togl_MakeCurrent) _ANSI_ARGS_((const Togl * togl)); /* 1 */
    void (*togl_PostRedisplay) _ANSI_ARGS_((Togl * togl)); /* 2 */
    void (*togl_SwapBuffers) _ANSI_ARGS_((const Togl * togl)); /* 3 */
    const char * (*togl_Ident) _ANSI_ARGS_((const Togl * togl)); /* 4 */
    int (*togl_Width) _ANSI_ARGS_((const Togl * togl)); /* 5 */
    int (*togl_Height) _ANSI_ARGS_((const Togl * togl)); /* 6 */
    Tcl_Interp * (*togl_Interp) _ANSI_ARGS_((const Togl * togl)); /* 7 */
    Tk_Window (*togl_TkWin) _ANSI_ARGS_((const Togl * togl)); /* 8 */
    const char * (*togl_CommandName) _ANSI_ARGS_((const Togl * togl)); /* 9 */
    unsigned long (*togl_AllocColor) _ANSI_ARGS_((const Togl * togl, float red, float green, float blue)); /* 10 */
    void (*togl_FreeColor) _ANSI_ARGS_((const Togl * togl, unsigned long index)); /* 11 */
    void (*togl_SetColor) _ANSI_ARGS_((const Togl * togl, unsigned long index, float red, float green, float blue)); /* 12 */
    Tcl_Obj * (*togl_LoadBitmapFont) _ANSI_ARGS_((const Togl * togl, const char * fontname)); /* 13 */
    int (*togl_UnloadBitmapFont) _ANSI_ARGS_((const Togl * togl, Tcl_Obj * toglfont)); /* 14 */
    void (*togl_UseLayer) _ANSI_ARGS_((Togl * togl, int layer)); /* 15 */
    void (*togl_ShowOverlay) _ANSI_ARGS_((Togl * togl)); /* 16 */
    void (*togl_HideOverlay) _ANSI_ARGS_((Togl * togl)); /* 17 */
    void (*togl_PostOverlayRedisplay) _ANSI_ARGS_((Togl * togl)); /* 18 */
    int (*togl_ExistsOverlay) _ANSI_ARGS_((const Togl * togl)); /* 19 */
    int (*togl_GetOverlayTransparentValue) _ANSI_ARGS_((const Togl * togl)); /* 20 */
    int (*togl_IsMappedOverlay) _ANSI_ARGS_((const Togl * togl)); /* 21 */
    unsigned long (*togl_AllocColorOverlay) _ANSI_ARGS_((const Togl * togl, float red, float green, float blue)); /* 22 */
    void (*togl_FreeColorOverlay) _ANSI_ARGS_((const Togl * togl, unsigned long index)); /* 23 */
    ClientData (*togl_GetClientData) _ANSI_ARGS_((const Togl * togl)); /* 24 */
    void (*togl_SetClientData) _ANSI_ARGS_((Togl * togl, ClientData clientData)); /* 25 */
    void (*togl_DrawBuffer) _ANSI_ARGS_((Togl * togl, GLenum mode)); /* 26 */
    void (*togl_Clear) _ANSI_ARGS_((const Togl * togl, GLbitfield mask)); /* 27 */
    void (*togl_Frustum) _ANSI_ARGS_((const Togl * togl, GLdouble left, GLdouble right, GLdouble bottom, GLdouble top, GLdouble near, GLdouble far)); /* 28 */
    int (*togl_GetToglFromObj) _ANSI_ARGS_((Tcl_Interp * interp, Tcl_Obj * obj, Togl ** toglPtr)); /* 29 */
    int (*togl_TakePhoto) _ANSI_ARGS_((Togl * togl, Tk_PhotoHandle photo)); /* 30 */
    Togl_FuncPtr (*togl_GetProcAddr) _ANSI_ARGS_((const char * funcname)); /* 31 */
    int (*togl_GetToglFromName) _ANSI_ARGS_((Tcl_Interp * interp, const char * cmdName, Togl ** toglPtr)); /* 32 */
    Bool (*togl_SwapInterval) _ANSI_ARGS_((const Togl * togl, int interval)); /* 33 */
    void (*togl_Ortho) _ANSI_ARGS_((const Togl * togl, GLdouble left, GLdouble right, GLdouble bottom, GLdouble top, GLdouble near, GLdouble far)); /* 34 */
    int (*togl_NumEyes) _ANSI_ARGS_((const Togl * togl)); /* 35 */
    int (*togl_ContextTag) _ANSI_ARGS_((const Togl * togl)); /* 36 */
    Bool (*togl_UpdatePending) _ANSI_ARGS_((const Togl * togl)); /* 37 */
    int (*togl_WriteObj) _ANSI_ARGS_((const Togl * togl, const Tcl_Obj * toglfont, Tcl_Obj * obj)); /* 38 */
    int (*togl_WriteChars) _ANSI_ARGS_((const Togl * togl, const Tcl_Obj * toglfont, const char * str, int len)); /* 39 */
} ToglStubs;

#ifdef __cplusplus
extern "C" {
#endif
extern ToglStubs *toglStubsPtr;
#ifdef __cplusplus
}
#endif

#if defined(USE_TOGL_STUBS) && !defined(USE_TOGL_STUB_PROCS)

/*
 * Inline function declarations:
 */

#ifndef Togl_Init
#define Togl_Init \
	(toglStubsPtr->togl_Init) /* 0 */
#endif
#ifndef Togl_MakeCurrent
#define Togl_MakeCurrent \
	(toglStubsPtr->togl_MakeCurrent) /* 1 */
#endif
#ifndef Togl_PostRedisplay
#define Togl_PostRedisplay \
	(toglStubsPtr->togl_PostRedisplay) /* 2 */
#endif
#ifndef Togl_SwapBuffers
#define Togl_SwapBuffers \
	(toglStubsPtr->togl_SwapBuffers) /* 3 */
#endif
#ifndef Togl_Ident
#define Togl_Ident \
	(toglStubsPtr->togl_Ident) /* 4 */
#endif
#ifndef Togl_Width
#define Togl_Width \
	(toglStubsPtr->togl_Width) /* 5 */
#endif
#ifndef Togl_Height
#define Togl_Height \
	(toglStubsPtr->togl_Height) /* 6 */
#endif
#ifndef Togl_Interp
#define Togl_Interp \
	(toglStubsPtr->togl_Interp) /* 7 */
#endif
#ifndef Togl_TkWin
#define Togl_TkWin \
	(toglStubsPtr->togl_TkWin) /* 8 */
#endif
#ifndef Togl_CommandName
#define Togl_CommandName \
	(toglStubsPtr->togl_CommandName) /* 9 */
#endif
#ifndef Togl_AllocColor
#define Togl_AllocColor \
	(toglStubsPtr->togl_AllocColor) /* 10 */
#endif
#ifndef Togl_FreeColor
#define Togl_FreeColor \
	(toglStubsPtr->togl_FreeColor) /* 11 */
#endif
#ifndef Togl_SetColor
#define Togl_SetColor \
	(toglStubsPtr->togl_SetColor) /* 12 */
#endif
#ifndef Togl_LoadBitmapFont
#define Togl_LoadBitmapFont \
	(toglStubsPtr->togl_LoadBitmapFont) /* 13 */
#endif
#ifndef Togl_UnloadBitmapFont
#define Togl_UnloadBitmapFont \
	(toglStubsPtr->togl_UnloadBitmapFont) /* 14 */
#endif
#ifndef Togl_UseLayer
#define Togl_UseLayer \
	(toglStubsPtr->togl_UseLayer) /* 15 */
#endif
#ifndef Togl_ShowOverlay
#define Togl_ShowOverlay \
	(toglStubsPtr->togl_ShowOverlay) /* 16 */
#endif
#ifndef Togl_HideOverlay
#define Togl_HideOverlay \
	(toglStubsPtr->togl_HideOverlay) /* 17 */
#endif
#ifndef Togl_PostOverlayRedisplay
#define Togl_PostOverlayRedisplay \
	(toglStubsPtr->togl_PostOverlayRedisplay) /* 18 */
#endif
#ifndef Togl_ExistsOverlay
#define Togl_ExistsOverlay \
	(toglStubsPtr->togl_ExistsOverlay) /* 19 */
#endif
#ifndef Togl_GetOverlayTransparentValue
#define Togl_GetOverlayTransparentValue \
	(toglStubsPtr->togl_GetOverlayTransparentValue) /* 20 */
#endif
#ifndef Togl_IsMappedOverlay
#define Togl_IsMappedOverlay \
	(toglStubsPtr->togl_IsMappedOverlay) /* 21 */
#endif
#ifndef Togl_AllocColorOverlay
#define Togl_AllocColorOverlay \
	(toglStubsPtr->togl_AllocColorOverlay) /* 22 */
#endif
#ifndef Togl_FreeColorOverlay
#define Togl_FreeColorOverlay \
	(toglStubsPtr->togl_FreeColorOverlay) /* 23 */
#endif
#ifndef Togl_GetClientData
#define Togl_GetClientData \
	(toglStubsPtr->togl_GetClientData) /* 24 */
#endif
#ifndef Togl_SetClientData
#define Togl_SetClientData \
	(toglStubsPtr->togl_SetClientData) /* 25 */
#endif
#ifndef Togl_DrawBuffer
#define Togl_DrawBuffer \
	(toglStubsPtr->togl_DrawBuffer) /* 26 */
#endif
#ifndef Togl_Clear
#define Togl_Clear \
	(toglStubsPtr->togl_Clear) /* 27 */
#endif
#ifndef Togl_Frustum
#define Togl_Frustum \
	(toglStubsPtr->togl_Frustum) /* 28 */
#endif
#ifndef Togl_GetToglFromObj
#define Togl_GetToglFromObj \
	(toglStubsPtr->togl_GetToglFromObj) /* 29 */
#endif
#ifndef Togl_TakePhoto
#define Togl_TakePhoto \
	(toglStubsPtr->togl_TakePhoto) /* 30 */
#endif
#ifndef Togl_GetProcAddr
#define Togl_GetProcAddr \
	(toglStubsPtr->togl_GetProcAddr) /* 31 */
#endif
#ifndef Togl_GetToglFromName
#define Togl_GetToglFromName \
	(toglStubsPtr->togl_GetToglFromName) /* 32 */
#endif
#ifndef Togl_SwapInterval
#define Togl_SwapInterval \
	(toglStubsPtr->togl_SwapInterval) /* 33 */
#endif
#ifndef Togl_Ortho
#define Togl_Ortho \
	(toglStubsPtr->togl_Ortho) /* 34 */
#endif
#ifndef Togl_NumEyes
#define Togl_NumEyes \
	(toglStubsPtr->togl_NumEyes) /* 35 */
#endif
#ifndef Togl_ContextTag
#define Togl_ContextTag \
	(toglStubsPtr->togl_ContextTag) /* 36 */
#endif
#ifndef Togl_UpdatePending
#define Togl_UpdatePending \
	(toglStubsPtr->togl_UpdatePending) /* 37 */
#endif
#ifndef Togl_WriteObj
#define Togl_WriteObj \
	(toglStubsPtr->togl_WriteObj) /* 38 */
#endif
#ifndef Togl_WriteChars
#define Togl_WriteChars \
	(toglStubsPtr->togl_WriteChars) /* 39 */
#endif

#endif /* defined(USE_TOGL_STUBS) && !defined(USE_TOGL_STUB_PROCS) */

/* !END!: Do not edit above this line. */

#endif

blob
data 15312
/* $Id$ */

/* vi:set sw=4: */

/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2008  Greg Couch
 * See the LICENSE file for copyright details.
 */

/*
 * Togl Bitmap Font support
 *
 * If bitmap font support is requested, then this file is included into
 * togl.c.  Parts of this file are based on <http://wiki.tcl.tk/13881>,
 * "Creating and Using Tcl Handles in C Extensions".
 *
 * Neither the Tk public nor the internal interface give enough information
 * to reuse the font in OpenGL, so we copy the private structures here to
 * access what we need.
 *
 * Globals needed by the font module are in togl.c
 */

#include <tkFont.h>

#ifdef _WIN32
# define snprintf _snprintf
#endif

struct Togl_BitmapFontInfo {
    GLuint base;
    GLuint first;
    GLuint last;
    int contextTag;
    /* TODO: keep original font and/or encoding */
};
typedef struct Togl_BitmapFontInfo Togl_BitmapFontInfo;

#define BITMAP_FONT_INFO(obj) \
		((Togl_BitmapFontInfo *) (obj)->internalRep.otherValuePtr)
#define SET_BITMAP_FONT_INFO(obj) \
		(obj)->internalRep.otherValuePtr

static void Togl_FontFree(Tcl_Obj *obj);
static void Togl_FontDup(Tcl_Obj *src, Tcl_Obj *dup);
static void Togl_FontString(Tcl_Obj *obj);
static int Togl_FontSet(Tcl_Interp *interp, Tcl_Obj *obj);

static Tcl_ObjType Togl_BitmapFontType = {
	"Togl BitmapFont",	/* name */
	Togl_FontFree,		/* free internal rep */
	Togl_FontDup,		/* dup internal rep */
	Togl_FontString,	/* update string from internal rep */
	Togl_FontSet		/* set internal rep from string */
};

static int
Togl_FontSet(Tcl_Interp *interp, Tcl_Obj *obj)
{
	if (interp)
		Tcl_AppendResult(interp, "cannot (re)build object of type \"",
					Togl_BitmapFontType.name, "\"", NULL);
	return TCL_ERROR;
}

static void
Togl_FontFree(Tcl_Obj *obj)
{
    Togl_BitmapFontInfo *bfi = BITMAP_FONT_INFO(obj);
    ckfree((char *) bfi);
}

static void
Togl_FontString(Tcl_Obj *obj)
{
	/* assert(obj->bytes == NULL) */
	static char buf[256];
	register unsigned len;
	Togl_BitmapFontInfo *bfi = BITMAP_FONT_INFO(obj);
#ifndef TOGL_AGL
	snprintf(buf, sizeof buf, "{{%s} %d %d %d}", Togl_BitmapFontType.name,
			bfi->base, bfi->first, bfi->last);
#else
	/* unlike every other platform, on Aqua, GLint is long */
	snprintf(buf, sizeof buf, "{{%s} %ld %ld %ld}",
		Togl_BitmapFontType.name, bfi->base, bfi->first, bfi->last);
#endif
	len = strlen(buf);
	obj->bytes = (char *) ckalloc(len + 1);
	strcpy(obj->bytes, buf);
	obj->length = len;
}

static void Togl_FontDup(Tcl_Obj *src, Tcl_Obj *dup)
{
    /*
     * When duplicated, lose the font-ness and just be a string.
     * So don't copy the internal representation and don't set
     * dup->typePtr.
     */
}

#if defined(TOGL_X11)
/* From tkUnixFont.c */
/* 
 * The following structure encapsulates an individual screen font.  A font
 * object is made up of however many SubFonts are necessary to display a
 * stream of multilingual characters.
 */

typedef struct FontFamily FontFamily;

typedef struct SubFont
{
    char  **fontMap;            /* Pointer to font map from the FontFamily,
                                 * cached here to save a dereference. */
    XFontStruct *fontStructPtr; /* The specific screen font that will be used
                                 * when displaying/measuring chars belonging to 
                                 * the FontFamily. */
    FontFamily *familyPtr;      /* The FontFamily for this SubFont. */
} SubFont;

/* 
 * The following structure represents Unix's implementation of a font
 * object.
 */

#  define SUBFONT_SPACE		3
#  define BASE_CHARS		256

typedef struct UnixFont
{
    TkFont  font;               /* Stuff used by generic font package.  Must be 
                                 * first in structure. */
    SubFont staticSubFonts[SUBFONT_SPACE];
    /* Builtin space for a limited number of SubFonts. */
    int     numSubFonts;        /* Length of following array. */
    SubFont *subFontArray;      /* Array of SubFonts that have been loaded in
                                 * order to draw/measure all the characters
                                 * encountered by this font so far.  All fonts
                                 * start off with one SubFont initialized by
                                 * AllocFont() from the original set of font
                                 * attributes.  Usually points to
                                 * staticSubFonts, but may point to malloced
                                 * space if there are lots of SubFonts. */
    SubFont controlSubFont;     /* Font to use to display control-character
                                 * expansions. */

#  if 0
    Display *display;           /* Display that owns font. */
    int     pixelSize;          /* Original pixel size used when font was
                                 * constructed. */
    TkXLFDAttributes xa;        /* Additional attributes that specify the
                                 * preferred foundry and encoding to use when
                                 * constructing additional SubFonts. */
    int     widths[BASE_CHARS]; /* Widths of first 256 chars in the base font,
                                 * for handling common case. */
    int     underlinePos;       /* Offset from baseline to origin of underline
                                 * bar (used when drawing underlined font)
                                 * (pixels). */
    int     barHeight;          /* Height of underline or overstrike bar (used
                                 * when drawing underlined or strikeout font)
                                 * (pixels). */
#  endif
} UnixFont;

#elif defined(TOGL_WGL)
#  include <tkWinInt.h>
/* From tkWinFont.c */

typedef struct FontFamily FontFamily;

/* 
 * The following structure encapsulates an individual screen font.  A font
 * object is made up of however many SubFonts are necessary to display a
 * stream of multilingual characters.
 */

typedef struct SubFont
{
    char  **fontMap;            /* Pointer to font map from the FontFamily,
                                 * cached here to save a dereference. */
    HFONT   hFont;              /* The specific screen font that will be used
                                 * when displaying/measuring chars belonging to 
                                 * the FontFamily. */
    FontFamily *familyPtr;      /* The FontFamily for this SubFont. */
} SubFont;

/* 
 * The following structure represents Windows' implementation of a font
 * object.
 */

#  define SUBFONT_SPACE		3
#  define BASE_CHARS		128

typedef struct WinFont
{
    TkFont  font;               /* Stuff used by generic font package.  Must be 
                                 * first in structure. */
    SubFont staticSubFonts[SUBFONT_SPACE];
    /* Builtin space for a limited number of SubFonts. */
    int     numSubFonts;        /* Length of following array. */
    SubFont *subFontArray;      /* Array of SubFonts that have been loaded in
                                 * order to draw/measure all the characters
                                 * encountered by this font so far.  All fonts
                                 * start off with one SubFont initialized by
                                 * AllocFont() from the original set of font
                                 * attributes.  Usually points to
                                 * staticSubFonts, but may point to malloced
                                 * space if there are lots of SubFonts. */

    HWND    hwnd;               /* Toplevel window of application that owns
                                 * this font, used for getting HDC for
                                 * offscreen measurements. */
    int     pixelSize;          /* Original pixel size used when font was
                                 * constructed. */
    int     widths[BASE_CHARS]; /* Widths of first 128 chars in the base font,
                                 * for handling common case.  The base font is
                                 * always used to draw characters between
                                 * 0x0000 and 0x007f. */
} WinFont;

#elif defined(TOGL_AGL)

typedef struct FontFamily
{
    struct FontFamily *nextPtr; /* Next in list of all known font families. */
    int     refCount;           /* How many SubFonts are referring to this
                                 * FontFamily.  When the refCount drops to
                                 * zero, this FontFamily may be freed. */
    /* 
     * Key.
     */

    FMFontFamily faceNum;       /* Unique face number key for this FontFamily. */

    /* 
     * Derived properties.
     */

    Tcl_Encoding encoding;      /* Encoding for this font family. */
#  if 0
    int     isSymbolFont;       /* Non-zero if this is a symbol family. */
    int     isMultiByteFont;    /* Non-zero if this is a multi-byte family. */
    char    typeTable[256];     /* Table that identfies all lead bytes for a
                                 * multi-byte family, used when measuring
                                 * chars. If a byte is a lead byte, the value
                                 * at the corresponding position in the
                                 * typeTable is 1, otherwise 0.  If this is a
                                 * single-byte font, all entries are 0. */
    char   *fontMap[FONTMAP_PAGES];
    /* Two-level sparse table used to determine quickly if the specified
     * character exists. As characters are encountered, more pages in this
     * table are dynamically added.  The contents of each page is a bitmask
     * consisting of FONTMAP_BITSPERPAGE bits, representing whether this font
     * can be used to display the given character at the corresponding bit
     * position.  The high bits of the character are used to pick which page of 
     * the table is used. */
#  endif
} FontFamily;

/* 
 * The following structure encapsulates an individual screen font.  A font
 * object is made up of however many SubFonts are necessary to display a
 * stream of multilingual characters.
 */

typedef struct SubFont
{
    char  **fontMap;            /* Pointer to font map from the FontFamily,
                                 * cached here to save a dereference. */
    FontFamily *familyPtr;      /* The FontFamily for this SubFont. */
} SubFont;

/* 
 * The following structure represents Macintosh's implementation of a font
 * object.
 */

#  define SUBFONT_SPACE                3

typedef struct MacFont
{
    TkFont  font;               /* Stuff used by generic font package.  Must be 
                                 * first in structure. */
    SubFont staticSubFonts[SUBFONT_SPACE];
    /* Builtin space for a limited number of SubFonts. */
    int     numSubFonts;        /* Length of following array. */
    SubFont *subFontArray;      /* Array of SubFonts that have been loaded in
                                 * order to draw/measure all the characters
                                 * encountered by this font so far.  All fonts
                                 * start off with one SubFont initialized by
                                 * AllocFont() from the original set of font
                                 * attributes.  Usually points to
                                 * staticSubFonts, but may point to malloced
                                 * space if there are lots of SubFonts. */

    short   size;               /* Font size in pixels, constructed from font
                                 * attributes. */
    short   style;              /* Style bits, constructed from font
                                 * attributes. */
} MacFont;
#endif

/* 
 * Load the named bitmap font as a sequence of bitmaps in a display list.
 * fontname may be any font recognized by Tk_GetFont.
 */
Tcl_Obj *
Togl_LoadBitmapFont(const Togl *togl, const char *fontname)
{
    Tk_Font font;
    Togl_BitmapFontInfo *bfi;
    Tcl_Obj *obj;

#if defined(TOGL_X11)
    UnixFont *unixfont;
    XFontStruct *fontinfo;
#elif defined(TOGL_WGL)
    WinFont *winfont;
    HFONT   oldFont;
    TEXTMETRIC tm;
#elif defined(TOGL_AGL)
    MacFont *macfont;
#endif
    int     first, last, count;
    GLuint  fontbase;

    if (!fontname) {
        fontname = DEFAULT_FONTNAME;
    }

    font = Tk_GetFont(togl->Interp, togl->TkWin, fontname);
    if (!font) {
        return NULL;
    }
#if defined(TOGL_X11)
    unixfont = (UnixFont *) font;
    fontinfo = unixfont->subFontArray->fontStructPtr;
    first = fontinfo->min_char_or_byte2;
    last = fontinfo->max_char_or_byte2;
#elif defined(TOGL_WGL)
    winfont = (WinFont *) font;
    oldFont =
            (HFONT) SelectObject(togl->tglGLHdc, winfont->subFontArray->hFont);
    GetTextMetrics(togl->tglGLHdc, &tm);
    first = tm.tmFirstChar;
    last = tm.tmLastChar;
#elif defined(TOGL_AGL)
    macfont = (MacFont *) font;
    first = 10;                 /* don't know how to determine font range on
                                 * Mac... */
    last = 255;
#endif

    if (last > 255)
	last = 255;		/* no unicode support */

    count = last - first + 1;
    fontbase = glGenLists((GLuint) (last + 1));
    if (fontbase == 0) {
#ifdef TOGL_WGL
        SelectObject(togl->tglGLHdc, oldFont);
#endif
        Tk_FreeFont(font);
        return NULL;
    }
#if defined(TOGL_WGL)
    wglUseFontBitmaps(togl->tglGLHdc, first, count, fontbase + first);
    SelectObject(togl->tglGLHdc, oldFont);
#elif defined(TOGL_X11)
    glXUseXFont(fontinfo->fid, first, count, (int) fontbase + first);
#elif defined(TOGL_AGL)
    aglUseFont(togl->aglCtx,
            macfont->subFontArray->familyPtr->faceNum,
            macfont->style, macfont->size, first, count, fontbase + first);
#endif
    Tk_FreeFont(font);

    bfi = (Togl_BitmapFontInfo *) ckalloc(sizeof (Togl_BitmapFontInfo));
    bfi->base = fontbase;
    bfi->first = first;
    bfi->last = last;
    bfi->contextTag = togl->contextTag;

    obj = Tcl_NewObj();
    SET_BITMAP_FONT_INFO(obj) = bfi;
    obj->typePtr = &Togl_BitmapFontType;

    return obj;
}

/* 
 * Release the display lists which were generated by Togl_LoadBitmapFont().
 */
int
Togl_UnloadBitmapFont(const Togl *togl, Tcl_Obj *toglfont)
{
    Togl_BitmapFontInfo *bfi;
    if (toglfont == NULL || toglfont->typePtr != &Togl_BitmapFontType) {
	Tcl_Interp *interp = Togl_Interp(togl);
	Tcl_AppendResult(interp, "font not found", NULL);
	return TCL_ERROR;
    }
    bfi = BITMAP_FONT_INFO(toglfont);
    glDeleteLists(bfi->base, bfi->last + 1);	/* match glGenLists */
    return TCL_OK;
}

int
Togl_WriteObj(const Togl *togl, const Tcl_Obj *toglfont, Tcl_Obj *obj)
{
    const char *str;
    int len;

    str = Tcl_GetStringFromObj(obj, &len);
    return Togl_WriteChars(togl, toglfont, str, len);
}

int
Togl_WriteChars(const Togl *togl, const Tcl_Obj *toglfont, const char *str, int len)
{
    /* TODO: assume utf8 encoding and convert to font encoding */
    Togl_BitmapFontInfo *bfi;
    if (toglfont == NULL || toglfont->typePtr != &Togl_BitmapFontType)
	return -1;
    bfi = BITMAP_FONT_INFO(toglfont);
    if (Togl_ContextTag(togl) != bfi->contextTag)
	return -1;
    if (len == 0)
	len = strlen(str);
    glListBase(bfi->base);
    glCallLists(len, GL_UNSIGNED_BYTE, str);
    return len;
}

blob
data 1587
/* $Id */

/* vi:set sw=4: */

/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2006  Greg Couch
 * See the LICENSE file for copyright details.
 */

#include "togl.h"

#if defined(TOGL_OSMESA) || defined(TOGL_WGL)
/* nothing extra to include */
#elif defined(__APPLE__)
#  include <mach-o/dyld.h>
#else
#  if !defined(TOGL_X11) || !defined(GLX_VERSION_1_4)
#    include <dlfcn.h>
#  endif
#endif

Togl_FuncPtr
Togl_GetProcAddr(const char *funcname)
{
#if defined(TOGL_OSMESA)
    return (Togl_FuncPtr) OSMesaGetProcAddress(funcname);
#elif defined(TOGL_WGL)
    return (Togl_FuncPtr) wglGetProcAddress(funcname);
#elif defined(__APPLE__)
    char    buf[256];
    NSSymbol nssym = NULL;

    sprintf(buf, "_%.*s", (int) sizeof buf - 1, funcname);
    if (NSIsSymbolNameDefined(buf))
        nssym = NSLookupAndBindSymbol(buf);
    if (nssym)
        return (Togl_FuncPtr) NSAddressOfSymbol(nssym);
    return NULL;
#else
#  if defined(TOGL_X11) && defined(GLX_VERSION_1_4)
    /* Strictly speaking, we can only call glXGetProcAddress if glXQueryVersion 
     * says we're using version 1.4 or later. */
    return (Togl_FuncPtr) glXGetProcAddress(funcname);
#  else
    /* Linux, IRIX, OSF/1, ? */
    static void *dlHandle = NULL;

    if (dlHandle == NULL)
        dlHandle = dlopen(NULL, RTLD_LAZY);
    /* Strictly speaking, the following cast of a data pointer to a function
     * pointer is not legal in ISO C, but we don't have any choice. */
    return (Togl_FuncPtr) dlsym(dlHandle, funcname);
#  endif
#endif
}

blob
data 1570
/* 
 * Togl - a Tk OpenGL widget
 *
 * Copyright (C) 1996-2002  Brian Paul and Ben Bederson
 * Copyright (C) 2005-2008  Greg Couch
 * See the LICENSE file for copyright details.
 */

#include "togl.h"

/* !BEGIN!: Do not edit below this line. */

ToglStubs toglStubs = {
    TCL_STUB_MAGIC,
    NULL,
    Togl_Init, /* 0 */
    Togl_MakeCurrent, /* 1 */
    Togl_PostRedisplay, /* 2 */
    Togl_SwapBuffers, /* 3 */
    Togl_Ident, /* 4 */
    Togl_Width, /* 5 */
    Togl_Height, /* 6 */
    Togl_Interp, /* 7 */
    Togl_TkWin, /* 8 */
    Togl_CommandName, /* 9 */
    Togl_AllocColor, /* 10 */
    Togl_FreeColor, /* 11 */
    Togl_SetColor, /* 12 */
    Togl_LoadBitmapFont, /* 13 */
    Togl_UnloadBitmapFont, /* 14 */
    Togl_UseLayer, /* 15 */
    Togl_ShowOverlay, /* 16 */
    Togl_HideOverlay, /* 17 */
    Togl_PostOverlayRedisplay, /* 18 */
    Togl_ExistsOverlay, /* 19 */
    Togl_GetOverlayTransparentValue, /* 20 */
    Togl_IsMappedOverlay, /* 21 */
    Togl_AllocColorOverlay, /* 22 */
    Togl_FreeColorOverlay, /* 23 */
    Togl_GetClientData, /* 24 */
    Togl_SetClientData, /* 25 */
    Togl_DrawBuffer, /* 26 */
    Togl_Clear, /* 27 */
    Togl_Frustum, /* 28 */
    Togl_GetToglFromObj, /* 29 */
    Togl_TakePhoto, /* 30 */
    Togl_GetProcAddr, /* 31 */
    Togl_GetToglFromName, /* 32 */
    Togl_SwapInterval, /* 33 */
    Togl_Ortho, /* 34 */
    Togl_NumEyes, /* 35 */
    Togl_ContextTag, /* 36 */
    Togl_UpdatePending, /* 37 */
    Togl_WriteObj, /* 38 */
    Togl_WriteChars, /* 39 */
};

/* !END!: Do not edit above this line. */

blob
data 1309
#ifndef   USE_TCL_STUBS
#  define USE_TCL_STUBS
#endif
#undef USE_TCL_STUB_PROCS
#ifndef   USE_TK_STUBS
#  define USE_TK_STUBS
#endif
#undef USE_TK_STUB_PROCS

#include "togl.h"

ToglStubs *toglStubsPtr;

/* 
 ** Ensure that Togl_InitStubs is built as an exported symbol.  The other stub
 ** functions should be built as non-exported symbols.
 */
#undef TCL_STORAGE_CLASS
#define TCL_STORAGE_CLASS DLLEXPORT

/* 
 * Togl_InitStubs --
 *
 *    Checks that the correct version of Togl is loaded and that it
 *    supports stubs.  It then initialises the stub table pointers.
 *
 * Results:
 *     The actual version of Togl that satisfies the request, or
 *     NULL to indicate that an error occurred.
 *
 * Side effects:
 *     sets the stub table pointer.
 *
 */

#ifdef Togl_InitStubs
#  undef Togl_InitStubs
#endif

const char *
Togl_InitStubs(Tcl_Interp *interp, const char *version, int exact)
{
    const char *actualVersion;

    actualVersion = Tcl_PkgRequireEx(interp, "Togl", version, exact,
            (ClientData *) &toglStubsPtr);
    if (!actualVersion) {
        return NULL;
    }

    if (!toglStubsPtr) {
        Tcl_SetResult(interp,
                "This implementation of Togl does not support stubs",
                TCL_STATIC);
        return NULL;
    }

    return actualVersion;
}

blob
data 130
#ifndef TOGL_WS_H
# define TOGL_WS_H

/* define windowing system togl is compiled with */
# define @TOGL_WINDOWINGSYSTEM@

#endif

blob
data 2335
/* 
 * getToglFromWidget:
 *
 * Given a Python widget, get the corresponding Togl pointer.  <Python.h>
 * and <togl.h> should be included before this.  If included into a C file,
 * there should be a static keyword just before the include.
 * 
 * There should be one copy of getToglFromWidget per-shared libary so that
 * the library's Tcl/Tk/Togl stub pointers are properly initialized.
 *
 * Copyright (C) 2006  Greg Couch
 * See the LICENSE file for copyright details.
 */

Togl   *
getToglFromWidget(PyObject *widget)
{
    PyObject *cmdNameObj, *tk, *interpAddr;
    const char *cmdName;
    Tcl_Interp *interp;
    Togl   *curTogl;

#ifdef USE_TOGL_STUBS
    static int didOnce = 0;
#endif

    /* Python: cmdName = widget._w */
    /* Python: interpAddr = widget.tk.interpaddr() */
    cmdNameObj = PyObject_GetAttrString(widget, "_w");
    tk = PyObject_GetAttrString(widget, "tk");
    if (cmdNameObj == NULL || !PyString_Check(cmdNameObj) || tk == NULL) {
        Py_XDECREF(cmdNameObj);
        Py_XDECREF(tk);
#ifdef __cplusplus
        throw   std::invalid_argument("not a Tk widget");
#else
        return NULL;
#endif
    }

    interpAddr = PyEval_CallMethod(tk, "interpaddr", "()");
    if (interpAddr == NULL || !PyInt_Check(interpAddr)) {
        Py_DECREF(cmdNameObj);
        Py_DECREF(tk);
        Py_XDECREF(interpAddr);
#ifdef __cplusplus
        throw   std::invalid_argument("not a Tk widget");
#else
        return NULL;
#endif
    }

    cmdName = PyString_AsString(cmdNameObj);
    interp = (Tcl_Interp *) PyInt_AsLong(interpAddr);

#ifdef USE_TOGL_STUBS
    if (!didOnce) {
        /* make sure stubs are initialized before calling a Togl function. */
        if (Tcl_InitStubs(interp, TCL_VERSION, 0) == NULL
                || Tk_InitStubs(interp, TK_VERSION, 0) == NULL
                || Togl_InitStubs(interp, TOGL_VERSION, 0) == NULL)
#  ifdef __cplusplus
            throw   std::runtime_error("unable to initialize Togl");
#  else
            return NULL;
#  endif
        didOnce = 1;
    }
#endif

    if (Togl_GetToglFromName(interp, cmdName, &curTogl) != TCL_OK)
        curTogl = NULL;
    Py_DECREF(cmdNameObj);
    Py_DECREF(tk);
    Py_DECREF(interpAddr);
#ifdef __cplusplus
    if (curTogl == NULL)
        throw   std::invalid_argument("not a Togl widget");
#endif
    return curTogl;
}

blob
mark :50
data 66048
⁄   Ä Ä        ˇ    no name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         @@@?0?;?000@   0                                                                                                                @1@116@@000@   0                                                                                                                @,)55@?,000   0                                                                                                                  @0::@60000  0                                                                                                                  *@566@45)0000                                                                                                                   )@1540@4@00                                                                                                                     4@)114@1@00                                                                                                                     4F@1145)000@                                                                                                                    0@0*104)000                                                                                                                     ,@0,45@)000                                                                                                                   @0156@:@00                                                                                                                   @@0*4>@;@0@                                                                             ((                               64,51:@6>,>(                                                                     ((($                                6,*>54@1,16:5                           $JJ                                         (6C(@E50(((*                         @@1,54)$*441,,      $$ $           T@?*>                                      fa>151:4*(((((((              (;))$(*)$1E41,,N@(  (6?C)(((   L\lF;,*5                              65WF>4;4*(450(((((0E$4*5N    		  ,?((((*(056()0,()0,0$W NJ,1*FcPFI;IZoV>@ 44C50((,?                           L,1N@00:440>F>*((((>5,)( *5>Jp0**5?$1$(@(((,:6($,4(140)*,**)6O4* ((5;6456TP``:1F??400((((*6 (N\                      $YVpQ;1:>;:*00450500(((0NPF*((*0550())1045) (0((()*(()*)(,,)***5*))*(  (((0>0(*:5J:0444>:0((()),4$(E@?    ]C        ;;;;;6NQPFZN551466J0((055*0>4( *>:@()*,,**(     **   (5:1($($(*)  *)***1*$)*   ( ((0**(((*:*00*:5((((**5 FC66((IP51(      ;;;;54âoJF:4:5;:5T:***44*(:0(  (*( )),*$$       ( (:0           ( *(         ((((*(((0:(4:((((((()),FI0C66;$L;TY;6I5;     ;;;;44;o{Y444:5@:054*(((**(**((( (    (             0(    ((    (((((   (  ((((((*(((** *0((((((((()**4>4:,5a?5:bTEC10?L   ;;;;::ßÉr`>@>:00>0(**((((((((( (   (                  (4*(((       ((  ((((     ((((((*(())(*((*)*,*0*:@4445>Lz   ;;;;;5bwY>@55*(**((((((           (                (((550*(      (    ((((    (  ((*(((((((((((****0**4*04>@YmJ  ;;;;5Q]î|J:40:40(((((((((((( *(    (              (             ((4E0(((  (( (((( ((((    (((((**(((((((((((**(4*400555JN>0  ;;;;5Yr∞f>50*0*(((((((( (((((>:(             (    *(                *:0((  ((((*0*((*((      (((((((((( ((((((*(05(000554:@4*  ;;;;;5qúcE:4*((((((((((  ((( 05(             (                    *((000((( *4*(((((     (((((((((((((((***((44*5445>55540;;;;;@?cìêmTEJ:(    (((((  ((((*:0           ((((  ((     ( (* (    (0>>0(( (0(((  (      (((*((((*(((00540(*40*444:F:5440;;;;;ENc†|kT>@5(  (     ((((( **J4           (((            *4(       (040     ((   (   (  ((((   *0(((:@0((**00004:@YE444;;;;;?IT|qZfV>40(          (( (((EJ*        (             (  ** (*4*( (*(             (*( ((((   (( ((50((*0:5**0:NNoJ445;;;;;?FNJ`TT@:50((            (((5b*      (                >E>0*0J:(  ((             (*(   ((      (0@*(*04PT504:E:>>55;;;;;;;;Y`ÖP60440**(    (((((*   *0r5                       (Vc\F@EJ5* (*((            0(((((((( (  (0E\:055@@YE:V\E@:5455;;;;;;;;OZo;;;C4**(    ((*((4  4\::0                ((   *NfbYNVE00((**0(*(         ((((((((     (0>550>55*4@\mm`@514:54;;;::65WF`PC>C0((( ((( (((((  0\V>0   (0*            40 *JT>5@*4>4*((*04*(           ((((       (((*00**(((*FJN>EE>;;>EFE;;;6l1I\rE:;@0(*( (((  (*0(  (>F4*   4F*   (          :FF50**545*  (*50(  (    *(  (*((        (****(((*5@F504:J@WTVVT:;?;m{rrùV>I@F5*@*(  ((  (45   (40( (5PF4          (    0@0(** *5@* ((054(       :@*( *4(        ((*(( (((5NE505:E:;LFF>5;Ec~†mYELwbY5*@J0( (5(((0J*4*0*(((EEmpT       0  ((   (*   ((:TP0((044(( (   ( 5J(   0(   ( ((((*(((((((0>>005:::66;YF;;Y±ÖüÉcmkf`bY:4@P@0( *( (0VFY@54((0EY{Y4     0J  ((4(     (0JJ0**(*        *  (       (  ((((0*((04**((0>*0>P:>5;lyE;;vbpérqbm`@:450***((((    EbmJ4(*EoY|:(      ((  (0(   4:   (>E44(((                (    (((*(((5\5*))),*4EP@55Nreb;;v|Q\cZI@T:00*0  05(((    (@rY::\ÉJE:(               *(((  *4 ( 4@>5*(    (                  (((**(*4@45,))0E]T>I45LqÇ@;;:PWmfÜbLcJ40*0*(>Y0( (    (>TfbbY>*((          0(     ((((     (*(     (((          (    ((4*0*05>((*))*4`bZ@EFQYè{:6;≥Z\~ÖßflÉc>(((*(0FE*(**(   *>mTE* ( (         >J(    ((0             *0(         ((    (***045>4?;((*40@>C6JYZbJ@55;n6©|wbJTmVE((((0:05**(0(  (((***(   ((((   (   FT(  (*5(            *4(**(       (((((*04:FF5(,@?*0@`@554NfkZWC45565pì~?5?apP@50  (:(((  4*(((54((   ((((((  (( 4EV* (((*( (            ((*5TP0    (  ((((*0:@>P0(((,,(4;@514:n`xó\|J66614ye>>PcP\@50( (*(    *5@4*J@   ( *4( ((      EV@ (0   4*  (:0((     ((*>TF*      ((   *@TTF>*((((**F??0*5:IVf\röN:::öúvY>PN@5:40((((((    (4@T*N>  (0*((   (    ((@YN     ((     5N:0(  (  (( (4(       (*  (0>N\T>(((((*5{F>0,1@PI]P{Z445:@¢©I1JE:4045(*E@0( (  ( 4J(FE   (        ((5J5(      (*  ((  *>F5*  ((((  ( (        ( (0>@4JT>0*((**EW464,1;IV]Q@FV55;:N™Z154040EN4*P\>(4b: ((05(*5(             (:\5 ((((( 04 (( ((     (0@E( ((  (((( ((      ((((0::(4:*50((*,,5050:?:OhF@:ozJ6;:Zû†∞F504FV`00EJ4(*cV(*0@N*0N0             0F4    4:E4:@((  >@(    (:@@(     ((*(     (((((((**(**00*4***4?4;1*,;EI{E:::;CäZ6@é†àYC;44;@F04VN*((NV054:4((V:(    ((   *     (*(    PfN**0(  *04*(    *@0      ( (  (    ((*0*(**((4**05001>J;C?400IO~E>LZ:cùZ5ÑåΩZnJ50*04E5>T50*(mmF:E(    ( ( ((    (@0    55(    5bN( (((05((*((   (4(     (((      ((*0*(((((***4@106CTN;@>>1>NF;YZVCIÑ©6h\qÖaO5EV>@4:F44**JbWN:(      :5 ((   (>0( (0VP0(   44(*(((@N4(*****((**      ((05(      (*(((*(40((:4*0015;QN::?4C:NEO]wq@Lz|6îa\aphO0\\FV:0@\E45:cc{>*(    (:5((( (( *50(*4\Y4   >:( (( Pb@00(*00500*((   (((04        (((((*::0(***),4>:::OOJ5\F\qVFÜlVZàk;IêqQITf(Jc@`E04oP**4PYE4(((((  4:(((   ((*04@4VN@((  :E*0   4>:*0*0500*004(    *0*(    (  ((((((*0:0*4(*),1:;:ECOP:?CEVoT?OL\JqILçéLIEP05|pfFEJkP*::\T>40(((   (>*(:0( (((*4@:TFP*:V(*0 0((**05404*E>5*55J5(  ((*00   (4((((((***(0*4J5((0416056CF::>]mECOFZCJ≠?Eêp?]p60(PÖèk`@5>4:Vk`@:5***((*(( (JF4(((((*0:JEE*Ew4    (5EN@4FE5>cmT5:\pPF*  *4**(((4E>*(((0*44(4:E\>0*5F00>50>:55;TÇV;JNQå™:6?L§`rÉ@>(0{mOT0**4N`\c\m\EN**V>((  *40*(((0((*>J4(@*(4  *(>fkJ5445PwyVEFyêbF5*((00*>>>JF5*(*5:55:(0:V\:**0:>444::>>?>;booOJlî;::åwúTTbT@((wéb:555NTb{óàìà\F*0@>*((  (***(**4(5c5**4 (4*(0(4YkYJ:>F@fpfTcp`bJ>50*(0*ETYN4****>N\F5(*:N@0555JPE44>FE>JVO@]|lEPJó6:åCNeVPrC0(4l~V@TJN\Ykó∞¥≠{FN>:5** 40E(((04*4(:rN*04 (5:54 4féÖykVPTk{yocVPbTF4:504F`54@E:4*0:YcV4(*4::0@F@fcT>40>:?EJPJE;IOEOrkà;:11YPC:1*4aâíkY{TY00`wô|Émw\4   (VN*(((*0*((0Vm0(*:F004* 5o||wwpkYbàâkF4\ÖpV55:JT`N(*NJ@40*0Nof@54EJE4>F4Ybk`405@bTEFJ>6PZTWO|Ö:;:4?lP;0)*0FîrWpbP0(04YNPTJ4(**  \`  ((((*((*:F* VkJ4(@( (>@V\kopTNN`@0VÖrF5:PmP****4@55>>JVb\N0F\`>NN:JPY\;:@VàTEFE>@PVqqalò6;:510ÜJ0000:ìy\ôpJ:(((((0@:P(04  **  (((((**((0*(45>5(>0    (*ETobVJJ@>05P{yJNY\bJ040>>5@EPVPJ@@4(4Tf@JYJVVbL;F@>O:;@:FFLJàÑVÖ|6;:p11≤ea@>0VmzZcJCF4:*0(((0V0((     ((((((0*(  (4EJN@:0*(   (0>`rmF:545VkN\{cJ>44>E:0::4@E:000*(>YNP\@PT`C5>JE@;5::JVPaúYL{F:;{æn4:ê£ÖV@YFN;,*4>:@40((( 005(     (*(*(((0*  *Tùì{T@:0(      :PTmfJ@4>VÉrcyTJ4(*TJF400*4>N@>:4*4YTT:>`VkPEOcf\ZE::YVTZlk`É∆6ü†ìw™££wî\>;610)*5>`J@4(*0  (0     ((4*0***:0   4pyo`P4((*     (*>b{YT>>f¶âkV>E0*:\VV55:>>>P>5NJ5(54>5PNF`TJcmcNTTE>JNTQN]nk†4Çà{\o®ÖQ;4*)*(((050>V:04*0  F0(0@((((*(0N>00(   (:yb:50*(*   ((    (0kkJ>N™ù\::::@J@F>4:@NFFV>4FJ5((5E5VYPP\bc\JT\mkF>JTrhevhl1k~Ñw]`TF@4****)**F4:NF(*(( (kF04T0*((**4wT0     :PwT4:45:(   ((  ((0*fÖNFbPâêNPPEJV@4@J>FPF5:P@>N@4((5F>TbPE\aN>EJ\fFCOPwnäèzF66{Ö@YJTEâE55F44::@>F4P4** (*04* J@0(***4J5(    (45*:F>5YY0   (   0N5ÖFT``NP`pcVVP04F`TPN40*4>@NF:4504:E>@E:CFJCJEN@@CIn]`Çßc6:Ö\NFNTOO`\PFNJYJJ0:05fT(*(0@*   *:0(**((4:5@**((*(**05JYw>     4YfJJ\NcfbJNTTE@>4(0@cpVV@>0:PFJb`P@05ETJ\V:J`TVc@::>@Vw1P4≥|W:cIJ{P;Coêùko`EE:P4((FY:(( EJ( ((*(((*((*4f@0((*(   0>54(       >N`YJVE>VTPcV0:0*545Nwéy\NYPkwcmé£ì`@5bo`kP>TcccfP>FFQ4x4pmk]NoqC6>OYCåz£rE>P>6FTJ(JmE(((4cP5(E:00*(**(*5b{oJN:*((  (0:0 (      0*PTN`P@`fF4*>T>5PE>JPkyJ>PoâúùàìùùpEYcokPJrcro|r\oYYqoaWªû†4hOV54]cZ]WC1EpàoP>V`5>fF**0:cT0(YV:5*(**0FcPmà`ok0    ((*( ((((  (Tomc\fN4N\4(@ÉwJ>NNJN>Pm\J\ybTâ£bPúb@FVcÖr\cVVfÖ|rqlTkpOV“I56>6@::?QóLCC1:PÉwWYPP>5NJ500>\Y* >T@54*(05\mN>f{N:@((*(((5(  **((((JcJbyrE((4*4fûêfcfcP5@bkowÖE>>:00FJJN@VmwpkYVrmlczàêçåôèù:656>L|Z?m\z®âV>EFTaÉÖc54>4:4*0>EE* *:>44*(*JTÖ:(:{kFF(0T0( *(  ((((( *0(TPV:**5*4crrkfkNETprrùÖm::>:40ETYbNcÉàcYTOÉ{n\ràïªô≥?6;:66>lòß~Öff{óNPFCLçàÖ`Y5@:044040**(:>:(((*04:E*(:myY0(050((((((((((( *005>* (E40EPJ\ob\JNVcwykâc@@@:>4@>Nk\Vbro\bPrxxfoÉooohV5:::;1CYóÖz44óNYc\TQ®```o:@J:*E40*** :V5((((4N:(((4@T>4*40****( (*((*(((0PY\* (@*5\>JbÉ`cppormpyk|E0J:5@JENbpYTmll|rmoålnwllùâa`::;;NT\{::î6OlÉobY`YTïâ\P£Y:bV:>J>(*TE0((*5f@((((0F@44>50**0((4F*5E400>Yb>    (*F\``mF@kpwJNV`Tm@:YFEFFJYpw\Pc|{xqbåyïrìy~mâ®xP6;;éäoÜ:†à{`ìì£|rY`Y{Y∂ê£ÉTFfP>Tc:0T>*(05Em>5*(*4F:5TF:4(>4*5*>*:N544Pày0    0*(5>0@@0>:N>:J?I:>LICC\NNV|àmT]lâÑkbefkoyÉoahß†ÉœV;;;::;;Ñ~bó@lYeYerr®£££fNyÖcTY:5bN:J0**:JPY44*((*0(:T**0*fN*0(444E540Jb@  (   (*:0(NP@5((0;I??6NT?4>Q\PTko\VfLO~bYeTe]äwaY]`†àà;;;66;5bVWrn\]ONcww£FmFT>5NypàP>co|P0*>oNF:50((*((*40(0::4*4(4J5Y>05:(  (   (**>0*0500**4Fb]L?cP>:CNZcYfcVPP::ZZEJ`úôì£f¢\Lúbà;;;;65:55656Tf]ocï?:5£J:Fcr`w|{JF:FÖÉr4(*>5*000(*:*(*54*>N*0*4* 5*EV5@c00*4(  (055***005446\`cNPÇmLCQkbhv\ZVbYCCWqTQWp£∂££∞wC£N;;;;;:6:;;ùÖNlJlkâQLFr£F\rc~óåyFEF0P\E4*(4N0****N`:(*0:>PfE0((((**Jc>5>*F>5*((*>5:0*404E5>VcFP`Vh{VFYeWeyWYVÉÉppaZoxy`\lzY~f\e\;;;;;;;;;;Ö~fZßT£feY\mêúzN]w\P\NJT>Vk:540@ÖJFP@@kT500450>`k4>:*5>5Epf>*@TF*(((0:5:0440**@ye?N\YxÖZJ\QWekhe]cZOqc{àù§O?ELéÇL\wq;;;;;;;;;;::15OnxqO\rqqw]Qbvpmop\VVcr>>@45kPN|V\:44@5( *5E44>5@555w{E:YoJ0>(*:PF:*040**@àmO]{Vb|peV]OWh`lmJV\whalö©â?Wnao~Nqøh;;;;;;;;;;::Q5LC\zF]àrWI;>J>VååàâTTT\k@:J@:@:5ôV0*4@F4*(*F4*0EEPJE0Jk45pÖN*4:ENfwr40544005@Nàúw~rbpnhV`hcYTVZ?CLEJp|e>>4låoVZO5;;;;;;;;;;4IFQ\hÑxQWlóOOC50?{xàÖc`I>cJ>JV{rTEo4:@TE4:05*F545kYbff0*0(*FcJ**4>@@V>04440?EETT£≠ÜùâfknaNOpzZPZ>OLEOkzlFIlfqè?555;;;;;;;;;;5kmyìnßm?6WLF:5;CWyyry|`>46;>@bmÖYYm`4>PTV:4*4*(*5*PTPP>(*(((*******00>*0000*;Pùówîâmy`zzYV|PVyOZìZäÜìmfynO{x55;;;;;;;;;;;;∞êêk5nY>6;??FC:QkxkxoNJOC?LCOPTrk\cobF4T\\@E:@5**((0**(((0((054455*04550044445TúìrYénZÇhÇú®rrìå`f]\\OràfffVfWY\::;;;;;;;;;;;;;;;;;;àc::CeIr`O\lQZxpFJENJpbk\mycNTN>N@5JofPNE@E0*00(((((*5>50:E>44*55E54Pk@:4@YmVNrìo|òvvü±âÉù`ïúvnVÖq|QTaßvN;;;;;;;;;;;;;;;;;;;::àøTû@vfWZcpêTxponrNYJFYwrôpJrVNyE:mrP:>:>54b`(((((*YY::4FPE5:04>45\fN>5bVVO?@Pûº®ú†~çµ¢ûò¶úîrk`TpâTEO;?O:;;;;;;;;;;;;;;;;;;;:56~lpYTI>Wna®åúçàéâ|bJFJFVoNFcoJc{{VE`â`>F:*05Y@((((0:J:>TE5JE0:>@>**F@JVJbVJJ?TNêíèïêÇoììçkoôò®ïï\IJY>N?5J;;;;;;;;;;;;;;;;;;;;51YWpw\EPrr`Fc{≤éYrâpOTJETcyNTPNboNY`FJF5>Yb>(*T4 *(0PN>0>TF5>:(4\V>054:JbPw|ECC?m|~z{Ç¢öÉllk]vô~èbP\LmLO|`a;;;;;;;;;;;;;;;;;;;;5\JJamè``wJ>CIJ`OEac`J`JIZfY`rkoÖyYmk:40>F\E((@0 *4*>E5:FE5E44**VJEP5@NE5ê{YYLY~parYEOÇåbWíî]zïbèÉå\xoÜüòb;;;;;;;;;;;;;;;;;;;;;àïNok|ßà>5Pl`ENQTeoQYTY\Tc{poå≤oìÖJE55::045J*((**0>05>5>@*44*To@:`5FPE55`mâßçlQJO@?>l|~WªÑNEJp£InínbbZZ;;;;;;;;;;;;;;;;;;;;;;îWü∫rFfywÖw±rcCFNPcbbW{pTEZyêåÖ®®kpwé]V5E4@5>J`4**(44F455*045045JkV545TP``p5vnó®ôlCIEWICJPoYnQfxbÃN]ÑÇôf::;;;;;;;;;;;;;;;;;;;;;;îWa¢mPTYEaLJJ\J@FJTbn]rYN?bcÉw|óêoåoC@O5Y>E5*5PTP@**:F5:5000>554\bf54@Vc::5511ù≥îå\Qfìf@5FÇeFPêú§]Lrlün6:;;;;;;;;;;;;;;;;;;;;;;;;;5vpìnfPIIN\hL>E\|ÖYornP@b`r{îöZJcv@?T:>FF5((0ENF540400**4:E5:4FP`>5@Pr]oTYYY{nÜÉûCEpO\I>E?wvP]{äÇc@J;66;;;;;;;;;;;;;;;;;;;;;;;;;54{lÉFIh]poV?@?cÖhbfkÑOYpcé{êxL54TVPq@J:J5**((0:4*4:0((05F\54>ETV:>@Jp{Tlrô`5`|è¥CäzfJpC?;;55;lóäCW;44;;;;;;;;;;;;;;;;;;;;;;;;;;;qlÖEV{nx{I`cP`q\hOETCVeìêJF4;:N]ÉaPPNVV5ET0*4:04>:0*5@@NF@>NTJE>N\ToåkbqbbT4{röà;JJ5\ÑQF;;;;;:6≥Wù;66;;;;;;;;;;;;;;;;;;;;;;;;;;;ìì∞ïìlà∫îcwhZZpoék\YNbà\@;>CLTkoZ>OFeE*:`>*54:Yc@04@J>NYJJVobYJmàkaZZhcWO]O4YY``FF;ì~NF;;;;;;66≥|6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ì∞¶í±có|ofYQbk|vràf;?`YYkaq{YÜO:6;:NI:@Nf@44:FP@5@@N`wEPNYpP@QymaL?WcFPèYY{{`;`;;ì|@;;;;;;;:::à6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;∞îc¿≠\à†ùÉPVVTZlhê≤CCF\êyNÖqkaçr\?C;PPmm5F`>44>@@:@FcråcPbLLvI>QcezN;z~r`{`{{âY;;;;ì¢5;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;êr5|ﬁxßààyLb|qy~~Ç{IÇq\`haà~~llµ@ErnwPc\TEJF5:FPfF>@Nbå{kmNPlPW]YT]mIl¶¢äà`º`úF;;;Fìn6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6|cÉ‘ùrcYà™ówb6C{EPPÖYVLôYWWßéPOÖ`F>:N\T::5:`bkNEPffÖêywTLo\\híT|OPl™≥mrqûY]`;;;;F\làEC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:56;yÀº∂óaT]]J6kbLcWvzqNPhbkzºxxWw`VP@:IT:4>Jk`hfENf`VâîâT`NTcNoÉQLNYï±WWOTf´àì;;;;FÜåÑ\C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;65::râòö≤cFLT\Eà{QQZqìPP~óWbà|ÇLVbOJP>cfJ6FbrEL`TTbm`ÖórLV?Cb;I`âÜC]ÖΩvßYüZxÉÉ;;;;;@I]àO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;66:rQÇ≤ïöÑqèÖc\Ü|JTTâoWbÜìyCJì¢{NàâJEw`wÉàpàåîZ@FP`cYPbze?E;JàOV¢@∞pmw;;;;;;;ÉÉÉ;;;;;LYöJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;66;QP`4Öî €„∆WLîcZ]T::êàçPheF|ßc`éÜTLy|e>@mÇöî|kOFPTNbewòZEF`≠kY¥Là∞rw;;;;;;;;;É;;;;;;JJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;lç:LZ™êzÀxwxméÜ66:êàNkJNovÖfbôäVLVpL45x~Y`TL@;?JPTpìîírpofllàà∞∞∞wà;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:6E?êx64~lecîì;::;;;?@WZeçTVopNOJL:4>xçWWQ;?LYfcVì≠fl~âÇfààà;Éààww;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:6WzÖz:4hÇac™ì;;;;;;;5f;E~ÉVTmTEbP;>6CavfzfJ6{éÜTOrÉaavúúYìììì;Zà©àì;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;êê†:65ºÉNNøyL;;;;;;>@{Yk`TkYC>`TEPIPF:aÑ\J@bnä\Y]lx~vohlàìì;;;pòàìN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;£;;:55;::I`]Y;;;;;;Yy¶ü`LYåwP>Y|YVPW;4>pÑQFEaÉo\WTbeekYC;ì;;;;ZfìqN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;êê;;:6:;::å`TL;;;;;:F≥ívevìù¶V?]wVVY5@>:bpofQí£cZm\Vflox?;;àê;;;;NqàN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ê;;;;;;;;;LYL;;;;6:;F@Wlvo∂åê`WWT\yh5?J]Pì∞ÑcF§é`ocW]í|r:;;;;;;;;;NÉ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;>;@amVí£ôûéoV\wCP{O46?àwoåzÑW≥|ObûVZ¢éöoY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;C@Iaâxóœ≤öèVVwJPL¶PJÉFONqïycJoOblcJWW∞ßïY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6@eeÇèoO~VQN\yma\nf@EbmùüyÑVCnT`ìkLN\∏ßo;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;::P§be]OQâêYJTwêx`oéaIN|†ß{ÇyÇéxkJCwOÇ“ïY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;yknlfö\QLOhcààöô≠≤WQo†~p{{ùµJwJ>c\Y£n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6?xxxºZQNWww£¥àpf∏WQl`aÜÇïxêWYETck]®n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;66|pfYWWÀààl≥Éà©T\h:]Jk±YlfmZC>ó†≤´òY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;êÖVmæzwôÇ¢û â~{oYY6`Ck¥weéüQ]h©∂’rY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:`ú¡ßó±wòäÆåmclfìl≤`≤äeavONìÇ±Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Qâº{yìö]OfÉLLTfömlàw†oTZmJ@¶yêC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Qxw{wéôy±c;@Nêàoa|ºpWCPúNC@IC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;É]éê|xÉÉL;;El¢†Éèß££;>@E:6:;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;JzààWYL;;;;NÇÇl|äàL;::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   )                                                                                                                   	                                                                                                                    	                                                                                                                                                                                                   $$                                                                                                            ,,                                                              $                                          0*,)                                $                            (JI(                                        0>F$0FE50(((*                          $   *4$$$      )*(*$ $            PC>4>                                      TV>5;:>4*(((((((               ($  $$( ,C (( O>*  *;?@10),,()(   FWcL?11:                               :6F:4,0*((440(((((4C*5*5N      ( ,?(( (0(1,($ $()554)W(NE044F`PEE>I$VeO;E(54I>0**4@                              I45?5*(0*00>J>0(***E:1,  (5:Fc40,>@(5)(@((($;;($ ($ $,1440*:P1*$((5?;5:>WOc];5PII5440***4?),Ya                       *TPemF:46;::*0*5:4:44**(4PYP0,)*455*,,(4441, (*(((($(($ ($$,144:1,04   (((4@0*0>>V>455;F@4***004;),OIF(  $$eF$         ]]]]]TJQOEOJ5445:;F0*(0>:44F5*(0@@F,00441,( $$( **  ( 5:1($($$   **,4160)00   ((((000***0@044*@:((**11>$ NN;?,))0OV;:*$      ]]]]NFbÉfJ@:5:55>:N5**0:>0*>5*( (*(()04*)(     (((:0  ( (     (*(**         ((((**((4:(:>((((((*),4LJ0F6>@((J?TW>>N>@)(   ]]]]II]YpV444:45:4540***40(0**(( (    (         *(    ((   (*(((   (  ((((((****** 00( (((***(,0*5@5?5>]?::bTFC66EJ   ]]]]YYÖmm`@F@>44E5000*****((((((   ((                *50**((    ((((( (((((     ((((*0*(** (*(*000*0*:>445:>Jp   ]]]]]Ohop\@@:50*00*(***((((((((   (*(                         (  (*:>4*((     (((( ((((    (((((0*****((((((****4*04045@>V`E  ]]]]LWbå{N:54>55*((((***(((((0*   (*(   ((((      (      (    ((( **:J0*((  (((*((( **(*    ((*((00((*(( ((*(****404445:5EJ>4  ]]]]L]xßkE:40400*(*(***((((((@>*   ((  ((    ((   *(    ( ((    ( ( 4@4*(  ((*(040((0*(      (((***((((((((((***45*0045:5>>40  ]]]]]NyìfF@50***(((((**(((*((4>*   ((( (    (((         (( ((     **(540*** *50***((      (((((*((((((*(***(*55*544:>55544]]]]]\JbäâoVNP>*((( ((((*(((***0@4            ((*(  **    (( (0 (   ((5EE5*(((0**(         (((*((((*((*00440*0540445:E:5544]]]]]ZOeö{mY@F>* ((  ((((0*(((0*N5          ((((((         ( *4(        ((4:4   ((((   *   ( (((((   *4***>@0****44004>@TE545]]]]]\YWyp]k`E:4*( (   (  (*(((0(FJ* (       (((              (  00 *050( (0*    (        (*((((((    ( (*:0((04>5004:NNkF44:]]]]]\YONaVVF@>4**  (    ((((((**:`*       (((                    EJ@404T@( (*(        (    (*(( (((      (4@***45NN545:E>>>55]]]]]]]]\`V?4::400*((  (**((*( (*4o5        (            (       *`k`JFJP:0(*0**( (    (( ((0((((*(((((  (0EV:05:E@YE:VY@@:55::]]]]]]]VQ`o@@CI500*(((((00**5( 5Y@>4   ((   ((       (  *(  (0Pmf\PYF45((004**(       (((((*(((( (   (4>550>5:45E`kfY@55:>>5]]]WTOIWJ]QICI50*((*(( (**(*((5c\F5(  040 (     (     ( 50  0PV@>E05E50((0450*((    (    (((((     (((**04*****4JNN>@E>??@FNJ]]QIn@N]oJ?@F500*(**0(((04(( *FP>4( (:J4    (            (@NJ:400>::0 ((4:0(((  (  *( ((*(         (****(((*5@F:45:JEVQ\YT@]\OovwïYCJFN@4F40((**((*5:(  *:5*((:VJ5   (       (*    5E4*40(4>F0((*:>4*(      :>*( *5*     ( ((**(( (((5N@50:>@>@NJJ@>]PÇk†nWLOyk]@4NV5*(*>***5P04*40***EJorV       (0  *(*( (*  ((@\T5(*4:5(( *(  ( 5F(   4((    (( (*((((((*4@>00:::::;@\J]]]§|ò{alkkcf`@:F\F4((0*((5bJ\@>5**4F\yY5        4J    *05(      *0PP40000        (  ((      (  (((*4**(04**(*0>*4@N>@>@orF]]qanàpncmcJE:>500000**( ((NkoN:00Fm\Éy>((( (    ((   ((*5*    45  ((EJ:50**                  (   ((((*(((:V50,,0105EN?>>Prb`]]qyT\c]LJY@5545*(4:0**(  ((Er{\@E`{NJ:*  *((((  (      (*(((( *0 ( 5FE>0*    ((               ( ((*(0***4>450015F]Q@I;?Qr|a]]FTWlhÖcOeP55050*EY4((((   *FYfcc\@*0*(  ((     5*      ((**    (  (*0*(    *0(        (     (4*0*0::(**),45]]WCJLTaíwOO]ßZZzÇ†flÜkF0**404NJ4044*  (4FmVJ0(((*(((   (   EN(    **0         (((    04*(        ((((  (0*0045>5??**044?>E;OZZaWVIJ]nL†nbIVp\J0((04@5:40*5* (**(*00* ((0***(  *( (JV* (*0:(     (       05***(      ((***(*45>JE5*,C@00@\>55:Neh\]NFLOQLpïÇC:Ecr\JE5((*@0*(((50***>4 ((( (*****(  ** :FT*   ****(((     (    (  ((0:TP4(     (((***4>@@P0**(11*5>C655>k]xîY~ZOOP@CyhC@TfTbJ@5*((40(   0:F:0P@   *(0:((**(   ( JV>  (4 ((5*     *>4((    *(0EVF*      ((  (0EVPF>**(((*0E@?405:JTfZnô`QPTîîrYCVTF:>:5**(**((  (*4EY0P@(((4*(*   * (((*(J\N(   (   *( (   :N>4*     (*(*4*       **  (4@PYT@***(*05rE>016EOJ]Q|YIIPYQú†J6PJ@:45:00JE4((*((((5N*JF(((( (  (  ((0*>T@(    (   (  *0  ** (0EJ:0(((((*(((((       (( (4>@4JT:4**(*0FQ4;54:@LWZWEFYJQ]CO§]6>55:5JT:4Y`E*4b>***4:*0:*     (        (*@c@( (*((*(44(*( **( (((4EE* ((  *(*((*(      ((((4::(4:*54***1,5155@E@QeLE?oyYT]J\ô¢∞N>4:PYb55JP5*0kY(05FN44T0     ( (  (    (4P:(  (5@F5:@** (EJ(  (((>F@*     ((** (  (((((**(*0***00*400*5@5;101CILqE@@?CEàkPVé¢â`L@:>CJP5>\P40*VV5>:>4((V>(  ((**(  4(  ( *4*    VfN0*0* (445*(((  0E4(     (((  (   (**040***(*4**05444?L>F@555JPzE@JW>còkNÖç≤]oO:445:N>EV@54*kfPEF(    ((*(((((  (F0  *(>>*    :bN*(*0(4>*(*(((  (:((   ***      (**040*((((*004>44;EVP?E>?:CNFEYWVCLÇ†Pk]p{hT:J\EJ;CN:544Nc]V@((    (E:(*((( (J5* 05bV5(  (:4(0***EP500004***00((    (*5:(      **(***(40((:400046;QP;;C6F>OFP`onEOz|Pêa`bnmT4bbP`@5E\F:>>ccr@0*((( (>:***((( 0>5*5:cY5(  E>((*((YfE45*040>450*(   ((*44       (*((*0*>:0*0*0*,4>;;;QQO:]L`rTJ|nTYÑmVYérWNTf0PcFcJ55kN04:VY@5***(( (5>***( (((05>J:bTF**  >F04   5F@4404:444445*    *40*   (( (((***004>404**),1:>?FCQT?EEIQpY@LIaNv\WâäPOJT4:ofNJPmP5@@`V@:4***(((*@**E:0(*(04:JEbPV*:T(44 4(**05>5450J@:0>>N5(  (*044   *5*((((*000*444N:*(4556466FI>>C`hIFQFZJO™P\åoIarC5*Tàk`F>E:F\m\E@>444*00*((*YP:000*055>TJF0Fo0(( ((>NVJ:JJ>EkoY:@`oPF0( *500*((5F>*((*44:5*5>FY>0*>J04>:4>:::CV|W@QQTà¢OL\WûcràJC04wlPT544>Tcbmbp`FT00V@**((0:5540000*0EN5(F**4  0*EprT>55>V{{YJPwàbJ>0(*440EE@NF5**0>@:>>*4>Y\:000>>445>>@>EC@bloQPmíYYYêwóZ\m\J0*pÖcC:>@TVf{îàìÖbP45FE0*(  *040*045*>f>4*5 *50(4(5bm\N@FJFmrkVfr`cN@:40(44NV\P4**00ETbN>*0@PE0:::NPE45@FJ@PVPC\xkNWNóTYêWQe\TwI505lzWFYPV`Ykìß™¶yNTEE>40(50E***454:*>rT444 *:>:5 :kåÖ{m\TTk{wmcVTcVF5>>45Jb:5@E>504@`kY:*0:@:0EFFcbT@54@@ELJPNE>NOITwh~]WE?\QF>:45`Éêob|\`54brì|Éryb:(((0\N0((*444*(4`p5**@J5450(>r||yypk\cÉÉfF5`oY>>>TVbN*0FJE:445TpfF:5FJF4@F5V`f\54:EaPEJJ>;PYVYP{|T]VEFmW@5445Jêy]pn\5*45YNY\J5*00 (\\(((***0**0@J0(\fP:*@( (@EY`op|pTNJbE4YÖ|pJ:@TmP*0005F::E@JYf`N4F\\>TP>NPVYC>EYàQJFE@@PZoo]líP]VI>?ÖO545:@ìy`ïvV@*****4@>T*44( *0(((****40**50*55F>*>4(  ((0FVofYNPFE4:TypNP\`cN454@@:FJVVPJE@4*4Pc@JYJVV`L@NE@P??@>JFQNÜ~WÑQ]Wp>>ÆfaFE:Yoz]cJJN>>05*(*4V50*( (((((****54*((*:FNTE>00*      (4EcwpN@>5>YkTbycNE45@F>4@>5EF:444**>YPT\EPTVC;>NFI@:>>NVTbï\P~YWYy¥h?Yê†ÖYI\OVC50:EEE54*(*(45:(   ((*000**0:0((0YîåyPE:4*       (>PTokNE:EVpfwVN5*4\NJ:554:@NE@>5*5\TT:E`YbPEPec`ZI>@YVW\hlkÖæLö¢ïr§††yå]E@?;614>EbNJ:*05((04(  ((*0505040@4( (5oyo`T50(0(     ((0@c{\V@EkûkV@J54@b\Y>:>E@@N>:PP:*:5@:VPFYTNbh`PTTF@JPVVQhwnûCÇây\p£ÉY@:415,*05@5>YE:>45(*N4*5E((*0004P@450   (>yb@::4(*(  ((    *5kykN@Pßî\>@>@FNEJ@:>@PJJT>5NN:*0:F:YYPN\``VJV`mfJENTwkozmo?m~ra`WLE;4410,*4T:>NJ04**(*kJ45Y40*004:rT0 (   >TrP5@>>>*   (*  **40k|NNbTâàNPTFPYE5@NEJPF:>TE@TF500:J@T`J@YZN@IL`{bFFOVwxçí{VJPzÇE\NWIçN>@F;:@@JFJ5T:4*((0450*TF4*000:N5( ((((5:0>N>:`\4(   ((  5T>Ö{FVbbPP\fc\VT5:NbYYP:40:EETJ>5:45:F@EE:ELNEPJNEEFNwaeÖ£fNYÉ\OOPWOO`cVNPV`PJ5@4>fT00(4F0(((4>5*0000:>:@00*(**000:P\w>((     :`fNP\PfkbNTVNEE@5*4Jkp\\F@5@TJNb\T@45FVN\T:F\T\fE>>EEVv;Y>∞~kYcNL{QCFpéùkobNJ>P:*(Pb@**(F|N0***00*000005k{F4***(( (4@:5*(( (   EPb\PYF@YVTmY4@40:5:Tyây\T\Tmwfmâúé`@:`m\bJ>P\\ckT@IFT>y>rkf`]ppJ?ET\Iâz†{J@YF?JTJ0PwN00*5fP>0N@55**0004>cypNP:**( (*4>0 *( (( *50TYT`PEcfN50EYE>VF@NTmwJEVo{ÉîóÉâôúmET`fcNJm`mm|p\kWZqqcY±óôLhTW;;`b\b`F:JråwWEV`>EoN445EkV40c`E@4*005Pr\oÖ`of4(  (0*0*(**(((((VrpcbbN5P\5*FrP@PPNP@Vp`Nbr`TÖû`PÉî\@FTb{kY`VVh~wonhWloTW…YPPC;E>?IVîQJJ:>TÖx`cVYJ@TP>45Ec\0(E`J@:405>frT@kyN>E*(0((*5( (00***(JcNc{oE**54:mùémckcT>EcorrÉÉ@>@:45NJJPETcombWWwmkey~ÖâàìâòYPPPCN|ZEney£â\EJTYfÑàk@>J>@:04EJJ0(4@F550*4NY:*>{oNJ*4T0((4*((*****(04*YPV:44>4:fywof|kNJVpryúk>>@:54JVY`PcycYTPà{m]pç≤ì´PL]WQTChí£~Ékh|ìY`PNQâàÖ``>J@5::44440*@FE0**05::E0*@p{\0*5:400*0*(*(**((4:5>E0(0P55PTTbobYJPVbrwoà{fEEE>@4E@Pf\V\mk\`TwyykpÉpppkZIYWW];F\îÑzFFîTcmaYY†```p@JT@4F54450(Ec>0***:T>0*(5ET@50:54400*(*0(*00*0:V\\0 *E*@kETkÖbfpomrkr{mÉF4N:>EFETboVTkek{pmqÜhkomnôäckVY]]LV\ÉWYïTOlÉÇpeZ`ZVîåb\†\@f\@@TE00\J4*04>mE0*((4PJ55@@4004**5N0>N>45F`c@((((00PkkfoJEkp{rNP\aWoE;]FFNFJ\moYQe{yrnaäzîqéwzpä§ycT]]àÑpçW†äÉ`ôô†~qZ`ZÉY≤é†ÉÉYNcTEVf>4VF40:@Nk@>0*0:P@:TF>:*@54>0J4@T>:>\àw0((((400>E5JE4@>PE@NFL>@OJIJ\TPYyfT]kÜ~keffepyÉqel††Éƒl]]]TT]]ÉykíIpZk\mzvù†††fTwÖk\b@>fVET:40ET``::0(*04*>T0455kP45*::>J>:5Tb@((*(((*0@50TPF>0,5@JE@;TVC;@TYNVkm\YkPTa\fWcfähbfk¢àà]]]NN]LbW\wk]bQTeww†FkJYE>TyâV@kpT40EoPP@@5(*0**05404E@:4:05P>\@5@@*((((((*04E405:54446Ib]NEfTE?EOZb\f`VVT@@]ZLObôìä†pù`Wöqà]]]]ONWLJC@JYf`peîFC>†PEPkyfÉ{PNENÖp:04>>4454*4@0**>50ET454:0(:4F\>Fc0504*((*5>>44454>::?bbcPTÇpQFVkblwZZVe\FJZpWTWmú´††ßvL†h]]]]]YQW]YóQlOlmâ\YP{†Tf{l~ôé|{NJP5\bJ:40:T:4440Vb@*05@ETmF40*0004NfE>>0N@:0((0E>>45:55N>F`mJT`Yn{YI]h]hyYZWÉÉppb]pyyb]my]~h]op]]]]]]]]]]Ñ|h\†V†pl]crèÖúzVcwbTbTTYE`mE:>5FÉPNYJEkY@555:0Eck:E@4@FENymE4EYJ0*0*5@>>4>:404J|ÖmETc\zÉ`O`Y\emlkah]WpcxÉïúQFJPâ~O`~]]]]]]]]]]YYE>WozyV`Ö{wppbWex{rwpb`\mrEEF::kYTÖÉY\>55F:*(4@J::F@J@@@{{JE\pN5@00@TN@45:444FâoQc|ZcymkZ`V\kbnoQZazmcmî¢ÇFZppo|Tq∏y]]]]]]]]]]YYY?OEayPbâ{YOCEPEYêêéå\`\bmJ@PF@JE@ÖóY50:EJ50*0T>04JP\VP:Pm5@wÉP45>JTkyw54>5:55>ETåúzwcyvlYblhaZ\bILTNPq{eEEFpäpak`Q]]]]]]]]]]FLNT]hÇrZ`qïQTF;:Izw|ââkmOEfNEP\Éy\Fo{5>FYJ5>5>4N>::oboom444*4NfN00:EEFY>45::5@LJV\¶™àúåmàmnaQQpzbWbFWTNVl{pONlfrçNIQQ]]]]]]]]]]Ikoyín†nF@\NJC?EL`yzyÉ{|bF>?CFNorå``ob:ETV`>:050(4>0TVTT@*4**0444404455E045550@WÉô{Éôzîåw|cyy]ZÇY]xWbíbÜÑìpfynTyÇIL]]]]]]]]]]]]∞éélNn\F@EFELLCTrzlzyPQWNETNZV`wmcfpmN:YccFN@F>**00400***40*4@::>>4::::44:::5>Yúép\ìwcââoàößvvêéfmeccWqÉkkkWkY\kYY]]]]]]]]]]]]]]]]]]àe?CFhLr`VarY`~rNONYTwfwcp{fV`VF\J@TrkPVFFN5455*(**00>F>5EPF::4@>F:5TpF>:FbÖp\V|ù{Öúxzü±åàòcóô|r\ÖqyWVb†wZ]]]]]]]]]]]]]]]]]]]TTà∫VöIwfZ]hqè\{wwmoYcPPcy{órT|ÉbYÖPFpwT@E@F:5fb****04b`>@5P\J>@::E:>bfTE>fZ`YJJY¶º¶ù¢Çå≤¢úïüòî{of\rÜVJP@I\Y]]]]]]]]]]]]]]]]]]]TLT~npZYNC]mbûÜòéâåé|bVQVNYpNNmwVp|bPcÖ`EP@05>`E**004ET>@TE>VJ4EFF@44NET\PfZQOJYVîêçöçÉpìèénríîßïïcPQ\EPE?T]]]]]]]]]]]]]]]]]]]]PF\\px`JWvp]J`v§à\{çpQ`WN\kyJY`YowPbfPTJ>FbcE*0Y4(00:VPE4E\F5EE0:c\E5>>@PcV|ÉJOLFpz~Éûó~kkfbxïÖèhYbToOQ{ck]]]]]]]]]]]]]]]]]]]]PbONcoåaavLEFJP\OJbf]NkVTekYbwr{âboÖo@::EN`F*(F5*050@J@@PJ:F:>40\ÉPJT@FTF>ì|bbT]|qcvaLT~âeZååawícèÖåcypÖúìq]]]]]]]]]]]]]]]]]]]]]åèWp{l{ûÉE?Wm`IPVYhn]c`beWm|rpé™ÖwìÉàPN>:EE55:N0(*44:E5>E>EF4>:4VrF@b@PVF>>bré§älVNQJEEl~~Z±|PIPwûOqêohokk]]]]]]]]]]]]]]]]]]]]]]ï`ú≥vLevvÖxßrcIJVVomocyVLa|îåàßßo{{êc\>N>F>EPb5040>>N:>>45:>5:>TpY>:>YVbbp>ywì¶ínLOL\NJNVoYlWcqføWbàìlYY]]]]]]]]]]]]]]]]]]]]]]ï`cüqWY\LeONPbPJTVboxcwbVFlkÖwÉóórêwNIT>`EJ>5>T\VE45@P@E>455E@>:fkk>:F`m@@>>;;ô≠îåcZhêhJ;LÇkOQàíôaTqmúpPY]]]]]]]]]]]]]]]]]]]]]]]]YLrqìvkVNLTcnQENfàêcryrZFlcw|óôcQeyJJ]>FJJ>0*4NTN>:5>:440>@J>@:PYcE>J\{`oW]\\wäÑú\ZpW]PEVVwxYb|É|hIP]PP]]]]]]]]]]]]]]]]]]]]]]]]]NE{mÉJNncvrZJIImàrmkmÉQckâÉêyT@:\\VqFV@N:44005@>55@5005@Vb>:@J\`@EFNyYoxùb>b~è´\èzhOpV\]]QQ]rïäJ]]OO]]]]]]]]]]]]]]]]]]]]]]]]]]]ymÉIW~rz~Omo\kycnQNYJ]mîéON;E@YkÜcV\Y`Y>NY50:>:>FE54>FFYPFEV\PNEVbVréohwhhW;Éröà]ZZPcÉac]]]]]YVß\ò]TT]]]]]]]]]]]]]]]]]]]]]]]]]]]ôô∞îêmä∏îkoeeyyíÇm`bQhâcF@FINWrq\FTNmJ5EkE0>>EcoJ:>FNFY`TT`yk`PrÖkb`ale\TcV>\\bbZZ]ô~\c]]]]]]TT¶Q]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]ô∞¢í~ÆfóÉwla\hn~vrÜn@F`ZZkcqzZâTC?@@QN?FVoJ::FNVJ>JJVfâyNYVbwVFWypaPEYeLYå\\b]b]]ôÉW]]]]]]]YYYâQ]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]∞ïeª¶aà£ûÉY]]\alkèßFJNféyPÉqlhåzcINCYYpm>PmF5:EFFENPoyéoYkTVxLCWck|TEz{yvbbÖZ]]]]ôöO]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]évNÉÿyûâÖyPlÑy~{{ÉP~xf`hbâ~ppÆIJypwTf\VFVP>@NYkNJJVfìÖopTWlPZ`]YcpOmzûúäàb¥bòY]]]cônJ]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TÉfÉœúyfcå™îrc>LÉNTPÑYYPòa]a†àQTâcNE@P\T>E>EkkoVPYkmåôÉYVwaakéYÇTVmú´lqqòZ`b]]]]cnpÇ]a]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TLQYz≈∫≤îfY`fN>phVcYyzqOTqhmz±zx]{h]VF>OY?>EVwkpoJTmfcéúéYfQZlTpÉZQQ]å¶ZYQWh¶àô]]]]cçâÑna]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]PJTTyäîò™eLPZaNéVT`qîQWÇÜê]eà~ÇQ`lYPVLkmQ@Pk{LVf\\mpkéùxQ`IJhELbÜâZb~¥vß\ökxÉÉ]]]]]aVbäh]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]NJYwWÇ´êïqçâkbçÉNTZäqZkçèxIPïûyQåâPJ{f{àéxåéóbIP\km\YkÉoIJEOäV\¢Y∞p]]]]]]]ÉÉÉ]]]]]beôe]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]PP]YWcL~èæ—ÿæZQèe]]WVVéçâVhcNûfkêàZTy{fFLrÜóîÇkVLY\TfmÇ†aJOc®l\™hà∞{]]]]]]]]]É]]]]]]ee]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]oåYP]¢éyø~vrwmäçQTYéçWkQTlwÑpmùè]QYpO>>~ÇbhZQFEEVYYvúúïxrphmmàà∞∞∞à]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TPIEÜyPIzmffèô]YY]]]\V``eå~\`wwVWQO@>FÑê`bZ?FO\ok`ó∞oqÑà~hààà]Éàà]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TPZyÑyVJhbcüô]]]]]]]FfENÉà`\r\PkVEFCIlzloT>zìâYWyÖkhyúòcôôôô]pàßàô]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]éé†YPN∏ÉOOªÑf]]]]]]LIzble\o`LFbVO\TWOChâfQJfvéa`enÇàznhmàôô]]]~öàôh]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]†]]TIP]TFLaco]]]]]]h{ûöbPbî~ZEbbaY\E?Iwâ\OPméqaa\kÖmckmb]ô]]]]qzôh]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]éé]]TPY]TJÜa]f]]]]]WW™çrhwô†¶\Cfyba`?JECkwvmZó¶h`va\kpoz\]]àé]]]]hàh]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]é]]]]]]]]]fof]]]]TJL\NYkww¥éìcaa`fzl@JTe\î≠âmJ£êcql]bî{qY]]]]]]]]]hÉ]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]QINmlWé†ù†îw`fFZ~T>@Fåzråâa≤~Tfú``üäó~p]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]\WWhÖyï≈≠úí``{NZVÉûVNÖJWTwó~kNoQcnhO]]ß§ôp]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]QWfhÇ~çnT`\Ofrb]opJLfpúú~â`NmYbêkQQb≤§~]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]WW`öehbQWâéaL]|ívbxîhNPÉûûzÇ~ÖàxlQFwV…ôp]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]ymznhòf\VWnmààüö≤≥\Trôzq{|ö´]wLEc`]£|]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TZyyy≤c\Waww†≥àpf∂\TpabÜÇîwåf\NWhlcß|]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]TT|qh`Z\øààp≥Éà§Y`lFaOk±mwkmeOFê¢©©úo]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]éÑbm∂yvòÇúú≈íâÑrfZCaLk±Çqçú\em†≠ÀÉo]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]Yoú∫¢ï≠xêà©ì{ryyíp≤~b≠íwmwWPç©h]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]mê±xwéèaTkÉh]eyòpmàwûzlenQIüÖéb]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]mxwzvâóz´w]\céÑqmà≥ph]aî\TVab]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]Éoêé|yÉÉf]]c{ùúåîß††]QVbYTY]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]fÜààoof]]]]kÇÇ{àêàf]YY]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]                                                           	                                                                                                                                                                                                                                                                 	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   		                                                                                                                     		                               	  				                             	                                        	                                	                            **                                        *)),                                   	           1)($                                      		II*  (  	             	0)  ()*  	,4>)$                               					( 0*   * (0    				 )   6,,,>1()$*1;0 $ * )                           					; *  *    *E$)  $0  $,,54 )$)  $	14                      		?:W`;)  $    **($ (  *  $  )$(  4)        ((((($@@?4?5(     *   ((  *    () ,0  	      ((((  \kJ00       4   *(    **)$(,$,1$$)$(   ((((  (JF4  (     ( 6$  54*,$ *0   ((((((éV@5 (  (0 (((*;\   ((((($:TE*     (  (04Pb:  (((($05]E(  (((  ***:E5   (((($4C{4 *( (  (   ***45*   ((((( CP0( ((  ( (*4****((((((00PW@50(( (   (  ((  ((*0>00**((((((14Qx>40   4   4:   (04N>*0*(((((*5?lW:4*(00 0( (( (05@`@*00(((((*46:C5*   (@  *  (5  (@@*(*0044400((((((((?Jb0  V( (*( ((  5N0 ( *4N50NV5500*00((((((()4:Q$$(*( :((  (*((0( 0** *(((5PcfY:0,,00*((($$$$E4>,((* ::* (*     >@E5>>4544544((($F,>O)((((*(  0(     *4:0(04@5LC:>50(*)FPJJÇ4()(**(  50  (05 (*E:0*05:4144400(4T6PfC:(*>4, ((( 4 00JN>  0**@ (55**0444,,1>5((?èZwN;>>544*  (** 0(@0* 4:V:  > 	**  (  (4(*4E4401CF5((Q@EWLE;@5(   (4>0 0J:V\*( * (  0N*    $()5@4,*5FEP((\e:;?6,(,   (FP:((@c54*(   (4(*$ $(5LE5>)*:Va)(():?E5P@,0(*> 5@@EE4 	 ( **  )INL6::EEyN)((Ñ;:INY>;:0 0*  (E40*4  (*4(10 ( 146,:F;>0*(((L$ÇPT5015*   ( 0: (  (0:*$54 5N4***>OC>>1(($$ L`Q*()4>0(  ( (( 0:** (**4  $$*01)(*0ZE\vC`5(($ $QE$ 45*4( (0(50*5**   ( *04*( ;41$ *,4?N@Qv:((${ÉP@$*0( (  (0>:0((:5((044(*m50($)4;6F;`@(($$0Öv1**    0* (>:4*(  (  (( 04  :F(,,$(06FJ@4;6((()6o:   ( *05>* @  * (4   (* (( (     ($)),00EW;4,Wc6$((>mhp0( (055  *0 @5 0: (> ( (*4(*0( (((   (*$($  01;m:00001o@$,]hW60*(((**(5045   * F0>N: (       (,(,*($$:@r:4>F*L~@$WZî>T1((  * *:(  NE( 0(  (F:    *  $(10***)$0>54EC?44fè(J>Jwl@:(*@**$,5    5C:4(**  5:   (  * 0    $)(00))0),*>:>Icb5:`\(o>:CWL5 :@05)$4@0 **CCF(** (5> (* *    00     $))))110(606@C>yO?@kO(6rF41>F4>0:* (N5 5:* (* ((* 54*(4     (  (  ()(*)16,116E?11C>J4V0;wf444> (FJN405J: ((:5*( 0   (*(505(E (     *  (  0( ((( ))04044OY541:;04ì,4xP0FT) 4TmLE0(0(*>F:* (   (*(    **05b( ( *  04* (05*(  0(    (*:*  0  **(00004J{C0:06né))*;äEPV,, YN1:   (5>@>:>:05>*      (0 4  *0(  (44*((:E4(   (((40( ( ( (5:(**(((*004444Y`\:6\(((QVw65>50krJ,(**5:@TcPTT@4 0*   ((E (( (00*  *(000*44**((  (040(*50  0(   (450((0:40:E>4Ql\4>Cê((Q05O?6Y1 *Wh>0@45EFNf{{fE*5* (  4 ( *(N4 ((*((0::44000445540*0**   *5 00( (444  (  *0*>@40((4046:>>:4>?>LNCw($  F>1*$ *PvlJ:Y:E( >NbFE:J5 >:  (( 5J *5    4::544400>F4((:54 (005*54* *45*  44* *0(:>>@*(05YI::>:1IPLNIrr$(($,Z4,   (5cF;I54 (*:4*00  @F  (*EN4 0  **04:40**0(*555((0:4 *( *(**040 055*04(05:;,0:NcI:5:55FLfJVWâ$(($  f1 $$ *`L>hF1( **: (  ((( 0( (400(((  (55**4440  (* **040*((  0>005055@40544@0,44:>C>zyFqQ$($Lò>C0*(EJV>F414(*( >( ( *00((  050(    04(4:4*( ((*( (( (((   *5404*55E0*0:410004>FEL~F:h4$(TíT (bb\>4C44*  **0   (*   :kbV:0* *(04*( (0::45*( 0**   (*(((((:54((:>J:4:EF@?444JFIIOJ6\®$äh`VäbbNrF*0,($$ (*@0(   * (  ( (NPNF@ *0:0*  0J@:*   (404  (**(5( 00(( ((405F:4EJE::>55>@FE>5>Lç pWlELoV:,(      *:(   4  *    @0  (VF*( 5>0*((JJ5   (*0(*((((4005( 00((*(::@>@FE@:>ETP:5>CVN:LNF FLwkN:50*($  * 054 P4( 5     (c@ (:`E(* (*5E**40:>*0*(*4* **(*40 (0**40 (0*5::5FI;046JfP::?CY>`ca5$(Tw0O05,e,((4((**0(5(:    0*  (( (:*((*50 @E * >@**44**5E4000  *4000   **40( * (*4044*1454;:>55:>>EEWyJ($Z?4;@511:@6055@::   (J:  0*     *0(4  *EE`0*5*(4*454**04*((  (5>00*((400>:50 (455>:0:F>EJ50,1:JY(1(â\>$E44q4))LbÉ@:0*40E((0(4\5 (  (Pk0((5**  (00*4* 00040 *   (0>F@4440:@:>PYP>0(FE>E:4ENNJE>555L(O(PE@C6;k0(*CL,ÜQb>*(5**:>5*5*(F>(** ( (   (EYV:@0 (0 *0*40*55**:* 40*44:>**0EJEJPFJV\F4E@EE:>\NVOOPET@EQLC6ï~ç Y;J( NOE:04(4JPE5*4:((5*  (@: >4**  ( (404EfE``  (05405*(*4 *@>*(0000*4>54:E:0EY:0JY@45>EVNEJE@IWVTTF>PP5:º4($)$0**15Z:01(*5YL44**((4*  *:: (*(*(( (*@>40P\:** * (**5:>( (>EE555:5(*:>:EPE***( (555:5@JNJF@@PNIFTY]lpÇqÉ(((()4\:*@5QÖc>004:@VV:( ( *( *44 ((((( ::b**P@44(@  004(    55:::@:4*4FF>TP>**40((4>>E5ETN@@>:\TJ;J\féwò0(($$(*W{rLkFEZy46114fc`:>(*(  (     *0* ((*4 *@EE (*  (* * *004>:4045>EF:EE:**40*(405@>>ETNEJ>N@@:>E>>;:4(($$(*6ZZQ$ n4:>:4:é:::>**4( 0  (4( *:0 (*50( *   >@> ( 0(*4E5:E>>E>PP:EF* 50*054:@J>>QNNVTL>\LNVPC~Z6F((((6;>I$(`$0>NN>;6:64{J44b5(>0(*4*0*   *F5  *0((4     5(0(  0:@0 *444>0*>@JJ0::>6>0,;5455:@ENE@IWYOLFV@ZN`VbFYÇ@:(((haLN$fWI:TTfEI6:6I5Pb@@0*54*:@(0*  **5P0*  (0((E>( *( 00 (4(((4VT * (( *((*(400:*4,0:614>5:@TPF>CIZVLJJOP;@E?:;ÖhEÆ>(((((((Y];x,@5@6>@OóbbbE0>F:05((:4(0(  05:E(*   *E    E5 ((((0(( *5*  0( *05*(14,,,551)0;@>>JN@@J::YI@NCQ:V@656FOhcc((($$( @:4LZF:44@IIb:\45**0F@N4(@FYV0( 0P50**( (   **( ( (4(@0 ** 0  (*((  *6E@;0@5,,4:EJENF@@@,*@@14Eåälb;çC0ÉIc(((($ $  (()>Q:I@Z***b:*0>J:@@>0**0\P@(  0*    * *(*:( ( (05 4N ( *  (* ((((*((,EEF@@TJ60;ICJWJ@@NE11EeC:Icíòbbòe*í5(((((($$((Öq;Y0LET450>b4:>6NYF@@005(4:**   :(  5E0(*4:E4 4@**0 400  0*0 (*((0*0@F5@N@FO>1@E>FWE?CEE>>41>@@6IWe4NNF:@((((((((((ZWQFå4b;C>@@ZPcP1;F54>44>0:F**( 0c5:0**F5(  (* *@J 00(( 0JE* 0>4 (**0 **(((4Y`L1>I>NQ>4C?@EPOLILE?TNkvçô0,,0|e4F@Q(((((((((((($(:EQF0;J>CLP>;EVE>EE@>>@F00*(*N>:NN:@( (4((0((4(4(((PP0*@N5(4 0>:*((0(((4bP@IY@EPFE>E;@NIPN:CEPNJVÜôy5I?F;f6ZüL((((((((((((;*40CY,:P>?;,15,>NFEF5:>>F4050***(EP5 (05(0( (40555 0F((NV: (0:>NY\**0*0**05@bcT]J@JJJ>@LJI@CE55>66WcO0)$OkY@C>((((((((((( 145?Om]:5:Z4F6,(0TNFE@:>1,>44::@E50@F (0@0(*((0( (P@>>J  0E5 *550@4*0*005:5@Ero]hVETFIC66PVE?I5;>6;JZT1;YPYr0((((((((((((( TEe~PóW0*:000,40@TJFF@E>*),,005>J5>@> (:>>*( ( :@:0*     (((0 (0**(5;Tf\YbYePETFOO>;QW@CW>IlIhcq@ZeY>bY((((((((((((((pbbI(PJ1*1*,150>>YPJ@414104415>F@T:EE4* :::*004(    (((00 ((*0((*0000>kbTEYICEQPZ\fPO`YLOFII@VfOO:::FLE((((((((((((((((((((cI()*?0PL??:45IC15144E>E>NNF440(**(4@@45400   (0( (*0** (*5**EP4405@VN@:FNJPYPP`{]YnLakCQEaY\@@QlÖa:((((((((((((((((((($$cû5â*IJ?CPTq;C>:LV4:545TPpT45F50FJ*(EJ5(*(0* JN @E**(4:4(*(*4**PT@54N;::5:>bÖr\kTYmkk{oe>PJEWb?6?,5?(((((((((((((((((((($$(PFN:E6*:YOïr~ZFPTVF:115>F544:05@J4*>Y@*0*  *E4 *4**:4(45 *054(*@:@J>E:55:F>behZfYIcrZEFwofaaI66E1;4*6((((((((((((((((((((((;:QJJ5;NVL5QhûrEEOP>>1,>@J5:54>504:450(*5@( >( >5* (04**0 (>@4*404>N@PJ:544T\TZNZvmbVVT>LqIaF?J;V;>bNI(((((((((((((((((((((@44ENrIJY:141:NC:FII:J515F>>FE>T@>FNE*( *0:**  (04(*0**5(*( >\:5F4:@:4cTE?;IeZPZ:4>hhLE{r;a]@WPmF`ZpÉ{I(((((((((((((((((((((Yz0F\Wkìp0,FNE:?C;EW>@>:56:JEJVÉPNfPN40*(**((*:   (4((*(55(0*(@T54J4>E:44JPVqlY@@E1,4V]a;ûf@*6If4EpWJICC((((((((((((((((((((((`6|ÜQ5P]\e\ûVE65>5E@>6J@41:JJVTckF@F\?>(* *(05F*   ((4  ( ((0***5N@404E>JJ`1Y>pzQ;?4C656EZ>YEOcIß0?PeÉ:((((((((((((((((((((((((`6EqF6:;5L40:E:45::>F@J:5,:FVJPJT@YN0,:*@*4* *:E@4  *4(**(*(40*(:EJ00:EJ5541*,wémkN5LzW1):n@5;qÑåE;ZTÜ>((((((((((((((((((((((((((($]OmI@:51>E?:,4EPN:VVQ;1>@NJ\]60@L1,@0*05*  055(( (    *0500*5:E54:>NIN@FCCb>afà01T?J100*JI1@OmhL,0(((((((((((((((((((((((((((($ ]Na15F@NJ6144JZC@NN\;:@JkE\Z5,$656\40*5*   *( (* (*5F4045>>4:::PYCPQmJ4J\hó0P\Pn,],*(((((;ZT4;((((((((((((((((((((((((((((((@NZ1CPJTY5EE@EN@C::@16?mp45),,6?NI>55:@*4:  *0((0*( *445555::5:5@EEVfNFQII@*WTqc(::(:l1*(((((((çCÖ((((((((((((((((((((((((((((((TTpm`IbåkTNC:?JEVZP@>0;T@1,*,04?E@*55@1(>0 **0>F0*(4:0:F>:>FEF@N\VLCCQI>6E;,EEJJ55(T`,*((((((((çO$((((((((((((((((((((((((((((((TpzZQîFp`PE;6>FWQTV>)*:66FCNT6Y5((**41(04@4**45:4*44:FVY5>>@N4,>YTJ60?F6>rEEYYJ(J((TF)((((((((($V$((((((((((((((((((((((((((((((p`F§|@cy|c?@;;?NNhà1,1EbQ0ZNJ6bC:01,>:>@*0>4**445045EPbE>N?>O0*>JOZ5,hbcTJYJYYqF((((TÑ$(((((((((((((((((((((((((((((((((((((((((bT Fæ?rVcb>JYVNTVZJ4`@E:FC\]b>>ä10COT>:>:445*05:N:45:EbJFJ>:?4;FC?IJ:LfÇmcJêJÇ5(((*TP$((((((((((((((((((((((((((((((((((((((((((($FFEÉhQNJ\wpQI)1J1:1Z5:6y:51|]15P@54*5@@0004@@J>5@NJY\PP?>J@@Oq?Q>CNäâTaW~FIJ((((*5?n*)(((((((((((((((((((((((((((((((((((((((($  (@åqcJCEE5(?;6>>CQN5:L>OQôJJ:J@@>40;:,,5:N?NJ:>FE@cffEJ:>J;Vc1,;Cpà>@55EçcT((((*Nph5)((((((((((((((((((((((((((((((((((((((($$$(LYhehE4>CC1NP44?O]60]Lz4FcZW4;@65:1FE6,;NT16E@@FVJYkV>E11N16ElV,Fh†YìCàCEEE((((()*?`0(((((((((((((((((((((((((((((((((((((((  (L6béob`Nf\:5NI*?1Y>@:Np])*`Ñc4]b;5P@NNTJ\cm?45>>FE@FOC041:h?EÑ,pQT@(((((((EEE(((((,5v,(((((((((((((((((((((((((((((((((((((((  (:;5(kfôúâÇ5,zE?E0((bNo4QL*PäP@PL>:PLC,0ETolZT>55>@PPO\@5:OíYEì4cp>@(((((((((E((((((,,(((((((((((((((((((((((((((((((((((((((((((Fw(,IíbQôLZZ\PnN$((bN:W50VJhF@\V@;;I5**NWIN@;,*1>EF]`Z\\`\LNNccppp@c((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((($$0,x?$ aNJLmT((((((*16ENba@>FJ>>61,)0N`C@>(06FTTJywEF`pmLccc(Ecc@@((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((($$;QkT($N\ENÜT(((((((T**TWEEJ>:J@11*4@TL]T;(afb??\]EFY{Ö@TTTT(@cÇcT((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((bbh(((êE**òY4(((((()0c4JEENF;5JC;@6>5,JcE40@N`E?NYZcWVPNcTT(((QqcT5(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((b(($ $($))6E?((((((>Z~L>F`ZC5JbF@CC0(1VcC64LZNFEENYOVV@,(T((((@LTT5(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((bb(($$(($(n6;4((((($0ór\>FkoyJ6IVF@E,11,JTQN>fwJFP4CFV`h*((cb((((5Tc5(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((b(((((((((4?4(((($()00IVFNàpoT@@FJZW*16I>kêcT,|kJW64Epla$(((((((((5E(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((**,IYCrbyykVJE\*;]>(**aTVo\c@âP;QÇ,CÉyÜP?(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((0,1IlJ\ùâqe??\0;6eì44\,??WkZT0W4?CN*05ì~p?((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((($,NOOhoO4N??5E\PLJPN01FTàÇZc?0W;@vN)1>ç~P((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((($$>äI@>14T{E6@`ocEVkI46fèómaZbycC44a4e©p?((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((TOPON`E>:>WVccrq{çE?]èmc\ZÑû6Q6,PI0|O((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((*@@E†E>:@WWbêcVOúE?WPQr`Y`z@>4:@Q1ÇP(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((\PEEEE≤cWZìEcê>>Y,?>Wö?PIWC10~hçÑr?((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((bZ?TüeP]`è¢f]\TCL*?0VòYJYâ>CNåò¥V?(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((EvôÖZîWÇpàkNJOL{Wïk;êhIEI;6vZê;(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((;fúcbx:1:E46?LÇYJcYÑT>@C50èYb,((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((;EObTpÇ]ìI(0:bnZI\öW@,:Ç60,1,((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((EElb\@EE4((0Oéâalbb()*,$$(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((4\cc??4((((5aaN\fc4(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((                                                       ˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                                     ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                      ˇˇˇˇˇˇˇˇˇˇ                                                                                                                     ˇˇˇˇˇˇˇˇˇˇˇ                                                                                       ˇˇˇˇˇˇˇ                      ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                         ˇˇˇ                                                ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ   ˇˇˇ               ˇˇˇˇˇˇˇ                                             ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ           ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ  ˇˇˇˇ ˇˇˇˇˇˇˇˇ                                            ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                        ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ   ˇˇ      ˇˇ                          ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ    ˇˇˇˇ                         ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                      ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                  ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                  ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                  ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                      ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                  ˇ   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                  ˇ    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                        ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                    ˇˇ  ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                   ˇˇˇˇˇ ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                            ˇˇˇˇˇ ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                 ˇˇ ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                 ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                  ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                    ˇˇ ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                      ˇ   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                          ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ ˇˇˇˇˇˇˇˇˇˇ                                           ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ       ˇˇ   ˇ                                         ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ  ˇ                                                      ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                          ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                           ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                               ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                   ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                      ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                        ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                         ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                           ˇˇˇˇˇˇˇˇˇˇˇˇˇˇ       ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                             ˇˇˇˇˇ  ˇˇ ˇˇ        ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                               ˇˇ   ˇˇ ˇˇ        ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                      ˇˇ          ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                       ˇˇ          ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                    ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ                                                                                                    ˇˇˇˇˇˇˇˇˇˇˇ  ˇˇˇˇˇ    ˇˇ  ˇ                                                                                                        ˇˇˇˇˇˇˇ   ˇˇˇˇ                                                                                                                   ˇˇˇˇˇ    ˇˇˇˇ                                                                                                                   ˇˇˇˇˇ   ˇˇˇˇˇ                                                                                                                    ˇˇˇˇˇ ˇˇ  ˇ                                                                                                                      ˇˇˇˇ                                                                                                                             ˇˇ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
blob
data 3602

if BUILD_REGEX
REGEXDIR=libregex
else !BUILD_REGEX
REGEXDIR=
endif

if BUILD_ZLIB
ZDIR=libz
else !BUILD_ZLIB
ZDIR=
endif

if BUILD_PNG
PNGDIR=libpng
else !BUILD_PNG
PNGDIR=
endif

if BUILD_JOVE
JOVEDIR=jove
else !BUILD_JOVE
JOVEDIR=
endif

if BUILD_URT
URTDIR=URToolkit
UTAHRLEDIR=libutahrle
else !BUILD_URT
URTDIR=
UTAHRLEDIR=
endif

if BUILD_TCL
TCLDIR=tcl
else !BUILD_TCL
TCLDIR=
endif

if BUILD_TK
if WITH_X11
TKDIR=tk
else !WITH_X11
TKDIR=
endif
else !BUILD_TK
TKDIR=
endif

if BUILD_ITCL
ITCLDIR=incrTcl
else !BUILD_ITCL
ITCLDIR=
endif

if BUILD_IWIDGETS
IWIDGETSDIR=iwidgets
else !BUILD_IWIDGETS
IWIDGETSDIR=
endif

if BUILD_TERMLIB
TERMLIBDIR=libtermlib
else !BUILD_TERMLIB
TERMLIBDIR=
endif

if WITH_OPENGL
TOGL_MAKE=$(MAKE)
else
TOGL_MAKE=:
endif

togl-all:
	cd togl && ${TOGL_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBGL} -lXmu" all

togl-install:
	cd togl && ${TOGL_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBGL} -lXmu" install

togl-clean:
	cd togl && ${TOGL_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBGL} -lXmu" clean

togl-distclean:
	cd togl && ${TOGL_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBGL} -lXmu" distclean

togl-uninstall:
	cd togl && ${TOGL_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBGL} -lXmu" uninstall

if BUILD_DOCS
if BUILD_TKHTML3
if WITH_X11
TKHTML3_MAKE=$(MAKE)
else
TKHTML3_MAKE=:
endif
else
TKHTML3_MAKE=:
endif
else
TKHTML3_MAKE=:
endif

tkhtml3-all:
	cd tkhtml3 && ${TKHTML3_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBS}" all

tkhtml3-install:
	cd tkhtml3 && ${TKHTML3_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBS}" install

tkhtml3-clean:
	cd tkhtml3 && ${TKHTML3_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBS}" clean

tkhtml3-distclean:
	cd tkhtml3 && ${TKHTML3_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBS}" distclean

tkhtml3-uninstall:
	cd tkhtml3 && ${TKHTML3_MAKE} $(AM_MAKEFLAGS) LIBS="${X_LIBS} ${LIBS}" uninstall

all-local: tkhtml3-all togl-all
install-exec-local: tkhtml3-install togl-install
clean-local: tkhtml3-clean togl-clean
distclean-local: tkhtml3-distclean togl-distclean
uninstall-local: tkhtml3-uninstall togl-uninstall

.PHONY : tkhtml3-all tkhtml3-install tkhtml3-clean tkhtml3-distclean tkhtml3-uninstall togl-all togl-install togl-clean togl-distclean togl-uninstall



if BUILD_TKIMG
if WITH_X11
TKIMGDIR=tkimg
else !WITH_X11
TKIMGDIR=
endif
else !BUILD_TKIMG
TKIMGDIR=
endif

if BUILD_OPENNURBS
OPENNURBSDIR=openNURBS
else !BUILD_OPENNURBS
OPENNURBSDIR=
endif

if BUILD_STEP
STEPDIR=step
else !BUILD_STEP
STEPDIR=
endif

if BUILD_TNT
TNTDIR=tnt
else !BUILD_TNT
TNTDIR=
endif


if ONLY_BENCHMARK
SUBDIRS = \
	${ZDIR} \
	${PNGDIR} \
	${REGEXDIR} \
	${TCLDIR} \
	${OPENNURBSDIR} \
	${TNTDIR}

else !ONLY_BENCHMARK

if ONLY_RTS
SUBDIRS = \
	${ZDIR} \
	${PNGDIR} \
	${REGEXDIR} \
	${TCLDIR} \
	${OPENNURBSDIR} \
	${TNTDIR}

else !ONLY_RTS
# do not sort SUBDIRS
SUBDIRS = \
	${ZDIR} \
	${PNGDIR} \
	${REGEXDIR} \
	$(UTAHRLEDIR) \
	$(URTDIR) \
	${TCLDIR} \
	${TKDIR} \
	${ITCLDIR} \
	${IWIDGETSDIR} \
	${TERMLIBDIR} \
	${JOVEDIR} \
	${STEPDIR} \
	${TKIMGDIR} \
	${OPENNURBSDIR} \
	${TNTDIR} \
	awf

endif
# end ONLY_RTS

endif
# end ONLY_BENCHMARK

EXTRA_DIST = \
	boost \
	tkhtml3/COPYRIGHT \
	tkhtml3/Makefile \
	tkhtml3/Makefile.in \
	tkhtml3/README \
	tkhtml3/aclocal.m4 \
	tkhtml3/configure \
	tkhtml3/configure.in \
	tkhtml3/doc \
	tkhtml3/src \
	tkhtml3/tclconfig

# FIXME: need to only traverse tcl/tk if configured
DIST_SUBDIRS = \
	URToolkit \
	awf \
	incrTcl \
	iwidgets \
	jove \
	libpng \
	libregex \
	libtermlib \
	libutahrle \
	libz \
	openNURBS \
	step \
	tcl \
	tk \
	tkimg \
	tnt

include $(top_srcdir)/misc/Makefile.defs
blob
data 135420
dnl                    C O N F I G U R E . A C
dnl BRL-CAD
dnl
dnl Copyright (c) 2004-2009 United States Government as represented by
dnl the U.S. Army Research Laboratory.
dnl
dnl Redistribution and use in source and binary forms, with or without
dnl modification, are permitted provided that the following conditions
dnl are met:
dnl
dnl 1. Redistributions of source code must retain the above copyright
dnl notice, this list of conditions and the following disclaimer.
dnl
dnl 2. Redistributions in binary form must reproduce the above
dnl copyright notice, this list of conditions and the following
dnl disclaimer in the documentation and/or other materials provided
dnl with the distribution.
dnl
dnl 3. The name of the author may not be used to endorse or promote
dnl products derived from this software without specific prior written
dnl permission.
dnl
dnl THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS
dnl OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
dnl WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
dnl ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
dnl DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
dnl DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
dnl GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
dnl INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
dnl WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
dnl NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
dnl SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
dnl
dnl NOTE: BRL-CAD as a collective work is distributed under the LGPL.
dnl       BRL-CAD's build system is under the BSD license.
dnl       See the COPYING file for more details.
dnl
dnl $Id$
dnl
dnl ******************************************************************
dnl ***                  BRL-CAD's configure.ac                    ***
dnl ******************************************************************
dnl
dnl Herein lies the venerable GNU Build System configure template for
dnl BRL-CAD.  As best is reasonably possible, proper ordering and
dnl separation of tests and settings should be maintained per the
dnl recommended standard layout.  The tests should be added to the
dnl rather clearly labeled sections below so that they are as
dnl follows:
dnl
dnl     0) information on the package
dnl     1) check command-line arguments
dnl     2) check programs
dnl     3) check libraries
dnl     4) check headers
dnl     5) check types/structures
dnl     6) check compiler characteristics
dnl     7) check functions
dnl     8) check system services
dnl     9) output a summary
dnl
dnl Any useful build settings should be added to the output summary
dnl at the end.  Although it may be possible to check for certain
dnl features near the top in the command-line arguments section, any
dnl related tests should be delayed and placed into the appropriate
dnl check section.
dnl
dnl You should use enable/disable arguments for build settings and
dnl optional compilation components that are part of this package.
dnl You specify with/without arguments for components that are not a
dnl part of this package.
dnl
dnl Features of the GNU Autotools that would require an increase in
dnl the minimum version requirement are highly discouraged.  Likewise
dnl discouraged is rolling back support for versions released prior
dnl to the AC_PREREQ version shown below unless extensive testing has
dnl been performed.
dnl
dnl Strive to tame the chaos that is so easily achieved.
dnl

dnl minimum version of autoconf required.  should coincide with
dnl setting in autogen.sh script.
AC_PREREQ(2.52)

dnl See HACKING for details on how to properly update the version
define([MAJOR_VERSION], [patsubst(esyscmd([cat include/conf/MAJOR]), [
])])
define([MINOR_VERSION], [patsubst(esyscmd([cat include/conf/MINOR]), [
])])
define([PATCH_VERSION], [patsubst(esyscmd([cat include/conf/PATCH]), [
])])
define([CAD_VERSION], [patsubst([MAJOR_VERSION.MINOR_VERSION.PATCH_VERSION], [
])])

AC_INIT(BRL-CAD, [CAD_VERSION], [http://brlcad.org], brlcad)
AC_REVISION($Revision$)

AC_CONFIG_AUX_DIR([misc])
AC_CONFIG_MACRO_DIR([m4])

# keep track of cmd-line options for later
BC_ARG0="$0"
AC_SUBST(BC_ARG0)
BC_ARGS="$*"
AC_SUBST(BC_ARGS)

dnl just in case
PACKAGE_NAME="BRL-CAD"
AC_SUBST(PACKAGE_NAME)

BRLCAD_VERSION=CAD_VERSION
AC_SUBST(BRLCAD_VERSION)

# force lang/locale setting to C so things like date output as expected
LANG=C
LC_ALL=C

CONFIG_DAY=`date +%d`
CONFIG_MONTH=`date +%m`
CONFIG_YEAR=`date +%Y`
CONFIG_DATE="${CONFIG_YEAR}${CONFIG_MONTH}${CONFIG_DAY}"
CONFIG_TS="`date -R 2>/dev/null || date +'%a, %d %b %Y %H:%M:%S %z' 2>/dev/null || date`" # try RFC 2822
AC_SUBST(CONFIG_DAY)
AC_SUBST(CONFIG_MONTH)
AC_SUBST(CONFIG_YEAR)
AC_SUBST(CONFIG_DATE)
AC_SUBST(CONFIG_TS)


# print out the title with a pretty box computed to wrap around
title="Configuring BRL-CAD Release $BRLCAD_VERSION, Build $CONFIG_DATE"
length="`echo x${title}x | wc -c`"
separator=""
while test $length -gt 1 ; do
    separator="${separator}*"
    length="`expr $length - 1`"
done

BC_BOLD
AC_MSG_RESULT([***${separator}***])
AC_MSG_RESULT([*** ${title} ***])
AC_MSG_RESULT([***${separator}***])
BC_UNBOLD

# necessary for proper file creation on nfs volumes
umask 022


# override the default autoconf cflags if user has not modified them
if test "x$CFLAGS" = "x" ; then
	# an unset CFLAGS var is set to "-O2 -g" during AC_PROG_CC, so
	# set it to something benign instead like whitespace
	CFLAGS=" "
fi
if test "x$CXXFLAGS" = "x" ; then
	# an unset CXXFLAGS var is set to "-O2 -g" during AC_PROG_CXX, so
	# set it to something benign instead like whitespace
	CXXFLAGS=" "
fi

# override the default (empty) yflags (yacc) if user has not modified them
if test "x$YFLAGS" = "x" ; then
	YFLAGS="-d"
fi
AC_SUBST(YFLAGS)

# cannot override LD directly, so warn about that (configure sets it)
if test "x$LD" != "x" ; then
	AC_MSG_WARN([LD cannot be set directly yet it seems to be set ($LD)])
	sleep 1
fi

# classify this machine
AC_CANONICAL_HOST
AC_CANONICAL_TARGET

# am_init_automake performs a ac_prog_install check so need to handle
# problematic /usr/brl/bin/install on irix
if test "x$build_vendor" = "xsgi" ; then
   PATH="`echo $PATH | sed 's/\/brl\/bin/bin/g'`"
fi

# sanity check, make sure we have sources where we expect them
AC_CONFIG_SRCDIR([src/librt/bool.c])

# where are we coming from and where are we going to.
# prefix is set to NONE until AC_OUTPUT unless --prefix is used
AC_PREFIX_DEFAULT([/usr/brlcad])

# set up the BRLCAD_ROOT installation path, sets bc_prefix
BC_BRLCAD_ROOT

# set up the BRLCAD_DATA install directory, sets bc_data_dir
#   e.g. /usr/local/share/brlcad/7.4.0
BC_BRLCAD_DATA

# if this is not a checkout, disable dependency tracking for a faster
# build. it's not likely that the user is doing development from a
# source release. at least they really should not given the extra
# steps that are necessary for making a proper useful diff.
AC_MSG_CHECKING([whether dependency tracking should be enabled])
if test -d $srcdir/CVS -o -d $srcdir/.svn ; then
	if test "x$enable_maintainer_mode" = "x" ; then
		enable_maintainer_mode="yes"
	fi
	if test "x$enable_dependency_tracking" = "x" ; then
		enable_dependency_tracking="yes"
	fi
	AC_MSG_RESULT([yes])
else
	if test "x$enable_maintainer_mode" = "x" ; then
		enable_maintainer_mode="no"
	fi
	if test "x$enable_dependency_tracking" = "x" ; then
		enable_dependency_tracking="no"
	fi
	AC_MSG_RESULT([no])
fi

# init the venerable automake only _once_ or incur the wrath of
# several automake bugs (like "aclocal-" and install detection)
AM_INIT_AUTOMAKE([1.6 dist-zip dist-bzip2])

# disables the build system dependency tracking by default for the
# automake and autoconf template files.
AM_MAINTAINER_MODE

# write out all of our definitions to this header
AM_CONFIG_HEADER([include/brlcad_config.h])

# load the tcl SC_* macros
builtin(include,src/other/tcl/unix/tcl.m4)

# automatically enable and load our configure cache file if available
BC_CONFIG_CACHE([config.cache.${host_os}.${ac_hostname}], [yes])


dnl ***********************
dnl *** Check arguments ***
dnl ***********************

#
# DOCUMENT NEW ARGUMENTS AND ALIASES IN THE "INSTALL" FILE.
#

BC_CONFIGURE_STAGE([arguments], [1 of 9])

dnl *** enable options ***

# enable everything
BC_ARG_ENABLE([everything], [almost-everything], [Turn on compilation of almost everything], [auto])

# only build benchmark
BC_ARG_ENABLE([only_benchmark], [only-benchmark], [Only build the components necessary for the benchmark], [no])

# only build librtserver
BC_ARG_ENABLE([only_rts], [only-rtserver], [Only build the components necessary for the raytrace server], [no])

# run-time debugging
BC_ARG_ENABLE([build_runtime_debug], [runtime-debug], [Enable run-time debug checking], [yes])

# strict compilation flags
BC_ARG_ENABLE([build_strict], [strict-build], [Enable strict compiler settings], [yes])

# enable 64-bit builds
BC_ARG_ENABLE([build_64bit], [64bit-build], [Enable 64-bit compilation mode], [auto])

# force enable/disable building of libregex
BC_ARG_ENABLE([build_regex], [regex-build], [Build the included regular expression library], [auto])

# force enable/disable building of libpng
BC_ARG_ENABLE([build_png], [png-build], [Build the included Portable Network Graphics library], [auto])

# force enable/disable building of zlib
BC_ARG_ENABLE([build_zlib], [zlib-build], [Build the included zlib compression library], [auto])

# force enable/disable building of utah raster toolkit
BC_ARG_ENABLE([build_urt], [urt-build], [Build the included Utah Raster Toolkit], [auto])

# force enable/disable building of openNURBS
BC_ARG_ENABLE([build_opennurbs], [opennurbs-build], [Build the included openNURBS library], [auto])

# force enable/disable building of NIST STEP Class Libraries 
BC_ARG_ENABLE([build_step], [step-build], [Build the included STEP Class Libraries], [auto])

# force enable/disable building of termlib
BC_ARG_ENABLE([build_termlib], [termlib-build], [Build the included termlib library], [auto])

# force enable/disable building of Tcl
BC_ARG_ENABLE([build_tcl], [tcl-build], [Build the included Tcl], [auto])

# force enable/disable building of Tk
BC_ARG_ENABLE([build_tk], [tk-build], [Build the included Tk], [auto])

# force enable/disable building Tk using AquaTk (Mac OS X specific)
BC_ARG_ENABLE([build_aquatk], [aquatk-build], [Use Aqua windowing system on Mac OS X], [no])

# force enable/disable building of incrTcl
BC_ARG_ENABLE([build_itcl], [itcl-build], [Build the included incrTcl], [auto])

# force enable/disable building of iwidgets
BC_ARG_ENABLE([build_iwidgets], [iwidgets-install], [Install the included iwidgets], [auto])

# tkhtml3
BC_ARG_ENABLE([build_tkhtml3], [tkhtml3-build], [Build the included tkhtml3], [yes])

# togl
BC_ARG_ENABLE([build_togl], [togl-build], [Build the included togl], [yes])

# tkimg
BC_ARG_ENABLE([build_tkimg], [tkimg-build], [Build the included tkImg], [auto])

# force enable/disable building of tnt
BC_ARG_ENABLE([build_tnt], [tnt-install], [Install the included Template Numerical Toolkit], [auto])

# jove
BC_ARG_ENABLE([build_jove], [jove-build], [Enable compilation of jove (optional)], [no])

# endgame framework simulation module
BC_ARG_ENABLE([build_ef], [ef-build], [Enable compilation of Endgame Framework module (optional)], [no])

# unigraphics plugin
BC_ARG_ENABLE([build_ug], [unigraphics-build], [Enable compilation of Unigraphics importer (optional)], [no])

# example geometry
BC_ARG_ENABLE([install_geometry], [models-install], [Enable installation of example geometry models], [yes])

# enable building Docbook documentation
BC_ARG_ENABLE([build_docs], [documentation], [Enable compilation and installation of extra documentation], [auto])

# optimized
BC_ARG_ENABLE([use_optimized], [optimized], [Enable optimized compilation], [no])

# debug
BC_ARG_ENABLE([use_debug], [debug], [Enable debug symbols], [auto])

# profiling
BC_ARG_ENABLE([use_profiling], [profiling], [Enable profiling], [no])

# parallel
BC_ARG_ENABLE([build_parallel], [parallel], [Compile for SMP architectures], [yes])

# Sun dtrace
BC_ARG_ENABLE([use_dtrace], [dtrace], [Enable dtrace support], [no])

# verbosity
BC_ARG_ENABLE([build_verbose], [verbose], [Enable verbose compilation], [auto])

# warnings
BC_ARG_ENABLE([build_warnings], [warnings], [Enable verbose compilation warnings], [no])

# build progress status
BC_ARG_ENABLE([build_progress], [progress], [Enable verbose compilation progress], [no])

BC_ARG_ENABLE([rtgl], [rtgl], [Enable compilation of experimental Ray Trace OpenGL display manager], [no])


dnl *** with options ***

# provides convenience argument handlers for specifying CFLAGS,
# LDFLAGS, CPPFLAGS, and LIBS using --with argument handlers.
BC_WITH_FLAG_ARGS

# use the jdk
BC_ARG_WITH([with_java], [jdk], [Specify use of or path to the JDK for librtserver (optional)], [auto])

# use x11
BC_ARG_WITH([with_x11], [x11], [Specify use of or path to X11 (optional)], [auto])

# use opengl
BC_ARG_WITH([with_opengl], [ogl], [Specify use of or path to OpenGL (optional)], [no])

# use wgl
BC_ARG_WITH([with_wgl], [wgl], [Specify use of or path to WindowsGL], [auto])

# use pro/engineer
BC_ARG_WITH([with_proe], [proe], [Specify build of Pro/ENGINEER plugin or path to Pro/ENGINEER installation (optional)], [no])

###
# argument aliases
# they need to go below here in order for --help to consolidate the
# blank line that it inserts to exactly one line in the right place.
#
# DOCUMENT NEW ARGUMENTS AND ALIASES IN THE "INSTALL" FILE.
###

# aliases for enabling configuration of everything (help uses almost-everything)
BC_ARG_ALIAS([everything], [all])
BC_ARG_ALIAS([everything], [all-build])
BC_ARG_ALIAS([everything], [build-all])
BC_ARG_ALIAS([everything], [all-builds])
BC_ARG_ALIAS([everything], [everything])
BC_ARG_ALIAS([everything], [everything-build])
BC_ARG_ALIAS([everything], [build-everything])

# aliases for building only the benchmark (help uses only-benchmark)
BC_ARG_ALIAS([only_benchmark], [only-bench])
BC_ARG_ALIAS([only_benchmark], [only-benchmarks])
BC_ARG_ALIAS([only_benchmark], [bench-only])
BC_ARG_ALIAS([only_benchmark], [benchmark-only])
BC_ARG_ALIAS([only_benchmark], [benchmarks-only])

# aliases for building only the raytrace server (help uses only-rtserver)
BC_ARG_ALIAS([only_rts], [only-rts])
BC_ARG_ALIAS([only_rts], [only-librtserver])
BC_ARG_ALIAS([only_rts], [rts-only])
BC_ARG_ALIAS([only_rts], [rtserver-only])
BC_ARG_ALIAS([only_rts], [librtserver-only])

# run-time debugging (help uses runtime-debug)
BC_ARG_ALIAS([build_runtime_debug], [run-time-debug])
BC_ARG_ALIAS([build_runtime_debug], [runtime-debugging])
BC_ARG_ALIAS([build_runtime_debug], [run-time-debugging])

# run-time debugging (help uses runtime-debug)
BC_ARG_ALIAS([build_strict], [strict])
BC_ARG_ALIAS([build_strict], [strict-compile])
BC_ARG_ALIAS([build_strict], [strict-compile-flags])


# Docbook documentation (help uses documentation)
BC_ARG_ALIAS([build_docs], [documentation-install])
BC_ARG_ALIAS([build_docs], [docs])
BC_ARG_ALIAS([build_docs], [docs-install])

# 64-bit compilation (help uses 64bit-build)
BC_ARG_ALIAS([build_64bit], [64bit])
BC_ARG_ALIAS([build_64bit], [64])
BC_ARG_ALIAS([build_64bit], [64-build])
BC_ARG_ALIAS([build_64bit], [64-bit])
BC_ARG_ALIAS([build_64bit], [64-bit-build])

# force building libregex (help uses regex-build)
BC_ARG_ALIAS([build_regex], [regex])
BC_ARG_ALIAS([build_regex], [libregex])
BC_ARG_ALIAS([build_regex], [libregex-build])

# aliases to force building libpng (help uses png-build)
BC_ARG_ALIAS([build_png], [png])
BC_ARG_ALIAS([build_png], [libpng])
BC_ARG_ALIAS([build_png], [libpng-build])

# aliases to force building zlib (help uses zlib-build)
BC_ARG_ALIAS([build_zlib], [zlib])
BC_ARG_ALIAS([build_zlib], [libz])
BC_ARG_ALIAS([build_zlib], [libz-build])

# aliases to force building urt (help uses urt-build)
BC_ARG_ALIAS([build_urt], [urt])
BC_ARG_ALIAS([build_urt], [urtoolkit])
BC_ARG_ALIAS([build_urt], [urtoolkit-build])
BC_ARG_ALIAS([build_urt], [utahrle])
BC_ARG_ALIAS([build_urt], [utahrle-build])
BC_ARG_ALIAS([build_urt], [libutahrle])
BC_ARG_ALIAS([build_urt], [libutahrle-build])
BC_ARG_ALIAS([build_urt], [utah-raster-toolkit])
BC_ARG_ALIAS([build_urt], [utah-raster-toolkit-build])

# aliases to force building openNURBS (help uses opennurbs-build)
BC_ARG_ALIAS([build_opennurbs], [opennurbs])
BC_ARG_ALIAS([build_opennurbs], [libopennurbs])
BC_ARG_ALIAS([build_opennurbs], [libopennurbs-build])
BC_ARG_ALIAS([build_opennurbs], [open-nurbs])
BC_ARG_ALIAS([build_opennurbs], [open-nurbs-build])

# aliases to force building NIST STEP Class Libraries (help uses step-build)
BC_ARG_ALIAS([build_step], [step])
BC_ARG_ALIAS([build_step], [steplibs])
BC_ARG_ALIAS([build_step], [libstep-build])
BC_ARG_ALIAS([build_step], [libstep])

# aliases to force building tcl (help uses tcl-build)
BC_ARG_ALIAS([build_tcl], [tcl])
BC_ARG_ALIAS([build_tcl], [libtcl])
BC_ARG_ALIAS([build_tcl], [libtcl-build])

# aliases to force building tk (help uses tk-build)
BC_ARG_ALIAS([build_tk], [tk])
BC_ARG_ALIAS([build_tk], [libtk])
BC_ARG_ALIAS([build_tk], [libtk-build])

# aliases to force building tkaqua (help uses aquatk-build)
BC_ARG_ALIAS([build_aquatk], [aquatk])
BC_ARG_ALIAS([build_aquatk], [aqua-tk])
BC_ARG_ALIAS([build_aquatk], [aqua-tk-build])
BC_ARG_ALIAS([build_aquatk], [tkaqua])
BC_ARG_ALIAS([build_aquatk], [tkaqua-build])
BC_ARG_ALIAS([build_aquatk], [tk-aqua-build])

# aliases to force building itcl (help uses itcl-build)
BC_ARG_ALIAS([build_itcl], [itcl])
BC_ARG_ALIAS([build_itcl], [itk])
BC_ARG_ALIAS([build_itcl], [itk-build])
BC_ARG_ALIAS([build_itcl], [libitcl])
BC_ARG_ALIAS([build_itcl], [libitcl-build])
BC_ARG_ALIAS([build_itcl], [libitk])
BC_ARG_ALIAS([build_itcl], [libitk-build])
BC_ARG_ALIAS([build_itcl], [incrtcl])
BC_ARG_ALIAS([build_itcl], [incrtcl-build])

# aliases to force building iwidgets (help uses iwidgets-install)
BC_ARG_ALIAS([build_iwidgets], [iwidgets])
BC_ARG_ALIAS([build_iwidgets], [iwidgets-build])

# aliases to force building tkhtml3 (help uses tkhtml3-build)
BC_ARG_ALIAS([build_tkhtml3], [tkhtml3])

# aliases to force building togl (help uses togl-build)
BC_ARG_ALIAS([build_togl], [togl])

# aliases to force building tkimg (help uses tkimg-build)
BC_ARG_ALIAS([build_tkimg], [tkimg])
BC_ARG_ALIAS([build_tkimg], [libtkimg])
BC_ARG_ALIAS([build_tkimg], [libtkimg-build])

# aliases to force building termlib (help uses termlib-build)
BC_ARG_ALIAS([build_termlib], [termlib])
BC_ARG_ALIAS([build_termlib], [termcap])
BC_ARG_ALIAS([build_termlib], [termcap-build])
BC_ARG_ALIAS([build_termlib], [libtermlib])
BC_ARG_ALIAS([build_termlib], [libtermlib-build])
BC_ARG_ALIAS([build_termlib], [libtermcap])
BC_ARG_ALIAS([build_termlib], [libtermcap-build])

# aliases to force building tnt (help uses tnt-install)
BC_ARG_ALIAS([build_tnt], [tnt])
BC_ARG_ALIAS([build_tnt], [tnt-build])
BC_ARG_ALIAS([build_tnt], [template-numerical-toolkit])
BC_ARG_ALIAS([build_tnt], [template-numerical-toolkit-build])
BC_ARG_ALIAS([build_tnt], [template-numerical-toolkit-install])

# jove aliases (help uses jove-build)
BC_ARG_ALIAS([build_jove], [jove])

# endgame framework module aliases (help uses ef-build)
BC_ARG_ALIAS([build_ef], [ef])
BC_ARG_ALIAS([build_ef], [endgameframework])
BC_ARG_ALIAS([build_ef], [endgameframework-build])
BC_ARG_ALIAS([build_ef], [endgame-framework])
BC_ARG_ALIAS([build_ef], [endgame-framework-build])

# unigraphics (NX) importer aliases (help uses unigraphics-build)
BC_ARG_ALIAS([build_ug], [unigraphics])
BC_ARG_ALIAS([build_ug], [ug])
BC_ARG_ALIAS([build_ug], [ug-build])
BC_ARG_ALIAS([build_ug], [nx])
BC_ARG_ALIAS([build_ug], [nx-build])

# install geometry aliases (help uses models-install)
BC_ARG_ALIAS([install_geometry], [models])
BC_ARG_ALIAS([install_geometry], [models-build])
BC_ARG_ALIAS([install_geometry], [geometry])
BC_ARG_ALIAS([install_geometry], [geometry-build])
BC_ARG_ALIAS([install_geometry], [geometry-install])

# optimized aliases (help uses optimized)
BC_ARG_ALIAS([use_optimized], [opt])
BC_ARG_ALIAS([use_optimized], [optimize])
BC_ARG_ALIAS([use_optimized], [optimization])
BC_ARG_ALIAS([use_optimized], [optimizations])

# debug aliases (help uses debug)
BC_ARG_ALIAS([use_debug], [debugging])

# profiling aliases (help uses profiling)
BC_ARG_ALIAS([use_profiling], [profile])
BC_ARG_ALIAS([use_profiling], [profiled])

# parallel aliases (help uses parallel)
BC_ARG_ALIAS([build_parallel], [parallel-build])
BC_ARG_ALIAS([build_parallel], [smp])
BC_ARG_ALIAS([build_parallel], [smp-build])

# verbose output (help uses verbose)
BC_ARG_ALIAS([build_verbose], [verbosity])
BC_ARG_ALIAS([build_verbose], [output-verbose])
BC_ARG_ALIAS([build_verbose], [verbose-output])
BC_ARG_ALIAS([build_verbose], [build-verbose])
BC_ARG_ALIAS([build_verbose], [verbose-build])

# verbose warning aliases (help uses warnings)
BC_ARG_ALIAS([build_warnings], [warning])
BC_ARG_ALIAS([build_warnings], [verbose-warnings])
BC_ARG_ALIAS([build_warnings], [warnings-verbose])
BC_ARG_ALIAS([build_warnings], [build-warnings])
BC_ARG_ALIAS([build_warnings], [warnings-build])

# verbose compilation progress status (help uses progress)
BC_ARG_ALIAS([build_progress], [verbose-progress])
BC_ARG_ALIAS([build_progress], [progress-verbose])
BC_ARG_ALIAS([build_progress], [build-progress])
BC_ARG_ALIAS([build_progress], [progress-build])

# with java aliases (help uses jdk)
BC_ARG_WITH_ALIAS([with_java], [java])

# with proe aliases
BC_ARG_WITH_ALIAS([with_proe], [proe])

# with x11 aliases (help uses x11)
BC_ARG_WITH_ALIAS([with_x11], [x])

# with opengl aliases (help uses ogl)
BC_ARG_WITH_ALIAS([with_opengl], [opengl])

# with wgl aliases (help uses wgl)
BC_ARG_WITH_ALIAS([with_wgl], [windowsgl])


###
# set up path searching
###

dnl automatically scan /usr/local (e.g. BSD uses /usr/local for ports)
BC_SEARCH_DIRECTORY([/usr/local])


###
# argument sanity checks and meta-argument settings
# here go checks to warn or abort when conflicting options specified
###

# handle enabling/disabling all the packages and codes that ship with
# the package.  if something is changed from a default, leave it alone
# so that the user may specify everything and then disable specific
# ones.  specifically only test yes/no as default 'auto' is to leave
# the options alone.
set_everything=""
if test "x$bc_everything" = "xyes" ; then
	set_everything=yes
elif test "x$bc_everything" = "xno" ; then
	set_everything=no
fi
if test "x$set_everything" != "x" ; then
	if test "x$bc_build_runtime_debug_set" = "xno" ; then
		bc_build_runtime_debug="$set_everything"
	fi
	if test "x$bc_build_strict_compile" = "xno" ; then
		bc_build_strict="$set_everything"
	fi
	if test "x$bc_build_regex_set" = "xno" ; then
		bc_build_regex="$set_everything"
	fi
	if test "x$bc_build_png_set" = "xno" ; then
		bc_build_png="$set_everything"
	fi
	if test "x$bc_build_zlib_set" = "xno" ; then
		bc_build_zlib="$set_everything"
	fi
	if test "x$bc_build_urt_set" = "xno" ; then
		bc_build_urt="$set_everything"
	fi
	if test "x$bc_build_opennurbs_set" = "xno" ; then
		bc_build_opennurbs="$set_everything"
	fi
	if test "x$bc_build_step" = "xno" ; then
		bc_build_step="$set_everything"
	fi
	if test "x$bc_build_termlib_set" = "xno" ; then
		bc_build_termlib="$set_everything"
	fi
	if test "x$bc_build_tcl_set" = "xno" ; then
		bc_build_tcl="$set_everything"
	fi
	if test "x$bc_build_tk_set" = "xno" ; then
		bc_build_tk="$set_everything"
	fi
	if test "x$bc_build_itcl_set" = "xno" ; then
		bc_build_itcl="$set_everything"
	fi
	if test "x$bc_build_iwidgets_set" = "xno" ; then
		bc_build_iwidgets="$set_everything"
	fi
	if test "x$bc_build_tkhtml3" = "xno" ; then
		bc_build_tkhtml3="$set_everything"
	fi
	if test "x$bc_build_togl" = "xno" ; then
		bc_build_togl="$set_everything"
	fi
	if test "x$bc_build_tkimg_set" = "xno" ; then
		bc_build_tkimg="$set_everything"
	fi
	if test "x$bc_build_tnt_set" = "xno" ; then
		bc_build_tnt="$set_everything"
	fi
	if test "x$bc_build_jove_set" = "xno" ; then
		bc_build_jove="$set_everything"
	fi
	# Singe the Endgame Framework "simulation module" will only
	# compile if you have it installed, don't enable it even if
	# requesting everything.  fine to disable, though.
	if test "x$bc_build_ef_set" = "xno" ; then
		if test "x$set_everything" = "xno" ; then
			bc_build_ef=no
		fi
	fi
	# Since the Unigraphics importer is primarily tested on only one
	# platform and requires UGOPEN, don't enable it even if
	# requesting everything.  fine to disable, though.
	if test "x$bc_build_ug_set" = "xno" ; then
		if test "x$set_everything" = "xno" ; then
			bc_build_ug=no
		fi
	fi
fi


# make sure multiple "only" options were not given
if test "x$bc_only_benchmark" != "xno" ; then
	if test "x$bc_only_rts" != "xno" ; then
		AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		AC_MSG_WARN([Requesting BOTH benchmark and librtserver "only"?])
		AC_MSG_WARN([Building both benchmark and librtserver])
		AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
		sleep 1
	fi
	if test "x$bc_everything" = "xyes" ; then
		AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		AC_MSG_WARN([Requesting ONLY benchmark and EVERYTHING?])
		AC_MSG_WARN([Building everything])
		AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
		bc_only_benchmark=no
		sleep 1
	fi
fi

# the opengl interface is presently tied to the x11 interface
if test "x$bc_with_opengl" = "xyes" ; then
	if test "x$bc_with_x11" = "xno" ; then
		AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		AC_MSG_WARN([OpenGL interface presently requires X11 support])
		AC_MSG_WARN([Presuming X11 availability for the OpenGL interface])
		AC_MSG_WARN([The X11 interface will not be built])
		AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
		sleep 1
	fi
fi

# turning on verbose means turning on progress and warning verbosity
if test "x$bc_build_verbose" = "xyes" ; then
	if test "x$bc_build_warnings_set" = "xno" ; then
		bc_build_warnings=yes
	fi
	if test "x$bc_build_progress_set" = "xno" ; then
		bc_build_progress=yes
	fi
fi

###
# argument summary printing
###

AC_MSG_CHECKING(whether to compile everything was requested)
AC_MSG_RESULT($bc_everything)

AC_MSG_CHECKING(whether to only build benchmark)
AC_MSG_RESULT($bc_only_benchmark)

AC_MSG_CHECKING(whether to only build the raytrace server)
AC_MSG_RESULT($bc_only_rts)

AC_MSG_CHECKING(whether to use run-time debug checks)
AC_MSG_RESULT($bc_build_runtime_debug)

AC_MSG_CHECKING(whether to use strict compiler options)
AC_MSG_RESULT($bc_build_strict)

AC_MSG_CHECKING(whether to compile and install Docbook documentation)
AC_MSG_RESULT($bc_build_docs)

AC_MSG_CHECKING(whether to compile in 64-bit mode)
AC_MSG_RESULT($bc_build_64bit)

AC_MSG_CHECKING(whether to build the regular expression library)
AC_MSG_RESULT($bc_build_regex)

AC_MSG_CHECKING(whether to build the PNG library)
AC_MSG_RESULT($bc_build_png)

AC_MSG_CHECKING(whether to build the zlib compression library)
AC_MSG_RESULT($bc_build_zlib)

AC_MSG_CHECKING(whether to build the Utah Raster Toolkit)
AC_MSG_RESULT($bc_build_urt)

AC_MSG_CHECKING(whether to build the openNURBS library)
AC_MSG_RESULT($bc_build_opennurbs)

AC_MSG_CHECKING(whether to build the NIST Step Class libraries)
AC_MSG_RESULT($bc_build_step)

AC_MSG_CHECKING(whether to build the Tcl library)
AC_MSG_RESULT($bc_build_tcl)

AC_MSG_CHECKING(whether to build the Tk library)
AC_MSG_RESULT($bc_build_tk)

AC_MSG_CHECKING(whether to use AquaTk)
AC_MSG_RESULT($bc_build_aquatk)

AC_MSG_CHECKING(whether to build the incrTcl library)
AC_MSG_RESULT($bc_build_itcl)

AC_MSG_CHECKING(whether to install the iwidgets library)
AC_MSG_RESULT($bc_build_iwidgets)

AC_MSG_CHECKING(whether to build the tkhtml3 library)
AC_MSG_RESULT($bc_build_tkhtml3)

AC_MSG_CHECKING(whether to build the togl library)
AC_MSG_RESULT($bc_build_togl)

AC_MSG_CHECKING(whether to build the tkImg library)
AC_MSG_RESULT($bc_build_tkimg)

AC_MSG_CHECKING(whether to build the termlib library)
AC_MSG_RESULT($bc_build_termlib)

AC_MSG_CHECKING(whether to build the Template Numerical Toolkit)
AC_MSG_RESULT($bc_build_tnt)

AC_MSG_CHECKING(whether to compile jove or not)
AC_MSG_RESULT($bc_build_jove)

AC_MSG_CHECKING(whether to compile the Endgame Framework module)
AC_MSG_RESULT($bc_build_ef)

AC_MSG_CHECKING(whether to compile the Unigraphics importer)
AC_MSG_RESULT($bc_build_ug)

AC_MSG_CHECKING(whether to install example geometry databases)
AC_MSG_RESULT($bc_install_geometry)

AC_MSG_CHECKING(whether to enable optimized compilation)
AC_MSG_RESULT($bc_use_optimized)

AC_MSG_CHECKING(whether to disable debug mode compilation)
AC_MSG_RESULT($bc_use_debug)

AC_MSG_CHECKING(whether to enable profile mode compilation)
AC_MSG_RESULT($bc_use_profiling)

AC_MSG_CHECKING(whether to enable support for SMP architectures)
AC_MSG_RESULT($bc_build_parallel)

AC_MSG_CHECKING(whether to enable verbose output)
AC_MSG_RESULT($bc_build_verbose)

AC_MSG_CHECKING(whether to enable verbose compilation warnings)
AC_MSG_RESULT($bc_build_warnings)

AC_MSG_CHECKING(whether to enable verbose compilation progress)
AC_MSG_RESULT($bc_build_progress)

AC_MSG_CHECKING(whether to compile with the Java Development Kit)
AC_MSG_RESULT($bc_with_java)

AC_MSG_CHECKING(whether to compile the X11 interfaces)
AC_MSG_RESULT($bc_with_x11)

AC_MSG_CHECKING(whether to compile the OpenGL interfaces)
AC_MSG_RESULT($bc_with_opengl)

AC_MSG_CHECKING(whether to compile the WindowsGL interfaces)
AC_MSG_RESULT($bc_with_wgl)

AC_MSG_CHECKING(whether to compile the Pro/ENGINEER plugin)
AC_MSG_RESULT($bc_with_proe)

AC_MSG_CHECKING(whether to compile experimental RTGL display manager)
AC_MSG_RESULT($bc_rtgl)


dnl **************************
dnl *** Check for programs ***
dnl **************************

BC_CONFIGURE_STAGE([programs], [2 of 9])

AC_LANG(C)

dnl added in autoconf 2.54 to define _GNU_SOURCE
dnl AC_GNU_SOURCE

AC_AIX
AC_MINIX

AC_PROG_CC
AM_PROG_CC_C_O

AC_PROG_CXX

AC_PROG_CPP
AC_REQUIRE_CPP

AC_PROG_AWK
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AM_PROG_MKDIR_P

# automake 'requires' AM_PROG_LEX, not AC_PROG_LEX
AM_PROG_LEX
AC_PROG_YACC

# libtool's configuration check has a bug that causes a /lib/cpp
# sanity check failure if a C++ compiler is not installed.  This makes
# the sanity test pass regardless of whether there is a c++ compiler.
if test "x$CXXCPP" = "x" ; then
    if test "x$CPP" = "x" ; then
	CXXCPP="cpp"
    else
	CXXCPP="$CPP"
    fi
fi

dnl disable unnecessary libtool test for fortran
define([AC_LIBTOOL_LANG_F77_CONFIG], [:])dnl

# libtool shouldn't be generated until after LD is set
# XXX went poof in libtool 1.9 -- AC_PROG_LIBTOOL
# LT_INIT
AC_PROG_LIBTOOL
AC_SUBST(LIBTOOL_DEPS)

dnl verbose compilation progress
if test "x$bc_build_progress" != "xyes" ; then
    LIBTOOLFLAGS=--silent
    AC_SUBST(LIBTOOLFLAGS)
    # LIBTOOLFLAGS isn't often not enough;
    # tack --silent onto the LIBTOOL command.
    if test "x$LIBTOOL" != "x" ; then
	LIBTOOL="$LIBTOOL --silent"
    fi
fi

# xsltproc is needed for docbook processing, fop is needed for pdf generation
xsltproc_works=no
fop_works=no
if test "x$bc_build_docs" != "xno" ; then
    AC_PATH_PROG(XSLTPROC, xsltproc)
    AC_PATH_PROG(APACHEFOP, fop)
fi

# XXX tests for ranlib may be required.  "ar ts" was used in cake for
# sgi and aix so more compensation may be required still.

dnl Libtool may need AR so try to find it
AC_PATH_PROG(AR, ar, [], $PATH:/usr/bin:/usr/local/bin:/usr/ccs/bin)
AC_SUBST(AR)

dnl check for basic shell facilities
AC_PATH_PROG(SH, sh)
AC_PATH_PROG(MV, mv)
AC_PATH_PROG(CP, cp)
AC_PATH_PROG(RM, rm)

if test "x$bc_with_dtrace" = "xyes" ; then
    AC_PATH_PROG(DTRACE, dtrace, bc_with_dtrace=no, [$PATH:/usr/sbin])
fi

dnl figure out which compiler is seems like we are using
dnl detected values include: gcc, mipspro, sunpro
dnl none of the tests should be compiler-specific, but it's good to
dnl know in the log which it seems we are using
compiler=unknown

dnl Determine whether we are using GCC
if test "x$GCC" = "xyes" ; then
    compiler=gnu
fi

dnl Determine whether we are using the MIPSpro compiler on SGI systems
if test "x$build_vendor" = "xsgi" ; then
    AC_MSG_CHECKING([whether we are using the MIPSpro compiler])
    using_mipspro=no
    AC_LINK_IFELSE([#if defined(sgi) && defined(_COMPILER_VERSION) && !defined(__GNUC__)
If we get here, we are using the MIPSPro compiler (and the link should fail).
#endif
int main() { return 0; }
    ], [using_mipspro=no], [using_mipspro=yes])
    AC_MSG_RESULT($using_mipspro)
    if test "x$using_mipspro" = "xyes" ; then
	compiler=sgi
    fi
fi

dnl Determine whether we are using the SUNWspro Sun Workshop compiler
if test "x$build_vendor" = "xsun" ; then
    AC_MSG_CHECKING([whether we are using the SUNWspro compiler])
    using_sunpro=no
    AC_LINK_IFELSE([#if defined(sun) && defined(__SUNPRO_C) && !defined(__GNUC__)
If we get here, we are using the SUNWspro compiler (and the link should fail).
#endif
int main() { return 0; }
    ], [using_sunpro=no], [using_sunpro=yes])
    AC_MSG_RESULT($using_sunpro)
    if test "x$using_sunpro" = "xyes" ; then
	AR="CC -xar"
	LD="CC -G"
	export AR LD
	compiler=sun
    fi
fi

AC_FUNC_ALLOCA

dnl if building jove wasn't specifically requested and wasn't
dnl disabled, see if there is either emacs or jove available.
dnl i.e. auto for jove is dependant on what is installed
BCEDITOR=""
if test "x$bc_build_jove" = "xauto" ; then
    AC_PATH_PROG(BCEDITOR, emacs, , $PATH)
    if test "x$BCEDITOR" = "x" ; then
	AC_PATH_PROG(BCEDITOR, jove, , $PATH)
    fi
fi


dnl ***************************
dnl *** Check for libraries ***
dnl ***************************

BC_CONFIGURE_STAGE([libraries], [3 of 9])

dnl check if there is a threading library that links, the order of
dnl these checks is consistent with libbu's bu_parallel()
dnl implementation preference.  this is usually in order of highest
dnl performing threading interface.
thread_link_works=no
LIBTHREAD=""
dnl try sgi sproc first
AC_CHECK_LIB(c, sproc, thread_link_works=yes ; LIBTHREAD="-lc",
    dnl try solaris threading
    [AC_CHECK_LIB(thread, thr_create, thread_link_works=yes ; LIBTHREAD="-lthread",
	dnl pthreading is a good default if none of the others are available
	dnl XXX need to test HPUX -- may require -lcma with pthreads
	[AC_CHECK_LIB(pthread, pthread_create, thread_link_works=yes ; LIBTHREAD="-lpthread",
	    dnl check if the BSD c_r threading library link works
	    [AC_CHECK_LIB(c_r, pthread_create, thread_link_works=yes ; LIBTHREAD="-pthread")]
	)]
    )]
)

dnl check for the daemon function in -lbsd and/or -lc for adrt
LIBBSD=""
AC_CHECK_LIB(bsd, daemon, LIBBSD="-lbsd",
    [AC_CHECK_LIB(c, daemon, LIBBSD="-lc")]
)
AC_SUBST(LIBBSD)

dnl check whether we ended up with functioning posix threading.
AC_MSG_CHECKING([whether we are using POSIX threading])
posix_threading=no
PRELIBS="$LIBS"
LIBS="$LIBS $LIBTHREAD"
AC_TRY_LINK([#include <pthread.h>], [
    pthread_t th;
    pthread_join(th, 0);
    pthread_attr_init(0);
    pthread_cleanup_push(0,0);
    pthread_create(0,0,0,0);
    pthread_cleanup_pop(0);
], [posix_threading=yes])
LIBS="$PRELIBS"
AC_MSG_RESULT($posix_threading)

dnl check whether the CoreFoundation framework is available (used when
dnl linking against static tcl)
AC_MSG_CHECKING([whether -framework CoreFoundation is available])
framework_cf=no
FRAMEWORK_COREFOUNDATION=""
PRELIBS="$LIBS"
LIBS="$LIBS -Xlinker -framework -Xlinker CoreFoundation"
AC_TRY_LINK([#include <CoreFoundation/CoreFoundation.h>], [
CFBundleRef bref = CFBundleGetMainBundle();
], [framework_cf=yes ; FRAMEWORK_COREFOUNDATION="-Xlinker -framework -Xlinker CoreFoundation"])
LIBS="$PRELIBS"
AC_MSG_RESULT($framework_cf)
AC_SUBST(FRAMEWORK_COREFOUNDATION)

dnl check whether the Carbon framework is available (used for X11 focus)
AC_MSG_CHECKING([whether -framework Carbon is available])
framework_carbon=no
FRAMEWORK_CARBON=""
PRELIBS="$LIBS"
LIBS="$LIBS -Xlinker -framework -Xlinker Carbon"
AC_TRY_LINK([#include <Carbon/Carbon.h>], [
OSStatus status;
ProcessSerialNumber psn = {kNoProcess, kNoProcess};
CFStringRef processName = NULL;
GetCurrentProcess(&psn);
CopyProcessName(&psn, &processName);
if (processName != NULL) {
   CFShow(processName);
}
], [framework_carbon=yes ; FRAMEWORK_CARBON="-Xlinker -framework -Xlinker Carbon"])
LIBS="$PRELIBS"
AC_MSG_RESULT($framework_carbon)
AC_SUBST(FRAMEWORK_CARBON)

dnl check whether the JavaVM framework is available (used for librtserver)
AC_MSG_CHECKING([whether -framework JavaVM is available])
framework_javavm=no
FRAMEWORK_JAVAVM=""
PRELIBS="$LIBS"
LIBS="$LIBS -framework JavaVM"
AC_TRY_LINK([#include <JavaVM/jni.h>], [
JavaVM *jvm;
JNIEnv *env;
JavaVMInitArgs args;
jint i = JNI_GetDefaultJavaVMInitArgs(&args);
jboolean j = JNI_CreateJavaVM(&jvm, (void**)&env, &args);
if (j && jvm) {
  (*jvm)->DestroyJavaVM(jvm);
}
], [framework_javavm=yes ; FRAMEWORK_JAVAVM="-framework JavaVM"])
LIBS="$PRELIBS"
AC_MSG_RESULT($framework_javavm)
AC_SUBST(FRAMEWORK_JAVAVM)


dnl check for java
JAVA_CFLAGS="$FRAMEWORK_JAVAVM"
JAVA_LDFLAGS="-shrext .jnilib $FRAMEWORK_JAVAVM"
if test "x$bc_with_java" = "xyes" ; then
    if test "x$bc_with_java_val" = "xyes" ; then
	bc_with_java_val="/usr"
    fi
    if test "x$bc_with_java_val" != "x" ; then
	JAVA_CFLAGS="-I$bc_with_java_val/include -I$bc_with_java_val/include/`uname | tr [A-Z] [a-z]`"
	JAVA_LDFLAGS="-shrext .jnilib -L$bc_with_java_val/lib64 -L$bc_with_java_val/lib"
    fi
fi
AC_SUBST(JAVA_CFLAGS)
AC_SUBST(JAVA_LDFLAGS)


dnl find a curses or other terminal library
LIBTERMLIB=""
AC_CHECK_LIB(termlib, tputs, LIBTERMLIB="-ltermlib",
    [AC_CHECK_LIB(ncurses, tputs, LIBTERMLIB="-lncurses",
	[AC_CHECK_LIB(curses, tputs, LIBTERMLIB="-lcurses",
	    [AC_CHECK_LIB(termcap, tputs, LIBTERMLIB="-ltermcap",
		[AC_CHECK_LIB(terminfo, tputs, LIBTERMLIB="-lterminfo",
		    [AC_CHECK_LIB(tinfo, tputs, LIBTERMLIB="-ltinfo",
			[AC_CHECK_LIB(ocurses, tputs, LIBTERMLIB="-locurses")]
		    )]
		)]
	    )]
	)]
    )]
)

dnl *** X11 ***
if test "x$bc_with_x11" != "xno" ; then

    if test "x$bc_with_x11_val" != "x" ; then
        if test "x$bc_with_x11_val" != "xyes" ; then
	    if test "x$x_includes" = "xNONE"; then
		x_includes="$bc_with_x11_val/include"
		ac_x_includes="$x_includes"
	    fi
	    if test "x$x_libraries" = "xNONE"; then
		x_libraries="$bc_with_x11_val/lib"
		ac_x_libraries="$x_libraries"
	    fi
	fi
    fi

    dnl find X11 libraries.  sets X_CFLAGS, X_LIBS, and X_EXTRA_LIBS
    BC_SEARCH_DIRECTORY([/usr/X11], [X11])
    AC_PATH_XTRA
    AC_CHECK_HEADERS([X11/Xlib.h])

    dnl add X11 libraries that link to X_LIBS
    LIBX11=""
    LIBXEXT=""
    LIBXI=""

    PRELIBS="$LIBS"
    PRECPPFLAGS="$CPPFLAGS"

    CPPFLAGS="$CPPFLAGS $X_CFLAGS"

    LIBS="$LIBS $X_LIBS"
    AC_CHECK_LIB(X11, XCreateWindow, LIBX11="-lX11")

    LIBS="$LIBS $LIBX11"
    AC_CHECK_LIB(Xext, XShapeCombineMask, LIBXEXT="-lXext")

    LIBS="$LIBS $LIBXEXT"
    AC_CHECK_LIB(Xi, XGetExtensionVersion, LIBXI="-lXi")
    X_LIBS="$LIBS $LIBXI"

    # common for systems to not have Xi X11 input library .. warn
    # verbosely about that being a problem since the build will
    # probably fail in src/bwish with undefined references to
    # XFreeDeviceList, XOpenDevice, XSelectExtensionEvent, and
    # XListInputDevices.
    if test "x$LIBXI" = "x" ; then
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_WARN([X11 support is enabled but the Xi library was not found.])
	AC_MSG_WARN([This will likely result in a build failure.])
	AC_MSG_WARN([See config.log for details why (look for this comment)])
	AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
	sleep 5
    fi

    CPPFLAGS="$PRECPPFLAGS"
    LIBS="$PRELIBS"
fi

dnl check if a math library links
m_link_works=no
LIBM=""
AC_CHECK_LIB(m, cos, m_link_works=yes ; LIBM="-lm")

dnl detect a useable system regular expression library
regex_link_works=no
LIBREGEX=""
AC_CHECK_LIB(c, regcomp, regex_link_works=yes ; LIBREGEX="-lc",
    [AC_CHECK_LIB(regex, regcomp, regex_link_works=yes ; LIBREGEX="-lregex",
	[AC_CHECK_LIB(compat, regcomp, regex_link_works=yes ; LIBREGEX="-lcompat")]
    )]
)

dnl check if zlib library links
z_link_works=no
LIBZLIB=""
if test "x$bc_build_zlib" != "xyes" ; then
    AC_CHECK_LIB(z, deflate, z_link_works=yes ; LIBZLIB="-lz")
fi

dnl check if a png library links
png_link_works=no
LIBPNG=""
PRELIBS="$LIBS"
LIBS="$LIBS $LIBZLIB"
AC_CHECK_LIB(png, png_access_version_number, png_link_works=yes ; LIBPNG="-lpng $LIBZLIB")
LIBS="$PRELIBS"

dnl check if utahrle library links
utahrle_link_works=no
UTAHRLE=""
if test "x$bc_build_urt" != "xyes" ; then
    # checking for rle_hdr_init is NOT sufficient to get urt 3.x
    PRELIBS="$LIBS"
    LIBS="$LIBS $LIBM"
    AC_CHECK_LIB(utahrle, rle_getraw, utahrle_link_works=yes ; UTAHRLE="-lutahrle $LIBM",
	[AC_CHECK_LIB(rle, rle_getraw, utahrle_link_works=yes ; UTAHRLE="-lrle $LIBM")]
    )
    LIBS="$PRELIBS"
fi

dnl check if openNURBS library links
opennurbs_link_works=no
LIBOPENNURBS=""
if test "x$bc_build_opennurbs" != "xyes" ; then
    AC_CHECK_LIB(openNURBS, onmalloc, opennurbs_link_works=yes ; LIBOPENNURBS="-lopenNURBS")
fi

dnl check if libtcl library links
tcl_link_works=no
LIBTCL=""
AC_CHECK_LIB(tcl8.6, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl8.6",
    [AC_CHECK_LIB(tcl86, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl86",
	[AC_CHECK_LIB(tcl8.5, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl8.5",
	    [AC_CHECK_LIB(tcl85, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl85",
		[AC_CHECK_LIB(tcl8.4, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl8.4",
		    [AC_CHECK_LIB(tcl84, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl84",
			[AC_CHECK_LIB(tcl, Tcl_Main, tcl_link_works=yes ; LIBTCL="-ltcl")]
		    )]
	    	)]
	    )]
	)]
    )]
)

dnl check if libtclstub library links
tclstub_link_works=no
LIBTCLSTUB=""
AC_CHECK_LIB(tclstub8.6, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub8.6",
    [AC_CHECK_LIB(tclstub86, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub86",
	[AC_CHECK_LIB(tclstub8.5, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub8.5",
	    [AC_CHECK_LIB(tclstub85, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub85",
	    	[AC_CHECK_LIB(tclstub8.4, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub8.4",
		    [AC_CHECK_LIB(tclstub84, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub84",
			[AC_CHECK_LIB(tclstub, Tcl_InitStubs, tclstub_link_works=yes ; LIBTCLSTUB="-ltclstub")]
		    )]
		)]
	    )]
	)]
    )]
)

dnl check if libtk library links
tk_link_works=no
LIBTK=""
AC_CHECK_LIB(tk8.6, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk8.6",
    [AC_CHECK_LIB(tk86, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk86",
	[AC_CHECK_LIB(tk8.5, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk8.5",
	    [AC_CHECK_LIB(tk85, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk85",
		[AC_CHECK_LIB(tk8.4, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk8.4",
		    [AC_CHECK_LIB(tk84, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk84",
			[AC_CHECK_LIB(tk, Tk_MainLoop, tk_link_works=yes ; LIBTK="-ltk")]
		    )]
	        )]
	    )]
	)]
    )]
)

dnl check if libtkstub library links
tkstub_link_works=no
LIBTKSTUB=""
PRELIBS="$LIBS"
LIBS="$LIBS $LIBTCLSTUB"
AC_CHECK_LIB(tkstub8.6, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub8.6",
    [AC_CHECK_LIB(tkstub86, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub86",
	[AC_CHECK_LIB(tkstub8.5, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub8.5",
	    [AC_CHECK_LIB(tkstub85, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub85",
	    	[AC_CHECK_LIB(tkstub8.4, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub8.4",
		    [AC_CHECK_LIB(tkstub84, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub84",
			[AC_CHECK_LIB(tkstub, Tk_InitStubs, tkstub_link_works=yes ; LIBTKSTUB="-ltkstub")]
		    )]
		)]
	    )]
	)]
    )]
)
LIBS="$PRELIBS"

dnl check if libitcl library links
itcl_link_works=no
LIBITCL=""
AC_CHECK_LIB(itcl3.4, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl3.4",
    [AC_CHECK_LIB(itcl34, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl34",
	[AC_CHECK_LIB(itcl3.3, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl3.3",
	    [AC_CHECK_LIB(itcl33, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl33",
		[AC_CHECK_LIB(itcl3.2, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl3.2",
		    [AC_CHECK_LIB(itcl32, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl32",
			[AC_CHECK_LIB(itcl, Itcl_Init, itcl_link_works=yes ; LIBITCL="-litcl")]
		    )]
		)]
	    )]
	)]
    )]
)

dnl check if libitk library links
itk_link_works=no
LIBITK=""
AC_CHECK_LIB(itk3.4, Itk_Init, itk_link_works=yes ; LIBITK="-litk3.4",
    [AC_CHECK_LIB(itk34, Itk_Init, itk_link_works=yes ; LIBITK="-litk34",
	[AC_CHECK_LIB(itk3.3, Itk_Init, itk_link_works=yes ; LIBITK="-litk3.3",
	    [AC_CHECK_LIB(itk33, Itk_Init, itk_link_works=yes ; LIBITK="-litk33",
		[AC_CHECK_LIB(itk3.2, Itk_Init, itk_link_works=yes ; LIBITK="-litk3.2",
		    [AC_CHECK_LIB(itk32, Itk_Init, itk_link_works=yes ; LIBITK="-litk32",
			[AC_CHECK_LIB(itk, Itk_Init, itk_link_works=yes ; LIBITK="-litk")]
		    )]
		)]
	    )]
	)]
    )]
)

dnl check if a socket library links
socket_link_works=no
LIBSOCKET=""
AC_CHECK_LIB(socket, socket, socket_link_works=yes ; LIBSOCKET="-lsocket")

dnl check if a network socket library links
nsl_link_works=no
LIBNSL=""
AC_CHECK_LIB(nsl, gethostbyaddr, nsl_link_works=yes ; LIBNSL="-lnsl")

dnl check if a network library links
newtork_link_works=no
LIBNETWORK=""
AC_CHECK_LIB(network, socket, network_link_works=yes ; LIBNETWORK="-lnetwork")

dnl check if a malloc library links
malloc_link_works=no
LIBMALLOC=""
AC_CHECK_LIB(c, mallopt, malloc_link_works=yes ; LIBMALLOC="-lc",
    [AC_CHECK_LIB(malloc, mallopt, malloc_link_works=yes ; LIBMALLOC="-lmalloc")]
)

dnl check if a mx library links
mx_link_works=no
LIBMX=""
AC_CHECK_LIB(mx, matherr, mx_link_works=yes ; LIBMX="-lmx")

dnl check if a dynamic link library links
dl_link_works=no
LIBDL=""
AC_CHECK_LIB(dl, dlopen, dl_link_works=yes ; LIBDL="-ldl")

dnl check if the SGI generic SCSI library links
ds_link_works=no
LIBDS=""
AC_CHECK_LIB(ds, dsopen, ds_link_works=yes ; LIBDS="-lds")

dnl check if an OpenGL graphics library links
gl_link_works=no
LIBGL=""
if test "x$bc_with_opengl" != "xno" ; then
    AC_CHECK_LIB(GL, glEnable, gl_link_works=yes ; LIBGL="$LIBGL -lGL",
	 [AC_CHECK_LIB(GL2, glEnable, gl_link_works=yes ; LIBGL="$LIBGL -lGL2")]
    )
    if test "x$gl_link_works" = "xno" ; then
	PRELDFLAGS="$LDFLAGS"
	PRELIBS="$LIBS"
	for bc_dir in "$ac_x_libraries" `echo "$ac_x_includes $ac_x_header_dirs" |
		sed s/include/lib/g` ; do

	    GL_LDFLAGS="-L$bc_dir"
	    LDFLAGS="$PRELDFLAGS $GL_LDFLAGS"
	    LIBS="$PRELIBS -lGL"
	    AC_LINK_IFELSE([AC_LANG_CALL([],[glEnable])],
		gl_link_works=yes ; LIBGL="-L$bc_dir -lGL" ; break)
	    LIBS="$PRELIBS -lGL2"
	    AC_LINK_IFELSE([AC_LANG_CALL([],[glEnable])],
		gl_link_works=yes ; LIBGL="-L$bc_dir -lGL2" ; break)
	done
	LDFLAGS="$PRELDFLAGS"
	LIBS="$PRELIBS"
    fi

    # Mac OS X 10.5 has a linker bug resulting in the following error:
    #   ld: cycle in dylib re-exports with /usr/X11/lib/libGL.dylib
    #
    # This fixes that error by forcing the GL exports specified in the
    # /usr/X11/lib dylib to use the framework dylib instead of being a
    # cyclic dependency due to search paths.  Fugly workaround.

    if test "x$gl_link_works" = "xno" ; then
	unset ac_cv_lib_GL_glEnable # disable cache result
	PRELDFLAGS="$LDFLAGS"
	GL_LDFLAGS="-Wl,-dylib_file -Wl,/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib"
	LDFLAGS="$PRELDFLAGS $GL_LDFLAGS"
	LIBGL=-lGL
	AC_CHECK_LIB(GL, glEnable, gl_link_works=yes)
	# leave LDFLAGS set with this gl workaround
	# LDFLAGS="$PRELDFLAGS"
	if test "x$gl_link_works" = "xno" ; then
	    GL_LDFLAGS=""
	    LIBGL=""
	fi
    fi
fi

dnl check if the Windows WGL graphics library links
wgl_link_works=no
LIBWGL=""
if test "xbc_with_wgl" != "xno" ; then
    AC_CHECK_LIB(opengl32, glEnable, wgl_link_works=yes ; LIBWGL="-lopengl32")
fi

dnl check if the SGI graphics library links
sgigl_link_works=no
LIBSGIGL=""
AC_CHECK_LIB(gl, gconfig, sgigl_link_works=yes ; LIBSGIGL="-lgl")

dnl check if the Solaris lexer library links
l_link_works=no
LIBL=""
AC_CHECK_LIB(l, yyless, l_link_works=yes ; LIBL="-ll")

dnl check for the IRIX libgen library (for basename/dirname)
gen_link_works=no
LIGEN=""
AC_CHECK_LIB(gen, basename, gen_link_works=yes ; LIBGEN="-lgen")

dnl check if the standard c++ library links without checking for any particular symbol
dnl library is needed when linking c++ code against c code (e.g. openNURBS)
stdcxx_link_works=no
LIBSTDCXX=""
AC_CHECK_LIB(stdc++, main, stdcxx_link_works=yes ; LIBSTDCXX="-lstdc++",
	[PRELIBS="$LIBS"
	 LIBS="$LIBS $LIBM"
	 AC_CHECK_LIB(stdc++, main, stdcxx_link_works=yes ; LIBSTDCXX="-lstdc++ $LIBM"
	 LIBS="$PRELIBS"
	 )]
)


dnl *************************
dnl *** Check for headers ***
dnl *************************

BC_CONFIGURE_STAGE([headers], [4 of 9])

# make our minimum compliance goal explicit (needs to be tested here
# so header files and types are tested properly)
dnl BC_COMPILER_AND_LINKER_RECOGNIZES([-std=c99], [cstd], [no])
dnl if test "x$bc_cstd_works" = "xyes" ; then
dnl     CFLAGS="$CFLAGS -std=c99"
dnl fi

# C89 headers: assert.h, ctype.h, errno.h, float.h, limits.h, locale.h,
# math.h, setjmp.h, signal.h, stdarg.h, stddef.h, stdio.h, stdlib.h,
# string.h, time.h

# C95 headers: wchar.h, wctype.h, iso646.h

# C99 headers: complex.h, fenv.h, inttypes.h, stdbool.h, stdint.h,
# tgmath.h

# POSIX.1 headers includes C89, C95, and C99 plus the following:
# aio.h, arpa/inet.h, cpio.h, dirent.h, dlfcn.h, fcntl.h, fmtmsg.h,
# fnmatch.h, ftw.h, glob.h, grp.h, iconv.h, langinfo.h, libgen.h,
# monetary.h, mqueue.h, ndbm.h, net/if.h, netdb.h, netinet/in.h,
# netinet/tcp.h, nl_types.h, poll.h, pthread.h, pwd.h, regex.h,
# sched.h, search.h, semaphore.h, spawn.h, strings.h, stropts.h,
# sys/ipc.h, sys/mman.h, sys/msg.h, sys/resource.h, sys/select.h,
# sys/stat.h, sys/statvfs.h, sys/time.h, sys/timeb.h, sys/times.h,
# sys/types.h, sys/uio.h, sys/un.h, sys/utsname.h, sys/wait.h,
# syslog.h, tar.h, termios.h, trace.h, ucontext.h, ulimit.h, unistd.h,
# utime.h, utmpx.h, wordexp.h

AC_HEADER_STDC
AC_HEADER_DIRENT
AC_HEADER_SYS_WAIT
AC_CHECK_HEADERS( \
	Carbon/Carbon.h \
	curses.h \
	dslib.h \
	getopt.h \
	gl/device.h \
	grp.h \
	inttypes.h \
	io.h \
	libgen.h \
	memory.h \
	ncurses.h \
	netinet/in.h \
	poll.h \
	pthread.h \
	pwd.h \
	rle.h \
	sched.h \
	sgtty.h \
	stdint.h \
	sys/file.h \
	sys/_ioctl.h \
	sys/ioctl.h \
	sys/ioctl_compat.h \
	sys/machd.h \
	sys/mman.h \
	sys/param.h \
	sys/prctl.h \
	sys/select.h \
	sys/socket.h \
	sys/stat.h \
	sys/sysctl.h \
	sys/sysinfo.h \
	sys/sysmp.h \
	sys/time.h \
	sys/times.h \
	sys/types.h \
	sys/un.h \
	sys/wait.h \
	syslog.h \
	tcl.h \
	termcap.h \
	terminfo.h \
	termio.h \
	termios.h \
	termlib.h \
	tinfo.h \
	tk.h \
	ulocks.h \
	unistd.h \
	winsock.h \
)

# specifically for openNURBS
AC_CHECK_HEADERS( \
	ieeefp.h \
)

AC_LANG_PUSH([C++])
AC_CHECK_HEADERS( \
	limits \
	istream \
)
AC_LANG_POP

if test "x$bc_with_dtrace" != "xno" ; then
    AC_CHECK_HEADER(sys/sdt.h,, [bc_with_dtrace=no])
fi

GL_H_CPPFLAGS=""
GLX_H_CPPFLAGS=""
PRECPPFLAGS="$CPPFLAGS"
# optionally check for OpenGL headers
if test "x$bc_with_opengl" != "xno" -o "x$bc_with_wgl" != "xno" ; then
    gl_include_works=no
    unset ac_cv_header_GL_gl_h
    AC_CHECK_HEADER([GL/gl.h], [
	AC_DEFINE(HAVE_GL_GL_H, 1, [Define to 1 if you have the <GL/gl.h> header file.])
	gl_include_works="yes"
    ], [unset ac_cv_header_GL_gl_h])
    # didn't find header, try harder
    if test "x$gl_include_works" = "xno" ; then
	# this won't work for paths with spaces
	for bc_dir in "$ac_x_includes" `echo $ac_x_header_dirs` `echo $ac_x_libraries | sed 's/\/lib/\/include/g'`; do
	    GL_H_CPPFLAGS="-I$bc_dir"
	    CPPFLAGS="$PRECPPFLAGS $GL_H_CPPFLAGS"
	    AC_MSG_NOTICE([ .. looking in $bc_dir for gl.h])
	    AC_CHECK_HEADER([GL/gl.h], [
		AC_DEFINE(HAVE_GL_GL_H, 1, [Define to 1 if you have the <GL/gl.h> header file.])
		gl_include_works="yes"
		break
	    ], [unset ac_cv_header_GL_gl_h])
	done
    fi
    CPPFLAGS="$PRECPPFLAGS"

    glx_include_works=no
    unset ac_cv_header_GL_glx_h
    AC_CHECK_HEADER([GL/glx.h], [
	AC_DEFINE(HAVE_GL_GLX_H, 1, [Define to 1 if you have the <GL/glx.h> header file.])
	glx_include_works="yes"
    ], [unset ac_cv_header_GL_glx_h])
    # didn't find header, try harder
    if test "x$glx_include_works" = "xno" ; then
	# this won't work for paths with spaces
	for bc_dir in "$ac_x_includes" `echo $ac_x_header_dirs` `echo $ac_x_libraries | sed 's/\/lib/\/include/g'`; do
	    GLX_H_CPPFLAGS="-I$bc_dir"
	    CPPFLAGS="$PRECPPFLAGS $GLX_H_CPPFLAGS"
	    AC_MSG_NOTICE([ .. looking in $bc_dir for glx.h])
	    AC_CHECK_HEADER([GL/glx.h], [
	    	AC_DEFINE(HAVE_GL_GLX_H, 1, [Define to 1 if you have the <GL/glx.h> header file.])
		glx_include_works="yes"
		break
	    ], [unset ac_cv_header_GL_glx_h])
	done
    fi
    CPPFLAGS="$PRECPPFLAGS"
fi # bc_with_opengl
GL_CPPFLAGS="$GL_H_CPPFLAGS $GLX_H_CPPFLAGS"
AC_SUBST(GL_CPPFLAGS)


# optionally (yes or auto) check for vectorization headers for opennurbs
if test "x$bc_build_opennurbs" != "xno" ; then
    AC_CHECK_HEADERS( \
	emmintrin.h \
    )
fi # bc_build_opennurbs

AC_CHECK_HEADER(sys/sched.h,
		AC_DEFINE(HAVE_SYS_SCHED_H, 1, Define to 1 if you have the <sys/sched.h> header file.),,
		[
#ifdef HAVE_PTHREAD_H
#  include <pthread.h>
#endif
#include <sys/sched.h>
])

AC_CHECK_HEADER(sys/mount.h,
		AC_DEFINE(HAVE_SYS_MOUNT_H,1, Define to 1 if you have the <sys/mount.h> header file.),,
		[
#ifdef HAVE_SYS_PARAM_H
#  include <sys/param.h>
#endif
#include <sys/mount.h>
])

AC_CHECK_HEADER(term.h,
		AC_DEFINE(HAVE_TERM_H, 1, Define to 1 if you have the <term.h> header file.),,
		[
#if HAVE_NCURSES_H
#  include <ncurses.h>
#else
#  ifdef HAVE_CURSES_H
#    include <curses.h>
#  else
#    ifdef HAVE_TERMCAP_H
#      include <termcap.h>
#    else
#      ifdef HAVE_TERMINFO_H
#        include <terminfo.h>
#      else
#        ifdef HAVE_TINFO_H
#          include <tinfo.h>
#        endif
#      endif
#    endif
#  endif
#endif
#include <term.h>
])

found_regex_h=no
AC_CHECK_HEADER(regex.h,
		AC_DEFINE(HAVE_REGEX_H,1,[Define to 1 if you have the '<regex.h>' header file])
		found_regex_h=yes )


# check for java headers
if test "x$bc_with_java " != "xno" ; then
    PRECPPFLAGS="$CPPFLAGS"
    CPPFLAGS="$CPPFLAGS $JAVA_CFLAGS"
    found_jni_h=no
    AC_CHECK_HEADER(JavaVM/jni.h,
		    AC_DEFINE(HAVE_JAVAVM_JNI_H,1,[Define to 1 if you have the '<JavaVM/jni.h>' header file])
		    found_jni_h=yes)
    AC_CHECK_HEADER(jni.h,
		    AC_DEFINE(HAVE_JNI_H,1,[Define to 1 if you have the '<jni.h>' header file])
		    found_jni_h=yes )

    search_for_jni_h_more=no
    if test "x$found_jni_h" = "xno" ; then
	if test "x$bc_only_rts" = "xyes" ; then
	    search_for_jni_h_more=yes
	fi
    fi

    if test "x$search_for_jni_h_more" = "xyes" ; then
	# darwin systems may have a prior jni.h stashed away elsewhere
	macjvmdir=/System/Library/Frameworks/JavaVM.framework/Versions
	if test -d "$macjvmdir"  ; then
	    for dir in `ls $macjvmdir` ; do
		if test -d "$macjvmdir/$dir/Headers" ; then
		    JAVA_CFLAGS="$JAVA_CFLAGS -I$macjvmdir/$dir/Headers"
		    CPPFLAGS="$CPPFLAGS -I$macjvmdir/$dir/Headers"
		fi
	    done
	fi

	# try one last time to find jni.h (must disable cached result)
	unset ac_cv_header_jni_h
	AC_CHECK_HEADER(jni.h,
			AC_DEFINE(HAVE_JNI_H,
				  1,
				  [Define to 1 if you have the '<jni.h>' header file])
			found_jni_h=yes )

	if test "x$found_jni_h" != "xno" ; then
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_WARN([jni.h was found by hunting through the JavaVM framework])
	    AC_MSG_WARN([This means you probably need to install the latest Java SDK])
	    AC_MSG_WARN([Build will try to use what it found, but you should update])
	    AC_MSG_NOTICE([See http://developer.apple.com/java/ for updates])
	    AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
	    sleep 5
	fi
    fi # search_for_jni_h_more
    CPPFLAGS="$PRECPPFLAGS"
fi # bc_with_java

# check for proe headers
PROE_CFLAGS=""
if test "x$bc_with_proe" != "xno" ; then
   PRE_CFLAGS="$CFLAGS"
   found_protk_h=no
   if test "x$bc_with_proe" = "xyes" ; then
      if test "x$bc_with_proe_val" = "x" ; then
            found_proe_base=no
	    proe_base=/usr/local/ptc/proeWildfire3.0
	    if test -e "$proe_base" ; then
	       found_proe_base=yes
	       PROE_CFLAGS="-I$proe_base/protoolkit/includes -I$proe_base/prodevelop/includes"
	       CFLAGS="$CFLAGS $PROE_CFLAGS"
	       AC_CHECK_HEADER(ProToolkit.h,
			 AC_DEFINE(HAVE_PROTOOLKIT,1,[Define to 1 if you have Pro/TOOLKIT header files])
			 found_protk_h=yes)
	       if test "x$found_protk_h" = "xyes" ; then
		  bc_with_proe_val=$proe_base
		  PRO_ENGINEER_DIR=$bc_with_proe_val
		  AC_SUBST(PRO_ENGINEER_DIR)
	       fi
	    fi
      else
        PROE_CFLAGS="-I$bc_with_proe_val/protoolkit/includes -I$bc_with_proe_val/prodevelop/includes"
        CFLAGS="$CFLAGS $PROE_CFLAGS"
        AC_CHECK_HEADER(ProToolkit.h,
		        AC_DEFINE(HAVE_PROTOOLKIT,1,[Define to 1 if you have Pro/TOOLKIT header files])
		        found_protk_h=yes)
      fi
   fi
   CFLAGS="$PRE_CFLAGS"
fi


dnl **********************************
dnl *** Check for types/structures ***
dnl **********************************

BC_CONFIGURE_STAGE([types], [5 of 9])

dnl added in autoconf 2.55
dnl AC_HEADER_STDBOOL

AC_C_CHAR_UNSIGNED
AC_HEADER_STAT
AC_HEADER_TIME
AC_STRUCT_ST_BLOCKS
AC_STRUCT_ST_BLKSIZE
AC_CHECK_MEMBERS([struct stat.st_blksize])
AC_CHECK_MEMBERS([struct stat.st_rdev])
AC_STRUCT_TM
AC_TYPE_UID_T
AC_TYPE_MODE_T
AC_TYPE_OFF_T
AC_TYPE_PID_T
AC_TYPE_SIZE_T
AC_CHECK_TYPE([socklen_t], [],
    AC_DEFINE([socklen_t], [int], [Define to int if <sys/socket.h> nor <sys/types.h> define socklen_t]),
    [
#ifdef HAVE_SYS_TYPES_H
#  include <sys/types.h>
#endif
#ifdef HAVE_SYS_SOCKET_H
#  include <sys/socket.h>
#endif
])
AC_CHECK_TYPES([sig_t], [], [], [#include <signal.h>])


dnl ******************************************
dnl *** Check for compiler characteristics ***
dnl ******************************************

BC_CONFIGURE_STAGE([compiler], [6 of 9])

if test "xyes" = "xyes" ; then

    dnl try to use -pipe to speed up the compiles
    BC_COMPILER_AND_LINKER_RECOGNIZES([-pipe])


    dnl check for -fno-strict-aliasing
    dnl XXX - THIS FLAG IS REQUIRED if any level of optimization is
    dnl enabled with GCC as we do use aliasing and type-punning.
    BC_COMPILER_AND_LINKER_RECOGNIZES([-fno-strict-aliasing])

    dnl check for -fno-common (libtcl needs it on darwin)
    BC_COMPILER_AND_LINKER_RECOGNIZES([-fno-common])

    dnl check for -fexceptions
    dnl this is needed to resolve __Unwind_Resume when compiling and
    dnl linking against openNURBS in librt for some binaries, for
    dnl example rttherm (i.e. any -static binaries)
    BC_COMPILER_AND_LINKER_RECOGNIZES([-fexceptions], [fexceptions])
    if test "x$bc_fexceptions_works" = "xyes" ; then
       FEXCEPTIONS="-fexceptions"
       AC_SUBST(FEXCEPTIONS)
    fi

    dnl check for -ftemplate-depth-NN this is needed in libpc and
    dnl other code using boost where the template instantiation depth
    dnl needs to be increased from the default ANSI minimum of 17.
    BC_COMPILER_RECOGNIZES([-ftemplate-depth-50], [template_depth], [nokeep])
    if test "x$bc_template_depth_works" = "xyes" ; then
	TEMPLATE_DEPTH="-ftemplate-depth-50"
	AC_SUBST(TEMPLATE_DEPTH)
    fi

    dnl dynamic SSE optimizations for NURBS processing
dnl
dnl XXX disable the SSE flags for now as they can cause illegal instructions.
dnl     the test needs to also be tied to run-time functionality since gcc
dnl     may still output SSE instructions (e.g., for cross-compiling).
dnl
dnl     BC_COMPILER_AND_LINKER_RECOGNIZES([-msse], [msse], [nokeep])
dnl     MSSE=""
dnl     if test "x$bc_msse_works" = "xyes" ; then
dnl        MSSE="-msse"
dnl     fi
dnl     MSSE2=""
dnl     BC_COMPILER_AND_LINKER_RECOGNIZES([-msse2], [msse2], [nokeep])
dnl     if test "x$bc_msse2_works" = "xyes" ; then
dnl        MSSE2="-msse2"
dnl     fi
dnl     SSE="$MSSE $MSSE2"
dnl     AC_SUBST(SSE)

    dnl check for -search_paths_first linker flag.
    dnl prevent a false-positive where it can be treated as a -s and-e
    dnl linker option by adding a benign flag that should succeed.
    dnl this flag allows dylibs and archives to be found based on a
    dnl library path search order, not biasing a preference for dylibs.
    BC_LINKER_RECOGNIZES([-Wl,-search_paths_first -Wnewline-eof])

    dnl 64bit compilation flags
    if test "x$bc_build_64bit" = "xyes" ; then
	found_64bit_flag=no

	AC_MSG_CHECKING([if configure snuck on a 32bit flag to ld])
	PRELD="$LD"
	LD="`echo $LD | sed 's/32/64/'`"
	if test "x$LD" = "x$PRELD" ; then
		AC_MSG_RESULT(no)
	else
		AC_MSG_RESULT(yes)
	fi

	if test "x$found_64bit_flag" = "xno" ; then
		BC_COMPILER_AND_LINKER_RECOGNIZES([-64], [64_flag])
		if test "x$bc_64_flag_works" = "xyes" ; then
			found_64bit_flag=yes
		fi
	fi

	if test "x$found_64bit_flag" = "xno" ; then
		BC_COMPILER_AND_LINKER_RECOGNIZES([-mabi=64], [64_flag])
		if test "x$bc_64_flag_works" = "xyes" ; then
			found_64bit_flag=yes
		fi
	fi

	if test "x$found_64bit_flag" = "xno" ; then
		BC_COMPILER_AND_LINKER_RECOGNIZES([-m64], [64_flag])
		if test "x$bc_64_flag_works" = "xyes" ; then
			found_64bit_flag=yes
		fi
	fi

	if test "x$found_64bit_flag" = "xno" ; then
		BC_COMPILER_AND_LINKER_RECOGNIZES([-q64], [64_flag])
		if test "x$bc_64_flag_works" = "xyes" ; then
			found_64bit_flag=yes
		fi
	fi
    fi

# end check for automatic flags
fi

dnl profile flags
if test "x$bc_use_profiling" != "xno" ; then
	BC_COMPILER_AND_LINKER_RECOGNIZES([-pg], [profile_flag])
	if test "x$bc_profile_flag_works" = "xno" ; then
		# intel gprof compiler flag
		BC_COMPILER_AND_LINKER_RECOGNIZES([-p], [profile_flag])
	fi

	if test "x$bc_profile_flag_works" = "xno" ; then
		# no profiling
		if test "x$bc_use_profiling" = "xyes" ; then
			dnl profiling was requested, so abort
			AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
			AC_MSG_NOTICE([Profiling was enabled but could not find a profile flag])
			AC_MSG_ERROR([*** Don't know how to profile with this compiler ***])
		fi
		AC_MSG_WARN([Don't know how to profile with this compiler])
		sleep 1
	else
		# profiling works
		if test "x$bc_use_profiling" = "xauto" ; then
			# convert 'auto' to 'no' even though it works
			bc_use_profiling=no
		fi
	fi
fi

dnl debug flags
if test "x$bc_use_debug" != "xno" ; then
	BC_COMPILER_AND_LINKER_RECOGNIZES([-g], [debug_flag])
	if test "x$bc_debug_flag_works" = "xno" ; then
		# no debug
		if test "x$bc_use_debug" = "xyes" ; then
			dnl debug was requested, so abort
			AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
			AC_MSG_NOTICE([Debug was enabled but -g does not work])
			AC_MSG_ERROR([*** Don't know how to debug with this compiler ***])
		fi
		AC_MSG_WARN([Do not know how to debug with this compiler])
		sleep 1
	else
		# debug works
		if test "x$bc_use_debug" = "xauto" ; then
			# convert 'auto' to 'yes'
			bc_use_debug="yes"
		fi
	fi
fi

dnl optimization flags
if test "x$bc_use_optimized" != "xno" ; then
	BC_COMPILER_AND_LINKER_RECOGNIZES([-O3], [o3_flag])
	if test "x$bc_o3_flag_works" = "xno" ; then
		AC_MSG_WARN([Don't know how to compile optimized with this compiler])
		sleep 1
	fi


# -fast provokes a stack corruption in the shadow computations because
# of strict aliasing getting enabled.  we _require_
# -fno-strict-aliasing until someone changes how lists are managed.
#
#	BC_COMPILER_AND_LINKER_RECOGNIZES([-fast], [mac_opt_flag])
#	if test "x$bc_mac_opt_flag_works" = "xno" ; then
#		BC_COMPILER_AND_LINKER_RECOGNIZES([-fast -mcpu=7450], [mac_opt_flag])
#	fi
	if test "xdisabled" = "xyes" ; then
		extra_optimization_flag="-ffast-math -fstrength-reduce -fexpensive-optimizations -finline-functions"
		if test "x$bc_use_debug" = "xno" ; then
			dnl non-debug can omit the frame pointer, debug cannot
			extra_optimization_flag="$extra_optimization_flag -fomit-frame-pointer"
		else
			extra_optimization_flag="$extra_optimization_flag -fno-omit-frame-pointer"
		fi
		BC_COMPILER_AND_LINKER_RECOGNIZES([$extra_optimization_flag])
	fi
fi

dnl verbose warning flags (if yes or auto)
if test "x$bc_build_warnings" != "xno" ; then
	BC_COMPILER_AND_LINKER_RECOGNIZES([-W -Wall -Wundef -Wfloat-equal -Wshadow -Wunreachable-code -Winline], [warning])
	# XXX also of interest
	# -Wmissing-declarations -Wmissing-prototypes -Wstrict-prototypes -pedantic -ansi -Werror

	if test "x$bc_warning_flag_works" = "xno" ; then
		AC_MSG_WARN([Don't know how to output verbose warnings with this compiler])
		sleep 1
	fi
fi

dnl we are more strict on clean dirs by default (no-long-long needed due to tcl.h)
if test "x$bc_build_strict" = "xyes" ; then
   BC_COMPILER_AND_LINKER_RECOGNIZES([-w -pedantic -W -Wall -Werror -Wno-long-long], [strict], [no])
   if test "x$bc_strict_works" = "xyes" ; then
       # do not include -w as that was just to suppress any test warnings
       STRICT_FLAGS="-pedantic -W -Wall -Werror -Wno-long-long"
       AC_SUBST(STRICT_FLAGS)
       AC_DEFINE([STRICT_FLAGS], [1], [Define to 1 if enabling strict compiler flags.])
   fi
fi

# determine the minimum single-precision floating point tolerance
# value at compile time such that: 1.0 + value != 1.0
# ANSI defines this as FLT_EPSILON but float.h may not provide it.
BC_FLOAT_EPSILON

# determine the minimum double-precision floating point tolerance
# value at compile time such that: 1.0 + value != 1.0
# ANSI defines this as DBL_EPSILON but float.h may not provide it.
BC_DOUBLE_EPSILON

# determine whether the single-precision floating point implementation
# seems IEEE 754 compliant.
BC_COMPLIANT_FLOAT

# determine whether the double-precision floating point implementation
# seems IEEE 754 compliant.
BC_COMPLIANT_DOUBLE

# warn if either floating point compliance failed
if test "x$bc_compliant_float" = "xno" || test "x$bc_compliant_double" = "xno" ; then
    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
    AC_MSG_WARN([The floating point implementation does not seem to be IEEE 754])
    AC_MSG_WARN([compliant.  The behavior of htond and htonf may be incorrect.])
    AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
    sleep 5
fi

AC_C_CONST
AC_C_INLINE
AC_C_VOLATILE
AC_C_BIGENDIAN

# figure out what size pointers the compiler is actually generating
AC_CHECK_SIZEOF(int)
AC_CHECK_SIZEOF(long)
AC_CHECK_SIZEOF(long long)
AC_CHECK_SIZEOF(void *, 4)
pointer_size="$ac_cv_sizeof_void_p"

dnl Make sure that we can actually compile C code
BC_SANITY_CHECK([$CC compiler and flags for sanity])

dnl Make sure that we can actually compile C++ code
AC_LANG_PUSH([C++])
BC_SANITY_CHECK([$CXX compiler and flags for sanity])
AC_LANG_POP


dnl ***************************
dnl *** Check for functions ***
dnl ***************************

BC_CONFIGURE_STAGE([functions], [7 of 9])

AC_TYPE_SIGNAL

# specifically not checked for and not used:
#   access - security concerns

# specifically not checked for but used including any well-behaved
# C89/posix functions.  this includes:
#   stat

# specifically checked for even though C89 (provided by libsysv):
#   memset, strchr, strtok

# some C89 functions: assert, isalnum, isalpha, iscntrl, isdigit,
# isgraph, islower, isprint, ispunct, isspace, isupper, isxdigit,
# tolower, toupper, localeconv, setlocale, acos, asin, atan, atan2,
# ceil, cos, cosh, exp, fabs, floor, fmod, frexp, ldexp, log, log10,
# modf, pow, sin, sinh, sqrt, tan, longjmp, setjmp, raise, signal,
# va_arg, va_end, va_start, offsetof, clearerr, fclose, feof, ferror,
# fflush, fgetc, fgetpos, fgets, fopen, fprintf, fputc, fputs, fread,
# freopen, fscanf, fseek, fsetpos, fwrite, getc, getchar, gets,
# perror, printf, putc, putchar, puts, remove, rename, rewind, scanf,
# setbuf, setvbuf, sprintf, sscanf, tmpfile, tmpnam, ungetc, vprintf,
# vsprintf, abort, abs, atexit, atof, atoi, atol, bsearch, calloc,
# div, exit, free, ftell, getenv, labs, ldiv, malloc, mblen, mbtowcs,
# mbtowc, qsort, rand, realloc, sizeof, srand, strtod, strtol,
# strtoul, system, wctomb, wcstombs, memchr, memcmp, memcpy, memmove,
# memset, strcat, strchr, strcmp, strcoll, strcpy, strcspn, strerror,
# strlen, strncat, strncmp, strncpy, strpbrk, strrchr, strspn, strstr,
# strtok, strxfrm, asctime, clock, ctime, difftime, gmtime, localtime,
# mktime, strftime, time

AC_CHECK_FUNCS(\
	XQueryExtension \
	alarm \
	dlopen \
	drand48 \
	fchmod \
	fsync \
	getegid \
	geteuid \
	gethostname \
	getloadavg \
	getopt_long \
	getprogname \
	kill \
	lrand48 \
	memset \
	mkstemp \
	pipe \
	popen \
	random \
	sbrk \
	setenv \
	setpgid \
	setpriority \
	setprogname \
	srand48 \
	strchr \
	strdup \
	strlcat \
	strlcpy \
	strsep \
	strtok \
	sync \
	sysctl \
	sysmp \
	vfork \
	writev \
)

dnl *** check if basename() exists ***
AC_MSG_CHECKING([for basename])
PRELIBS="$LIBS"
LIBS="$LIBS $LIBGEN"
AC_TRY_RUN([
#ifdef HAVE_LIBGEN_H
#  include <libgen.h>
#endif
int main(int argc, char *argv[]) {
  (void)basename(argv[0]);
  return 0;
}],
[ AC_MSG_RESULT(yes)
  AC_DEFINE([HAVE_BASENAME], [1], [Define to 1 if you have the `basename' function.])
],
[ AC_MSG_RESULT(no) ])
LIBS="$PRELIBS"

dnl *** check if dirname() exists ***
AC_MSG_CHECKING([for dirname])
PRELIBS="$LIBS"
LIBS="$LIBS $LIBGEN"
AC_TRY_RUN([
#ifdef HAVE_LIBGEN_H
#  include <libgen.h>
#endif
int main(int argc, char *argv[]) {
  (void)dirname(argv[0]);
  return 0;
}],
[ AC_MSG_RESULT(yes)
  AC_DEFINE([HAVE_DIRNAME], [1], [Define to 1 if you have the `dirname' function.])
],
[ AC_MSG_RESULT(no) ])
LIBS="$PRELIBS"


dnl *********************************
dnl *** Check for system services ***
dnl *********************************

BC_CONFIGURE_STAGE([services], [8 of 9])

dnl *** check for bison/yacc or flex/lex ***
# scanner and parser are optionally needed for mged and other tools
# that utilize a parser.  if both are found, provide a make var so we
# can conditionally compile the parsers.
build_parsers=no
if test "x$ac_cv_prog_LEX" != "x" ; then
    if test "x$ac_cv_prog_YACC" != "x" ; then
	# we have both
	build_parsers=yes
    else
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_WARN([A YACC-style parser was not found so dependant portions of the package])
	AC_MSG_WARN([(various MGED commands and STEP conversion support) will be disabled.])
	AC_MSG_NOTICE([Installation of GNU Bison or Yacc before continuing is recommended.])
	AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
	sleep 5
    fi
else
    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
    if test "x$ac_cv_prog_YACC" != "x" ; then
	AC_MSG_WARN([A LEX-style scanner was not found so dependant portions of the package])
	AC_MSG_WARN([(various MGED commands and STEP conversion support) will be disabled.])
	AC_MSG_NOTICE([Installation of GNU Flex or Lex before continuing is recommended.])
    else
	AC_MSG_WARN([Neither a YACC-style parser or a LEX-style scanner was found.])
	AC_MSG_WARN([Dependant portions of the package will be disabled.])
	AC_MSG_NOTICE([Installation of Bison/Yacc and Flex/Lex before continuing is recommended.])
    fi
    AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
    sleep 5
fi
AC_MSG_CHECKING([whether we have the essentials to make parsers])
if test "x$build_parsers" = "xyes" ; then
    AC_MSG_RESULT(yes)
    AC_DEFINE(BC_WITH_PARSERS, 1, [Define to enable compilation of parsers])
else
    AC_MSG_RESULT(no)
    if test "x$bc_build_step" = "xyes" ; then
	AC_MSG_NOTICE([STEP was enabled, but no system lexer/parser was found])
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_NOTICE([Try adding --disable-step-build])
	AC_MSG_ERROR([*** Building STEP support was enabled, yet no system lexer/parser was found ***])
    fi
    bc_build_step="no"
fi


dnl *** libpng ***
png_works=no
AC_MSG_CHECKING(for portable network graphics functionality)
PRELIBS="$LIBS"
LIBS="$LIBS $LIBPNG"
AC_TRY_RUN([
#include <png.h>
main() {
    int i = png_access_version_number();
    return 0;
}
], [png_works=yes])
LIBS="$PRELIBS"
AC_MSG_RESULT($png_works)

dnl figure out whether we need to build libpng
build_brlcad_png="no (using system)"
if test "x$bc_build_png" = "xyes" ; then
    build_brlcad_png=yes
else
    if test "x$bc_build_png" = "xno" ; then
	if test "x$png_works" != "xyes" ; then
	    AC_MSG_NOTICE([libpng was disabled, but no system png library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-png-build])
	    AC_MSG_ERROR([*** Building libpng was disabled, yet no system png library was found ***])
	fi
    else
	dnl automatic detection, we need to build if it won't run or won't link
	if test "x$png_works" = "xno" ; then
	    build_brlcad_png=yes
	elif test "x$png_link_works" = "xno" ; then
	    build_brlcad_png=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the included portable network graphics library)
PNG=""
PNG_CPPFLAGS=""
if test "x$build_brlcad_png" = "xyes" ; then
    PNG='${top_builddir}/src/other/libpng/libpng.la'
    PNG_CPPFLAGS='-I${top_srcdir}/src/other/libpng'
    AC_MSG_RESULT(yes)
else
    PNG="$LIBPNG"
    AC_MSG_RESULT(no)
fi
AC_SUBST(PNG)
AC_SUBST(PNG_CPPFLAGS)

dnl *** libregex ***
dnl See if regular expression support works
regex_works=no
AC_MSG_CHECKING(for regular expression functionality)
PRELIBS="$LIBS"
LIBS="$LIBS $LIBREGEX"
AC_TRY_RUN([
#ifdef HAVE_SYS_TYPES_H
#  include <sys/types.h>
#endif
#include <regex.h>
int main() {
    regex_t re;
    regcomp(&re, "abc", REG_EXTENDED);
    regexec(&re, "", 0, 0, 0);
    return 0;
}
], [regex_works=yes])
LIBS="$PRELIBS"
AC_MSG_RESULT($regex_works)

dnl figure out whether we need to build libregex
build_brlcad_regex="no (using system)"
if test "x$bc_build_regex" = "xyes" ; then
    build_brlcad_regex=yes
else
    if test "x$bc_build_regex" = "xno" ; then
	if test "x$regex_works" != "xyes" ; then
	    AC_MSG_NOTICE([libregex was disabled, but no system regular expression library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-regex-build])
	    AC_MSG_ERROR([*** Building libregex was disabled, yet no system regex was found ***])
	fi
    else
	dnl automatic detection
	if test "x$regex_works" = "xno" ; then
	    build_brlcad_regex=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the included regular expression library)
REGEX=""
REGEX_CPPFLAGS=""
if test "x$build_brlcad_regex" = "xyes" ; then
    REGEX='${top_builddir}/src/other/libregex/libregex.la'
    REGEX_CPPFLAGS='-I${top_srcdir}/src/other/libregex'
    AC_MSG_RESULT(yes)
else
    REGEX="$LIBREGEX"
    AC_MSG_RESULT(no)
fi
AC_SUBST(REGEX)
AC_SUBST(REGEX_CPPFLAGS)


dnl *** libz ***
dnl See if zlib library support works
zlib_works=no
AC_MSG_CHECKING(for zlib compression functionality)
PRELIBS="$LIBS"
LIBS="$LIBS $LIBZLIB"
AC_TRY_RUN([
#include <zlib.h>
int main () {
    char *zlibver = ZLIB_VERSION;
    return 0;
}
], [zlib_works=yes])
LIBS="$PRELIBS"
AC_MSG_RESULT($zlib_works)

dnl figure out whether we need to build libz
build_brlcad_zlib="no (using system)"
if test "x$bc_build_zlib" = "xyes" ; then
    build_brlcad_zlib=yes
else
    if test "x$bc_build_zlib" = "xno" ; then
	if test "x$zlib_works" != "xyes" ; then
	    AC_MSG_NOTICE([libz was disabled, but no system zlib compression library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-zlib-build])
	    AC_MSG_ERROR([*** Building libz was disabled, yet no system zlib compression library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$zlib_works" = "xno" ; then
	    build_brlcad_zlib=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the included zlib compression library)
LIBZ=""
LIBZ_CPPFLAGS=""
if test "x$build_brlcad_zlib" = "xyes" ; then
    LIBZ='${top_builddir}/src/other/libz/libz.la'
    LIBZ_CPPFLAGS='-I${top_srcdir}/src/other/libz'
    AC_MSG_RESULT(yes)
else
    LIBZ="$LIBZLIB"
    AC_MSG_RESULT(no)
fi
AC_SUBST(LIBZ)
AC_SUBST(LIBZ_CPPFLAGS)


dnl *** X11 interface compilation ***
build_against_x11="no"
if test "x$bc_with_x11" != "xno" ; then
    x11_works=no
    AC_MSG_CHECKING(for X11 header functionality)
    PRELIBS="$LIBS"
    PRECPPFLAGS="$CPPFLAGS"
    CPPFLAGS="$CPPFLAGS $X_CFLAGS"
    AC_TRY_RUN([
#include <X11/Xlib.h>
main() {
    XPoint pt;
    pt.x = pt.y = 0;
    return pt.x;
}
    ],[x11_works=yes])
    AC_MSG_RESULT($x11_works)
    if test "x$x11_works" = "xyes" ; then
	LIBS="$LIBS $X_LIBS"
	AC_MSG_CHECKING(for X11 link functionality)
	AC_TRY_RUN([
#include <X11/Xlib.h>
main() {
    XModifierKeymap *xmkm;
    xmkm=XNewModifiermap(1);
    return xmkm==NULL;
}
	],,x11_works=no)
	AC_MSG_RESULT($x11_works)
    fi
    LIBS="$PRELIBS"
    CPPFLAGS="$PRECPPFLAGS"

    dnl figure out whether we need to build against X11
    if test "x$bc_with_x11" != "xno" ; then
	if test "x$bc_build_aquatk" = "xyes" ; then
	    X_LIBS=""
	    LIBGL=""
	    X_CFLAGS=""
	    build_against_opengl="no"
	    if test "x$bc_with_x11" = "xyes" ; then
		AC_MSG_ERROR([*** X11 was requested, but tk will be built for AquaTk ***])
	    fi
	else
	    if test "x$x11_works" = "xyes" ; then
		build_against_x11="yes"
	    else
		if test "x$bc_with_x11" = "xyes" ; then
		    AC_MSG_NOTICE([X11 was requested, but no system X11 libraries were found])
		    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		    AC_MSG_NOTICE([Try adding --without-x11])
		    AC_MSG_ERROR([*** Using X11 was requested, yet no system X11 was found ***])
		else
		    AC_MSG_NOTICE([X11 does not appear to be functionally available])
		fi
	    fi
	fi
    fi
fi
AC_SUBST(X_CFLAGS)
AC_SUBST(X_LIBS)
AC_MSG_CHECKING(whether to build against X11)
AC_MSG_RESULT($build_against_x11)


dnl *** utah raster toolkit ***
dnl See if libutahrle seems to work
urt_works=no
AC_MSG_CHECKING(for Utah Raster Toolkit library functionality)
PRELIBS="$LIBS"
if test "x$utahrle_link_works" = "xyes" ; then
    LIBS="$LIBS $UTAHRLE"
fi
AC_TRY_RUN([
#ifdef HAVE_RLE_H
#  include <rle.h>
#endif
int main () {
    rle_hdr header = *rle_hdr_init( NULL );
    return 0;
}
], [urt_works=yes])
if test "x$utahrle_link_works" = "xyes" ; then
    LIBS="$PRELIBS"
fi
AC_MSG_RESULT($urt_works)

dnl figure out whether we need to build urt
build_brlcad_urt="no (using system)"
if test "x$bc_build_urt" = "xyes" ; then
    build_brlcad_urt=yes
else
    if test "x$bc_build_urt" = "xno" ; then
	if test "x$urt_works" != "xyes" ; then
	    AC_MSG_NOTICE([Utah Raster Toolkit was disabled, but no system URT/RLE library was found ***])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-urt-build])
	    AC_MSG_ERROR([*** Utah Raster Toolkit was disabled, yet no usable RLE system library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$urt_works" = "xno" ; then
	    build_brlcad_urt=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the Utah Raster Toolkit)
RLE=""
RLE_CPPFLAGS=""
if test "x$build_brlcad_urt" = "xyes" ; then
    RLE='${top_builddir}/src/other/libutahrle/libutahrle.la'
    RLE_CPPFLAGS='-I${top_srcdir}/src/other/libutahrle/include'
    AC_MSG_RESULT(yes)
else
    if test "x$utahrle_link_works" = "xyes" ; then
	RLE="$UTAHRLE"
    fi
    AC_MSG_RESULT(no)
fi
AC_SUBST(RLE)
AC_SUBST(RLE_CPPFLAGS)


dnl *** openNURBS ***
dnl See if openNURBS library support works
opennurbs_works=no
AC_MSG_CHECKING(for openNURBS functionality)
PRELIBS="$LIBS"
LIBS="$LIBS $LIBOPENNURBS $LIBZLIB"
AC_LANG_PUSH([C++])
AC_TRY_RUN([
#include <opennurbs.h>
int main () {
    int version = ON::Version();
    return 0;
}
], [opennurbs_works=yes])
AC_LANG_POP
LIBS="$PRELIBS"
AC_MSG_RESULT($opennurbs_works)

dnl figure out whether we need to build openNURBS
build_brlcad_opennurbs="no (using system)"
if test "x$bc_build_opennurbs" = "xyes" ; then
    build_brlcad_opennurbs=yes
else
    if test "x$bc_build_opennurbs" = "xno" ; then
	if test "x$opennurbs_works" != "xyes" ; then
	    AC_MSG_NOTICE([openNURBS was disabled, but no system openNURBS library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-opennurbs-build])
	    AC_MSG_ERROR([*** openNURBS was disabled, yet no usable system openNURBS was found ***])
	fi
    else
	dnl automatic detection
	if test "x$opennurbs_works" = "xno" ; then
	    build_brlcad_opennurbs=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the included openNURBS library)
OPENNURBS=""
OPENNURBS_CPPFLAGS='-I${top_srcdir}/src/other/openNURBS ${LIBZ_CPPFLAGS}'
if test "x$build_brlcad_opennurbs" = "xyes" ; then
    OPENNURBS='${top_builddir}/src/other/openNURBS/libopenNURBS.la ${LIBSTDCXX}'
    AC_MSG_RESULT(yes)
else
    OPENNURBS="$LIBOPENNURBS $LIBSTDCXX $LIBZ"	# produces "  " if we didn't find OpenNURBS
    AC_MSG_RESULT(no)
fi
AC_SUBST(OPENNURBS)
AC_SUBST(OPENNURBS_CPPFLAGS)

dnl *** NIST STEP Class Libraries ***
dnl figure out whether we need to build NIST STEP Class Libraries
STEP_VERSION="3.2.0"
AC_SUBST(STEP_VERSION)
AC_MSG_CHECKING(whether to build NIST Step Class Libraries)
STEP_CPPFLAGS='-I${top_srcdir}/src/other/step/include -I${top_srcdir}/src/other/step/src/cleditor -I${top_srcdir}/src/other/step/src/clstepcore -I${top_srcdir}/src/other/step/src/clutils -I${top_srcdir}/src/other/step/src/cldai -I${top_srcdir}/src/other/step/src/test'
if test ! "x$bc_build_step" = "xno" ; then
    STEP=""
    build_brlcad_step=yes
    AC_MSG_RESULT(no)
else
    build_brlcad_step=no
    STEP=""
    AC_MSG_RESULT(no)
fi
AC_SUBST(STEP)
AC_SUBST(STEP_CPPFLAGS)


dnl *** Tcl ***
dnl See if libtcl seems to work
tcl_works=no
AC_MSG_CHECKING(for Tcl library functionality)
PRELIBS="$LIBS"
if test "x$tcl_link_works" = "xyes" ; then
    LIBS="$LIBS $LIBTCL"
fi
AC_TRY_RUN([
#ifdef HAVE_TCL_H
#  include <tcl.h>
#endif
#ifndef TCL_MAJOR_VERSION
#  error Unknown major version of Tcl
#endif
#ifndef TCL_MINOR_VERSION
#  error Unknown minor version of Tcl
#endif
#include <stdio.h>
int main() {
    Tcl_Time time;
    Tcl_Interp *interp;
    interp = Tcl_CreateInterp();
    if (Tcl_Init(interp) == TCL_ERROR) {
	fprintf(stderr, "Tcl_Init returned error\n");
	return 1;
    }
    /* Tcl_GetTime is an 8.4 symbol */
    Tcl_GetTime(&time);
#if TCL_MAJOR_VERSION < 8
    fprintf(stderr, "major version < 8\n");
    return 1;
#elif TCL_MAJOR_VERSION == 8 && TCL_MINOR_VERSION < 4
    fprintf(stderr, "minor version < 4\n");
    return 1;
#endif
    return 0;
}
], [tcl_works=yes])
if test "x$tcl_link_works" = "xyes" ; then
    LIBS="$PRELIBS"
fi
AC_MSG_RESULT($tcl_works)

dnl figure out whether we need to build Tcl
build_brlcad_tcl="no (using system)"
if test "x$bc_build_tcl" = "xyes" ; then
    build_brlcad_tcl=yes
else
    if test "x$bc_build_tcl" = "xno" ; then
	if test "x$tcl_works" = "xno" ; then
	    AC_MSG_NOTICE([libtcl was disabled, but no system Tcl library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-tcl-build])
	    AC_MSG_ERROR([*** Tcl was disabled, yet no usable libtcl system library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$tcl_works" = "xno" ; then
	    build_brlcad_tcl=yes
	fi
    fi
fi

AC_MSG_CHECKING(whether to build Tcl)
TCL=""
TCLSTUB=""
TCL_CPPFLAGS=""
unset ac_cv_c_tclconfig
if test "x$build_brlcad_tcl" = "xyes" ; then
    TCL_VERSION="8.5"
    AC_MSG_RESULT(yes)
    case $host_os in
	 darwin*)
	     TCL='-L${top_builddir}/src/other/tcl/unix'" -ltcl${TCL_VERSION} $FRAMEWORK_COREFOUNDATION"
	     ;;
    	 *)
	     TCL='-L${top_builddir}/src/other/tcl/unix'" -ltcl${TCL_VERSION} ${LIBDL} ${LIBM}"
	     ;;
    esac
    TCLSTUB='-L${top_builddir}/src/other/tcl/unix'" -ltclstub${TCL_VERSION}"
    TCL_CPPFLAGS='-I${top_srcdir}/src/other/tcl/generic -I${top_srcdir}/src/other/tcl/unix'
else
    AC_MSG_RESULT(no)

    dnl find tclConfig.sh, add --with-tcl option, don't cache result for AC_CONFIG_SUBDIRS
    SC_PATH_TCLCONFIG
    # keep TCL_BIN_DIR, don't keep ac_cv_c_tclconfig
    unset ac_cv_c_tclconfig

    dnl If we're using the system Tcl, then we need to load
    dnl tclConfig.sh to get the TCL_VERSION and other vars.
    SC_LOAD_TCLCONFIG

    if test "x$tcl_link_works" = "xyes" ; then
	TCL="$LIBTCL"
    else
	AC_MSG_WARN([Unable to link against a system Tcl library])
	sleep 1
    fi
    if test "x$tclstub_link_works" = "xyes" ; then
	TCLSTUB="$LIBTCLSTUB"
    else
	AC_MSG_WARN([Unable to link against a system Tclstub library])
	sleep 1
    fi
fi
AM_CONDITIONAL(TCL_8_4_HEADERS, [test "x$TCL_VERSION" = "x8.4"])
AC_SUBST(TCL)
AC_SUBST(TCLSTUB)
AC_SUBST(TCL_CPPFLAGS)
AC_SUBST(TCL_VERSION)
AC_SUBST(LIBTCL)


dnl *** Tk ***
dnl See if libtk seems to work
tk_works=no
AC_MSG_CHECKING(for Tk library functionality)
PRELIBS="$LIBS"
if test "x$tk_link_works" = "xyes" ; then
    LIBS="$LIBS $LIBTK $LIBTCL"
fi
AC_TRY_RUN([
#ifdef HAVE_TCL_H
#  include <tcl.h>
#endif
#ifdef HAVE_TK_H
#  include <tk.h>
#endif
#ifndef TK_MAJOR_VERSION
#  error Unknown major version of Tk
#endif
#ifndef TK_MINOR_VERSION
#  error Unknown minor version of Tk
#endif
#include <stdio.h>
int cow = 0;
Tk_ArgvInfo argtbl[] = {
    {"-h", TK_ARGV_CONSTANT, (char *)1, (char *)&cow, "cow."},
    {NULL, TK_ARGV_END, NULL, NULL, NULL}};
int main() {
    Tcl_Interp *interp;
    const char *arg[5] = {".", "xview", "moveto", "1.0", NULL};
    int argl = 1, cow = 0;
    interp = Tcl_CreateInterp();
#define ATTEMPT(try,fail) if(try) { fprintf(stderr, fail": %s\n", \
	interp->result); return -1; }
    ATTEMPT(Tcl_Init(interp) == TCL_ERROR,"Tcl_Init returned error");
    ATTEMPT(Tk_ParseArgv(interp, NULL, &argl, arg, argtbl,
 	TK_ARGV_DONT_SKIP_FIRST_ARG) != TCL_OK, "Tk_ParseArgv");
#if TK_MAJOR_VERSION < 8
    fprintf(stderr, "major version < 8  (it's %d)\n", TK_MAJOR_VERSION);
    return 4;
#elif TK_MAJOR_VERSION == 8 && TK_MINOR_VERSION < 4
    fprintf(stderr, "minor version < 4  (it's %d)\n", TK_MINOR_VERSION);
    return 5;
#endif
    return 0;
}
], [tk_works=yes])
if test "x$tk_link_works" = "xyes" ; then
    LIBS="$PRELIBS"
fi
AC_MSG_RESULT($tk_works)

dnl figure out whether we need to build Tk
build_brlcad_tk="no (using system)"
build_against_tk=$tk_works
if test "x$bc_build_tk" = "xyes" ; then
    build_brlcad_tk=yes
else
    if test "x$bc_build_tk" = "xno" ; then
	if test "x$tk_works" = "xno" ; then
	    AC_MSG_NOTICE([libtk was disabled, but no system Tk library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-tk-build])
	    AC_MSG_ERROR([*** Tk was disabled, yet no usable libtk system library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$tk_works" = "xno" ; then
	    build_brlcad_tk=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build Tk)
TK=""
TKSTUB=""
TK_CPPFLAGS=""
unset ac_cv_c_tkconfig
if test "x$build_brlcad_tk" = "xyes" ; then
    TK_VERSION="8.5"
    build_against_tk="yes"
    AC_MSG_RESULT(yes)
    TK='-L${top_builddir}/src/other/tk/unix'" -ltk${TCL_VERSION}"
    TKSTUB='-L${top_builddir}/src/other/tk/unix'" -ltkstub${TK_VERSION}"
    TK_CPPFLAGS='-I${top_srcdir}/src/other/tk/generic -I${top_srcdir}/src/other/tk/unix -I${top_srcdir}/src/other/tk/win'
    if test "x$bc_build_aquatk" = "xyes" ; then
	TK_CPPFLAGS="$TK_CPPFLAGS "'-I${top_srcdir}/src/other/tk/xlib'
    fi
else
    AC_MSG_RESULT(no)

    dnl find tkConfig.sh, add --with-tk option, don't cache result for AC_CONFIG_SUBDIRS
    SC_PATH_TKCONFIG
    # keep TK_BIN_DIR, don't keep ac_cv_c_tkconfig
    unset ac_cv_c_tkconfig

    dnl If we're using the system Tk, then we need to load
    dnl tkConfig.sh to get the TK_VERSION and other vars.
    SC_LOAD_TKCONFIG

    if test "x$tk_link_works" = "xyes" ; then
	TK="$LIBTK"
    else
	AC_MSG_WARN([Unable to link against a system Tk library])
	sleep 1
    fi
    if test "x$tkstub_link_works" = "xyes" ; then
	TKSTUB="$LIBTKSTUB"
    else
	AC_MSG_WARN([Unable to link against a system Tkstub library])
	sleep 1
    fi
fi
AC_SUBST(TK)
AC_SUBST(TKSTUB)
AC_SUBST(TK_CPPFLAGS)
AC_SUBST(TK_VERSION)
AC_SUBST(LIBTK)


dnl *** incrTcl ***
dnl See if libitcl and libitk seem to work, make sure it's not dependant upon libtcl
itcl_works=no
AC_MSG_CHECKING(for incrTcl library functionality)
PRELIBS="$LIBS"
if test "x$itcl_link_works" = "xyes" ; then
    LIBS="$LIBS $LIBITCL $LIBTCL"
fi
AC_TRY_RUN([
#include <itcl.h>
#ifndef ITCL_MAJOR_VERSION
#  error Unknown major version of incrTcl
#endif
#ifndef ITCL_MINOR_VERSION
#  error Unknown minor version of incrTcl
#endif
#include <stdio.h>
int main() {
    Itcl_Stack stack;
    Itcl_InitStack(&stack);
#if ITCL_MAJOR_VERSION < 3
    fprintf(stderr, "major version < 3\n");
    return 1;
#elif ITCL_MAJOR_VERSION == 3 && ITCL_MINOR_VERSION < 2
    fprintf(stderr, "minorversion < 2\n");
    return 1;
#endif
    return 0;
}
], [itcl_works=yes])
if test "x$itcl_link_works" = "xyes" ; then
    LIBS="$PRELIBS"
fi
AC_MSG_RESULT($itcl_works)

dnl figure out whether we need to build incrTcl
build_brlcad_itcl="no (using system)"
if test "x$bc_build_itcl" = "xyes" ; then
    build_brlcad_itcl=yes
else
    if test "x$bc_build_itcl" = "xno" ; then
	if test "x$itcl_works" = "xno" ; then
	    AC_MSG_NOTICE([incrTcl was disabled, but no system incrTcl library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-itcl-build])
	    AC_MSG_ERROR([*** incrTcl was disabled, yet no usable libitcl system library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$itcl_works" = "xno" ; then
	    build_brlcad_itcl=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build incrTcl)

dnl itcl/itk
ITCL=""
ITK=""
ITCL_CPPFLAGS=""
ITK_CPPFLAGS=""
ITCL_VERSION=3.4
case $host_os in
     *netbsd-*|*freebsd-[[1-3]]*.*|*openbsd-[[1-3]]*|*sunos4*)
	 # some OS's don't like dots in the lib name
	 ITCL_VERSION="`echo ${ITCL_VERSION} | tr -d .`"
	 ;;
esac
AC_SUBST(ITCL_VERSION)
if test "x$build_brlcad_itcl" = "xyes" ; then
    ITCL='${top_builddir}/src/other/incrTcl/libitcl.la'
    ITK='${top_builddir}/src/other/incrTcl/libitk.la'
    ITCL_CPPFLAGS='-I${top_srcdir}/src/other/incrTcl/itcl/generic'
    ITK_CPPFLAGS='-I${top_srcdir}/src/other/incrTcl/itk/generic'
    AC_MSG_RESULT(yes)
else
    if test "x$itcl_link_works" = "xyes" ; then
	ITCL="$LIBITCL"
	ITK="$LIBITK"
    fi
    AC_MSG_RESULT(no)
fi
AC_SUBST(ITCL)
AC_SUBST(ITK)
AC_SUBST(ITCL_CPPFLAGS)
AC_SUBST(ITK_CPPFLAGS)
AC_SUBST(LIBITCL)
AC_SUBST(LIBITK)

# XXX hack until we can call incrTcl's configure to get the value
case $host_os in
    darwin*)
	SHLIB_SUFFIX=".dylib"
	;;
    *)
	SHLIB_SUFFIX=".so"
	;;
esac

# XXX hack since we don't call incrTcl's configure for the proper
# library name.
ITCL_LIB_FILE="libitcl${ITCL_VERSION}${SHLIB_SUFFIX}"
ITK_LIB_FILE="libitk${ITCL_VERSION}${SHLIB_SUFFIX}"
AC_SUBST(ITCL_LIB_FILE)
AC_SUBST(ITK_LIB_FILE)

dnl *** iwidgets ***
dnl See if the iwidgets are available
iwidgets_works=no
AC_MSG_CHECKING(for iwidgets functionality)
PRELIBS="$LIBS"
if test "x$tcl_link_works" = "xyes" ; then
    LIBS="$LIBS $LIBTCL $LIBITCL"
fi
dnl this test is probably not sufficient if iwidgets is not locateable
dnl in the tcl auto_path.
AC_TRY_RUN([
#ifdef HAVE_TCL_H
#  include <tcl.h>
#endif
int main() {
    int res = TCL_OK;
    Tcl_Interp *interp;
    const char *cmd = "package require Iwidgets";
    char *b = NULL;
    interp = Tcl_CreateInterp();
    if (Tcl_Init(interp) == TCL_ERROR) {
	printf("TCL interpreter failed to init: %s\n", interp->result);
	return 1;
    }
    if (Itcl_Init(interp) == TCL_ERROR) {
	printf("ITCL interp failed to initaliaze: %s\n", interp->result);
	return 1;
    }
    res = Tcl_Eval(interp, cmd);
    if ( res != TCL_OK) {
	printf("Failed to load Iwidgets: %s\n", interp->result);
	if(Tcl_Eval(interp, "package names") == TCL_ERROR)
	    return 1;
	while(b=strtok(b?NULL:interp->result," "))
	  if(!strncmp(b,"Iwidgets",8))
	    return 0;
        return 1;
    }
    return 0;
}
], [iwidgets_works=yes])
if test "x$tcl_link_works" = "xyes" ; then
    LIBS="$PRELIBS"
fi
AC_MSG_RESULT($iwidgets_works)

dnl figure out whether we need to install the iwidgets package
build_brlcad_iwidgets="no (using system)"
if test "x$bc_build_iwidgets" = "xyes" ; then
    build_brlcad_iwidgets=yes
else
    if test "x$bc_build_iwidgets" = "xno" ; then
	if test "x$iwidgets_works" = "xno" ; then
	    AC_MSG_NOTICE([iwidgets was disabled, but no system iwidgets package was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-iwidgets-build])
	    AC_MSG_ERROR([*** iwidgets was disabled, yet no usable iwidgets system package was found ***])
	fi
    else
	dnl automatic detection
	if test "x$iwidgets_works" = "xno" ; then
	    build_brlcad_iwidgets=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to install iwidgets)
AC_MSG_RESULT($build_brlcad_iwidgets)
IWIDGETS_VERSION="4.0.1"
AC_DEFINE_UNQUOTED([IWIDGETS_VERSION], "$IWIDGETS_VERSION", "Version of iWidgets")
AC_SUBST(IWIDGETS_VERSION)


dnl *** tkhtml3 ***
dnl figure out whether we need to build tkhtml3
TKHTML3_VERSION="alpha16"
AC_SUBST(TKHTML3_VERSION)
AC_MSG_CHECKING(whether to build tkhtml3)
if test ! "x$bc_build_tkhtml3" = "xno" ; then
    build_brlcad_tkhtml3=yes
    AC_MSG_RESULT(yes)
else
    build_brlcad_tkhtml3=no
    TKHTML3=""
    AC_MSG_RESULT(no)
fi
AC_SUBST(TKHTML3)

dnl *** togl***
dnl figure out whether we need to build togl
TOGL=""
TOGLSTUB=""
TOGL_CPPFLAGS=""
TOGL_VERSION="2.1"
AC_SUBST(TOGL_VERSION)
AC_MSG_CHECKING(whether to build togl)
if test ! "x$bc_build_togl" = "xno" ; then
    build_brlcad_togl=yes
    TOGL='-L${top_builddir}/src/other/togl'" -ltogl${TOGL_VERSION}"
    TOGLSTUB='-L${top_builddir}/src/other/togl'" -ltoglstub${TOGL_VERSION}"
    TOGL_CPPFLAGS='-I${top_srcdir}/src/other/togl'
    AC_MSG_RESULT(yes)
else
    build_brlcad_togl=no
    AC_MSG_RESULT(no)
fi
AC_SUBST(TOGL)
AC_SUBST(TOGLSTUB)
AC_SUBST(TOGL_CPPFLAGS)



dnl *** tkImg ***
dnl figure out whether we need to build tkImg
TKIMG_VERSION="1.3"
case $host_os in
     *netbsd-*|*freebsd-[[1-3]]*.*|*openbsd-[[1-3]]*|*sunos4*)
	 # some OS's don't like dots in the lib name
	 TKIMG_VERSION="`echo ${TKIMG_VERSION} | tr -d .`"
	 ;;
esac
AC_SUBST(TKIMG_VERSION)
AC_MSG_CHECKING(whether to build tkimg)
if test ! "x$bc_build_tkimg" = "xno" ; then
    build_brlcad_tkimg=yes
    TKIMG='${top_builddir}/src/other/tkimg/tkimg${TKIMG_VERSION}.la'
    AC_MSG_RESULT(yes)
else
    build_brlcad_tkimg=no
    TKIMG=""
    AC_MSG_RESULT(no)
fi
AC_SUBST(TKIMG)


dnl *** TNT ***
dnl See if template numerical toolkit works
tnt_works=no
AC_MSG_CHECKING(for TNT w/JAMA functionality)
AC_LANG_PUSH(C++)
AC_TRY_RUN([
#include <stdio.h>
#include <jama_lu.h>
int main () {
    Array2D<double> matrix = Array2D<double>(2,2);
    matrix[0][0] = matrix[1][0] = 1.0;
    matrix[0][1] = matrix[1][1] = 0.0;
    JAMA::LU<double> decomposition = JAMA::LU<double>(matrix);
    if (decomposition.isNonsingular()) {
	printf("JAMA:LU decomposition returned non-singular on a singular matrix\n");
	return 1;
    }
    return 0;
}
], [tnt_works=yes])
AC_LANG_POP(C++)
AC_MSG_RESULT($tnt_works)

dnl figure out whether we need to build libz
build_brlcad_tnt="no (using system)"
if test "x$bc_build_tnt" = "xyes" ; then
    build_brlcad_tnt=yes
else
    if test "x$bc_build_tnt" = "xno" ; then
	if test "x$tnt_works" != "xyes" ; then
	    AC_MSG_NOTICE([TNT was disabled, but no suitable system TNT was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-tnt-build])
	    AC_MSG_ERROR([*** Use of the included TNT was disabled, yet no system TNT was found ***])
	fi
    else
	dnl automatic detection
	if test "x$tnt_works" = "xno" ; then
	    build_brlcad_tnt=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to use the included Template Numerical Toolkit)
TNT_CPPFLAGS=""
if test "x$build_brlcad_tnt" = "xyes" ; then
    TNT_CPPFLAGS='-I${top_srcdir}/src/other/tnt'
    AC_MSG_RESULT(yes)
else
    AC_MSG_RESULT(no)
fi
AC_SUBST(TNT_CPPFLAGS)


dnl *** libthread ***
AC_MSG_CHECKING(for threading library availability)
AC_MSG_RESULT($thread_link_works)
AC_SUBST(LIBTHREAD)

AC_MSG_CHECKING(if pthreading works)
thread_works=no
AC_TRY_RUN([
#ifdef HAVE_PTHREAD_H
#  include <pthread.h>
#endif
void *thread_hook(void *arg) {
    return NULL;
}
main () {
    pthread_t thread;
    pthread_create(&thread, (void *)0, thread_hook, (void *)0);
    pthread_join(thread, NULL);
    return 0;
}
], [thread_works=yes])
AC_MSG_RESULT($thread_works)


dnl *** libtermlib ***
dnl See if termlib library support works
termlib_works=no
AC_MSG_CHECKING(for termlib functionality)
PRELIBS="$LIBS"
LIBS="$LIBS $LIBTERMLIB"
AC_TRY_RUN([
#ifdef HAVE_TERMLIB_H
#  include <termlib.h>
#else
#  if HAVE_NCURSES_H
#    include <ncurses.h>
#  else
#    ifdef HAVE_CURSES_H
#      include <curses.h>
#    else
#      ifdef HAVE_TERMCAP_H
#        include <termcap.h>
#      else
#        ifdef HAVE_TERMINFO_H
#          include <terminfo.h>
#        else
#          ifdef HAVE_TINFO_H
#            include <tinfo.h>
#          endif
#        endif
#      endif
#    endif
#  endif
#  if HAVE_TERM_H
#    include <term.h>
#  endif
#endif
int main () {
    char buffer[2048] = {0};
    int result = tgetent(buffer, "vt100");
    return 0;
}
], [termlib_works=yes])
LIBS="$PRELIBS"
AC_MSG_RESULT($termlib_works)

dnl figure out whether we need to build libtermlib
build_brlcad_termlib="no (using system)"
if test "x$bc_build_termlib" = "xyes" ; then
    build_brlcad_termlib=yes
else
    if test "x$bc_build_termlib" = "xno" ; then
	if test "x$termlib_works" != "xyes" ; then
	    AC_MSG_NOTICE([termlib was disabled, but no system terminal library was found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --enable-termlib-build])
	    AC_MSG_ERROR([*** Building termlib was disabled, yet no system termcap or curses library was found ***])
	fi
    else
	dnl automatic detection
	if test "x$termlib_works" = "xno" ; then
	    build_brlcad_termlib=yes
	fi
    fi
fi
AC_MSG_CHECKING(whether to build the included termlib library)
TERMLIB=""
TERMLIB_CPPFLAGS=""
if test "x$build_brlcad_termlib" = "xyes" ; then
    TERMLIB='${top_builddir}/src/other/libtermlib/libtermlib.la'
    TERMLIB_CPPFLAGS='-I${top_srcdir}/src/other/libtermlib'
    AC_MSG_RESULT(yes)
else
    TERMLIB="$LIBTERMLIB"
    AC_MSG_RESULT(no)
fi
AC_SUBST(TERMLIB)
AC_SUBST(TERMLIB_CPPFLAGS)

dnl *** Boost ***
dnl Header only Library requiring no build
BOOST_CPPFLAGS='-I${top_srcdir}/src/other'
AC_SUBST(BOOST_CPPFLAGS)

dnl *** libm ***
AC_MSG_CHECKING(whether to link with the system math library)
AC_MSG_RESULT($m_link_works)
AC_SUBST(LIBM)

dnl *** libsocket ***
AC_MSG_CHECKING(for system socket library availability)
AC_MSG_RESULT([$socket_link_works])
AC_SUBST(LIBSOCKET)

dnl *** libnsl ***
AC_MSG_CHECKING(for system network socket library availablity)
AC_MSG_RESULT([$nsl_link_works])
AC_SUBST(LIBNSL)

dnl *** libnetwork ***
AC_MSG_CHECKING(for system network library availablity)
AC_MSG_RESULT([$network_link_works])
AC_SUBST(LIBNETWORK)

dnl *** libmalloc ***
AC_MSG_CHECKING(for system malloc library availability)
AC_MSG_RESULT([$malloc_link_works])
AC_SUBST(LIBMALLOC)

dnl *** libmx ***
AC_MSG_CHECKING(for system mx library availability)
AC_MSG_RESULT([$mx_link_works])
AC_SUBST(LIBMX)

dnl *** libdl ***
AC_MSG_CHECKING(for system dynamic linker library availability)
AC_MSG_RESULT([$dl_link_works])
AC_SUBST(LIBDL)

dnl *** libds ***
AC_MSG_CHECKING(for SGI /dev/scsi library availability)
AC_MSG_RESULT([$ds_link_works])
AC_SUBST(LIBDS)

dnl *** libgl ***
AC_MSG_CHECKING(for OpenGL library availability)
AC_MSG_RESULT($gl_link_works)
AC_SUBST(LIBGL)

dnl *** libopengl32 ***
AC_MSG_CHECKING(for WindowsGL library availability)
AC_MSG_RESULT($wgl_link_works)
AC_SUBST(LIBWGL)

dnl *** sgigl ***
AC_MSG_CHECKING(for SGI graphics library availability)
AC_MSG_RESULT($sgigl_link_works)
AC_SUBST(LIBSGIGL)
if test "x$sgigl_link_works" = "xyes" ; then
    AC_DEFINE(HAS_SGIGL, 1, Irix GL is present.)
fi

dnl *** libl Solaris lexer library ***
AC_MSG_CHECKING(for Solaris lexer library availability)
AC_MSG_RESULT($l_link_works)
AC_SUBST(LIBL)

dnl *** libgen IRIX dirname/basename library ***
AC_MSG_CHECKING(for libgen library availability)
AC_MSG_RESULT($gen_link_works)
AC_SUBST(LIBGEN)

dnl *** libregex ***
AC_MSG_CHECKING(for system regular expression library availability)
AC_MSG_RESULT($regex_link_works)
AC_SUBST(LIBREGEX)

dnl *** libpng ***
AC_MSG_CHECKING(for system portable network graphics availability)
AC_MSG_RESULT($png_link_works)
AC_SUBST(LIBPNG)

dnl *** openNURBS library ***
AC_MSG_CHECKING(for system openNURBS library availability)
AC_MSG_RESULT($opennurbs_link_works)
AC_SUBST(LIBOPENNURBS)

dnl *** libstdc++ C++ library ***
AC_MSG_CHECKING(whether the Standard C++ library is available)
AC_MSG_RESULT($stdcxx_link_works)
AC_SUBST(LIBSTDCXX)

if test "x$bc_with_dtrace" = "xyes" ; then
    AC_DEFINE(USE_DTRACE, 1, [Are we building with DTrace support?])
    DTRACE_SRC="\${DTRACE_SRC}"
    DTRACE_HDR="\${DTRACE_HDR}"
    DTRACE_OBJ="\${DTRACE_OBJ}"
    AC_SUBST(DTRACE_SRC)
    AC_SUBST(DTRACE_HDR)
    AC_SUBST(DTRACE_OBJ)
fi

dnl *** 64-bit compilation ***
dnl figure out whether we are building 64-bit
build_brlcad_64bit="no"
if test "x$bc_build_64bit" = "xyes" ; then
    if test "x$pointer_size" != "x8" ; then
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_NOTICE([Try removing --enable-64bit-build or modifying the CFLAGS/LDFLAGS])
	AC_MSG_ERROR([*** Building 64-bit was requested, yet the build seems to be non-64-bit ***])
    fi
    build_brlcad_64bit=yes
else
    if test "x$bc_build_64bit" = "xno" ; then
	if test "x$pointer_size" = "x8" ; then
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try removing --disable-64bit-build or modifying the CFLAGS/LDFLAGS])
	    AC_MSG_ERROR([*** Building non-64-bit was requested, yet the build seems to be 64-bit ***])
	fi
    fi

    dnl automatic detection
    if test "x$pointer_size" = "x8" ; then
	build_brlcad_64bit="yes"
    elif test "x$pointer_size" = "x4" ; then
	build_brlcad_64bit="no (32-bit)"
    elif test "x$pointer_size" = "x2" ; then
	build_brlcad_64bit="no (16-bit)"
    elif test "x$pointer_size" = "x1" ; then
	build_brlcad_64bit="no (8-bit)"
    else
	AC_MSG_WARN([Unknown pointer size: $pointer_size])
	sleep 5
    fi
fi


dnl *** Jove compilation ***
build_brlcad_jove=no
if test "x$bc_build_jove" = "xyes" ; then
    build_brlcad_jove=yes
elif test "x$bc_build_jove" = "xno" ; then
    build_brlcad_jove=no	# body for the sake of body
else
    # enable jove if no suitable system emacs/jove was found
    if test "x$BCEDITOR" = "x" ; then
	build_brlcad_jove=yes
    fi
fi


dnl *** Java interface compilation ***
build_against_java=no
if test "x$bc_with_java" != "xno" ; then
    AC_MSG_CHECKING(for Java functionality)
    if test "x$found_jni_h" = "xno" ; then
	if test "x$bc_only_rts" != "xno" ; then
	    AC_MSG_RESULT(no)
	    AC_MSG_NOTICE([searching more extensively])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --with-jdk=/path/to/jdk to find jni.h])
	    AC_MSG_ERROR([*** Cannot locate jni.h for building librtserver ***])
	fi
	if test "x$bc_with_java" = "xyes" ; then
	    AC_MSG_RESULT(no)
	    AC_MSG_NOTICE([searching more extensively])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_ERROR([Failed to locate a functioning jni.h for Java])
	fi

	if test "x$bc_with_java" != "xauto" ; then
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_WARN([Unable to locate a functioning Java])
	    AC_MSG_WARN([Compilation of librtserver will be disabled])
	    AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
	    sleep 1
	fi
	AC_MSG_RESULT(no)
    else # found_jni_h
	if test "x$bc_with_java" = "xauto" ; then
	    build_against_java=yes
	else
	    build_against_java="yes ($bc_with_java_val)"
	fi
	AC_MSG_RESULT(yes)
    fi # found_jni_h
fi # bc_with_java


dnl *** Pro/ENGINEER installation / plugin compilation ***
build_against_proe=no
if test "x$bc_with_proe" != "xno" ; then
    if test "x$pointer_size" != "x4" ; then
	AC_MSG_RESULT(no)
	AC_MSG_WARN([The Pro/E plugin must be built as a 32-bit library. Please disable 64-bit builds and set appropriate C/CXXFLAGS])
	sleep 1
    else
	AC_MSG_CHECKING(for Pro/ENGINEER installation)
	if test "x$found_protk_h" = "xno" ; then
	    AC_MSG_RESULT(no)
	    if test "x$bc_with_proe" = "xyes" ; then
		AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		AC_MSG_WARN([Unable to locate ProToolkit.h. Make sure your installation of Pro/E also has Pro/TOOLKIT])
		AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
		sleep 5
	    fi
	    if test "x$bc_with_proe" = "xauto" ; then
		AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
		AC_MSG_WARN([Pro/E was not installed in the standard place (/usr/local/ptc/proeWildfire3.0).])
		AC_MSG_WARN([Try adding --with-proe=/path/to/proe to find the ProToolkit.h])
		AC_MSG_WARN([Compilation of Pro/ENGINEER plugin will be disabled])
		AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
		sleep 5
	    fi
	else
	    if test "x$bc_with_proe" = "xauto" ; then
		build_against_proe=yes
	    else
		build_against_proe="yes ($bc_with_proe_val)"
	    fi
	    AC_MSG_RESULT(yes)
	fi
    fi
fi


dnl *** OpenGL interface compilation ***
build_against_opengl="no"
if test "x$bc_with_opengl" != "xno" ; then
    AC_MSG_CHECKING(for OpenGL functionality)
    opengl_works=no
    PRELIBS="$LIBS"
    PRECPPFLAGS="$CPPFLAGS"
    PRELDFLAGS="$LDFLAGS"
    LIBS="$LIBS $LIBGL"
    CPPFLAGS="$CPPFLAGS $GL_CPPFLAGS"
    LDFLAGS="$LDFLAGS $GL_LDFLAGS"
    AC_TRY_RUN([
#ifdef HAVE_GL_GL_H
#  include <GL/gl.h>
#endif
main(int argc, char *argv[]) {
    GLboolean values;
    void (*func)() = glBegin;
    if (GL_FALSE || argc > 1) {
	func(GL_POINTS);
	glGetBooleanv(GL_DEPTH_TEST, &values);
	glEnd();
    }
    return 0;
}
    ], [opengl_works=yes])
    LIBS="$PRELIBS"
    CPPFLAGS="$PRECPPFLAGS"
    LDFLAGS="$PRELDFLAGS"
    AC_MSG_RESULT($opengl_works)

    dnl figure out whether we need to build against opengl
    if test "x$opengl_works" = "xyes" ; then
	build_against_opengl="yes"
    else
	if test "x$bc_with_opengl" = "xyes" ; then
	    AC_MSG_NOTICE([OpenGL was requested, but no system OpenGL libraries were found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --without-opengl])
	    AC_MSG_ERROR([*** Using OpenGL was requested, yet no system OpenGL was found ***])
	else
	    AC_MSG_NOTICE([OpenGL does not appear to be functionally available])
	fi
    fi
fi # bc_with_opengl
AC_MSG_CHECKING(whether to build against OpenGL)
AC_MSG_RESULT($build_against_opengl)


dnl *** WindowsGL interface compilation ***
build_against_wgl="no"
if test "x$bc_with_wgl" != "xno" ; then
    AC_MSG_CHECKING(for WindowsGL functionality)
    wgl_works=no
    PRELIBS="$LIBS"
    LIBS="$LIBS $LIBWGL"
    AC_TRY_RUN([
#ifdef HAVE_GL_GL_H
#  include <GL/gl.h>
#endif
main(int argc, char *argv[]) {
    GLboolean values;
    void (*func)() = glBegin;
    wglMakeCurrent(NULL, NULL);
    if (GL_FALSE || argc > 1) {
        func(GL_POINTS);
	glGetBooleanv(GL_DEPTH_TEST, &values);
	glEnd();
    }
    return 0;
}
    ], [wgl_works=yes])
    LIBS="$PRELIBS"
    AC_MSG_RESULT($wgl_works)

    dnl figure out whether we need to build against wgl
    if test "x$wgl_works" = "xyes" ; then
	build_against_wgl="yes"
    else
	if test "x$bc_with_wgl" = "xyes" ; then
	    AC_MSG_NOTICE([WindowsGL was requested, but no system WGL OpenGL libraries were found])
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_NOTICE([Try adding --without-wgl])
	    AC_MSG_ERROR([*** Using WindowsGL was requested, yet no system WGL OpenGL was found ***])
	else
	    AC_MSG_NOTICE([WindowsGL does not appear to be functionally available])
	fi
    fi
fi # bc_with_wgl
AC_MSG_CHECKING(whether to build against WindowsGL)
AC_MSG_RESULT($build_against_wgl)


dnl *** RTGL interface compilation ***
build_rtgl="no"
if test "x$bc_rtgl" = "xyes" ; then
    if test "x$build_against_opengl" = "xno" ; then
	AC_MSG_NOTICE([RTGL was requested, but no system OpenGL libraries were found])
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_NOTICE([Try adding --with-opengl])
	AC_MSG_ERROR([*** Using RTGL was requested, yet no system OpenGL was found ***])
    fi
    build_rtgl="yes"
fi # bc_with_rtgl
AC_MSG_CHECKING(whether to build experimental RTGL display manager)
AC_MSG_RESULT($build_rtgl)


dnl *** Knobs availability ***
dials_and_buttons=no
AC_MSG_CHECKING(for SGI dials and buttons support)
AC_TRY_RUN([
#ifdef HAVE_GL_DEVICE_H
#  include <gl/device.h>
#endif
main () {
    if (DIAL0 | DIAL1 | DIAL2 | DIAL3) {
	return 0;
    }
    return 1;
}
], [dials_and_buttons=yes])
if test "x$dials_and_buttons" = "xyes" ; then
    AC_DEFINE(IR_KNOBS, 8, [Turn on SGI knobs])
    AC_DEFINE(IR_BUTTONS, 32, [Turn on SGI buttons])
fi
AC_MSG_RESULT($dials_and_buttons)


dnl *** MGED GUI ***
tk_gui=yes
if test "x$build_against_x11" = "xno" && test "x$build_against_opengl" = "xno" && test "x$build_against_wgl" = "xno" ; then
    if test "x$build_brlcad_tk" = "xno" ; then
	tk_gui=no
    fi
fi
if test "x$tk_gui" = "xyes" ; then
    AC_DEFINE(HAVE_TK, 1, [Support for a Tk GUI is enabled])
fi

dnl *** Docbook functionality ***
docbook_processing=no
docbook_pdf_processing=no
if test "x$bc_build_docs" != "xno" ; then
    if test "x$bc_build_docs" = "xyes" ; then
	if test "x$XSLTPROC" = "x" ; then
	    AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	    AC_MSG_WARN([Extra documentation is enabled but xsltproc was not found])
	    AC_MSG_ERROR([*** Don't know how to generate documentation without xsltproc ***])
	fi
    fi

    if test "x$XSLTPROC" = "x" ; then
        docbook_processing=no
	XSLTPROC=:
    fi
    if test "x$APACHEFOP" != "x" ; then
	docbook_pdf_processing=yes
        docbook_processing="yes (man/html/pdf)"
		# set FOP_OPTS to avoid dock bounce on osX
	APACHEFOP="FOP_OPTS=-Djava.awt.headless=true $APACHEFOP"
    else
        docbook_processing="yes (man/html only)"
	docbook_pdf_processing="no"
	APACHEFOP=""
    fi
fi
AC_SUBST(XSLTPROC)
AC_SUBST(APACHEFOP)
AC_MSG_CHECKING(for Docbook processing functionality)
AC_MSG_RESULT($docbook_processing)
AC_MSG_CHECKING(for Docbook pdf generation functionality)
AC_MSG_RESULT($docbook_pdf_processing)

# XXX nasty temp hack for backwards cake compatibility. code needs to be fixed.
if test "x$host_os" = "xirix6.5" ; then
    # XXX the code that relies on this will be going away, but until then..
    if test "x$build_brlcad_64bit" = "xyes" ; then
	CFLAGS="$CFLAGS -DIRIX64=65"
    else
	CFLAGS="$CFLAGS -DIRIX=6"
    fi
fi

dnl search the BRL-CAD include directory (required for non-srcdir builds).
dnl should come after the system services checks otherwise or our headers
dnl may conflict.
CPPFLAGS="$CPPFLAGS -DBRLCADBUILD=1 -I\${top_srcdir}/include $OPENNURBS_CPPFLAGS"

# make sure ECHO and ECHO_N got defined and substituted
if test "x$ECHO" = "x" ; then
    ECHO=echo
    AC_MSG_NOTICE([ECHO was not defined by configure so defining manually])
fi
AC_SUBST(ECHO)
AC_SUBST(ECHO_N)


dnl **************************************
dnl *** Configure Makefiles and output ***
dnl **************************************

BC_CONFIGURE_STAGE([output], [9 of 9])

# remove surrounding whitspace
CFLAGS="`echo $CFLAGS`"
CXXFLAGS="`echo $CXXFLAGS`"
CPPFLAGS="`echo $CPPFLAGS`"
LDFLAGS="`echo $LDFLAGS`"
LIBS="`echo $LIBS`"

AM_CONDITIONAL(BUILD_TCL, [test "x$build_brlcad_tcl" = "xyes"])
AM_CONDITIONAL(BUILD_TK, [test "x$build_brlcad_tk" = "xyes"])
AM_CONDITIONAL(BUILD_ITCL, [test "x$build_brlcad_itcl" = "xyes"])
AM_CONDITIONAL(BUILD_IWIDGETS, [test "x$build_brlcad_iwidgets" = "xyes"])
AM_CONDITIONAL(BUILD_TKHTML3, [test "x$build_brlcad_tkhtml3" = "xyes"])
AM_CONDITIONAL(BUILD_TOGL, [test "x$build_brlcad_togl" = "xyes"])
AM_CONDITIONAL(BUILD_TKIMG, [test "x$build_brlcad_tkimg" = "xyes"])
AM_CONDITIONAL(BUILD_PNG, [test "x$build_brlcad_png" = "xyes"])
AM_CONDITIONAL(BUILD_REGEX, [test "x$build_brlcad_regex" = "xyes"])
AM_CONDITIONAL(BUILD_ZLIB, [test "x$build_brlcad_zlib" = "xyes"])
AM_CONDITIONAL(BUILD_URT, [test "x$build_brlcad_urt" = "xyes"])
AM_CONDITIONAL(BUILD_OPENNURBS, [test "x$build_brlcad_opennurbs" = "xyes"])
AM_CONDITIONAL(BUILD_BOOST, [test "x$ac_cv_header_limit" = "xyes" && test "x$ac_cv_header_istream" = "xyes"])
AM_CONDITIONAL(BUILD_STEP, [test "x$build_brlcad_step" = "xyes"])
AM_CONDITIONAL(BUILD_TERMLIB, [test "x$build_brlcad_termlib" = "xyes"])
AM_CONDITIONAL(BUILD_TNT, [test "x$build_brlcad_tnt" = "xyes"])
AM_CONDITIONAL(BUILD_JOVE, [test "x$build_brlcad_jove" = "xyes"])
AM_CONDITIONAL(BUILD_EF, [test "x$bc_build_ef" = "xyes"])
AM_CONDITIONAL(BUILD_CUBIT, [test "x$bc_build_cubit" = "xyes"])
AM_CONDITIONAL(BUILD_UG, [test "x$bc_build_ug" = "xyes"])

# libfb and libdm interfaces
AM_CONDITIONAL(WITH_X11, [test "x$build_against_x11" != "xno"])
AM_CONDITIONAL(WITH_OPENGL, [test "x$build_against_opengl" != "xno" && test "x$build_against_x11" != "xno"])
AM_CONDITIONAL(WITH_WGL, [test "x$build_against_wgl" != "xno"])
AM_CONDITIONAL(WITH_TK, [test "xyes" = "xno"])
#AM_CONDITIONAL(WITH_TK, [test "x$build_against_tk" != "xno"])

# XXX need to refactor the above fb/dm interfaces to have a better
# separation of their external 'with' deps and the interfaces
AM_CONDITIONAL(BUILD_RTGL, [test "x$build_rtgl" = "xyes"])

AM_CONDITIONAL(WITH_JAVA, [test "x$build_against_java" != "xno"])
AM_CONDITIONAL(WITH_PROE, [test "x$build_against_proe" != "xno"])
AM_CONDITIONAL(WITH_PARSERS, [test "x$build_parsers" != "xno"])

AM_CONDITIONAL(BUILD_DOCS, [test "x$docbook_processing" != "xno"])
AM_CONDITIONAL(BUILD_PDF_DOCS, [test "x$docbook_pdf_processing" != "xno"])
AM_CONDITIONAL(INSTALL_MODELS, [test "x$bc_install_geometry" = "xyes"])
AM_CONDITIONAL(ONLY_BENCHMARK, [test "x$bc_only_benchmark" != "xno"])
AM_CONDITIONAL(ONLY_RTS, [test "x$bc_only_rts" != "xno"])



dnl Any combination of the different optimizations listed below may individually be
dnl optionally turned off by commenting out the unwanted defines in the config file.
dnl
dnl NO_BOMBING_MACROS
dnl      turns off many macros in h/bu.h and h/bn.h that check a condition (such as a
dnl      magic number) and bu_bomb on failure.  note that turning this flag on will
dnl      remove the debug capability to catch fatal runtime erros (bugs) and exit
dnl      gracefully.
dnl NO_MAGIC_CHECKING
dnl      turns off allocation of (some) variables and calls to check magic numbers.
dnl      note that this will hinder memory corrupting bug detection.
dnl NO_BADRAY_CHECKING
dnl      is a risky optimization to turn off checking in librt/shoot.c for bad rays
dnl      passed in to the expensive shootray() routine.
dnl NO_DEBUG_CHECKING
dnl      is an optimization that replaces instances of rt_g.debug in if statements
dnl      where checking for a debug level occurs (in order to output a debug message)
dnl      with the integer constant 0.  note that turning this flag on will remove the
dnl      capability to output debug messages and commands that take a debug-level args
dnl      will not output as expected.  see h/raytrace.h for the implementation details.

if test "x$bc_build_runtime_debug" = "xno" ; then
	AC_MSG_NOTICE([}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}])
	AC_MSG_WARN([While disabling run-time debugging should increase])
	AC_MSG_WARN([performance, it will likewise remove several])
	AC_MSG_WARN([data-protection safeguards that are in place to])
	AC_MSG_WARN([minimize the possibility of corrupted data files])
	AC_MSG_WARN([in the inevitable event of a user encountering a bug.])
	AC_MSG_WARN([You have been warned.  Proceed at your own risk.])
	AC_MSG_NOTICE([{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{])
	sleep 5
	AC_DEFINE(NO_BOMBING_MACROS, 1, [Define to not do anything for macros that only bomb on a fatal error])
	AC_DEFINE(NO_MAGIC_CHECKING, 1, [Define to not perform magic number checking])
	AC_DEFINE(NO_BADRAY_CHECKING, 1, [Define to not check for divide by zero during ray shots])
	AC_DEFINE(NO_DEBUG_CHECKING, 1, [Define to not provide run-time debug facilities via rt_g.debug])
fi

dnl compile-time debug
if test "x$bc_use_debug" != "xno" ; then
	AC_DEFINE(DEBUG, 1, [Define to enable compile-time debug code])
else
	AC_DEFINE(NDEBUG, 1, [Define to indicate non-debug code (assert utilizes)])
fi

dnl SMP-aware (i.e. PARALLEL) build
if test "x$bc_build_parallel" != "xno" ; then
	AC_DEFINE(PARALLEL, 1, [Define to enable SMP architecture parallel computation support ])
fi


#
# set up the BRL-CAD libraries
#

BN='${top_builddir}/src/libbn/libbn.la'
BU='${top_builddir}/src/libbu/libbu.la'
CURSOR='${top_builddir}/src/libcursor/libcursor.la'
DM='${top_builddir}/src/libdm/libdm.la'
FB='${top_builddir}/src/libfb/libfb.la'
FFT='${top_builddir}/src/libfft/libfft.la'
GCV='${top_builddir}/src/libgcv/libgcv.la'
GED='${top_builddir}/src/libged/libged.la'
MULTISPECTRAL='${top_builddir}/src/libmultispectral/libmultispectral.la'
OPTICAL='${top_builddir}/src/liboptical/liboptical.la'
ORLE='${top_builddir}/src/liborle/liborle.la'
PC='${top_builddir}/src/libpc/libpc.la'
PKG='${top_builddir}/src/libpkg/libpkg.la'
RT='${top_builddir}/src/librt/librt.la'
SYSV='${top_builddir}/src/libsysv/libsysv.la'
TCLCAD='${top_builddir}/src/libtclcad/libtclcad.la'
TERMIO='${top_builddir}/src/libtermio/libtermio.la'
WDB='${top_builddir}/src/libwdb/libwdb.la'
BRLCAD='${top_builddir}/src/libbrlcad.la'

STEPCORE='${top_builddir}/src/other/step/src/clstepcore/libstepcore.la'
STEPDAI='${top_builddir}/src/other/step/src/cldai/libstepdai.la'
STEPEDITOR='${top_builddir}/src/other/step/src/cleditor/libstepeditor.la'
STEPUTILS='${top_builddir}/src/other/step/src/clutils/libsteputils.la'
STEPEXPRESS='${top_builddir}/src/other/step/src/express/libexpress.la'
STEPEXPPP='${top_builddir}/src/other/step/src/exppp/libexppp.la'
STEP_LIBS="${STEPCORE} ${STEPDAI} ${STEPEDITOR} ${STEPUTILS} ${STEPEXPRESS}"
STEP_FEDEX='${top_builddir}/src/other/step/src/express/fedex'
STEP_FEDEX_PLUS='${top_builddir}/src/other/step/src/fedex_plus/fedex_plus'
STEP_EXPPP='${top_builddir}/src/other/step/src/exppp/exppp'
STEP_AP203='${top_srcdir}/src/other/step/data/ap203/203wseds.exp'

ORLE_LIBS=
PKG_LIBS="${LIBSOCKET} ${LIBNSL} ${LIBNETWORK}"
SYSV_LIBS=
TERMIO_LIBS="${TERMLIB}"
CURSOR_LIBS="${TERMLIB}"
FFT_LIBS="${LIBM}"
BU_LIBS="${TCL} ${PNG} ${LIBM} ${LIBMALLOC} ${LIBTHREAD}"
BN_LIBS="${BU} ${BU_LIBS} ${TCL} ${LIBM}"
RT_LIBS="${BN} ${BN_LIBS} ${BU} ${BU_LIBS} ${REGEX} ${LIBM} ${SYSV} ${OPENNURBS}"
GCV_LIBS="${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS}"
GED_LIBS="${WDB} ${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS} ${PNG} ${TCL} ${REGEX}"
WDB_LIBS="${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS}"
FB_LIBS="${BU} ${BU_LIBS} ${PKG} ${PKG_LIBS} ${TCL}" # additional/optional FB_LIBS: ${TK} ${X_LIBS} ${LIBGL}
OPTICAL_LIBS="${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS} ${TCL}"
MULTISPECTRAL_LIBS="${OPTICAL} ${OPTICAL_LIBS} ${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS}"
PC_LIBS="${LIBSTDCXX} ${BU} ${BU_LIBS}"
if test "x$build_against_x11" = "xno" ; then
    DM_LIBS="${GED} ${GED_LIBS} ${RT} ${RT_LIBS} ${FB} ${FB_LIBS} ${PNG} ${FRAMEWORK_CARBON}"
    TCLCAD_LIBS="${GED} ${GED_LIBS} ${DM} ${DM_LIBS} ${FB} ${FB_LIBS} ${ITCL} ${TCLSTUB} ${TCL}"
else
    DM_LIBS="${GED} ${GED_LIBS} ${RT} ${RT_LIBS} ${FB} ${FB_LIBS} ${PNG} ${TK} ${X_LIBS} ${FRAMEWORK_CARBON}"
    TCLCAD_LIBS="${GED} ${GED_LIBS} ${DM} ${DM_LIBS} ${FB} ${FB_LIBS} ${ITK} ${ITCL} ${TK} ${TCLSTUB} ${TCL}"
fi
BRLCAD_LIBS="${GED} ${GED_LIBS} ${WDB} ${WDB_LIBS} ${RT} ${RT_LIBS} ${BN} ${BN_LIBS} ${BU} ${BU_LIBS}"

AC_SUBST(BN)
AC_SUBST(BU)
AC_SUBST(CURSOR)
AC_SUBST(DM)
AC_SUBST(FB)
AC_SUBST(FFT)
AC_SUBST(GCV)
AC_SUBST(GED)
AC_SUBST(MULTISPECTRAL)
AC_SUBST(OPTICAL)
AC_SUBST(ORLE)
AC_SUBST(PKG)
AC_SUBST(PC)
AC_SUBST(RT)
AC_SUBST(SYSV)
AC_SUBST(TCLCAD)
AC_SUBST(TERMIO)
AC_SUBST(WDB)
AC_SUBST(BRLCAD)

AC_SUBST(STEPCORE)
AC_SUBST(STEPDAI)
AC_SUBST(STEPEDITOR)
AC_SUBST(STEPUTILS)
AC_SUBST(STEPEXPRESS)
AC_SUBST(STEPEXPPP)
AC_SUBST(STEP_LIBS)
AC_SUBST(STEP_FEDEX)
AC_SUBST(STEP_FEDEX_PLUS)
AC_SUBST(STEP_EXPPP)
AC_SUBST(STEP_AP203)

AC_SUBST(BN_LIBS)
AC_SUBST(BU_LIBS)
AC_SUBST(CURSOR_LIBS)
AC_SUBST(DM_LIBS)
AC_SUBST(FB_LIBS)
AC_SUBST(FFT_LIBS)
AC_SUBST(GCV_LIBS)
AC_SUBST(GED_LIBS)
AC_SUBST(MULTISPECTRAL_LIBS)
AC_SUBST(OPTICAL_LIBS)
AC_SUBST(ORLE_LIBS)
AC_SUBST(PC_LIBS)
AC_SUBST(PKG_LIBS)
AC_SUBST(RT_LIBS)
AC_SUBST(SYSV_LIBS)
AC_SUBST(TCLCAD_LIBS)
AC_SUBST(TERMIO_LIBS)
AC_SUBST(WDB_LIBS)
AC_SUBST(BRLCAD_LIBS)


# if compiling with the MIPSpro 7.3 compiler, there is a bug when
# trying to link using an rpath longer than 256 that causes the linker
# to core dump.
AM_CONDITIONAL(LINK_STATIC_REQUIRED, [test "x$build_vendor" = "xsgi" -a "x$compiler" = "xsgi" ])

AM_CONDITIONAL(HAVE_DOXYGEN, false)

dnl sample applications
SAMPLE_APPLICATIONS_DIR='${BRLCAD_DATA}/sample_applications'
AC_SUBST(SAMPLE_APPLICATIONS_DIR)

# stash the top builddir before configuring subdirectories
bc_top_builddir="$ac_top_builddir"

# stash the current configuration args before adding additional ones
# for subconfigure
bc_configure_args="$ac_configure_args"

dnl the way to turn on debug for tcl/tk configure
if test "x$bc_use_debug" != "xno" ; then
   ac_configure_args="$ac_configure_args --enable-symbols"
fi

dnl configure Tcl
if test "x$build_brlcad_tcl" = "xyes" ; then
    TCL_PATH="$PWD/${ac_top_builddir}/src/other/tcl/unix"
    ac_configure_args="$ac_configure_args --with-tcl=\"$TCL_PATH\""
    AC_CONFIG_SUBDIRS([src/other/tcl/unix])
    TCL_PATH="`echo ${TCL_PATH} | sed 's/\\/\\//\\//g;s/\\//\\\\\\//g'`"
fi
AC_SUBST(TCL_PATH)

dnl configure Tk
if test "x$build_brlcad_tk" = "xyes" ; then
    if test "x$bc_build_aquatk" = "xyes" ; then
	ac_configure_args="$ac_configure_args --enable-aqua --disable-xft"
    fi
    TK_PATH="$PWD/${ac_top_builddir}/src/other/tk/unix"
    ac_configure_args="$ac_configure_args --with-tk=\"$TK_PATH\""
    AC_CONFIG_SUBDIRS([src/other/tk/unix])
    TK_PATH="`echo ${TK_PATH} | sed 's/\\/\\//\\//g;s/\\//\\\\\\//g'`"
fi
AC_SUBST(TK_PATH)

dnl configure enigma
AC_CONFIG_SUBDIRS([misc/enigma])

dnl configure step
if test "x$build_brlcad_step" = "xyes" ; then
    AC_CONFIG_SUBDIRS([src/other/step])
fi

dnl configure tkhtml3
if test "x$build_brlcad_tkhtml3" = "xyes" ; then
    ac_configure_args="$ac_configure_args --exec-prefix=\"$bc_prefix\""
    AC_CONFIG_SUBDIRS([src/other/tkhtml3])
fi

dnl configure togl
if test "x$build_brlcad_togl" = "xyes" ; then
    ac_configure_args="$ac_configure_args --exec-prefix=\"$bc_prefix\""
    AC_CONFIG_SUBDIRS([src/other/togl])
fi

AC_CONFIG_FILES([
	Makefile
	bench/Makefile
	regress/Makefile
	regress/mged/Makefile
	db/Makefile
	db/include/Makefile
	doc/Makefile
	doc/book/Makefile
	doc/docbook/Makefile
	doc/docbook/fop.xconf
	doc/html/Makefile
	doc/html/ReleaseNotes/Makefile
	doc/html/ReleaseNotes/Rel5.0/Makefile
	doc/html/ReleaseNotes/Rel5.0/Summary/Makefile
	doc/html/ReleaseNotes/Rel6.0/Makefile
	doc/html/manuals/Anim_Tutorial/Makefile
	doc/html/manuals/Makefile
	doc/html/manuals/archer/Makefile
	doc/html/manuals/cadwidgets/Makefile
	doc/html/manuals/libbu/Makefile
	doc/html/manuals/libdm/Makefile
	doc/html/manuals/librt/Makefile
	doc/html/manuals/mged/Makefile
	doc/html/manuals/mged/animmate/Makefile
	doc/html/manuals/shaders/Makefile
	doc/legal/Makefile
	doc/pad_file.xml
	include/Makefile
	include/conf/Makefile
	m4/Makefile
	misc/Makefile
	misc/archlinux/Makefile
	misc/brlcad-config
	misc/brlcad.spec
	misc/debian/Makefile
	misc/debian/changelog
	misc/macosx/Makefile
	misc/macosx/Resources/Makefile
	misc/macosx/Resources/ReadMe.rtfd/Makefile
	misc/macosx/Resources/Welcome.rtfd/Makefile
	misc/nsis/Makefile
	misc/pkgconfig/Makefile
	misc/pkgconfig/libbn.pc
	misc/pkgconfig/libbrlcad.pc
	misc/pkgconfig/libbu.pc
	misc/pkgconfig/libdm.pc
	misc/pkgconfig/libfb.pc
	misc/pkgconfig/libfft.pc
	misc/pkgconfig/libged.pc
	misc/pkgconfig/libgcv.pc
	misc/pkgconfig/libmultispectral.pc
	misc/pkgconfig/liboptical.pc
	misc/pkgconfig/libpc.pc
	misc/pkgconfig/libpkg.pc
	misc/pkgconfig/librt.pc
	misc/pkgconfig/libwdb.pc
	misc/win32-msvc/Dll/Makefile
	misc/win32-msvc/Makefile
	misc/win32-msvc8/Makefile
	pix/Makefile
	sh/Makefile
	src/Makefile
	src/adrt/Makefile
	src/anim/Makefile
	src/archer/Makefile
	src/archer/plugins/Commands/Makefile
	src/archer/plugins/Core/Makefile
	src/archer/plugins/Makefile
	src/archer/plugins/Utility/Makefile
	src/archer/plugins/Utility/attrGroupsDisplayUtilityP/Makefile
	src/archer/plugins/Wizards/Makefile
	src/archer/plugins/Wizards/humanwizard/Makefile
	src/archer/plugins/Wizards/tankwizard/Makefile
	src/archer/plugins/Wizards/tankwizard/images/Makefile
	src/archer/plugins/Wizards/tirewizard/Makefile
	src/brlman/Makefile
	src/brlman/brlman.sh
	src/burst/Makefile
	src/bwish/Makefile
	src/canon/Makefile
	src/conv/Makefile
	src/conv/iges/Makefile
	src/conv/intaval/Makefile
	src/conv/step/Makefile
	src/external/Makefile
	src/external/Cubit/Makefile
	src/external/EndgameFramework/Makefile
	src/external/ProEngineer/Makefile
	src/external/ProEngineer/mk
	src/external/ProEngineer/protk.dat
	src/external/Unigraphics/Makefile
	src/fb/Makefile
	src/fbed/Makefile
	src/fbserv/Makefile
	src/gtools/Makefile
	src/gtools/beset/Makefile
	src/halftone/Makefile
	src/irprep/Makefile
	src/java/Makefile
	src/java/mil/Makefile
	src/java/mil/army/Makefile
	src/java/mil/army/arl/Makefile
	src/java/mil/army/arl/brlcad/Makefile
	src/lgt/Makefile
	src/libbn/Makefile
	src/libbu/Makefile
	src/libcursor/Makefile
	src/libdm/Makefile
	src/libfb/Makefile
	src/libfft/Makefile
	src/libgcv/Makefile
	src/libged/Makefile
	src/libmultispectral/Makefile
	src/liboptical/Makefile
	src/liborle/Makefile
	src/libpc/Makefile
	src/libpkg/Makefile
	src/librt/Makefile
	src/librtserver/Makefile
	src/libsysv/Makefile
	src/libtclcad/Makefile
	src/libtermio/Makefile
	src/libwdb/Makefile
	src/mged/Makefile
	src/mged/points/Makefile
	src/nirt/Makefile
	src/nirt/sfiles/Makefile
	src/other/Makefile
	src/other/URToolkit/Makefile
	src/other/URToolkit/cnv/Makefile
	src/other/URToolkit/cnv/rletoabA62/Makefile
	src/other/URToolkit/cnv/rletogif/Makefile
	src/other/URToolkit/man/Makefile
	src/other/URToolkit/tools/Makefile
	src/other/URToolkit/tools/clock/Makefile
	src/other/awf/Makefile
	src/other/incrTcl/Makefile
	src/other/incrTcl/doc/Makefile
	src/other/incrTcl/itcl/Makefile
	src/other/incrTcl/itcl/doc/Makefile
	src/other/incrTcl/itcl/generic/Makefile
	src/other/incrTcl/itcl/library/Makefile
	src/other/incrTcl/itcl/pkgIndex.tcl
	src/other/incrTcl/itk/Makefile
	src/other/incrTcl/itk/doc/Makefile
	src/other/incrTcl/itk/generic/Makefile
	src/other/incrTcl/itk/library/Makefile
	src/other/incrTcl/itk/pkgIndex.tcl
	src/other/incrTcl/tools/Makefile
	src/other/iwidgets/Makefile
	src/other/iwidgets/doc/Makefile
	src/other/iwidgets/generic/Makefile
	src/other/iwidgets/iwidgets.tcl
	src/other/iwidgets/pkgIndex.tcl
	src/other/jove/Makefile
	src/other/jove/teach-jove
	src/other/libpng/Makefile
	src/other/libregex/Makefile
	src/other/libtermlib/Makefile
	src/other/libutahrle/Makefile
	src/other/libutahrle/include/Makefile
	src/other/libz/Makefile
	src/other/openNURBS/Makefile
	src/other/tcl/Makefile
	src/other/tk/Makefile
	src/other/tkimg/Makefile
	src/other/tkimg/base/Makefile
	src/other/tkimg/png/Makefile
	src/other/tkimg/pngtcl/Makefile
	src/other/tkimg/zlibtcl/Makefile
	src/other/tnt/Makefile
	src/proc-db/Makefile
	src/remrt/Makefile
	src/rt/Makefile
	src/rttherm/Makefile
	src/shapes/Makefile
	src/sig/Makefile
	src/tab/Makefile
	src/tclscripts/Makefile
	src/tclscripts/archer/Makefile
	src/tclscripts/archer/images/Makefile
	src/tclscripts/archer/images/Themes/Makefile
	src/tclscripts/archer/images/Themes/Crystal/Makefile
	src/tclscripts/archer/images/Themes/Crystal_Large/Makefile
	src/tclscripts/archer/images/Themes/Windows/Makefile
	src/tclscripts/geometree/Makefile
	src/tclscripts/lib/Makefile
	src/tclscripts/mged/Makefile
	src/tclscripts/nirt/Makefile
	src/tclscripts/pl-dm/Makefile
	src/tclscripts/rtwizard/Makefile
	src/tclscripts/rtwizard/examples/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeA/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeB/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeC/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeD/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeE/Makefile
	src/tclscripts/rtwizard/examples/PictureTypeF/Makefile
	src/tclscripts/rtwizard/lib/Makefile
	src/tclscripts/sdialogs/Makefile
	src/tclscripts/sdialogs/scripts/Makefile
	src/tclscripts/swidgets/Makefile
	src/tclscripts/swidgets/images/Makefile
	src/tclscripts/swidgets/scripts/Makefile
	src/tclscripts/util/Makefile
	src/util/Makefile
	src/vas4/Makefile
	src/vdeck/Makefile
	src/vfont/Makefile
])

# let the BC_CONFIG_CACHE know we completed successfully (must come before AC_OUTPUT)
BC_CONFIG_COMPLETE

# GENERATE EVERYTHING
AC_OUTPUT

# ac_top_builddir and other variables are modified after AC_OUTPUT so
# plan accordingly and save them beforehand.
ac_configure_args="$bc_configure_args"

# patch libtool if it has one of several common bugs and/or busted
# default configurations (e.g. Debian)
BC_PATCH_LIBTOOL


dnl
dnl Expand the variables for summary reporting
dnl
prefix=`eval "echo $prefix"`
prefix=`eval "echo $prefix"`
bindir=`eval "echo $bindir"`
bindir=`eval "echo $bindir"`
sysconfdir=`eval "echo $sysconfdir"`
sysconfdir=`eval "echo $sysconfdir"`
mandir=`eval "echo $mandir"`
mandir=`eval "echo $mandir"`
datadir=`eval "echo $datadir"`
datadir=`eval "echo $datadir"`

dnl
dnl Compute configuration time elapsed
dnl
if test -x "${srcdir}/sh/elapsed.sh" ; then
	time_elapsed="`${srcdir}/sh/elapsed.sh $CONFIG_TS`"
else
	time_elapsed="unknown"
fi


# AC_OUTPUT won't update the brlcad_config.h.in template timestamp if
# the file is unchanged.  forcibly update the timestamp so autoheader
# doesn't try to invoke.
if test ! "x`cat include/brlcad_config.h.in`" = "x" ; then
    touch include/brlcad_config.h.in
fi


dnl **********************
dnl *** Report Summary ***
dnl **********************

AC_MSG_RESULT([Done.])
AC_MSG_RESULT([])
BC_BOLD
AC_MSG_RESULT([BRL-CAD Release $BRLCAD_VERSION, Build $CONFIG_DATE])
BC_UNBOLD
AC_MSG_RESULT([])
AC_MSG_RESULT([             Prefix: ${bc_prefix}])
AC_MSG_RESULT([           Binaries: ${bindir}])
AC_MSG_RESULT([       Manual pages: ${mandir}])
AC_MSG_RESULT([Configuration files: ${sysconfdir}])
AC_MSG_RESULT([Data resource files: ${bc_data_dir}])
if test ! "x$BC_ARGS" = "x" ; then
AC_MSG_RESULT([Options & variables: $BC_ARGS])
fi
AC_MSG_RESULT([])
AC_MSG_RESULT([CC       = ${CC}])
AC_MSG_RESULT([CXX      = ${CXX}])
if test ! "x$CFLAGS" = "x" ; then
AC_MSG_RESULT([CFLAGS   = ${CFLAGS}])
fi
if test ! "x$CXXFLAGS" = "x" ; then
AC_MSG_RESULT([CXXFLAGS = ${CXXFLAGS}])
fi
if test ! "x$CPPFLAGS" = "x" ; then
AC_MSG_RESULT([CPPFLAGS = ${CPPFLAGS}])
fi
if test ! "x$LDFLAGS" = "x" ; then
AC_MSG_RESULT([LDFLAGS  = ${LDFLAGS}])
fi
if test ! "x$LIBS" = "x" ; then
AC_MSG_RESULT([LIBS     = ${LIBS}])
fi
AC_MSG_RESULT([])
AC_MSG_RESULT([Build Tcl ............................: $build_brlcad_tcl])
AC_MSG_RESULT([Build Tk .............................: $build_brlcad_tk])
AC_MSG_RESULT([Build Itcl/Itk .......................: $build_brlcad_itcl])
AC_MSG_RESULT([Build IWidgets .......................: $build_brlcad_iwidgets])
AC_MSG_RESULT([Build tkhtml3 ........................: $build_brlcad_tkhtml3])
AC_MSG_RESULT([Build togl... ........................: $build_brlcad_togl])
AC_MSG_RESULT([Build tkImg ..........................: $build_brlcad_tkimg])
AC_MSG_RESULT([Build libpng .........................: $build_brlcad_png])
AC_MSG_RESULT([Build libregex .......................: $build_brlcad_regex])
AC_MSG_RESULT([Build zlib ...........................: $build_brlcad_zlib])
AC_MSG_RESULT([Build termlib ........................: $build_brlcad_termlib])
AC_MSG_RESULT([Build Utah Raster Toolkit.............: $build_brlcad_urt])
AC_MSG_RESULT([Build Template Numerical Toolkit......: $build_brlcad_tnt])
AC_MSG_RESULT([Build openNURBS.......................: $build_brlcad_opennurbs])
AC_MSG_RESULT([Build NIST STEP Class Libraries.......: $build_brlcad_step])
AC_MSG_RESULT([Build jove ...........................: $build_brlcad_jove])
AC_MSG_RESULT([])
AC_MSG_RESULT([X11 support (optional)................: $build_against_x11])
AC_MSG_RESULT([OpenGL support (optional).............: $build_against_opengl])
AC_MSG_RESULT([librtserver JDK support (optional)....: $build_against_java])
AC_MSG_RESULT([Enable run-time debugging (optional)..: $bc_build_runtime_debug])
AC_MSG_RESULT([])
AC_MSG_RESULT([Build 64-bit release .................: $build_brlcad_64bit])
AC_MSG_RESULT([Build optimized release ..............: $bc_use_optimized])
AC_MSG_RESULT([Build debug release ..................: $bc_use_debug])
AC_MSG_RESULT([Build profile release ................: $bc_use_profiling])
AC_MSG_RESULT([Build SMP-capable release ............: $bc_build_parallel])
AC_MSG_RESULT([Build static libraries ...............: $enable_static])
AC_MSG_RESULT([Build shared/dynamic libraries .......: $enable_shared])
AC_MSG_RESULT([Print verbose compilation warnings ...: $bc_build_warnings])
AC_MSG_RESULT([Print verbose compilation progress ...: $bc_build_progress])
AC_MSG_RESULT([])
AC_MSG_RESULT([Only build benchmark suite ...........: $bc_only_benchmark])
AC_MSG_RESULT([Only build librtserver ...............: $bc_only_rts])
AC_MSG_RESULT([Install example geometry models ......: $bc_install_geometry])
AC_MSG_RESULT([Install extra docs ...................: $docbook_processing])
AC_MSG_RESULT([])
if test "x$time_elapsed" != "xunknown" ; then
AC_MSG_RESULT([Elapsed configuration time ...........: $time_elapsed])
fi
AC_MSG_RESULT([---])
AC_MSG_RESULT([$0 complete, type 'make' to begin building])
AC_MSG_RESULT([])

# Local Variables:
# tab-width: 8
# mode: autoconf
# sh-indentation: 4
# sh-basic-offset: 4
# indent-tabs-mode: t
# End:
# ex: shiftwidth=4 tabstop=8
