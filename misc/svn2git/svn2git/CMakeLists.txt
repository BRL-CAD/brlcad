# Minimum required version of CMake
cmake_minimum_required(VERSION 2.8)
if(COMMAND CMAKE_POLICY)
	CMAKE_POLICY(SET CMP0003 NEW)
	if ("${CMAKE_VERSION}" VERSION_GREATER 2.99)
		CMAKE_POLICY(SET CMP0026 OLD)
	endif ("${CMAKE_VERSION}" VERSION_GREATER 2.99)
endif(COMMAND CMAKE_POLICY)

# Set CMake project name
project(SVN2GIT)

set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH};${SVN2GIT_SOURCE_DIR}/CMake")
find_package(SubversionLibrary)
find_package(APR)
find_package(Qt4 REQUIRED QtCore)
include(${QT_USE_FILE})
include_directories(
	${CMAKE_CURRENT_SOURCE_DIR}
	${SUBVERSION_INCLUDE_DIRS}
	${APR_INCLUDE_DIRS}
	)

include(CheckFunctionExists)
cmake_push_check_state(RESET)
set(CMAKE_REQUIRED_INCLUDES ${SUBVERSION_INCLUDE_DIRS})
set(CMAKE_REQUIRED_LIBRARIES ${SUBVERSION_LIBRARIES})
check_function_exists(svn_repos_open3 HAVE_SVN_REPOS_OPEN3)
if(NOT HAVE_SVN_REPOS_OPEN3)
	check_function_exists(svn_repos_open HAVE_SVN_REPOS_OPEN)
	if(HAVE_SVN_REPOS_OPEN)
		add_definitions(-DUSE_SVN_REPOS_OPEN=1)
		add_definitions(-Wno-deprecated-declarations)
	endif(HAVE_SVN_REPOS_OPEN)
endif(NOT HAVE_SVN_REPOS_OPEN3)
check_function_exists(svn_stream_read_full HAVE_SVN_STREAM_READ_FULL)
if(NOT HAVE_SVN_STREAM_READ_FULL)
	check_function_exists(svn_stream_read HAVE_SVN_STREAM_READ)
	if(HAVE_SVN_STREAM_READ)
		add_definitions(-DUSE_SVN_STREAM_READ=1)
		add_definitions(-Wno-deprecated-declarations)
	endif(HAVE_SVN_STREAM_READ)
endif(NOT HAVE_SVN_STREAM_READ_FULL)
check_function_exists(svn_stream_copy3 HAVE_SVN_STREAM_COPY3)
if(NOT HAVE_SVN_STREAM_COPY3)
	check_function_exists(svn_stream_copy HAVE_SVN_STREAM_COPY)
	if(HAVE_SVN_STREAM_COPY)
		add_definitions(-DUSE_SVN_STRAM_COPY=1)
		add_definitions(-Wno-deprecated-declarations)
	endif(HAVE_SVN_STREAM_COPY)
endif(NOT HAVE_SVN_STREAM_COPY3)
cmake_pop_check_state()

set(SVN2GIT_SRCS
	ruleparser.cpp
	repository.cpp
	svn.cpp
	main.cpp
	CommandLineParser.cpp
	)

add_definitions(-DVER="brlcad-svn2git-20140907")

add_executable(svn-all-fast-export ${SVN2GIT_SRCS})
target_link_libraries(svn-all-fast-export ${SUBVERSION_LIBRARIES} ${QT_LIBRARIES})

# Local Variables:
# tab-width: 8
# mode: cmake
# indent-tabs-mode: t
# End:
# ex: shiftwidth=2 tabstop=8










######################################################################
# Automatically generated by qmake (2.01a) dim. dc. 23 13:49:28 2007
######################################################################

#SVN_INCLUDE = /usr/include/subversion-1 /usr/local/include/subversion-1
#APR_INCLUDE = /usr/include/apr-1.0 /usr/include/apr-1 /usr/local/include/apr-1

#INCLUDEPATH += . $$SVN_INCLUDE $$APR_INCLUDE
#!isEmpty($$SVN_LIBDIR): LIBS += -L$$SVN_LIBDIR
#LIBS += -lsvn_fs-1 -lsvn_repos-1 -lapr-1 -lsvn_subr-1

