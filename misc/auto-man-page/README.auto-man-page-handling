Rules:
=====

+ Provide a version-controlled list of all bin programs to be
  processed for the "auto-man" documentation feature:

    auto-man-progs.txt

+ In the auto-man list each bin program name will be listed followed
  on the same line by the source file which provides it, e.g.,

    burst    ./src/burst/burst.c

+ Each bin source file must have one instance each of the following
  string variables:

  const char usage[]     = "...."; /* mandatory: used for the SYNOPSIS 
                                      section of the man page */
  const char optstring[] = "";     /* mandatory for use with bu_getopt if it is used */

+ Other man page inputs come from one or more specially-formatted
  ordinary C-style comment blocks (Doxygen-style comments beginning
  with '/**' or '/*!' are completely ignored).

  Each such block is divided into one or more parts beginning with a
  keyword ('partname:'; but see 'opt:' later) which identifies a
  section to appear in the man page.

  The block must begin with the following format or it will be ignored:

  - Immediately following the opening '/*' must be one or more white
    space characters (newlines allowed) followed by one keyword
    followed by on or more white-space characters followed by its
    description (its 'value').  Note the description must exist (i.e.,
    its value must be at least one printable character).

  - A blank line inside a part description results in a new paragraph.

  - The part name may have underscores.  The part name will be
    translated into upper case and underscores into spaces in the man
    page.

  - Following the mandatory first part may be more parts.  

  - A description ends when the next part keyword is found or the the
    comment block ends.

  - Embedded asterisks surrounded by white space are ignored (to allow
    for the decorated comment style).

  - All the part desciptions may use valid DocBook code.

  Some part names are mandatory and some parts have default values.
  All part names must be unique except the 'opt:' part which may
  appear as many times as there are options.  Note option names follow
  the 'opt:' keyword and they must be unique.  Furthermore, the list
  of options in the comment blocks must exactly match the option in
  the optstring if it appears in the file.

  Each option (keyword 'opt:') must be described in one of three
  possible formats:

     opt: -c [N] description of this option and its optional arg N
     opt: -a <Z> description of this option and its mandatory arg Z
     opt: -d  description of this option which has no args

  Following is an example of such a comment block:

  /*
   * section1:  description
   *
   *  more description but this follows a blank line so it begins a new para

   anothersection: description ...

   ...

   opt: optiona description

   another para for optiona

   opt: optiond ...

  */

+ Mandatory parts:

    purpose: ...brief description for NAME section...

    description: some words, should give user a good idea of how and why 
         to use the program

      ...this will appear in the DESCRIPTION section

    opt: option

      ... one for each option (if any), all will be put in an OPTIONS 
          section

+ Default parts (user may override by explictly providing them):

    copyright: YYYY
  
      where YYYY is the beginning copyright year (default is 1984).

    diagnostics:

      default: Error messages are intended to be self-explanatory.

    authors:

      default:  BRL-CAD Team

    bug_reports:

      default:  Reports of bugs or problems should be submitted via
                electronic mail to <devs@brlcad.org>.

+ Optional but desirable parts:

    see_also:

      ...list of man pages (with sections) or other references,
      semicolon-separated, no other embellishments...

      ...list will go in the SEE ALSO section...

Translation:
===========

+ The purpose string will be used in the NAME section, e.g.:

NAME
       ls - list directory contents

+ The usage string will be used for the SYNOPSIS section.  For
  example:

    const char usage[] = "\
Usage: fbserv port_num\n\
	  (for a stand-alone daemon)\n\
   or  fbserv [-v] [-{sS} squaresize]\n\
	  [-{wW} width] [-{nN} height] -p port_num -F frame_buffer\n\
	  (for a single-frame-buffer server)\n\
          (can omit -p and -F, in which case port_num and frame_buffer\n\
           must appear in that order)\n\
";

  (Such a case may have to be specially handled for ease of parsing.)

Processing:
==========

A C++ program (version controlled) will be used to parse the source
files (defined in the file 'auto-man-progs.txt') and, after successful
parsing, a complete docbook file in man format is written to file
"progname.xml" in directory:

  ./doc/docbook/system/man1/en/

Assumptions:
===========

+ C++-style comments are ignored unless they are inside a C-style
  comment in which case they are treated as ordinary text.

+ No more than one C-style comment or partial comment is allowed per
  line.
