/*
			lgt/Cakefile

   FONTDIR is pathname to font file (times.r.6) which is included with sources
   but on real BSD systems is found in /usr/lib/vfont.  So on non-BSD systems,
   change path to the absolute directory path name where 'times.r.6' lives in
   the variable FONTDIR, and add it to CONFIGDEFS with 4 backslashes.

   Also, for debugging, ADB and DBX typically don't see 'static' functions, so
   add the following to CONFIGDEFS:

	-DSTATIC=

   To suppress warning messages on Suns running older releases than SunOS 4,
   due to incorrect declarations of signal() before release 4.0, add the
   following to CONFIGDEFS:

	-DSunOS4=0

 */

#if 1
# define CONFIGDEFS	LGT_CONFIG -DBEHIND_ME_TOL=0.05 /* -DDEBUG */
#else
# define CONFIGDEFS	LGT_CONFIG -DBEHIND_ME_TOL=0.05 -DFONTDIR=\\\\"/usr/brlcad/vfont\\\\"
#endif

#define SRCDIR	lgt
#define PRODUCTS	lgt
#define	SRCSUFF	.c
#define MANSECTION	1

#define FILES	lgt char do_options getfont error\
	execshell fb glob grid_rotate ir lgt_db mat_db octree\
	prnt reflect texture trie sgi_dep\
	strtok hmenu
#define TFILES	tfiles/ldb tfiles/mdb tfiles/model.g tfiles/key tfiles/lgt.in

#define PIXCMP	../bench/pixcmp

#include "../Cakefile.defs"
#include "../Cakefile.prog"

/* Explicit composition of each product */

lgt:	OBJ
	CC LDFLAGS -o lgt OBJ LIBRT LIBBN LIBBU LIBBU_LIBES LIBFB LIBFB_LIBES LIBTERMIO LIBCURSOR LIBTERMLIB LIBES

tfiles/model.g:	tfiles/model.asc
	asc2g < tfiles/model.asc > tfiles/model.g

/* The 'test' and 'untest' targets are for local testing where the 'tfiles'
	sub-directory is available.  Since 'tfiles' is not part of the
	BRLCAD distribution, remote sites should use bench/lgt.sh to test
	'lgt'.
 */
test&:	TFILES PRODUCTS PIXCMP
	@./lgt tfiles/model.g all.g < tfiles/lgt.in && tfiles/script1 < /dev/null && tfiles/script2 < /dev/null && tfiles/script3 < /dev/null || \{ echo "Test failed."; exit 1; }
	@for i in 1 2 3; do if PIXCMP tfiles/image$\{i\}.pix tfiles/image$\{i\}a.pix; then :; else echo "Test failed."; exit 1; fi; done
	@for i in 1 2 3; do if PIXCMP tfiles/image$\{i\}a.pix tfiles/image$\{i\}b.pix; then :; else echo "Test failed."; exit 1; fi; done
	@echo "Tested OK."

untest&:
	rm -f tfiles/script\? tfiles/\*.pix tfiles/model.g

#include "../Cakefile.rules"
