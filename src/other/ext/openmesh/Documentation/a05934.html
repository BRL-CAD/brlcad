<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenMesh: Filtering ranges with predicates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="logo_align.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rwth_vci_rgb.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenMesh
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a05934.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Filtering ranges with predicates </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This examples shows:</p>
<ul>
<li>How to use predicates to filter which elements of a mesh you want iterate over</li>
</ul>
<p>In the previous tutorial we discussed already that the ranges returned by functions like all_vertices(), voh_range() or outgoing_halfedges() provide a few helpful methods such as avg() or to_vector(). Another interesting method is filtered() which requires as argument something that can be called for an element of the range and returns a bool. The resulting range will then only iterate over elements for which the filter returs true. The filter can be a lambda, a function pointer, a property manager holding a bool property, or a functor object such as the predicates defined in &lt;<a class="el" href="a00473_source.html">OpenMesh/Core/Utils/Predicates.hh</a>&gt;. The predefined predicates can check the status of a mesh element and test if they are boundary. With their help you can for example count all boundary vertices:</p>
 <div class="fragment"><div class="line">  <span class="comment">// Count boundary vertices</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Mesh contains &quot;</span> &lt;&lt; mesh.vertices().count_if(Boundary()) &lt;&lt; <span class="stringliteral">&quot; boundary vertices&quot;</span>;</div>
</div><!-- fragment --><p> Predicates can be composed using the operators ||, &amp;&amp;, and !. This enables you to specify precisely which elements you want process in your loop, e.g. inner vertices that are selected:</p>
<div class="fragment"><div class="line">  <span class="comment">// Selected inner vertices</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;These are the selected inner vertices: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> vh : mesh.vertices().filtered(!Boundary() &amp;&amp; Selected()))</div>
<div class="line">    std::cout &lt;&lt; vh.idx() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> As mentioned above, the filter argument can be anything returning a bool for a given input, e.g. a function pointer:</p>
<div class="fragment"><div class="line">  <span class="comment">// Faces whose id is divisible by 3</span></div>
<div class="line">  <span class="keyword">auto</span> vec = mesh.faces().filtered(is_divisible_by_3).to_vector();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; vec.size() &lt;&lt; <span class="stringliteral">&quot; faces whose id is divisible by 3&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> However, function pointers, lambdas etc are not composable. Fortunately, you can use make_predicate to turn them into composable predicates:</p>
<div class="fragment"><div class="line">  <span class="comment">// Faces which are tagged or whose id is not divisible by 3</span></div>
<div class="line">  <span class="keyword">auto</span> vec2 = mesh.faces().filtered(Tagged() || !make_predicate(is_divisible_by_3)).to_vector();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; vec2.size() &lt;&lt; <span class="stringliteral">&quot; faces which are tagged or whose id is not divisible by 3&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> Below is the complete source code:</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;OpenMesh/Core/IO/MeshIO.hh&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;OpenMesh/Core/Mesh/DefaultTriMesh.hh&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;OpenMesh/Core/Utils/PropertyManager.hh&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;OpenMesh/Core/Utils/Predicates.hh&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="a02690.html">MyMesh</a> = <a class="code" href="a02682.html">OpenMesh::TriMesh</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> is_divisible_by_3(<a class="code" href="a02562.html">OpenMesh::FaceHandle</a> vh) { <span class="keywordflow">return</span> vh.<a class="code" href="a02546.html#abdf740ab77f5d0e97aa1a0ba971354e0">idx</a>() % 3 == 0; }</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span>OpenMesh::Predicates; <span class="comment">// for easier access to predicates</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Read command line options</span></div>
<div class="line">  <a class="code" href="a02690.html">MyMesh</a> mesh;</div>
<div class="line">  <span class="keywordflow">if</span> (argc != 4) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; infile&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">const</span> std::string infile = argv[1];</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Read mesh file</span></div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code" href="a01266.html#ac417960ec28ffdd7e7003a2b1ebb2d1c">OpenMesh::IO::read_mesh</a>(mesh, infile)) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: Cannot read mesh from &quot;</span> &lt;&lt; infile &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Count boundary vertices</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Mesh contains &quot;</span> &lt;&lt; mesh.vertices().count_if(Boundary()) &lt;&lt; <span class="stringliteral">&quot; boundary vertices&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Selected inner vertices</span></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;These are the selected inner vertices: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> vh : mesh.vertices().filtered(!Boundary() &amp;&amp; Selected()))</div>
<div class="line">    std::cout &lt;&lt; vh.<a class="code" href="a02546.html#abdf740ab77f5d0e97aa1a0ba971354e0">idx</a>() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">  std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Faces whose id is divisible by 3</span></div>
<div class="line">  <span class="keyword">auto</span> vec = mesh.faces().filtered(is_divisible_by_3).to_vector();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; vec.size() &lt;&lt; <span class="stringliteral">&quot; faces whose id is divisible by 3&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Faces which are tagged or whose id is not divisible by 3</span></div>
<div class="line">  <span class="keyword">auto</span> vec2 = mesh.faces().filtered(Tagged() || !make_predicate(is_divisible_by_3)).to_vector();</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; vec2.size() &lt;&lt; <span class="stringliteral">&quot; faces which are tagged or whose id is not divisible by 3&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Edges that are longer than 10 or shorter than 2</span></div>
<div class="line">  <a class="code" href="a03302.html">OpenMesh::EProp&lt;bool&gt;</a> longer_than_10(mesh);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> eh : mesh.edges())</div>
<div class="line">    longer_than_10[eh] = mesh.<a class="code" href="a02694.html#a7d170b57c860a510e4d430efc873f1a0">calc_edge_length</a>(eh) &gt; 10;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt;</div>
<div class="line">    mesh.edges().count_if(make_predicate(longer_than_10) || make_predicate([&amp;](<a class="code" href="a02558.html">OpenMesh::EdgeHandle</a> eh) { <span class="keywordflow">return</span> mesh.<a class="code" href="a02694.html#a7d170b57c860a510e4d430efc873f1a0">calc_edge_length</a>(eh) &lt; 2; })) &lt;&lt;</div>
<div class="line">    <span class="stringliteral">&quot; edges which are shorter than 2 or longer than 10&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="aa01266_html_ac417960ec28ffdd7e7003a2b1ebb2d1c"><div class="ttname"><a href="a01266.html#ac417960ec28ffdd7e7003a2b1ebb2d1c">OpenMesh::IO::read_mesh</a></div><div class="ttdeci">bool read_mesh(Mesh &amp;_mesh, const std::string &amp;_filename)</div><div class="ttdoc">Read a mesh from file _filename.</div><div class="ttdef"><b>Definition:</b> MeshIO.hh:95</div></div>
<div class="ttc" id="aa02546_html_abdf740ab77f5d0e97aa1a0ba971354e0"><div class="ttname"><a href="a02546.html#abdf740ab77f5d0e97aa1a0ba971354e0">OpenMesh::BaseHandle::idx</a></div><div class="ttdeci">int idx() const</div><div class="ttdoc">Get the underlying index of this handle.</div><div class="ttdef"><b>Definition:</b> Handles.hh:69</div></div>
<div class="ttc" id="aa02558_html"><div class="ttname"><a href="a02558.html">OpenMesh::EdgeHandle</a></div><div class="ttdoc">Handle for a edge entity.</div><div class="ttdef"><b>Definition:</b> Handles.hh:135</div></div>
<div class="ttc" id="aa02562_html"><div class="ttname"><a href="a02562.html">OpenMesh::FaceHandle</a></div><div class="ttdoc">Handle for a face entity.</div><div class="ttdef"><b>Definition:</b> Handles.hh:142</div></div>
<div class="ttc" id="aa02682_html"><div class="ttname"><a href="a02682.html">OpenMesh::TriMesh_ArrayKernelT</a></div><div class="ttdoc">Triangle mesh based on the ArrayKernel.</div><div class="ttdef"><b>Definition:</b> TriMesh_ArrayKernelT.hh:96</div></div>
<div class="ttc" id="aa02690_html"><div class="ttname"><a href="a02690.html">OpenMesh::PolyMesh_ArrayKernelT</a></div><div class="ttdoc">Polygonal mesh based on the ArrayKernel.</div><div class="ttdef"><b>Definition:</b> PolyMesh_ArrayKernelT.hh:96</div></div>
<div class="ttc" id="aa02694_html_a7d170b57c860a510e4d430efc873f1a0"><div class="ttname"><a href="a02694.html#a7d170b57c860a510e4d430efc873f1a0">OpenMesh::PolyMeshT::calc_edge_length</a></div><div class="ttdeci">Scalar calc_edge_length(EdgeHandle _eh) const</div><div class="ttdoc">Compute normals for all primitives.</div><div class="ttdef"><b>Definition:</b> PolyMeshT.hh:424</div></div>
<div class="ttc" id="aa03302_html"><div class="ttname"><a href="a03302.html">OpenMesh::PropertyManager</a></div><div class="ttdoc">This class is intended to manage the lifecycle of properties.</div><div class="ttdef"><b>Definition:</b> PropertyManager.hh:76</div></div>
</div><!-- fragment --><hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr>
<address>
<small>
<a href="http://www.rwth-graphics.de" style="text-decoration:none;">
</a>
Project <b>OpenMesh</b>, 
&copy;&nbsp; Visual Computing Institute, RWTH Aachen.
Documentation generated using 
<a class="el" href="http://www.doxygen.org/index.html">
<b>doxygen</b>
</a>.
</small>
</address>
</body>
</html>
