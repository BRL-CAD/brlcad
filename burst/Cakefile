/*
			burst/Cakefile

	Author:		Gary S. Moss
			U. S. Army Ballistic Research Laboratory
			Aberdeen Proving Ground
			Maryland 21005-5066

	$Header$ (BRL)

 */
/* Remove the following line if you have BRLCAD 4.0 or later. */
/* #define LIBFB_LIBES	/**/

#define CONFIGDEFS	LGT_CONFIG -I. -U_POSIX_SOURCE /*-DDEBUG*/

#define SRCDIR	burst
#define PRODUCTS	burst
#define	SRCSUFF	.c
#define MANSECTION	1
#define FILES	burst error fb glob grid gridrotate idents\
		paint plot prnt trie ui\
		Hm HmGetc HmGlob Sc Tc
#include "../Cakefile.defs"
#include "../Cakefile.prog"

/* Explicit composition of each product */
PRODUCTS:	OBJ LIBRT_DEP LIBBN_DEP LIBFB_DEP LIBBU_DEP
	CC LDFLAGS -o burst OBJ LIBFB LIBFB_LIBES LIBRT LIBBN LIBBU LIBBU_LIBES LIBTERMLIB LIBES -lm

all&: PRODUCTS

test&:	../.burst.MTYPE/burst tfiles/ktank.g
	../.burst.MTYPE/burst -b < tfiles/ktank.in
	@if test $? -ne 0 \\
	then	echo "Test failed."; exit 1 \\
	fi
	diff tfiles/ktank.burst tfiles/ktank.burst.bak4.0
	@if test $? -ne 0 \\
	then	echo "Test failed."; exit 1 \\
	fi
	diff tfiles/ktank.shotlines tfiles/ktank.shotlines.bak4.0
	@if test $? -ne 0 \\
	then	echo "Test failed."; exit 1 \\
	fi
	@echo "Tested OK."

untest&:
	rm -f tfiles/ktank.burst tfiles/ktank.shotlines tfiles/ktank.plot \\
		tfiles/ktank.pix tfiles/ktank.g tfiles/ktank.log

tfiles/ktank.g:
	asc2g < ../burst/tfiles/ktank.asc > tfiles/ktank.g

#include "../Cakefile.rules"
