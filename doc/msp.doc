From: Dario Alcocer <dar@nucleus.uucp>
Newsgroups: comp.windows.ms,comp.sys.ibm.pc,comp.graphics
Subject: Re: Microsoft Windows Paint (.MSP) format?
Date: 1 Nov 89 19:33:01 GMT
Keywords: Paint, MSP

In article <7264@ttidca.TTI.COM>, svirsky@ttidca.TTI.COM (Bill Svirsky) writes:
> Can anyone tell me the format of Microsoft Windows Paint (.MSP) files, both
> the old and new formats? Thanks.
> 
> -- 
> Bill Svirsky, Citicorp+TTI, 3100 Ocean Park Blvd., Santa Monica, CA 90405
> Work phone: 213-450-9111 x2597
> svirsky@ttidca.tti.com | ...!{csun,psivax,rdlvax,retix}!ttidca!svirsky

The following is the Windows Paint file format, taken from the book
"The Programmer's PC Sourcebook", by Thom Hogan (Microsoft Press, 1988),
pg.298:

Offset		Length	Usually:	Description
------		------	--------	--------------------------
0		word	6144h		ver. of Paint used to create
2		word	4d6eh		ver. of Paint used to create
4		word			width of bitmap in pixels
6		word			height of bitmap in pixels
8		word			X aspect ratio of bitmap
A		word			Y aspect ratio of bitmap
C		word			X aspect ratio of printer
E		word			Y aspect ratio of printer
10		word			width of printer in pixels
12		word			height of printer in pixels
14		word			used for checksum calcs
16		word			used for checksum calcs
18		word			checksum of header
1A		word			reserved
1C		word			reserved
1E		word			reserved
20		varies			bitmap

Notes:
	A Paint file version 1.01 consists of a 32-byte header, as described
	above, followed by a bitmap organized as scan lines.  The total size
	of the bitmap will be = widthOfBitmap*heightOfBitmap/8

	The 3rd through the 10th fields in the header are determined by
	calling GetDeviceCaps()

	Paint files in Windows 2.03 use a different format

Hopes this helps.


-- Dario Alcocer (San Diego, CA)
via dar@nucleus.mi.org
