<refentry xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="comb">

  <refmeta>
    <refentrytitle>COMB</refentrytitle>
    <manvolnum>nged</manvolnum>
    <refmiscinfo class="source">BRL-CAD</refmiscinfo>
    <refmiscinfo class="manual">BRL-CAD User Commands</refmiscinfo>
  </refmeta>

  <refnamediv xml:id="name">
    <refname>comb</refname>
    <refpurpose>Creates a BRL-CAD combination with the name
    <emphasis>combination_name</emphasis>.
    </refpurpose>
  </refnamediv>

  <!-- body begins here -->
  <refsynopsisdiv xml:id="synopsis">
    <cmdsynopsis sepchar=" ">
      <command>comb</command>
      <group choice="opt" rep="norepeat">
        <arg choice="opt" rep="norepeat">-c</arg>
        <arg choice="opt" rep="norepeat">-r</arg>
      </group>
      <arg choice="opt" rep="norepeat">-w</arg>
      <arg choice="req" rep="norepeat"><replaceable>combination_name</replaceable> </arg>
      <arg choice="opt" rep="repeat"><replaceable>&lt;operator object_name&gt;</replaceable> </arg>
    </cmdsynopsis>
  </refsynopsisdiv>

  <refsection xml:id="description"><title>DESCRIPTION</title>

    <para>The <command>comb</command> command creates a <emphasis>BRL-CAD</emphasis> combination
    with the name <emphasis>combination_name</emphasis>. The <option>r</option> option
    indicates that the combination is a <emphasis>BRL-CAD </emphasis>region. The
    <option>c</option> option is the default and indicates that the combination is not
    a region. The <emphasis>operator/object_name</emphasis> pairs are combinations of boolean
    operators and object names to be added to the comb.
    </para>
    <para>The <option>w</option> moves the contentions of a combination to a new combination
    and makes that combination the sole child of the original combination.  See the "fixing
    nested regions" example below for an illustration of how this option is used.
    </para>
  </refsection>

  <refsection xml:id="examples"><title>EXAMPLES</title>

    <para>
      This example shows how to use the <command>comb</command> command to create a combination
      according to a given formula.
    </para>
    <example><title>Creating a combination.</title>

      <variablelist>
	<varlistentry>
	  <term><prompt>mged&gt;</prompt> <userinput>comb abc u a u b - a + d</userinput></term>
	  <listitem>
	    <para>Creates a combination named <emphasis>abc</emphasis>.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </example>

    <example><title>Fixing a nested region.</title>

      <variablelist>
	<varlistentry>
	  <term>
         Suppose we have a situation where region2.r is unioned into region1.r, and both
         region1.r and region2.r have the region flag set, as seen in the tree below.  
          </term>

<listitem>	
      <literallayout>
      <computeroutput>
<prompt>mged&gt;</prompt> <userinput>tree region1.r</userinput>
region1.r/R
        u region2.r/R
	        u sph.s
        u comb.c/
                u arb.s
      </computeroutput>
      </literallayout>

      <para>
      This geometry has an error in that one
      region is not supposed to be combined into another using boolean operations.
      Further, suppose that one or
      more assemblies use region2.r and expect it to be a region - i.e., region2.r needs
      to remain a region with the same contents.  

      To fix this problem without disturbing other geometry using region2.r, first 
      make a combination below region2.r using the <option>w</option> flag to <command>comb</command>:
      </para>

      <literallayout>
      <computeroutput>
<prompt>mged&gt;</prompt> <userinput>c -w region2.r</userinput>
<prompt>mged&gt;</prompt> <userinput>tree region2.r</userinput>
region2.r/R
        u region2.r.c/
                  u sph.s
      </computeroutput>
      </literallayout>

      <para>
        The next step is to adjust the region1.r tree definition to reference the
        non-region combination instead of region2.r:
      </para>

      <literallayout>
      <computeroutput>
<prompt>mged&gt;</prompt> <userinput>set glob_compat_mode 0</userinput>
0
<prompt>mged&gt;</prompt> <userinput>get region1.r tree</userinput>
u {l region2.r} {l comb.c}
<prompt>mged&gt;</prompt> <userinput>adjust region1.r tree {u {l region2.r.c} {l comb.c}}</userinput>
<prompt>mged&gt;</prompt> <userinput>tree region1.r</userinput>
region1.r/R
        u region2.r.c/
                u sph.s
        u comb.c/
                u arb.s
      </computeroutput>
      </literallayout>
      
      <para>
        Because the tree is manipulated as a Tcl list, we need glob compatibility mode to be
        off on the MGED command line.  Once the tree is re-defined, region1.r no longer has
        region2.r below it, but still defines the same physical volume via region2.r.c.
      </para>

      <para>
        Optionally, the name region2.r.c can be changed to the name region2.c with 
        the <command>mvall</command> command: 
      </para>

      <literallayout>
      <computeroutput>
<prompt>mged&gt;</prompt> <userinput>mvall region2.r.c region2.c</userinput>
<prompt>mged&gt;</prompt> <userinput>tree region1.r</userinput>
region1.r/R
        u region2.c/
                u sph.s
        u comb.c/
                u arb.s
<prompt>mged&gt;</prompt> <userinput>tree region2.r</userinput>
region2.r/R
        u region2.c/
                u sph.s
      </computeroutput>
      </literallayout>
	  </listitem>
	</varlistentry>
      </variablelist>

    </example>
  </refsection>

  <refsection xml:id="author"><title>AUTHOR</title><para>BRL-CAD Team</para></refsection>

  <refsection xml:id="bug_reports"><title>BUG REPORTS</title>

    <para>
      Reports of bugs or problems should be submitted via electronic
      mail to &lt;devs@brlcad.org&gt;, or via the "cadbug.sh" script.
    </para>
  </refsection>
</refentry>
