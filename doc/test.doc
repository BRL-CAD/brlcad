.\" $Header$
.\" tbl benchmark.doc | troff -t -ms | ...
.TL
The BRL-CAD Benchmark Test
.AU
Michael John Muuss
.AU
Charles M. Kennedy
.AI
The Ballistic Research Laboratory
.PP
This document describes the BRL-CAD Benchmark Test Methodology,
and the Ray-Tracing Figure of Merit (RTFM) used to judge the
computational performance of different computer systems.
.PP
The core of the test is the \fBrt\fR ray-tracing program.
The results for each processor are determined by
running a benchmark test of the RT ray-tracing program on each of the sample
databases provided.
The \fBrt\fR program requires a binary database for input ("db/xxx.g"), and
produces a binary image as output ("bench/xxx.pix"), along with a log
file ("bench/xxx.log").
Each run will produce a 512x512x24 bit color
shaded image in a "bench/xxx.pix" file, and a run log in "bench/xxx.log".
Reference copies of the images are provided as "pix/xxx.pix" and
"pix/xxx.log".  The sample databases provided are processed in
order of increasing difficulty, and each produces a colorful image.  In
each picture there are two light sources; the primary source is located
near the center of the model (the white ball), and the secondary light
source is located at the "eye" position.
.NH 1
The Benchmark Models
.LP
moss.g  --  This is a simple model, containing a yellow torus,
a green ellipsoid, a bluish cube, a pink truncated (distorted) cone,
all sitting on a blue plate.  Note the shadowing, and "specular splash".
.sp
world.g -- The same model as moss.g, but with various rendering
features enabled.  The model is enclosed in a hollow cloud sphere.
The plate is a mirror, the egg is crystal, the box has a debugging
texture map applied.
.sp
star.g  --  A familiar sight to Star Trek fans;  a low-detail exterior
of the ship "Enterprise".  The hull is white, with some other structures
in other colors.  The small red object in the foreground is the
shuttlecraft Galileo, to scale.
.sp
bldg391.g  --  An exploded view of a two-story imaginary computer site,
including various walls, red stairways, green disk drives, etc.
The lower floor is a mirror, the upper floor is glass.
.NH 1
MACHINE INDEPENDENCE
.PP
To make the benchmark
distribution machine independent,
the databases are provided
in an ASCII format in the "db" directory, and
ascii-to-binary converters are provided in the "conv" directory.
The setup command "\fBcake benchmark\fR"
(see the document \fIInstalling the BRL-CAD Package\fR)
will automatically compile and run the converters.
.PP
If you are running this
benchmark on a non-UNIX machine that has difficulty writing binary
streams, change the "-o file.pix" flag to "-O file.a_pix" and RT
will write an ASCII form directly.  For more discussion, consult
the doc/pix.5 and conv/asc2pix.1 manual pages.
.PP
The reference images are distributed in binary BRL-CAD
.BR pix (5)
format.
Earlier releases distributed the reference images in the portable
ASCII form, and then converted them to the binary form.
This consumed a significant amount of extra storage on UNIX machines,
so this practice was discontinued.
It is assumed that anyone attempting to benchmark a system that
can not read pure binary files will at least have access to a
UNIX system.
That UNIX system can be used to convert the reference images to
the portable ASCII form with the
.BR pix2asc (1)
tool, and then those images may be sent to the machine under test.
.PP
Information about modifying the benchmark to run on a particular system
may be found in the document \fIInstalling the BRL-CAD Package\fR.
For a detailed explanation of various hardware specific modifications
necessary to take advantage of parallel processing, see the document
\fIWorkstations, Networking, Distributed Graphics, and
Parallel Processing\fR.
Implementations for several different types of hardware in use at BRL
are included.
.PP
If you encounter difficulty
with running the benchmark,
you might wish to build the full BRL-CAD package, to
take advantage of the image tools in determining the nature of the problem.
For example, one system suffered from a compiler bug that made
TGC solids vanish, while another system had difficulties with
the light visibility calculations.
.NH 1
OBTAINING CORRECT RESULTS
.PP
The benchmark timings are not considered valid unless
the correct results are given.
Make sure that the answers match the reference files
to within plus-or-minus one in each color (see pixdiff(1)).
Slight variations in the calculated pixels are generally attributable
to variations in floating point precision.
You may wish to
compare the execution times and log file remarks
from your tests (in the "bench/xxx.log" files) with the
VAX-11/780 (with hardware FPA) times which are given in the
"pix/xxx.log" files.
The reference images are also located in the "pix/" directory.
.PP
For example,
if you are running the benchmark on a Cray XMP,
the world.pix and bldg391.pix images will have a single byte in the
blue channel off by 1, out in the cloud background.  This is not to be
considered an error.
.NH 1
BENCHMARK IMAGE DISPLAY
.PP
If you have a suitable framebuffer,
you may wish to
display the images generated by the benchmark, and compare them
to the reference images.
This section assumes that you have successfully compiled the
full set of BRL-CAD software, not just the benchmark portion.
Programs for dealing with images are in the "util" directory.
To display a \fBpix\fR(5)
file on a framebuffer, set environment variable FB_FILE
(see \fBbrlcad\fR(1)
for details), and run \fBpix-fb\fR.  Note that by leaving
FB_FILE unset, your default display will be used.
.sp
.nf
.ft B
	cd bench
	pix-fb moss.pix
.ft R
.fi
.sp
If the images computed on your machine do not match the reference images,
the program "util/pixdiff" will compute a pix file that will highlight
the differences for you, and report a summary of bytes equal, off-by-1,
and off-by-many, e.g.,
.sp
.ft B
	pixdiff moss.pix ../pix/moss.pix \(or pix-fb
.ft R
.fi
.sp
For a display of the relative magnitude of the differences at
each pixel, use "util/bwdiff" instead, e.g.,
.sp
.nf
.ft B
	bwdiff moss.pix ../pix/moss.pix \(or pix-fb
.ft R
or
.ft B
	bwdiff moss.pix ../pix/moss.pix \(or \\
	bwmod -s 128 -m 4 -a 128 \(or pix-fb
.ft R
.fi
.sp
and for statistics on the differences, use
.sp
.ft B
	bwdiff moss.pix ../pix/moss.pix \(or pixstat
.ft R
.NH 1
THE COMPETITION
.PP
Here is the list of systems that have been tested so far,
with as much information about the configuration as could be obtained.
Some systems have a great many options for small things that can
affect performance, such as memory interleaving.
.LP
.TS
center box;
l l.
System Name	Configuration
_	_
alliant	Alliant FX/8 (8 CEs, 9 IPs, 64 Mbytes), Concentrix 3.0
amsaa-seer	Gould PN 9080, w/MACCs, UTX 2.0, 4x4Mb mem boards
ardec-3	Pyramid 90Mx, Dual-CPU, OSx 2.5, 16 Mbytes
bob.brl.mil	Cray-2, SN 2009, 4.3ns clock
brl-patton	Cray X-MP/48, SN213, COS V115BF2, 8.5ns clock
brl-spark	Gould PN 9050, no MACC, UTX 2.0, 2x4Mb mem boards
brl-sws2	Convex C120, 16 Mbytes, Convex Unix 6.2.32.2
brl-vector	Alliant FX/80 (8 ACEs, 6 IPs, 32 Mbytes), Concentrix
brl-venom	Alliant FX/8 (8 CEs, 6 IPs, 32 Mbytes), Concentrix
brl-vgr	VAX 780, FPA, 4.3 BSD
brl-virus	Sun-3/50, 15 Mhz clock, 12 Mhz 68881, Sun UNIX 3.2
brl-vista	SGI 3030, w/FP chip, UNIX release 3.5
brl-vmb	Gould PN 9080, no MACCs, UTX 2.0, 12x1Mb mem boards
brl-vhs	Silicon Graphics 4D/60T, 12.5 Mhz clock 8MB memory
c1east	T{
Convex C1 XP (2 IOPs, 4 Multibus, 64 Mbytes),
S/W 6.0.1.12
T}
elxsi-gnu	Elxsi 6420, BSD 4.2 16 MB
elxsi-gnuy	Elxsi 6420, Sys Vr2, 16MB
elxsi-m1	Elxsi 6410, BSD 4.2 16 MB
hep	Denelcor HEP, 4 PEMs
indigo	SGI Iris 3030, FPA, GL2-W3.5
mseries	T{
MIPS Mseries, Release 0.6, UMIPS 2.1, 16 MB of R2350 RAM.
R2000 CPU rev 5.0, R2010 FP rev 2.0
T}
multiflow	Multiflow Trace 7/200 (PRELIMINARY)
snm2	Cray 1-M, SN2, UNICOS 2.0
tek4132	Tektronix 4132, 32082 fpp, UTek 2.3
utah-gr	VAX 785, FPA, 4.3 BSD
utah-cs	VAX 8600, FPA, 4.3 BSD
violet	VaxStationII GPX, Ultrix 1.2
vortac	Sun-3/160, 16.67 Mhz clock, 12 Mhz 68881, Sun 3.2
.TE
.NH 1
BENCHMARK RESULTS
.PP
In the tradition of Dongarra, the Rays/sec figure is considered the
"RT Figure of Merit" (RTFM).  Note that the RTFM can only be compared
between different runs on the \fIsame\fR database;  it is not meaningful
to compare RTFM numbers between different databases. The Rays/sec number
for a multi-processor machine is for "aggregate CPU cluster seconds",
rather than rays/total CPU seconds (which remains fairly constant on
good parallel machines). Worthy finalists to date are listed below.
Entries are omitted for tests in which correct results were not
obtained.
.PP
The statistics are recorded in
an easily understood format, with all results for
a particular configuration listed on a single line.
The numbers reported are the rays/sec (RTFM) figure.
Entries denoted with a dagger ("\(dg") produced incorrect results.
Entries denoted with a dash ("-") were not available and should be
considered differently than those entries with a dagger.
Generally the results are not available because time constraints
prevented running the complete set of databases.
.fi
.NH 1
RELEASE 1.20 STATISTICS (12-Feb-1987)
.LP
.TS H
expand box;
l l | n n n n | n | l.
A/*	H/W	Moss	World	Star	Bldg	Mean	S/W Notes
_
.TH
Rays	tek4132	80.5	44.0	33.9	31.4	?	UTek 2.3
*vgr	tek4132	0.72	0.69	0.62	0.62	?
_
Rays	violet	107.7	57.3	44.7	44.1	?	Ultrix 1.2
*vgr	violet	0.96	0.90	0.81	0.87	?
_
Rays	violet	119.0	63.0	50.0	46.3	?	Ultrix 1.2,
*vgr	violet	1.06	0.99	0.91	0.91	?	w/fast_sqrt
_
Rays	vgr	112.1	63.6	55.0	50.7	?	BSD 4.3
*vgr	vgr	1.0	1.0	1.0	1.0	1.0
_
Rays	indigo	115.9	85.3	\(dg	101.8	?	GL2-W3.5
*vgr	indigo	1.03	1.34	\(dg	2.01	?
_
Rays	vista	116.4	86.0	\(dg	102.3	?	SGI UNIX 3.5
*vgr	vista	1.04	1.35	\(dg	2.02	?
_
Rays	virus	127.3	69.9	57.0	52.4	?	Sun UNIX 3.2
*vgr	virus	1.14	1.10	1.04	1.03	?
_
Rays	vortac	148.2	81.0	65.8	60.7	?	Sun UNIX 3.2
*vgr	vortac	1.32	1.27	1.20	1.20	?
_
Rays	utah-gr	191.8	105.8	89.9	86.5	?	4.3 BSD
*vgr	utah-gr	1.71	1.66	1.64	1.71	?
_
Rays	ardec-3	-	68.4	57.2	-	?	OSx 2.5
*vgr	ardec-3	-	1.08	1.04	-	?
_
Rays	elxsim1	380.5	232.2	204.8	189.3	?	BSD 4.2
*vgr	elxsim1	3.39	3.65	3.72	3.73	?
_
Rays	spark	413.4	232.0	213.8	211.9	?	UTX 2.0
*vgr	spark	3.69	3.65	3.89	4.18	?
_
Rays	vmb	413.9	233.4	210.6	212.6	?	UTX 2.0
*vgr	vmb	3.69	3.67	3.83	4.19	?
_
Rays	c1east	454.8	252.4	205.6	192.3	?	Convex UNIX 6.0.1.12,
*vgr	c1east	4.06	3.97	3.74	3.80	?	vanilla cc
_
Rays	seer	460.7	263.2	246.8	241.0	?	UTX 2.0
*vgr	seer	4.11	4.14	4.49	4.75	?
_
Rays	venom	492.9	228.0	180.0	157.1	?	Concentrix 2.0
*vgr	venom	4.40	3.58	3.27	3.10	?
_
Rays	elxgnu	520.6	315.4	264.4	242.0	?	BSD 4.2
*vgr	elxgnu	4.64	4.96	4.81	4.77	?
_
Rays	utah-cs	521.1	292.1	237.4	216.2	?	BSD 4.3
*vgr	utah-cs	4.64	4.59	4.32	4.27	?
_
Rays	c1east	521.6	285.3	230.5	215.1	?	Convex UNIX 6.0.1.12,
*vgr	c1east	4.66	4.49	4.20	4.24	?	vc -O1 (scalar)
_
Rays	c1east	527.7	287.4	228.7	210.0	?	Convex UNIX 6.0.1.12,
*vgr	c1east	4.71	4.52	4.16	4.14	?	vc -O2 (vector)
_
Rays	elxgnuy	644.7	349.3	264.6	242.1	?	System Vr2
*vgr	elxgnuy	5.75	5.49	4.81	4.77	?
_
Rays	mflow	845.2	439.5	313.1	338.9	?	(preliminary)
*vgr	mflow	7.54	6.91	5.69	6.68	?
_
Rays	venom	904.9	424.6	349.3	312.6	?	Concentrix 2.0,
*vgr	venom	8.07	6.68	6.35	6.17	?	2 CEs, no vectors
_
Rays	venom	1375.5	650.0	523.4	459.9	?	Concentrix 2.0,
*vgr	venom	12.27	10.22	9.52	9.07	?	3 CEs, no vectors
_
Rays	venom	1813.5	845.5	686.0	600.7	?	Concentrix 2.0,
*vgr	venom	16.17	13.29	12.47	11.85	?	4 CEs, no vectors
_
Rays	venom	2364.1	1104.4	870.2	775.9	?	Concentrix 2.0,
*vgr	venom	21.08	17.36	15.82	15.3	?	5 CEs, no vectors
_
Rays	snm2	2492.9	-	-	-	?	Unicos 2.0,
*vgr	snm2	22.24	-	-	-	?	no vectors, no optim
_
Rays	hep	2502.0	-	-	-	?	1 PEM, npsw=10
*vgr	hep	22.32	-	-	-	?
_
Rays	venom	2811.4	1319.0	1051.6	918.0	?	Concentrix 2.0,
*vgr	venom	25.08	20.74	19.12	18.1	?	6 CEs, no vectors
_
Rays	venom	3248.8	1533.0	1232.3	1065.9	?	Concentrix 2.0,
*vgr	venom	28.98	24.10	22.41	21.02	?	7 CEs, no vectors
_
Rays	patton	3453.3	1514.3	1271.2	1027.3	?	COS V115BF2
*vgr	patton	30.81	23.81	23.11	20.26	?	1 CPU, no vectors
_
Rays	venom	3677.3	1724.2	1375.4	1208.4	?	Concentrix 2.0,
*vgr	venom	32.80	27.11	25.01	23.83	?	8 CEs, no vectors
_
Rays	alliant	3972.9	1840.0	1457.2	1266.4	?	Concentrix 3.0,
*vgr	alliant	35.44	28.93	26.49	24.98	?	8 CEs, no vectors
_
Rays	hep	4055.9	-	-	-	?	1 PEM, npsw=40
*vgr	hep	36.18	-	-	-	?
_
Rays	patton	6856.6	-	2522.2	-	?	COS V115BF2
*vgr	patton	61.16	-	45.86	-	?	2 CPUs, no vectors
_
Rays	patton	10205.1	-	3749.9	-	?	COS V115BF2
*vgr	patton	91.04	-	68.18	-	?	3 CPUs, no vectors
_
Rays	patton	13320.2	-	4955.6	-	?	COS V115BF2
*vgr	patton	118.82	-	90.10	-	?	4 CPUs, no vectors
.TE
.NH 1
RELEASE 2.3 STATISTICS (2-Nov-1987)
.LP
.TS H
expand box;
l l | n n n n | n | l.
A/*	H/W	Moss	World	Star	Bldg	Mean	S/W Notes
_
.TH
Rays	vgr	118.8	64.9	36.5	34.2	?	BSD 4.3
*vgr	vgr	1.0	1.0	1.0	1.0	1.0
_
Rays	vmb	375.4	218.6	186.4	196.2	?	UTX 2.0
*vgr	vmb	3.16	3.37	5.11	5.74	?
_
Rays	venom	468.2	221.7	166.1	144.9	?	Concentrix 3.0,
*vgr	venom	3.94	3.42	4.55	4.24	?	1 CE, no vectors
_
Rays	sws2	471.9	258.4	202.5	186.4	?	Convex Unix 6.2.32.2
*vgr	sws2	3.97	3.98	5.55	5.45	?	vanilla cc -O
_
Rays	vector	656.6	301.6	221.1	195.0	?	Concentrix 3.0,
*vgr	vector	5.53	4.65	6.06	5.70	?	1 ACE, no vectors
_
Rays	venom	827.3	424.0	327.1	287.9	?	Concentrix 3.0,
*vgr	venom	6.96	6.53	8.96	8.42	?	2 CEs, no vectors
_
Rays	vhs	958.3	545.6	447.0	414.1	?	-O2 optimization
*vgr	vhs	8.07	9.41	12.25	12.11	?
_
Rays	mseries	988.3	603.5	515.6	491.6	?
*vgr	mseries	8.32	9.29	14.13	14.37	?
_
Rays	vector	1280.9	596.8	436.7	389.2	?	Concentrix 3.0,
*vgr	vector	10.78	9.19	11.96	11.38	?	2 ACEs, no vectors
_
Rays	venom	1288.7	630.6	486.4	428.0	?	Concentrix 3.0,
*vgr	venom	10.85	9.72	13.33	12.51	?	3 CEs, no vectors
_
Rays	venom	1732.9	853.2	645.4	560.1	?	Concentrix 3.0,
*vgr	venom	14.59	13.15	17.68	16.38	?	4 CEs, no vectors
_
Rays	bob	1856.7	801.9	574.1	500.3	?	1 CPU, UNICOS 3.0,
*vgr	bob	15.63	12.36	15.73	15.62	?	CC -O
_
Rays	vector	1952.1	881.7	647.6	578.8	?	Concentrix 3.0,
*vgr	vector	16.43	13.58	17.74	16.92	?	3 ACEs, no vectors
_
Rays	venom	2158.4	1031.3	797.3	703.1	?	Concentrix 3.0,
*vgr	venom	18.17	15.89	21.84	20.56	?	5 CEs, no vectors
_
Rays	bob	2346.1	1127.4	751.0	677.2	?	1 CPU UNICOS 4.0
*vgr	bob	19.75	17.37	20.57	19.80	?	CC -O
_
Rays	bob	2423.5	1045.7	719.3	609.4	?	1 CPU, UNICOS 3.0,
*vgr	bob	20.40	16.11	19.71	17.82	?	VCC -O
_
Rays	vector	2546.2	1170.0	867.2	758.7	?	Concentrix 3.0,
*vgr	vector	21.43	18.03	23.76	22.18	?	4 ACEs, no vectors
_
Rays	venom	2633.7	1232.7	943.4	839.5	?	Concentrix 3.0,
*vgr	venom	22.17	18.99	25.85	24.55	?	6 CEs, no vectors
_
Rays	venom	2769.4	1393.3	1098.1	971.6	?	Concentrix 3.0,
*vgr	venom	23.31	21.47	30.08	28.41	?	7 CEs, no vectors
_
Rays	vector	3131.2	1453.8	1065.8	945.4	?	Concentrix 3.0,
*vgr	vector	26.36	22.40	29.20	27.64	?	5 ACEs, no vectors
_
Rays	venom	3368.7	1605.3	1231.3	1095.11	?	Concentrix 3.0,
*vgr	venom	28.36	24.73	33.73	32.02	?	8 CEs, no vectors
_
Rays	patton	3456.5	1691.8	1169.0	1043.6	?	1 CPU, UNICOS 2.1
*vgr	patton	29.10	26.07	32.03	30.51	?	no vectors
_
Rays	vector	3686.4	1688.6	1259.1	1129.0	?	Concentrix 3.0,
*vgr	vector	31.03	26.02	34.49	33.01	?	6 ACEs, no vectors
_
Rays	vector	4140.3	1953.0	1463.3	1299.7	?	Concentrix 3.0,
*vgr	vector	34.85	30.09	40.09	38.00	?	7 ACEs, no vectors
_
Rays	bob	4641.7	2243.4	1498.2	1358.1	?	2 CPUs, UNICOS 4.0
*vgr	bob	39.07	34.57	41.05	39.71	?	CC -O
_
Rays	vector	4712.2	2226.3	1649.0	1469.7	?	Concentrix 3.0,
*vgr	vector	39.66	34.30	45.18	42.97	?	8 ACEs, no vectors
_
Rays	bob	6884.9	3422.4	2267.7	2034.3	?	3 CPUs, UNICOS 4.0
*vgr	bob	57.95	52.73	62.13	59.48	?	CC -O
_
Rays	bob	9477.1	4484.7	2947.0	2832.9	?	4 CPUs, UNICOS 4.0
*vgr	bob	79.77	69.10	80.76	82.83	?	CC -O
.TE
.NH 1
RELEASE 3.0 STATISTICS
.PP
Actual statistics for Release 3.0 were not available at the time
of this printing, because the manuals are sent to the printers
a month before the software is finalized.  Some preliminary results
have been included as available.  The Release 3.0 software tape
will have an updated version of this document with the results of
several machines of interest.
.LP
.TS H
expand box;
l l | n n n n | n | l.
A/*	H/W	Moss	World	Star	Bldg	Mean	S/W Notes
_
.TH
Abs	vgr	?	?	?	?	?	BSD 4.3 [PRELIM]
*vgr	vgr	1.0	1.0	1.0	1.0	1.0
_
Abs	vmb	409.5	201.9	181.0	179.0	?	UTX 2.0 [PRELIM]
*vgr	vmb	?	?	?	?	?
_
Abs	vector	5802.92	2261.92	1640.83	1419.19	2781.21	Alliant 3.0
*vgr	vector	47.31	38.12	35.45	30.88	37.94	8 Processors
.TE
.NH 1
ADDITIONAL STATISTICS
.PP
It would be greatly appreciated if you would return to BRL any
statistics that you gather, including:  which BRL CAD release
was used, the manufacturer of the machine,
hardware model name/number,
OS/compiler software version numbers,
presence or absence of floating point hardware,
and the local name (preferably InterNet or UUCP) of the
specific machine used.
